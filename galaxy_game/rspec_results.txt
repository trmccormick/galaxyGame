[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[33m*[0m[33m*[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[33m*[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[33m*[0m[31mF[0m[31mF[0m[32m.[0m[33m*[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[33m*[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[33m*[0m[32m.[0m[32m.[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[33m*[0m[33m*[0m[33m*[0m[32m.[0m[32m.[0m[31mF[0m[33m*[0m[33m*[0m[32m.[0m[33m*[0m[31mF[0m[33m*[0m[33m*[0m[33m*[0m[31mF[0m[31mF[0m[31mF[0m[33m*[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[33m*[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[33m*[0m[32m.[0m[32m.[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[32m.[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[33m*[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[33m*[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[33m*[0m[32m.[0m[31mF[0m[31mF[0m[33m*[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[33m*[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[31mF[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[31mF[0m[31mF[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m

Pending: (Failures listed here are expected and do not affect your suite's status)
[33m
  1) CelestialBodies::BrownDwarf habitable zones has a limited habitable zone[0m
     [36m# Habitable zone calculations not yet implemented for brown dwarfs[0m
[36m     # ./spec/models/celestial_bodies/brown_dwarf_spec.rb:127
[0m[33m
  2) CelestialBodies::BrownDwarf relationships with planets can have orbiting planets[0m
     [36m# Brown dwarf planetary systems not yet implemented[0m
[36m     # ./spec/models/celestial_bodies/brown_dwarf_spec.rb:135
[0m[33m
  3) CelestialBodies::Spheres::Geosphere#calculate_materials calculates and updates materials based on crust, mantle, and core composition[0m
     [36m# calculate_materials method not yet implemented[0m
[36m     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:45
[0m[33m
  4) CelestialBodies::Spheres::Geosphere callbacks triggers TerraSim service after adding a material[0m
     [36m# run_terrasim_service method not yet implemented[0m
[36m     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:168
[0m[33m
  5) CelestialBodies::Spheres::Geosphere material transfers transfers material to atmosphere when heated[0m
     [36m# heat_material method not yet implemented[0m
[36m     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:219
[0m[33m
  6) Galaxy#total_mass calculates total mass properly[0m
     [36m# Implement this when total_mass method exists[0m
[36m     # ./spec/models/galaxy_spec.rb:89
[0m[33m
  7) Lookup::CraftLookupService#find_craft loads JSON files with correct format[0m
     [36m# No craft JSON files found to test[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:19
[0m[33m
  8) Lookup::CraftLookupService#find_craft uses cached results for subsequent lookups[0m
     [36m# No craft JSON files found to test caching[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:41
[0m[33m
  9) Lookup::CraftLookupService#find_craft with real craft data matches by category[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:68
[0m[33m
  10) Lookup::CraftLookupService#find_craft with real craft data matches by id[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:75
[0m[33m
  11) Lookup::CraftLookupService#find_craft with real craft data matches by name[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:82
[0m[33m
  12) Lookup::CraftLookupService#find_craft with real craft data matches by subcategory if present[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:89
[0m[33m
  13) Lookup::CraftLookupService#find_craft with real craft data matches by partial id with sufficient length[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:96
[0m[33m
  14) Lookup::CraftLookupService#find_craft with real craft data is case insensitive[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:108
[0m[33m
  15) Lookup::CraftLookupService#find_craft with real craft data matches by partial name with sufficient length[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:116
[0m[33m
  16) Lookup::CraftLookupService#find_craft with real craft data handles special characters in queries[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:129
[0m[33m
  17) Lookup::CraftLookupService#find_craft with real craft data handles whitespace in queries[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:142
[0m[33m
  18) Lookup::CraftLookupService#find_craft with real craft data can match by multiple criteria simultaneously[0m
     [36m# No craft data available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:151
[0m[33m
  19) Lookup::CraftLookupService using actual data files finds a specific craft by id[0m
     [36m# No craft data files available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:242
[0m[33m
  20) Lookup::CraftLookupService using actual data files finds a craft by category[0m
     [36m# No craft data files available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:249
[0m[33m
  21) Lookup::CraftLookupService using actual data files can find crafts by folder structure[0m
     [36m# No craft data files available for testing[0m
[36m     # ./spec/services/lookup/craft_lookup_service_spec.rb:257
[0m[33m
  22) Lookup::ItemLookupService#find_item finds consumable items with correct data[0m
     [36m# No consumable item files found[0m
[36m     # ./spec/services/lookup/item_lookup_service_spec.rb:17
[0m[33m
  23) Lookup::ItemLookupService#find_item finds equipment items with correct data[0m
     [36m# No equipment item files found[0m
[36m     # ./spec/services/lookup/item_lookup_service_spec.rb:31
[0m[33m
  24) Lookup::ItemLookupService#find_item handles dynamic unassembled items[0m
     [36m# Requires operational data[0m
[36m     # ./spec/services/lookup/item_lookup_service_spec.rb:50
[0m[33m
  25) Lookup::ItemLookupService#find_item caches results for subsequent lookups[0m
     [36m# No item files found[0m
[36m     # ./spec/services/lookup/item_lookup_service_spec.rb:68
[0m[33m
  26) Lookup::ItemLookupService#find_item finds items by partial name match[0m
     [36m# No item files found[0m
[36m     # ./spec/services/lookup/item_lookup_service_spec.rb:89
[0m[33m
  27) Lookup::ItemLookupService#find_item is case insensitive[0m
     [36m# No item files found[0m
[36m     # ./spec/services/lookup/item_lookup_service_spec.rb:107
[0m[33m
  28) Lookup::ItemLookupService integration with other lookup services converts materials to items when needed[0m
     [36m# Requires material data[0m
[36m     # ./spec/services/lookup/item_lookup_service_spec.rb:150
[0m[33m
  29) Lookup::MaterialLookupService#get_molar_mass returns molar mass for existing materials[0m
     [36m# Oxygen fixture not found[0m
[36m     # ./spec/services/lookup/material_lookup_service_spec.rb:139
[0m[33m
  30) Lookup::ModuleLookupService module data structure validation when co2_scrubber module exists has all expected module properties[0m
     [36m# co2_scrubber module not found[0m
[36m     # ./spec/services/lookup/module_lookup_service_spec.rb:70
[0m[33m
  31) Lookup::ModuleLookupService module data structure validation when co2_scrubber module exists has correct energy consumption[0m
     [36m# co2_scrubber module not found[0m
[36m     # ./spec/services/lookup/module_lookup_service_spec.rb:79
[0m[33m
  32) Lookup::ModuleLookupService module data structure validation when co2_scrubber module exists has input and output resources[0m
     [36m# co2_scrubber module not found[0m
[36m     # ./spec/services/lookup/module_lookup_service_spec.rb:86
[0m[33m
  33) Lookup::ModuleLookupService module data structure validation when co2_scrubber module exists follows the operational data template[0m
     [36m# co2_scrubber module not found[0m
[36m     # ./spec/services/lookup/module_lookup_service_spec.rb:103
[0m[33m
  34) Lookup::ModuleLookupService module data structure validation when life_support module exists has basic life support properties[0m
     [36m# life_support module not found[0m
[36m     # ./spec/services/lookup/module_lookup_service_spec.rb:117
[0m[33m
  35) Lookup::ModuleLookupService module data structure validation when life_support module exists follows the operational data template[0m
     [36m# life_support module not found[0m
[36m     # ./spec/services/lookup/module_lookup_service_spec.rb:125
[0m[33m
  36) Lookup::UnitLookupService#find_unit finds units case-insensitively by ID[0m
     [36m# No unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:103
[0m[33m
  37) Lookup::UnitLookupService#find_unit with propulsion units finds propulsion units by their exact ID[0m
     [36m# No propulsion unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:54
[0m[33m
  38) Lookup::UnitLookupService#find_unit with propulsion units has expected propulsion unit properties[0m
     [36m# No propulsion unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:63
[0m[33m
  39) Lookup::UnitLookupService#find_unit with habitat units finds habitat units by their ID[0m
     [36m# No habitat unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:78
[0m[33m
  40) Lookup::UnitLookupService#find_unit with robot units finds robot units by their ID[0m
     [36m# No robot deployment unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:93
[0m[33m
  41) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has all expected top-level unit properties[0m
     [36m# No propulsion units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:147
[0m[33m
  42) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has performance properties if applicable[0m
     [36m# No propulsion units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:153
[0m[33m
  43) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has operational properties[0m
     [36m# No propulsion units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:158
[0m[33m
  44) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has maintenance requirements if defined[0m
     [36m# No propulsion units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:166
[0m[33m
  45) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has operational modes if defined[0m
     [36m# No propulsion units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:171
[0m[33m
  46) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has telemetry metadata if defined[0m
     [36m# No propulsion units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:179
[0m[33m
  47) Lookup::UnitLookupService unit data structure validation when any storage unit exists has storage capacity properties[0m
     [36m# No storage units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:195
[0m[33m
  48) Lookup::UnitLookupService unit data structure validation when any storage unit exists has alias support if defined[0m
     [36m# No storage units found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:203
[0m[33m
  49) Lookup::UnitLookupService matching behavior matches by exact ID[0m
     [36m# No unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:217
[0m[33m
  50) Lookup::UnitLookupService matching behavior matches by exact name[0m
     [36m# No unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:222
[0m[33m
  51) Lookup::UnitLookupService matching behavior matches by partial ID with sufficient length[0m
     [36m# No unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:226
[0m[33m
  52) Lookup::UnitLookupService matching behavior is case insensitive[0m
     [36m# No unit files found[0m
[36m     # ./spec/services/lookup/unit_lookup_service_spec.rb:233
[0m[33m
  53) ManufacturingService.manufacture with real blueprint data creates material requests based on actual blueprint requirements[0m
     [36m# This test expects material requests for a player with available materials, but the intended behavior is to only create material requests for AI managers or when materials are missing.[0m
[36m     # ./spec/services/manfacturing_service_spec.rb:161
[0m[33m
  54) Manufacturing::Service.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint[0m
     [36m# Liquid Rocket Engine blueprint not found[0m
[36m     # ./spec/services/manufacturing/service_spec.rb:52
[0m[33m
  55) Manufacturing::Service.manufacture with real blueprint data creates material requests based on actual blueprint requirements[0m
     [36m# This test expects material requests for a player with available materials, but the intended behavior is to only create material requests for AI managers or when materials are missing.[0m
[36m     # ./spec/services/manufacturing/service_spec.rb:159
[0m
  56) TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants
      [36m# ice_tectonics_enabled attribute doesn't exist in Geosphere model[0m
      [33mFailure/Error: expect(ice_giant.geosphere.ice_tectonics_enabled).to be true[0m
      [33m[0m
      [33mNoMethodError:[0m
      [33m  undefined method 'ice_tectonics_enabled' for an instance of CelestialBodies::Spheres::Geosphere[0m
      [36m# ./spec/services/terra_sim/geosphere_initalizer_spec.rb:82:in 'block (3 levels) in <main>'[0m

Failures:

  1) Admin::AiManagerController GET #planner runs simulation when pattern is provided
     [31mFailure/Error: resources << 'co2' if atmo.gas_percentage('CO2') > 0.01[0m
     [31m  #<Double "MarsAtmosphere"> received unexpected message :gas_percentage with ("CO2")[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:95:in 'AIManager::PrecursorCapabilityService#atmospheric_resources'[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:71:in 'AIManager::PrecursorCapabilityService#extract_local_resources'[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:31:in 'AIManager::PrecursorCapabilityService#local_resources'[0m
     [36m# ./app/services/ai_manager/mission_planner_service.rb:46:in 'AIManager::MissionPlannerService#initialize'[0m
     [36m# ./app/controllers/admin/ai_manager_controller.rb:52:in 'Class#new'[0m
     [36m# ./app/controllers/admin/ai_manager_controller.rb:52:in 'Admin::AiManagerController#planner'[0m
     [36m# /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'[0m
     [36m# /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'[0m
     [36m# /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'[0m
     [36m# /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'[0m
     [36m# /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'[0m
     [36m# /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'[0m
     [36m# ./spec/controllers/admin/ai_manager_controller_spec.rb:148:in 'block (3 levels) in <top (required)>'[0m

  2) Admin::AiManagerController GET #planner uses default parameters if not provided
     [31mFailure/Error: resources << 'co2' if atmo.gas_percentage('CO2') > 0.01[0m
     [31m  #<Double "MarsAtmosphere"> received unexpected message :gas_percentage with ("CO2")[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:95:in 'AIManager::PrecursorCapabilityService#atmospheric_resources'[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:71:in 'AIManager::PrecursorCapabilityService#extract_local_resources'[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:31:in 'AIManager::PrecursorCapabilityService#local_resources'[0m
     [36m# ./app/services/ai_manager/mission_planner_service.rb:46:in 'AIManager::MissionPlannerService#initialize'[0m
     [36m# ./app/controllers/admin/ai_manager_controller.rb:52:in 'Class#new'[0m
     [36m# ./app/controllers/admin/ai_manager_controller.rb:52:in 'Admin::AiManagerController#planner'[0m
     [36m# /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'[0m
     [36m# /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'[0m
     [36m# /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'[0m
     [36m# /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'[0m
     [36m# /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'[0m
     [36m# /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'[0m
     [36m# ./spec/controllers/admin/ai_manager_controller_spec.rb:161:in 'block (3 levels) in <top (required)>'[0m

  3) Admin::AiManagerController POST #export_plan exports simulation plan as JSON
     [31mFailure/Error: resources << 'co2' if atmo.gas_percentage('CO2') > 0.01[0m
     [31m  #<Double "MarsAtmosphere"> received unexpected message :gas_percentage with ("CO2")[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:95:in 'AIManager::PrecursorCapabilityService#atmospheric_resources'[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:71:in 'AIManager::PrecursorCapabilityService#extract_local_resources'[0m
     [36m# ./app/services/ai_manager/precursor_capability_service.rb:31:in 'AIManager::PrecursorCapabilityService#local_resources'[0m
     [36m# ./app/services/ai_manager/mission_planner_service.rb:46:in 'AIManager::MissionPlannerService#initialize'[0m
     [36m# ./app/controllers/admin/ai_manager_controller.rb:69:in 'Class#new'[0m
     [36m# ./app/controllers/admin/ai_manager_controller.rb:69:in 'Admin::AiManagerController#export_plan'[0m
     [36m# /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'[0m
     [36m# /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'[0m
     [36m# /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'[0m
     [36m# /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'[0m
     [36m# /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'[0m
     [36m# /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'[0m
     [36m# ./spec/controllers/admin/ai_manager_controller_spec.rb:172:in 'block (3 levels) in <top (required)>'[0m

  4) TerrestrialPlanetsController PATCH/PUT #update with valid parameters updates the requested terrestrial_planet
     [31mFailure/Error: expect(terrestrial_planet.surface_temperature).to eq(210)[0m
     [31m[0m
     [31m  expected: 210[0m
     [31m       got: 0.0[0m
     [31m[0m
     [31m  (compared using ==)[0m
     [36m# ./spec/controllers/terrestrial_planets_spec.rb:92:in 'block (4 levels) in <main>'[0m

  5) Alien World Template Integrity atmosphere rules has pressure > 0
     [31mFailure/Error: expect(pressure).to be > 0[0m
     [31m[0m
     [31m  expected: > 0[0m
     [31m       got:   nil[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:87:in 'block (4 levels) in <main>'[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:85:in 'Array#each'[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:85:in 'block (3 levels) in <main>'[0m

  6) Alien World Template Integrity volatile reservoirs has CO2 and H2O reservoirs defined
     [31mFailure/Error: expect(reservoir).to include('total_CO2_available', 'total_H2O_available')[0m
     [31m[0m
     [31m  expected {"CO2" => 1000.0, "H2O" => 500.0} to include "total_CO2_available" and "total_H2O_available"[0m
     [31m  Diff:[0m[0m
     [31m  [0m[34m@@ -1,2 +1,3 @@[0m
     [31m  [0m[31m-["total_CO2_available", "total_H2O_available"][0m
     [31m  [0m[32m+"CO2" => 1000.0,[0m
     [31m  [0m[32m+"H2O" => 500.0,[0m
     [31m  [0m[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:114:in 'block (4 levels) in <main>'[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:112:in 'Array#each'[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:112:in 'block (3 levels) in <main>'[0m

  7) Alien World Template Integrity material yield bias contains all yield bias categories
     [31mFailure/Error:[0m
     [31m  expect(bias.keys).to contain_exactly([0m
     [31m    'rare_earth_elements',[0m
     [31m    'precious_metals',[0m
     [31m    'industrial_metals'[0m
     [31m  )[0m
     [31m[0m
     [31m  expected collection contained:  ["industrial_metals", "precious_metals", "rare_earth_elements"][0m
     [31m  actual collection contained:    ["industrial_metal", "precious_metal", "rare_earth"][0m
     [31m  the missing elements were:      ["industrial_metals", "precious_metals", "rare_earth_elements"][0m
     [31m  the extra elements were:        ["industrial_metal", "precious_metal", "rare_earth"][0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:124:in 'block (4 levels) in <main>'[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:122:in 'Array#each'[0m
     [36m# ./spec/data/alien_world_templates_integrity_spec.rb:122:in 'block (3 levels) in <main>'[0m

  8) TerrestrialPlanets User views a planet detail
     [31mFailure/Error: expect(page).to have_content("Nitrogen: 7808000.0")[0m
     [31m  expected to find text "Nitrogen: 7808000.0" in "Blocked hosts: localhost\nTo allow requests to these hosts, make sure they are valid hostnames (containing only numbers, letters, dashes and dots), then add the following to your environment configuration:\nconfig.hosts << \"localhost\"\nFor more details view: the Host Authorization guide"[0m
     [36m# ./spec/features/terrestrial_planets_feature_spec.rb:22:in 'block (2 levels) in <main>'[0m

  9) TerrestrialPlanets User updates a planet's name only
     [31mFailure/Error: fill_in "Name", with: "Updated Earth"[0m
     [31m[0m
     [31mCapybara::ElementNotFound:[0m
     [31m  Unable to find field "Name" that is not disabled[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/finders.rb:312:in 'block in Capybara::Node::Finders#synced_resolve'[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/actions.rb:91:in 'Capybara::Node::Actions#fill_in'[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#fill_in'[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'[0m
     [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#fill_in'[0m
     [36m# ./spec/features/terrestrial_planets_feature_spec.rb:58:in 'block (2 levels) in <main>'[0m

  10) TerrestrialPlanets User updates a planet with all attributes
      [31mFailure/Error: fill_in "Name", with: "Updated Earth"[0m
      [31m[0m
      [31mCapybara::ElementNotFound:[0m
      [31m  Unable to find field "Name" that is not disabled[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/finders.rb:312:in 'block in Capybara::Node::Finders#synced_resolve'[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/node/actions.rb:91:in 'Capybara::Node::Actions#fill_in'[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#fill_in'[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'[0m
      [36m# /usr/local/bundle/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#fill_in'[0m
      [36m# ./spec/features/terrestrial_planets_feature_spec.rb:79:in 'block (2 levels) in <main>'[0m

  11) Component Production Game Loop Integration full production cycle produces components through game loop progression
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/component_production_game_loop_spec.rb:131:in 'block (3 levels) in <main>'[0m

  12) Component Production Game Loop Integration full production cycle handles partial progress over multiple ticks
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/component_production_game_loop_spec.rb:157:in 'block (3 levels) in <main>'[0m

  13) Component Production Game Loop Integration full production cycle processes multiple jobs simultaneously
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/component_production_game_loop_spec.rb:177:in 'block (3 levels) in <main>'[0m

  14) Covering System Integration Lava tube worldhouse covering workflow seals skylights when worldhouse construction completes
      [31mFailure/Error:[0m
      [31m  worldhouse = Structures::Worldhouse.create!([0m
      [31m    geological_feature: lava_tube,[0m
      [31m    settlement: luna_settlement,[0m
      [31m    owner: luna_settlement.owner,[0m
      [31m    structure_name: 'worldhouse',[0m
      [31m    operational_data: {[0m
      [31m      "structure_type" => "worldhouse",[0m
      [31m      "connection_systems" => {[0m
      [31m        "power_distribution" => {"status" => "offline", "efficiency" => 85}[0m
      [31m      },[0m
      [31m[0m
      [31mActiveRecord::RecordInvalid:[0m
      [31m  Validation failed: Structure type can't be blank[0m
      [36m# ./spec/integration/covering_system_integration_spec.rb:49:in 'block (3 levels) in <main>'[0m

  15) Covering System Integration Worldhouse segment covering workflow handles massive scale covering
      [31mFailure/Error:[0m
      [31m  Structures::Worldhouse.create!([0m
      [31m    name: 'Valles Marineris Worldhouse',[0m
      [31m    geological_feature: valley,[0m
      [31m    settlement: mars_settlement,[0m
      [31m    owner: mars_settlement.owner,[0m
      [31m    structure_name: 'worldhouse',[0m
      [31m    operational_data: {[0m
      [31m      "structure_type" => "worldhouse",[0m
      [31m      "connection_systems" => {[0m
      [31m        "power_distribution" => {"status" => "offline", "efficiency" => 85}[0m
      [31m[0m
      [31mActiveRecord::RecordInvalid:[0m
      [31m  Validation failed: Structure type can't be blank[0m
      [36m# ./spec/integration/covering_system_integration_spec.rb:114:in 'block (3 levels) in <main>'[0m
      [36m# ./spec/integration/covering_system_integration_spec.rb:147:in 'block (3 levels) in <main>'[0m
      [36m# ./spec/integration/covering_system_integration_spec.rb:157:in 'block (3 levels) in <main>'[0m

  16) Covering System Integration Multi-scale comparison uses same system for different scales
      [31mFailure/Error:[0m
      [31m  worldhouse = Structures::Worldhouse.create!([0m
      [31m    name: 'Test Worldhouse',[0m
      [31m    geological_feature: valley,[0m
      [31m    settlement: mars_settlement,[0m
      [31m    owner: mars_settlement.owner,[0m
      [31m    structure_name: 'worldhouse',[0m
      [31m    operational_data: {[0m
      [31m      "structure_type" => "worldhouse",[0m
      [31m      "connection_systems" => {[0m
      [31m        "power_distribution" => {"status" => "offline", "efficiency" => 85}[0m
      [31m[0m
      [31mActiveRecord::RecordInvalid:[0m
      [31m  Validation failed: Structure type can't be blank[0m
      [36m# ./spec/integration/covering_system_integration_spec.rb:193:in 'block (3 levels) in <main>'[0m

  17) Manufacturing Pipeline End-to-End complete ISRU to enclosed tank pipeline processes raw regolith through all stages to produce an enclosed tank
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/manufacturing_pipeline_e2e_spec.rb:333:in 'block (3 levels) in <main>'[0m

  18) Manufacturing Pipeline End-to-End pipeline with multiple batches can process multiple batches concurrently
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/manufacturing_pipeline_e2e_spec.rb:571:in 'block (3 levels) in <main>'[0m

  19) Manufacturing Pipeline End-to-End material tracking through pipeline preserves composition metadata through processing chain
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/manufacturing_pipeline_e2e_spec.rb:611:in 'block (3 levels) in <main>'[0m

  20) Shell Printing Game Loop Integration full shell printing cycle encloses inflatable tank through game loop progression
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/shell_printing_game_loop_spec.rb:147:in 'block (3 levels) in <main>'[0m

  21) Shell Printing Game Loop Integration full shell printing cycle tracks material composition in shell metadata
      [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
      [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
      [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
      [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
      [36m# ./spec/integration/shell_printing_game_loop_spec.rb:165:in 'block (3 levels) in <main>'[0m

  22) Terraforming Integration end-to-end terraforming simulation creates a barren planet with correct initial conditions
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:69:in 'block (3 levels) in <main>'[0m

  23) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time increases oxygen levels after 1 day
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:121:in 'block (5 levels) in <main>'[0m

  24) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time decreases CO2 levels after 1 day
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:31:in 'AtmosphereConcern#co2_percentage'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:131:in 'block (5 levels) in <main>'[0m

  25) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time shows progressive changes over 100 days
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:141:in 'block (5 levels) in <main>'[0m

  26) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time scales effects by time parameter
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:85:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:29:in 'TerraSim::BiosphereSimulationService#simulate'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:173:in 'block (5 levels) in <main>'[0m

  27) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed life form populations over time maintains or grows populations under favorable conditions
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:85:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:29:in 'TerraSim::BiosphereSimulationService#simulate'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:203:in 'block (5 levels) in <main>'[0m

  28) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed combined effects from multiple species aggregates atmospheric effects from all life forms
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:229:in 'block (5 levels) in <main>'[0m

  29) Terraforming Integration end-to-end terraforming simulation without life forms uses fallback values when no terraforming organisms exist
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:245:in 'block (4 levels) in <main>'[0m

  30) Terraforming Integration realistic terraforming scenario demonstrates full terraforming workflow
      [31mFailure/Error: return composition[formula_or_name].to_f if composition[formula_or_name][0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'[0m
      [36m# ./spec/integration/terraforming_integration_spec.rb:300:in 'block (3 levels) in <main>'[0m

  31) Terraforming Workflow Integration transforms atmosphere over time with deployed organisms
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: O2. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:143:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:29:in 'TerraSim::BiosphereSimulationService#simulate'[0m
      [36m# ./app/services/terra_sim/simulator.rb:79:in 'TerraSim::Simulator#update_spheres'[0m
      [36m# ./app/services/terra_sim/simulator.rb:26:in 'TerraSim::Simulator#calc_current'[0m
      [36m# ./app/models/celestial_bodies/celestial_body.rb:686:in 'CelestialBodies::CelestialBody#run_terra_sim'[0m
      [36m# ./spec/integration/terraforming_workflow_spec.rb:28:in 'block (2 levels) in <main>'[0m

  32) Terraforming Workflow Integration allows monitoring of terraforming progress
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: O2. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:143:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
      [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:29:in 'TerraSim::BiosphereSimulationService#simulate'[0m
      [36m# ./app/services/terra_sim/simulator.rb:79:in 'TerraSim::Simulator#update_spheres'[0m
      [36m# ./app/services/terra_sim/simulator.rb:26:in 'TerraSim::Simulator#calc_current'[0m
      [36m# ./app/models/celestial_bodies/celestial_body.rb:686:in 'CelestialBodies::CelestialBody#run_terra_sim'[0m
      [36m# ./spec/integration/terraforming_workflow_spec.rb:28:in 'block (2 levels) in <main>'[0m

  33) ConcurrentTaskWorkerJob#perform with manufacturing task during daylight executes the task successfully
      [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(1.0)[0m
      [31m  #<Location::CelestialLocation id: 19367, name: "Location 17", coordinates: "59.64°S 10.52°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 17486, celestial_body_id: 44623, created_at: "2026-01-19 04:24:52.391442000 +0000", updated_at: "2026-01-19 04:24:52.415120000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
      [36m# ./spec/jobs/concurrent_task_worker_job_spec.rb:30:in 'block (4 levels) in <main>'[0m

  34) ConcurrentTaskWorkerJob#perform with manufacturing task during daylight generates manufacturing byproducts
      [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(1.0)[0m
      [31m  #<Location::CelestialLocation id: 19368, name: "Location 18", coordinates: "26.17°N 153.57°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 17487, celestial_body_id: 44624, created_at: "2026-01-19 04:24:52.603883000 +0000", updated_at: "2026-01-19 04:24:52.631221000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
      [36m# ./spec/jobs/concurrent_task_worker_job_spec.rb:30:in 'block (4 levels) in <main>'[0m

  35) ConcurrentTaskWorkerJob#perform with manufacturing task during low light does not generate byproducts
      [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(0.05) # Below 0.1 threshold[0m
      [31m  #<Location::CelestialLocation id: 19369, name: "Location 19", coordinates: "3.97°N 141.86°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 17488, celestial_body_id: 44625, created_at: "2026-01-19 04:24:52.824775000 +0000", updated_at: "2026-01-19 04:24:52.845988000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
      [36m# ./spec/jobs/concurrent_task_worker_job_spec.rb:51:in 'block (4 levels) in <main>'[0m

  36) ConcurrentTaskWorkerJob#perform with non-manufacturing task does not attempt byproduct generation
      [31mFailure/Error: solar_factor = settlement.location&.solar_output_factor || 1.0[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'solar_output_factor' for an instance of Location::CelestialLocation[0m
      [36m# ./app/jobs/concurrent_task_worker_job.rb:30:in 'ConcurrentTaskWorkerJob#handle_manufacturing_byproducts'[0m
      [36m# ./app/jobs/concurrent_task_worker_job.rb:12:in 'ConcurrentTaskWorkerJob#perform'[0m
      [36m# /usr/local/bundle/gems/i18n-1.14.7/lib/i18n.rb:348:in 'I18n::Base#with_locale'[0m
      [36m# ./spec/jobs/concurrent_task_worker_job_spec.rb:73:in 'block (4 levels) in <main>'[0m

  37) Financial::Account validations is expected to validate that :balance looks like a number greater than or equal to 0
      [31mFailure/Error: it { should validate_numericality_of(:balance).is_greater_than_or_equal_to(0) }[0m
      [31m[0m
      [31m  Expected Financial::Account to validate that :balance looks like a[0m
      [31m  number greater than or equal to 0, but this could not be proved.[0m
      [31m    After setting :balance to ‹-1›, the matcher expected the[0m
      [31m    Financial::Account to be invalid, but it was valid instead.[0m
      [36m# ./spec/models/account_spec.rb:18:in 'block (3 levels) in <main>'[0m

  38) Financial::Account#deposit with a valid amount increases the account balance
      [31mFailure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:25:in 'block (5 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:24:in 'block (4 levels) in <main>'[0m

  39) Financial::Account#deposit with an invalid amount (negative) raises an error and does not modify the balance
      [31mFailure/Error:[0m
      [31m  expect { player_account.deposit(-500, "Invalid deposit") }[0m
      [31m    .to raise_error(ArgumentError, "Amount must be positive")[0m
      [31m[0m
      [31m  expected ArgumentError with "Amount must be positive", got #<NameError: uninitialized constant Account> with backtrace:[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [31m    # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'[0m
      [31m    # ./spec/models/account_spec.rb:38:in 'block (5 levels) in <main>'[0m
      [31m    # ./spec/models/account_spec.rb:38:in 'block (4 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:38:in 'block (4 levels) in <main>'[0m

  40) Financial::Account#withdraw when funds are sufficient decreases the account balance
      [31mFailure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:50:in 'block (5 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:49:in 'block (4 levels) in <main>'[0m

  41) Financial::Account#withdraw when funds are insufficient raises an error and does not modify the balance
      [31mFailure/Error:[0m
      [31m  expect { player_account.withdraw(2_000, "Overdraft attempt") }[0m
      [31m    .to raise_error("Insufficient funds")[0m
      [31m[0m
      [31m  expected Exception with "Insufficient funds", got #<NameError: uninitialized constant Account> with backtrace:[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [31m    # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'[0m
      [31m    # ./spec/models/account_spec.rb:63:in 'block (5 levels) in <main>'[0m
      [31m    # ./spec/models/account_spec.rb:63:in 'block (4 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:63:in 'block (4 levels) in <main>'[0m

  42) Financial::Account#transfer_funds when funds are sufficient transfers the amount from one account to another
      [31mFailure/Error: let(:recipient_account) { create(:account, accountable: recipient_player, balance: 500) }[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:10:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:76:in 'block (5 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:74:in 'block (4 levels) in <main>'[0m

  43) Financial::Account#transfer_funds when funds are insufficient raises an error and does not modify balances
      [31mFailure/Error:[0m
      [31m  expect { player_account.transfer_funds(2_000, recipient_account, "Overdraft transfer attempt") }[0m
      [31m    .to raise_error("Insufficient funds")[0m
      [31m[0m
      [31m  expected Exception with "Insufficient funds", got #<NameError: uninitialized constant Account> with backtrace:[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [31m    # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [31m    # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'[0m
      [31m    # ./spec/models/account_spec.rb:96:in 'block (5 levels) in <main>'[0m
      [31m    # ./spec/models/account_spec.rb:96:in 'block (4 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:96:in 'block (4 levels) in <main>'[0m

  44) Financial::Account edge cases when balance is exactly zero prevents withdrawals or transfers
      [31mFailure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:108:in 'block (4 levels) in <main>'[0m

  45) Financial::Account edge cases when balance is exactly zero allows deposits
      [31mFailure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/account_spec.rb:108:in 'block (4 levels) in <main>'[0m

  46) Financial::Account different accountable types works with a player account
      [31mFailure/Error: account = create(:account, accountable: create(:player))[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:128:in 'block (3 levels) in <main>'[0m

  47) Financial::Account different accountable types works with a settlement account
      [31mFailure/Error: account = create(:account, accountable: create(:base_settlement))[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:133:in 'block (3 levels) in <main>'[0m

  48) Financial::Account different accountable types works with an organization account
      [31mFailure/Error: account = create(:account, accountable: create(:organization))[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant Account[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
      [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
      [36m# ./spec/models/account_spec.rb:138:in 'block (3 levels) in <main>'[0m

  49) Units::BiogasGenerator#operate consumes biomass, organic waste, and energy, producing biogas and fertilizer
      [31mFailure/Error:[0m
      [31m  BiogasGenerator.new([0m
      [31m    name: 'Basic Biogas Generator',[0m
      [31m    material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },[0m
      [31m    energy_cost: 15  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant BiogasGenerator[0m
      [36m# ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/biogas_generator_spec.rb:19:in 'block (3 levels) in <main>'[0m

  50) Units::BiogasGenerator#operate returns false if insufficient biomass is available
      [31mFailure/Error:[0m
      [31m  BiogasGenerator.new([0m
      [31m    name: 'Basic Biogas Generator',[0m
      [31m    material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },[0m
      [31m    energy_cost: 15  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant BiogasGenerator[0m
      [36m# ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/biogas_generator_spec.rb:29:in 'block (3 levels) in <main>'[0m

  51) Units::BiogasGenerator#operate returns false if insufficient organic waste is available
      [31mFailure/Error:[0m
      [31m  BiogasGenerator.new([0m
      [31m    name: 'Basic Biogas Generator',[0m
      [31m    material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },[0m
      [31m    energy_cost: 15  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant BiogasGenerator[0m
      [36m# ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/biogas_generator_spec.rb:34:in 'block (3 levels) in <main>'[0m

  52) Units::BiogasGenerator#operate returns false if insufficient energy is available
      [31mFailure/Error:[0m
      [31m  BiogasGenerator.new([0m
      [31m    name: 'Basic Biogas Generator',[0m
      [31m    material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },[0m
      [31m    energy_cost: 15  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant BiogasGenerator[0m
      [36m# ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/biogas_generator_spec.rb:39:in 'block (3 levels) in <main>'[0m

  53) Biology::LifeForm#simulate_growth uses _calculate_base_growth_rate to modify population
      [31mFailure/Error: expect(life_form.population).to eq((initial_population * 1.3).to_i)[0m
      [31m[0m
      [31m  expected: 1300[0m
      [31m       got: 1000[0m
      [31m[0m
      [31m  (compared using ==)[0m
      [36m# ./spec/models/biology/life_form_library_spec.rb:63:in 'block (3 levels) in <main>'[0m

  54) Biology::LifeForm#simulate_growth is affected by biosphere habitability
      [31mFailure/Error: expect(life_form.population).to be < perfect_life_form.population[0m
      [31m[0m
      [31m  expected: < 1000[0m
      [31m       got:   1000[0m
      [36m# ./spec/models/biology/life_form_library_spec.rb:88:in 'block (3 levels) in <main>'[0m

  55) Biology::LifeForm#simulate_growth uses _calculate_base_growth_rate to modify population
      [31mFailure/Error: expect(life_form.population).to eq((initial_population * 1.3).to_i)[0m
      [31m[0m
      [31m  expected: 1300[0m
      [31m       got: 1000[0m
      [31m[0m
      [31m  (compared using ==)[0m
      [36m# ./spec/models/biology/life_form_spec.rb:63:in 'block (3 levels) in <main>'[0m

  56) Biology::LifeForm#simulate_growth is affected by biosphere habitability
      [31mFailure/Error: expect(life_form.population).to be < perfect_life_form.population[0m
      [31m[0m
      [31m  expected: < 1000[0m
      [31m       got:   1000[0m
      [36m# ./spec/models/biology/life_form_spec.rb:88:in 'block (3 levels) in <main>'[0m

  57) Units::BiomassRecycler#operate consumes biomass and energy, producing fertilizer and biofuel
      [31mFailure/Error:[0m
      [31m  BiomassRecycler.new([0m
      [31m    name: 'Basic Biomass Recycler',[0m
      [31m    material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },[0m
      [31m    energy_cost: 20  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant BiomassRecycler[0m
      [36m# ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/biomass_recycler_spec.rb:19:in 'block (3 levels) in <main>'[0m

  58) Units::BiomassRecycler#operate returns false if insufficient biomass is available
      [31mFailure/Error:[0m
      [31m  BiomassRecycler.new([0m
      [31m    name: 'Basic Biomass Recycler',[0m
      [31m    material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },[0m
      [31m    energy_cost: 20  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant BiomassRecycler[0m
      [36m# ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/biomass_recycler_spec.rb:28:in 'block (3 levels) in <main>'[0m

  59) Units::BiomassRecycler#operate returns false if insufficient energy is available
      [31mFailure/Error:[0m
      [31m  BiomassRecycler.new([0m
      [31m    name: 'Basic Biomass Recycler',[0m
      [31m    material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },[0m
      [31m    energy_cost: 20  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant BiomassRecycler[0m
      [36m# ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/biomass_recycler_spec.rb:33:in 'block (3 levels) in <main>'[0m

  60) Blueprint#materials returns a hash of required materials from JSON
      [31mFailure/Error: expect(materials.keys).to include('titanium_alloy', 'composite_insulation', 'pressure_valves', 'electronics')[0m
      [31m  expected [] to include "titanium_alloy", "composite_insulation", "pressure_valves", and "electronics"[0m
      [36m# ./spec/models/blueprint_spec.rb:18:in 'block (3 levels) in <main>'[0m

  61) CelestialBodies::BrownDwarf atmospheric and other properties can have an atmosphere
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: H2. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./spec/models/celestial_bodies/brown_dwarf_spec.rb:107:in 'block (3 levels) in <main>'[0m

  62) CelestialBodies::CelestialBody material management #add_material creates or updates material properly
      [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
      [31m[0m
      [31mMaterialManagementConcern::InvalidMaterialError:[0m
      [31m  Material 'oxygen' not found in materials database[0m
      [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:21:in 'block (5 levels) in <main>'[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:21:in 'block (4 levels) in <main>'[0m

  63) CelestialBodies::CelestialBody material management #add_material updates atmosphere gases if material is a gas
      [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
      [31m[0m
      [31mMaterialManagementConcern::InvalidMaterialError:[0m
      [31m  Material 'oxygen' not found in materials database[0m
      [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:27:in 'block (4 levels) in <main>'[0m

  64) CelestialBodies::CelestialBody material management #remove_material reduces material amount and deletes if zero
      [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
      [31m[0m
      [31mMaterialManagementConcern::InvalidMaterialError:[0m
      [31m  Material 'oxygen' not found in materials database[0m
      [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:33:in 'block (4 levels) in <main>'[0m

  65) CelestialBodies::CelestialBody material management #remove_material updates atmosphere gases accordingly
      [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
      [31m[0m
      [31mMaterialManagementConcern::InvalidMaterialError:[0m
      [31m  Material 'oxygen' not found in materials database[0m
      [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:33:in 'block (4 levels) in <main>'[0m

  66) CelestialBodies::CelestialBody properties JSONB accessors can read and write last_simulated_at
      [31mFailure/Error: mars.last_simulated_at = Time.now.utc[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'last_simulated_at=' called for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:95:in 'block (3 levels) in <main>'[0m

  67) CelestialBodies::CelestialBody#planet_class? returns true for a planet type
      [31mFailure/Error: expect(mars.planet_class?).to be true[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'planet_class?' called for #<CelestialBodies::Planets::Rocky::TerrestrialPlanet:0x00007f01082208c0>[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:104:in 'block (3 levels) in <main>'[0m

  68) CelestialBodies::CelestialBody#planet_class? returns false for nil type
      [31mFailure/Error: expect(mars.planet_class?).to be false[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'planet_class?' called for #<CelestialBodies::Planets::Rocky::TerrestrialPlanet:0x00007f010919f288>[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:109:in 'block (3 levels) in <main>'[0m

  69) CelestialBodies::CelestialBody#planet_class? returns false for non-planet type
      [31mFailure/Error: expect(mars.planet_class?).to be false[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'planet_class?' called for #<CelestialBodies::Planets::Rocky::TerrestrialPlanet:0x00007f0109a2fb50>[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:114:in 'block (3 levels) in <main>'[0m

  70) CelestialBodies::CelestialBody#should_simulate? returns false if not active
      [31mFailure/Error: expect(mars.should_simulate?).to be false[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'should_simulate?' called for #<CelestialBodies::Planets::Rocky::TerrestrialPlanet:0x00007f010ad00518>[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:121:in 'block (3 levels) in <main>'[0m

  71) CelestialBodies::CelestialBody#should_simulate? returns false if radius is too small
      [31mFailure/Error: expect(mars.should_simulate?).to be false[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'should_simulate?' called for #<CelestialBodies::Planets::Rocky::TerrestrialPlanet:0x00007f0115137be0>[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:126:in 'block (3 levels) in <main>'[0m

  72) CelestialBodies::CelestialBody#should_simulate? returns true for planet_class? or is_moon
      [31mFailure/Error: expect(mars.should_simulate?).to be true[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'should_simulate?' called for #<CelestialBodies::Planets::Rocky::TerrestrialPlanet:0x00007f0115672d08>[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:133:in 'block (3 levels) in <main>'[0m

  73) CelestialBodies::CelestialBody#should_simulate? returns true if force_simulate property is set
      [31mFailure/Error: expect(mars.should_simulate?).to be true[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  private method 'should_simulate?' called for #<CelestialBodies::Planets::Rocky::TerrestrialPlanet:0x00007f0107153c18>[0m
      [36m# ./spec/models/celestial_bodies/celestial_body_spec.rb:142:in 'block (3 levels) in <main>'[0m

  74) CelestialBodies::Materials::Gas associations can be accessed through atmosphere.gases
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: Oxygen. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./spec/models/celestial_bodies/materials/gas_spec.rb:22:in 'block (3 levels) in <main>'[0m

  75) CelestialBodies::Planets::Ocean::HyceanPlanet validations inherits ocean planet water coverage validation
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: H2O. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'[0m
      [36m# ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'[0m
      [36m# ./app/models/celestial_bodies/spheres/hydrosphere.rb:316:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'[0m
      [36m# ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:39:in 'block (3 levels) in <main>'[0m

  76) CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry returns unknown when hydrosphere composition is missing
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: H2O. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'[0m
      [36m# ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'[0m
      [36m# ./app/models/celestial_bodies/spheres/hydrosphere.rb:316:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'[0m
      [36m# ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:163:in 'block (3 levels) in <main>'[0m

  77) CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet can analyze water chemistry
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: H2O. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'[0m
      [36m# ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'[0m
      [36m# ./app/models/celestial_bodies/spheres/hydrosphere.rb:316:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'[0m
      [36m# ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:284:in 'block (3 levels) in <main>'[0m

  78) CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors includes temperature state for liquid water range
      [31mFailure/Error: expect(factors[:temperature_state]).to eq("liquid_water_possible")[0m
      [31m[0m
      [31m  expected: "liquid_water_possible"[0m
      [31m       got: "frozen_surface"[0m
      [31m[0m
      [31m  (compared using ==)[0m
      [36m# ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:91:in 'block (3 levels) in <main>'[0m

  79) CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors identifies vapor dominated state for high temperatures
      [31mFailure/Error: expect(factors[:temperature_state]).to eq("vapor_dominated")[0m
      [31m[0m
      [31m  expected: "vapor_dominated"[0m
      [31m       got: "frozen_surface"[0m
      [31m[0m
      [31m  (compared using ==)[0m
      [36m# ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:109:in 'block (3 levels) in <main>'[0m

  80) CelestialBodies::Planets::Ocean::OceanPlanet#surface_features includes liquid oceans for moderate temperatures
      [31mFailure/Error: expect(features).to include("liquid_oceans")[0m
      [31m  expected ["significant_bodies_of_water", "coastal_zones", "ice_formations"] to include "liquid_oceans"[0m
      [36m# ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:155:in 'block (3 levels) in <main>'[0m

  81) CelestialBodies::Planets::Ocean::OceanPlanet#surface_features includes vapor clouds for high temperatures
      [31mFailure/Error: expect(features).to include("vapor_clouds")[0m
      [31m  expected ["significant_bodies_of_water", "coastal_zones", "ice_formations"] to include "vapor_clouds"[0m
      [36m# ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:164:in 'block (3 levels) in <main>'[0m

  82) CelestialBodies::Planets::Rocky::TerrestrialPlanet#calculated_atmospheric_pressure returns a numeric value for calculated atmospheric pressure
      [31mFailure/Error: new_mass = [gas.mass - gas.mass * loss_factor, 0].max[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method '*' for nil[0m
      [36m# ./app/services/terra_sim/atmosphere_simulation_service.rb:106:in 'block in TerraSim::AtmosphereSimulationService#simulate_atmospheric_loss'[0m
      [36m# ./app/services/terra_sim/atmosphere_simulation_service.rb:105:in 'TerraSim::AtmosphereSimulationService#simulate_atmospheric_loss'[0m
      [36m# ./app/services/terra_sim/atmosphere_simulation_service.rb:15:in 'TerraSim::AtmosphereSimulationService#simulate'[0m
      [36m# ./app/services/terra_sim/simulator.rb:64:in 'TerraSim::Simulator#update_spheres'[0m
      [36m# ./app/services/terra_sim/simulator.rb:26:in 'TerraSim::Simulator#calc_current'[0m
      [36m# ./app/models/celestial_bodies/planets/rocky/terrestrial_planet.rb:100:in 'CelestialBodies::Planets::Rocky::TerrestrialPlanet#calculated_atmospheric_pressure'[0m
      [36m# ./spec/models/celestial_bodies/planets/rocky/terrestrial_planets_spec.rb:77:in 'block (3 levels) in <main>'[0m

  83) CelestialBodies::Spheres::Atmosphere#initialize_gases creates gases based on the composition
      [31mFailure/Error: expect(atmosphere.gases.find_by(name: 'N2')).to be_present[0m
      [31m  expected `nil.present?` to be truthy, got false[0m
      [36m# ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:47:in 'block (3 levels) in <main>'[0m

  84) CelestialBodies::Spheres::Atmosphere#add_gas adds gas using chemical formula
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: O2. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:56:in 'block (3 levels) in <main>'[0m

  85) CelestialBodies::Spheres::Atmosphere#remove_gas removes gas and updates total atmospheric mass
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: CO2. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:127:in 'AtmosphereConcern#remove_gas'[0m
      [36m# ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:81:in 'block (3 levels) in <main>'[0m

  86) CelestialBodies::Spheres::Biosphere defaults accesses default temperature values via delegation methods
      [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
      [31m[0m
      [31mAtmosphereConcern::InvalidGasError:[0m
      [31m  Unknown chemical formula or name: water. Check materials database.[0m
      [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
      [36m# ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:8:in 'block (3 levels) in <main>'[0m
      [36m# ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:7:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:67:in 'block (3 levels) in <main>'[0m

  87) CelestialBodies::Spheres::Geosphere#add_material adds a material and updates the celestial body and geosphere
      [31mFailure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)[0m
      [31m[0m
      [31mActiveRecord::StatementInvalid:[0m
      [31m  PG::UndefinedColumn: ERROR:  column materials.layer does not exist[0m
      [31m  LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [31m                                                               ^[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:75:in 'block (3 levels) in <main>'[0m
      [36m# ------------------[0m
      [36m# --- Caused by: ---[0m
      [36m# PG::UndefinedColumn:[0m
      [36m#   ERROR:  column materials.layer does not exist[0m
      [36m#   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [36m#                                                                ^[0m
      [36m#   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m

  88) CelestialBodies::Spheres::Geosphere#add_material adds material to the specified layer
      [31mFailure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)[0m
      [31m[0m
      [31mActiveRecord::StatementInvalid:[0m
      [31m  PG::UndefinedColumn: ERROR:  column materials.layer does not exist[0m
      [31m  LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [31m                                                               ^[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:114:in 'block (3 levels) in <main>'[0m
      [36m# ------------------[0m
      [36m# --- Caused by: ---[0m
      [36m# PG::UndefinedColumn:[0m
      [36m#   ERROR:  column materials.layer does not exist[0m
      [36m#   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [36m#                                                                ^[0m
      [36m#   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m

  89) CelestialBodies::Spheres::Geosphere#remove_material removes material from the specified layer
      [31mFailure/Error:[0m
      [31m  layer_materials.each do |material|[0m
      [31m    percentage = (material.amount.to_f / total_mass) * 100[0m
      [31m    composition[material.name] = percentage[0m
      [31m  end[0m
      [31m[0m
      [31mActiveRecord::StatementInvalid:[0m
      [31m  PG::UndefinedColumn: ERROR:  column materials.layer does not exist[0m
      [31m  LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...[0m
      [31m                                                               ^[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:563:in 'GeosphereConcern#update_composition_percentages'[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:225:in 'GeosphereConcern#remove_material'[0m
      [36m# ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:144:in 'block (3 levels) in <main>'[0m
      [36m# ------------------[0m
      [36m# --- Caused by: ---[0m
      [36m# PG::UndefinedColumn:[0m
      [36m#   ERROR:  column materials.layer does not exist[0m
      [36m#   LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...[0m
      [36m#                                                                ^[0m
      [36m#   ./app/models/concerns/geosphere_concern.rb:563:in 'GeosphereConcern#update_composition_percentages'[0m

  90) CelestialBodies::Spheres::Geosphere material management creates materials in correct layer
      [31mFailure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)[0m
      [31m[0m
      [31mActiveRecord::StatementInvalid:[0m
      [31m  PG::UndefinedColumn: ERROR:  column materials.layer does not exist[0m
      [31m  LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [31m                                                               ^[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:181:in 'block (3 levels) in <main>'[0m
      [36m# ------------------[0m
      [36m# --- Caused by: ---[0m
      [36m# PG::UndefinedColumn:[0m
      [36m#   ERROR:  column materials.layer does not exist[0m
      [36m#   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [36m#                                                                ^[0m
      [36m#   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m

  91) CelestialBodies::Spheres::Geosphere material management updates composition percentages
      [31mFailure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)[0m
      [31m[0m
      [31mActiveRecord::StatementInvalid:[0m
      [31m  PG::UndefinedColumn: ERROR:  column materials.layer does not exist[0m
      [31m  LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [31m                                                               ^[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m
      [36m# ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:197:in 'block (3 levels) in <main>'[0m
      [36m# ------------------[0m
      [36m# --- Caused by: ---[0m
      [36m# PG::UndefinedColumn:[0m
      [36m#   ERROR:  column materials.layer does not exist[0m
      [36m#   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [36m#                                                                ^[0m
      [36m#   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'[0m

  92) CelestialBodies::Spheres::Geosphere#extract_volatiles extracts volatiles based on temperature increase
      [31mFailure/Error:[0m
      [31m  volatile_material = materials.find_or_initialize_by([0m
      [31m    name: name,[0m
      [31m    location: 'geosphere',[0m
      [31m    layer: 'crust'[0m
      [31m  )[0m
      [31m[0m
      [31mActiveRecord::StatementInvalid:[0m
      [31m  PG::UndefinedColumn: ERROR:  column materials.layer does not exist[0m
      [31m  LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [31m                                                               ^[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:387:in 'Hash#each'[0m
      [36m# ./app/models/concerns/geosphere_concern.rb:387:in 'GeosphereConcern#extract_volatiles'[0m
      [36m# ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:276:in 'block (3 levels) in <main>'[0m
      [36m# ------------------[0m
      [36m# --- Caused by: ---[0m
      [36m# PG::UndefinedColumn:[0m
      [36m#   ERROR:  column materials.layer does not exist[0m
      [36m#   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...[0m
      [36m#                                                                ^[0m
      [36m#   ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'[0m

  93) CelestialBodies::CelestialBody when not part of a solar system allows distance_from_star to be nil
      [31mFailure/Error: expect(brown_dwarf.solar_system).to be_nil[0m
      [31m[0m
      [31m  expected: nil[0m
      [31m       got: #<SolarSystem id: 25630, identifier: "SS-527", name: "Solar System 464", galaxy_id: nil, current_star...4:26:26.801123000 +0000", updated_at: "2026-01-19 04:26:26.801123000 +0000", wormhole_capacity: 0.0>[0m
      [36m# ./spec/models/celestial_body_spec.rb:19:in 'block (3 levels) in <main>'[0m

  94) CelestialBodies::CelestialBody#add_material creates a new material if it does not exist
      [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
      [31m[0m
      [31mMaterialManagementConcern::InvalidMaterialError:[0m
      [31m  Material 'Oxygen' not found in materials database[0m
      [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
      [36m# ./spec/models/celestial_body_spec.rb:25:in 'block (4 levels) in <main>'[0m
      [36m# ./spec/models/celestial_body_spec.rb:25:in 'block (3 levels) in <main>'[0m

  95) CelestialBodies::CelestialBody#add_material updates the amount of an existing material
      [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
      [31m[0m
      [31mMaterialManagementConcern::InvalidMaterialError:[0m
      [31m  Material 'Nitrogen' not found in materials database[0m
      [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
      [36m# ./spec/models/celestial_body_spec.rb:31:in 'block (3 levels) in <main>'[0m

  96) CelestialBodies::CelestialBody#update_gravity calculates and updates the gravity based on mass and radius
      [31mFailure/Error: mars.update_gravity[0m
      [31m[0m
      [31mNoMethodError:[0m
      [31m  undefined method 'update_gravity' for an instance of CelestialBodies::CelestialBody[0m
      [36m# ./spec/models/celestial_body_spec.rb:68:in 'block (3 levels) in <main>'[0m

  97) Units::CompostingUnit#operate consumes organic waste and energy, producing compost
      [31mFailure/Error:[0m
      [31m  CompostingUnit.new([0m
      [31m    name: 'Basic Composting Unit',[0m
      [31m    material_list: { 'organic_waste' => 40, 'compost_output' => 25 },[0m
      [31m    energy_cost: 15  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant CompostingUnit[0m
      [36m# ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/composting_unit_spec.rb:19:in 'block (3 levels) in <main>'[0m

  98) Units::CompostingUnit#operate returns false if insufficient organic waste is available
      [31mFailure/Error:[0m
      [31m  CompostingUnit.new([0m
      [31m    name: 'Basic Composting Unit',[0m
      [31m    material_list: { 'organic_waste' => 40, 'compost_output' => 25 },[0m
      [31m    energy_cost: 15  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant CompostingUnit[0m
      [36m# ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/composting_unit_spec.rb:27:in 'block (3 levels) in <main>'[0m

  99) Units::CompostingUnit#operate returns false if insufficient energy is available
      [31mFailure/Error:[0m
      [31m  CompostingUnit.new([0m
      [31m    name: 'Basic Composting Unit',[0m
      [31m    material_list: { 'organic_waste' => 40, 'compost_output' => 25 },[0m
      [31m    energy_cost: 15  # Updated to use energy_cost[0m
      [31m  )[0m
      [31m[0m
      [31mNameError:[0m
      [31m  uninitialized constant CompostingUnit[0m
      [36m# ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'[0m
      [36m# ./spec/models/composting_unit_spec.rb:32:in 'block (3 levels) in <main>'[0m

  100) AtmosphereConcern#add_gas adds a new gas to the atmosphere
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: N2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./spec/models/concerns/atmosphere_concern_spec.rb:103:in 'block (3 levels) in <main>'[0m

  101) AtmosphereConcern#add_gas updates existing gas
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: O2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./spec/models/concerns/atmosphere_concern_spec.rb:124:in 'block (3 levels) in <main>'[0m

  102) AtmosphereConcern#remove_gas removes gas from the atmosphere
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: O2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:127:in 'AtmosphereConcern#remove_gas'[0m
       [36m# ./spec/models/concerns/atmosphere_concern_spec.rb:149:in 'block (3 levels) in <main>'[0m

  103) AtmosphereConcern#remove_gas deletes gas when amount becomes zero
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: H2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:127:in 'AtmosphereConcern#remove_gas'[0m
       [36m# ./spec/models/concerns/atmosphere_concern_spec.rb:168:in 'block (3 levels) in <main>'[0m

  104) AtmosphereConcern#estimate_molar_mass calculates different molar mass for different compositions
       [31mFailure/Error: expect(molar_mass).to be < 0.005  # Much lighter than air[0m
       [31m[0m
       [31m  expected: < 0.005[0m
       [31m       got:   0.029[0m
       [36m# ./spec/models/concerns/atmosphere_concern_spec.rb:309:in 'block (3 levels) in <main>'[0m

  105) AtmosphereConcern#initialize_gases creates gases based on composition
       [31mFailure/Error: expect(result).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/models/concerns/atmosphere_concern_spec.rb:470:in 'block (3 levels) in <main>'[0m

  106) EnergyManagement solar output factor #current_solar_output_factor queries location solar output factor
       [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(0.8)[0m
       [31m  #<Location::CelestialLocation id: 19418, name: "Location 70", coordinates: "86.44°S 127.39°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 17537, celestial_body_id: 45263, created_at: "2026-01-19 04:26:40.512557000 +0000", updated_at: "2026-01-19 04:26:40.552421000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
       [36m# ./spec/models/concerns/energy_management_spec.rb:197:in 'block (4 levels) in <main>'[0m

  107) EnergyManagement solar output factor #current_solar_output_factor returns 1.0 when no settlement
       [31mFailure/Error: expect(settlement.current_solar_output_factor).to eq(1.0)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'current_solar_output_factor' for #<Settlement::BaseSettlement:0x00007f0108951b80>[0m
       [36m# ./spec/models/concerns/energy_management_spec.rb:203:in 'block (4 levels) in <main>'[0m

  108) EnergyManagement solar output factor #solar_daylight? returns true when solar factor > 0.1
       [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)[0m
       [31m  #<Location::CelestialLocation id: 19420, name: "Location 72", coordinates: "33.58°N 88.63°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 17539, celestial_body_id: 45265, created_at: "2026-01-19 04:26:41.029885000 +0000", updated_at: "2026-01-19 04:26:41.106603000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
       [36m# ./spec/models/concerns/energy_management_spec.rb:209:in 'block (4 levels) in <main>'[0m

  109) EnergyManagement solar output factor #solar_daylight? returns false when solar factor <= 0.1
       [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(0.05)[0m
       [31m  #<Location::CelestialLocation id: 19421, name: "Location 73", coordinates: "61.05°N 21.68°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 17540, celestial_body_id: 45266, created_at: "2026-01-19 04:26:41.366150000 +0000", updated_at: "2026-01-19 04:26:41.429653000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
       [36m# ./spec/models/concerns/energy_management_spec.rb:214:in 'block (4 levels) in <main>'[0m

  110) EnergyManagement solar output factor power generation with solar scaling scales solar unit output by solar factor
       [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)[0m
       [31m  #<Location::CelestialLocation id: 19422, name: "Location 74", coordinates: "2.46°N 8.50°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 17541, celestial_body_id: 45267, created_at: "2026-01-19 04:26:41.641343000 +0000", updated_at: "2026-01-19 04:26:41.700142000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
       [36m# ./spec/models/concerns/energy_management_spec.rb:245:in 'block (4 levels) in <main>'[0m

  111) EnergyManagement solar output factor power generation with solar scaling does not scale non-solar units
       [31mFailure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)[0m
       [31m  #<Location::CelestialLocation id: 19423, name: "Location 75", coordinates: "8.09°S 43.44°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 17542, celestial_body_id: 45268, created_at: "2026-01-19 04:26:41.858699000 +0000", updated_at: "2026-01-19 04:26:41.903110000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor[0m
       [36m# ./spec/models/concerns/energy_management_spec.rb:251:in 'block (4 levels) in <main>'[0m

  112) GeosphereConcern#reset returns false if base_values lack required keys
       [31mFailure/Error: geosphere.update!(base_values: {})[0m
       [31m[0m
       [31mActiveRecord::NotNullViolation:[0m
       [31m  PG::NotNullViolation: ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint[0m
       [31m  DETAIL:  Failing row contains (29943, 45271, {"silicon":45.0,"oxygen":45.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 1e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-19 04:26:43.784417, 2026-01-19 04:26:43.950183, 0, 0, 0, {}, null, f, 0).[0m
       [36m# ./spec/models/concerns/geosphere_concern_spec.rb:81:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# PG::NotNullViolation:[0m
       [36m#   ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint[0m
       [36m#   DETAIL:  Failing row contains (29943, 45271, {"silicon":45.0,"oxygen":45.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 1e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-19 04:26:43.784417, 2026-01-19 04:26:43.950183, 0, 0, 0, {}, null, f, 0).[0m
       [36m#   ./spec/models/concerns/geosphere_concern_spec.rb:81:in 'block (3 levels) in <main>'[0m

  113) GeosphereConcern#reset does not modify attributes when base_values are empty
       [31mFailure/Error: geosphere.update!(base_values: {})[0m
       [31m[0m
       [31mActiveRecord::NotNullViolation:[0m
       [31m  PG::NotNullViolation: ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint[0m
       [31m  DETAIL:  Failing row contains (29944, 45272, {"silicon":30.0,"oxygen":60.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 2e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-19 04:26:44.050764, 2026-01-19 04:26:44.233512, 0, 0, 0, {}, null, f, 0).[0m
       [36m# ./spec/models/concerns/geosphere_concern_spec.rb:111:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# PG::NotNullViolation:[0m
       [36m#   ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint[0m
       [36m#   DETAIL:  Failing row contains (29944, 45272, {"silicon":30.0,"oxygen":60.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 2e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-19 04:26:44.050764, 2026-01-19 04:26:44.233512, 0, 0, 0, {}, null, f, 0).[0m
       [36m#   ./spec/models/concerns/geosphere_concern_spec.rb:111:in 'block (3 levels) in <main>'[0m

  114) GeosphereConcern#extract_volatiles extracts volatiles based on temperature increase
       [31mFailure/Error: expect(result).to include('carbon_dioxide')[0m
       [31m[0m
       [31m  expected {} to include "carbon_dioxide"[0m
       [31m  Diff:[0m[0m
       [31m  [0m[34m@@ -1,2 +1 @@[0m
       [31m  [0m[31m-["carbon_dioxide"][0m
       [31m  [0m[0m
       [36m# ./spec/models/concerns/geosphere_concern_spec.rb:176:in 'block (3 levels) in <main>'[0m

  115) GeosphereConcern#extract_volatiles adds gases to atmosphere using chemical formula
       [31mFailure/Error: DEFAULT_FAILURE_NOTIFIER = lambda { |failure, _opts| raise failure }[0m
       [31m  Exactly one instance should have received the following message(s) but didn't: add_gas[0m
       [36m# /usr/local/bundle/gems/rspec-support-3.13.2/lib/rspec/support.rb:110:in 'block in <module:Support>'[0m
       [36m# /usr/local/bundle/gems/rspec-support-3.13.2/lib/rspec/support.rb:119:in 'RSpec::Support.notify_failure'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks/error_generator.rb:348:in 'RSpec::Mocks::ErrorGenerator#notify'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks/error_generator.rb:332:in 'RSpec::Mocks::ErrorGenerator#__raise'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks/any_instance/error_generator.rb:7:in 'RSpec::Mocks::AnyInstance::ErrorGenerator#raise_second_instance_received_message_error'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks/any_instance/recorder.rb:100:in 'RSpec::Mocks::AnyInstance::Recorder#verify'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks/space.rb:75:in 'block in RSpec::Mocks::Space#verify_all'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks/space.rb:75:in 'Hash#each_value'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks/space.rb:75:in 'RSpec::Mocks::Space#verify_all'[0m
       [36m# /usr/local/bundle/gems/rspec-mocks-3.13.2/lib/rspec/mocks.rb:45:in 'RSpec::Mocks.verify'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/mocking_adapters/rspec.rb:23:in 'RSpec::Core::MockingAdapters::RSpec#verify_mocks_for_rspec'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:525:in 'RSpec::Core::Example#verify_mocks'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:519:in 'RSpec::Core::Example#run_after_example'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:283:in 'block in RSpec::Core::Example#run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:511:in 'block in RSpec::Core::Example#with_around_and_singleton_context_hooks'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:468:in 'block in RSpec::Core::Example#with_around_example_hooks'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:486:in 'block in RSpec::Core::Hooks::HookCollections#run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:626:in 'block in RSpec::Core::Hooks::HookCollections#run_around_example_hooks_for'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:352:in 'RSpec::Core::Example::Procsy#call'[0m
       [36m# /usr/local/bundle/gems/rspec-rails-7.1.0/lib/rspec/rails/adapters.rb:75:in 'block (2 levels) in <module:MinitestLifecycleAdapter>'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:457:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:457:in 'RSpec::Core::Example#instance_exec'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:390:in 'RSpec::Core::Hooks::AroundHook#execute_with'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:628:in 'block (2 levels) in RSpec::Core::Hooks::HookCollections#run_around_example_hooks_for'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:352:in 'RSpec::Core::Example::Procsy#call'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:629:in 'RSpec::Core::Hooks::HookCollections#run_around_example_hooks_for'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:486:in 'RSpec::Core::Hooks::HookCollections#run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:468:in 'RSpec::Core::Example#with_around_example_hooks'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:511:in 'RSpec::Core::Example#with_around_and_singleton_context_hooks'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:259:in 'RSpec::Core::Example#run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:646:in 'block in RSpec::Core::ExampleGroup.run_examples'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:642:in 'Array#map'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:642:in 'RSpec::Core::ExampleGroup.run_examples'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:607:in 'RSpec::Core::ExampleGroup.run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:608:in 'block in RSpec::Core::ExampleGroup.run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:608:in 'Array#map'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:608:in 'RSpec::Core::ExampleGroup.run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:121:in 'block (3 levels) in RSpec::Core::Runner#run_specs'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:121:in 'Array#map'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:121:in 'block (2 levels) in RSpec::Core::Runner#run_specs'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/configuration.rb:2097:in 'RSpec::Core::Configuration#with_suite_hooks'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:116:in 'block in RSpec::Core::Runner#run_specs'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/reporter.rb:74:in 'RSpec::Core::Reporter#report'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:115:in 'RSpec::Core::Runner#run_specs'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:89:in 'RSpec::Core::Runner#run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:71:in 'RSpec::Core::Runner.run'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:45:in 'RSpec::Core::Runner.invoke'[0m
       [36m# /usr/local/bundle/gems/rspec-core-3.13.2/exe/rspec:4:in '<top (required)>'[0m
       [36m# /usr/local/bundle/bin/rspec:25:in 'Kernel#load'[0m
       [36m# /usr/local/bundle/bin/rspec:25:in '<top (required)>'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/cli/exec.rb:59:in 'Kernel.load'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/cli/exec.rb:59:in 'Bundler::CLI::Exec#kernel_load'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/cli/exec.rb:23:in 'Bundler::CLI::Exec#run'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/cli.rb:452:in 'Bundler::CLI#exec'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/vendor/thor/lib/thor/command.rb:28:in 'Bundler::Thor::Command#run'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/vendor/thor/lib/thor/invocation.rb:127:in 'Bundler::Thor::Invocation#invoke_command'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/vendor/thor/lib/thor.rb:538:in 'Bundler::Thor.dispatch'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/cli.rb:35:in 'Bundler::CLI.dispatch'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/vendor/thor/lib/thor/base.rb:584:in 'Bundler::Thor::Base::ClassMethods#start'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/cli.rb:29:in 'Bundler::CLI.start'[0m
       [36m# /usr/local/lib/ruby/gems/3.4.0/gems/bundler-2.6.7/exe/bundle:28:in 'block in <top (required)>'[0m
       [36m# /usr/local/lib/ruby/3.4.0/bundler/friendly_errors.rb:117:in 'Bundler.with_friendly_errors'[0m
       [36m# /usr/local/lib/ruby/gems/3.4.0/gems/bundler-2.6.7/exe/bundle:20:in '<top (required)>'[0m
       [36m# /usr/local/bundle/bin/bundle:25:in 'Kernel#load'[0m
       [36m# /usr/local/bundle/bin/bundle:25:in '<main>'[0m
       [36m# [0m
       [36m#   Showing full backtrace because every line was filtered out.[0m
       [36m#   See docs for RSpec::Configuration#backtrace_exclusion_patterns and[0m
       [36m#   RSpec::Configuration#backtrace_inclusion_patterns for more information.[0m

  116) GeosphereConcern#add_material adds material to the specified layer
       [31mFailure/Error: raise ArgumentError, "Material '#{name}' not found in the lookup service."[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  Material 'iron' not found in the lookup service.[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:142:in 'GeosphereConcern#add_material'[0m
       [36m# ./spec/models/concerns/geosphere_concern_spec.rb:213:in 'block (3 levels) in <main>'[0m

  117) GeosphereConcern#physical_state returns liquid for temperature between melting and boiling points
       [31mFailure/Error: expect(state).to eq('liquid')[0m
       [31m[0m
       [31m  expected: "liquid"[0m
       [31m       got: "solid"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/concerns/geosphere_concern_spec.rb:347:in 'block (3 levels) in <main>'[0m

  118) GeosphereConcern#physical_state returns gas for temperature above boiling point
       [31mFailure/Error: expect(state).to eq('gas')[0m
       [31m[0m
       [31m  expected: "gas"[0m
       [31m       got: "solid"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/concerns/geosphere_concern_spec.rb:353:in 'block (3 levels) in <main>'[0m

  119) Housing population management calculates population capacity from habitat units
       [31mFailure/Error: after_initialize :set_default_population_capacity[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'after_initialize' for class #<Class:0x00007f0108bd9240>[0m
       [36m# ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'[0m

  120) Housing population management uses alias total_capacity for population_capacity
       [31mFailure/Error: after_initialize :set_default_population_capacity[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'after_initialize' for class #<Class:0x00007f0108bd6c20>[0m
       [36m# ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'[0m

  121) Housing population management calculates available capacity
       [31mFailure/Error: after_initialize :set_default_population_capacity[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'after_initialize' for class #<Class:0x00007f0108bd4600>[0m
       [36m# ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'[0m

  122) Housing population management checks if it has capacity for additional population
       [31mFailure/Error: after_initialize :set_default_population_capacity[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'after_initialize' for class #<Class:0x00007f0108bd2260>[0m
       [36m# ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'[0m

  123) Housing population management ignores non-habitat units when calculating capacity
       [31mFailure/Error: after_initialize :set_default_population_capacity[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'after_initialize' for class #<Class:0x00007f0108bd00a0>[0m
       [36m# ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'[0m

  124) Housing population management calculates total population from base units
       [31mFailure/Error: after_initialize :set_default_population_capacity[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'after_initialize' for class #<Class:0x00007f0108c0de00>[0m
       [36m# ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'[0m

  125) HydrosphereConcern#calculate_evaporation_rate calculates higher evaporation at higher temperatures
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: H2O. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./app/models/concerns/hydrosphere_concern.rb:75:in 'HydrosphereConcern#handle_evaporation'[0m
       [36m# ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'[0m
       [36m# ./app/models/celestial_bodies/spheres/hydrosphere.rb:316:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'[0m
       [36m# ./spec/models/concerns/hydrosphere_concern_spec.rb:88:in 'block (3 levels) in <main>'[0m

  126) HydrosphereConcern#add_liquid validates material exists in lookup service
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    hydrosphere.add_liquid('NonExistentMaterial123456', 1000)[0m
       [31m  }.to raise_error(ArgumentError, /not found in the lookup service/)[0m
       [31m[0m
       [31m  expected ArgumentError with message matching /not found in the lookup service/, got #<RSpec::Mocks::MockExpectationError:"#<InstanceDouble(Lookup::MaterialLookupService) (anonymous)> re...2O\")\n Please stub a default value first if message might be received with other args as well. \n"> with backtrace:[0m
       [31m    # ./app/models/concerns/atmosphere_concern.rb:125:in 'AtmosphereConcern#remove_gas'[0m
       [31m    # ./app/models/concerns/hydrosphere_concern.rb:102:in 'HydrosphereConcern#handle_precipitation'[0m
       [31m    # ./app/models/concerns/hydrosphere_concern.rb:23:in 'HydrosphereConcern#water_cycle_tick'[0m
       [31m    # ./app/models/celestial_bodies/spheres/hydrosphere.rb:316:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'[0m
       [31m    # ./app/models/celestial_bodies/spheres/hydrosphere.rb:154:in 'CelestialBodies::Spheres::Hydrosphere#add_liquid'[0m
       [31m    # ./spec/models/concerns/hydrosphere_concern_spec.rb:198:in 'block (4 levels) in <main>'[0m
       [31m    # ./spec/models/concerns/hydrosphere_concern_spec.rb:197:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/concerns/hydrosphere_concern_spec.rb:197:in 'block (3 levels) in <main>'[0m

  127) HydrosphereConcern#remove_liquid removes liquid from the hydrosphere
       [31mFailure/Error: raise ArgumentError, "Material '#{name}' not found in hydrosphere"[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  Material 'H2O' not found in hydrosphere[0m
       [36m# ./app/models/celestial_bodies/spheres/hydrosphere.rb:167:in 'CelestialBodies::Spheres::Hydrosphere#remove_liquid'[0m
       [36m# ./spec/models/concerns/hydrosphere_concern_spec.rb:222:in 'block (3 levels) in <main>'[0m

  128) MaterialManagementConcern#add_material with valid inputs looks up material data using real service
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'oxygen' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:63:in 'block (4 levels) in <main>'[0m

  129) MaterialManagementConcern#add_material with valid inputs creates material with standardized ID
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'oxygen' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:79:in 'block (4 levels) in <main>'[0m

  130) MaterialManagementConcern#add_material with valid inputs adds to existing material amount
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'oxygen' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:90:in 'block (4 levels) in <main>'[0m

  131) MaterialManagementConcern#add_material when material is a gas updates atmosphere composition
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'oxygen' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:106:in 'block (4 levels) in <main>'[0m

  132) MaterialManagementConcern#remove_material with valid inputs raises error for insufficient material
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    test_object.remove_material('iron', 100)[0m
       [31m  }.to raise_error(MaterialManagementConcern::InsufficientMaterialError, "Not enough iron available")[0m
       [31m[0m
       [31m  expected MaterialManagementConcern::InsufficientMaterialError with "Not enough iron available", got #<MaterialManagementConcern::InvalidMaterialError: Material 'iron' not found in materials database> with backtrace:[0m
       [31m    # ./app/models/concerns/material_management_concern.rb:75:in 'MaterialManagementConcern#remove_material'[0m
       [31m    # ./spec/models/concerns/material_management_concern_spec.rb:149:in 'block (5 levels) in <main>'[0m
       [31m    # ./spec/models/concerns/material_management_concern_spec.rb:148:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:148:in 'block (4 levels) in <main>'[0m

  133) MaterialManagementConcern#remove_material with valid inputs raises error when material not found
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    test_object.remove_material('iron', 100)[0m
       [31m  }.to raise_error(MaterialManagementConcern::InsufficientMaterialError, "Not enough iron available")[0m
       [31m[0m
       [31m  expected MaterialManagementConcern::InsufficientMaterialError with "Not enough iron available", got #<MaterialManagementConcern::InvalidMaterialError: Material 'iron' not found in materials database> with backtrace:[0m
       [31m    # ./app/models/concerns/material_management_concern.rb:75:in 'MaterialManagementConcern#remove_material'[0m
       [31m    # ./spec/models/concerns/material_management_concern_spec.rb:157:in 'block (5 levels) in <main>'[0m
       [31m    # ./spec/models/concerns/material_management_concern_spec.rb:156:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:156:in 'block (4 levels) in <main>'[0m

  134) MaterialManagementConcern#remove_material with valid inputs reduces material amount and saves
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'iron' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:75:in 'MaterialManagementConcern#remove_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:165:in 'block (4 levels) in <main>'[0m

  135) MaterialManagementConcern#remove_material with valid inputs sets amount to zero when fully removed
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'iron' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:75:in 'MaterialManagementConcern#remove_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:175:in 'block (4 levels) in <main>'[0m

  136) MaterialManagementConcern#remove_material when material is a gas updates atmosphere composition
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'iron' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:75:in 'MaterialManagementConcern#remove_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:192:in 'block (4 levels) in <main>'[0m

  137) MaterialManagementConcern#has_gas_properties? returns true for gases
       [31mFailure/Error: expect(test_object.send(:has_gas_properties?, 'oxygen')).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:202:in 'block (3 levels) in <main>'[0m

  138) MaterialManagementConcern integration with CelestialBody works with actual celestial body materials association
       [31mFailure/Error: raise InvalidMaterialError, "Material '#{name}' not found in materials database"[0m
       [31m[0m
       [31mMaterialManagementConcern::InvalidMaterialError:[0m
       [31m  Material 'oxygen' not found in materials database[0m
       [36m# ./app/models/concerns/material_management_concern.rb:28:in 'MaterialManagementConcern#add_material'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:225:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:224:in 'block (3 levels) in <main>'[0m

  139) MaterialManagementConcern integration with CelestialBody correctly identifies gas materials from fixtures
       [31mFailure/Error: expect(mars.send(:has_gas_properties?, 'oxygen')).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/models/concerns/material_management_concern_spec.rb:241:in 'block (3 levels) in <main>'[0m

  140) MaterialPropertiesConcern exotic state handling identifies exotic states
       [31mFailure/Error: expect(material.exotic_state?).to be false[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'exotic_state?' for an instance of #<Class:0x00007f01153a7c68>(id: integer, geosphere_id: integer, name: string, layer: string, percentage: decimal, mass: decimal, state: string, melting_point: decimal, boiling_point: decimal, is_volatile: boolean, category: string, created_at: datetime, updated_at: datetime)[0m
       [36m# ./spec/models/concerns/material_properties_concern_spec.rb:206:in 'block (3 levels) in <main>'[0m

  141) MaterialPropertiesConcern exotic state handling calculates phase transitions for exotic conditions
       [31mFailure/Error: expect(hydrogen.state_at(300, 1_500_000)).to eq('metallic_hydrogen')[0m
       [31m[0m
       [31m  expected: "metallic_hydrogen"[0m
       [31m       got: "gas"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/concerns/material_properties_concern_spec.rb:239:in 'block (3 levels) in <main>'[0m

  142) Mineable#mine_gcc mines from satellites and computers
       [31mFailure/Error: @account = double('Account', update: true) # Mocking the account[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'double' for an instance of TestModel[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:11:in 'TestModel#initialize'[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:17:in 'Class#new'[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:17:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:24:in 'block (3 levels) in <main>'[0m

  143) Mineable#mine_gcc does not exceed available power
       [31mFailure/Error: @account = double('Account', update: true) # Mocking the account[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'double' for an instance of TestModel[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:11:in 'TestModel#initialize'[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:17:in 'Class#new'[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:17:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/concerns/mineable_spec.rb:24:in 'block (3 levels) in <main>'[0m

  144) Craft::Harvester validations is valid with a positive extraction_rate
       [31mFailure/Error: let(:harvester) { create(:craft_harvester, player: player) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "craft_harvester"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "craft_harvester"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  145) Craft::Harvester validations is invalid with a negative extraction_rate
       [31mFailure/Error: let(:harvester) { create(:craft_harvester, player: player) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "craft_harvester"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "craft_harvester"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  146) Craft::Harvester#extract_resources when extracting from a valid target increases inventory with extracted resources
       [31mFailure/Error: let(:harvester) { create(:craft_harvester, player: player) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "craft_harvester"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "craft_harvester"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  147) Craft::Harvester#extract_resources when extracting from an invalid target raises an error
       [31mFailure/Error: let(:harvester) { create(:craft_harvester, player: player) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "craft_harvester"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "craft_harvester"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  148) Craft::Harvester#extract_resources when storage is full raises an error
       [31mFailure/Error: let(:harvester) { create(:craft_harvester, player: player) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "craft_harvester"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "craft_harvester"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  149) Craft::Harvester#process_resources converts raw material into refined material
       [31mFailure/Error: let(:harvester) { create(:craft_harvester, player: player) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "craft_harvester"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "craft_harvester"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  150) Craft::Harvester#process_resources does nothing if no processable materials are present
       [31mFailure/Error: let(:harvester) { create(:craft_harvester, player: player) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "craft_harvester"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "craft_harvester"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  151) Craft::VariantManager#initialize loads base data and variants
       [31mFailure/Error: expect(variant_manager.instance_variable_get(:@base_data)).to be_present[0m
       [31m  expected `{}.present?` to be truthy, got false[0m
       [36m# ./spec/models/craft/variant_manager_spec.rb:67:in 'block (3 levels) in <main>'[0m

  152) Craft::VariantManager#get_variant merges base data with standard variant data
       [31mFailure/Error: expect(merged_data['id']).to eq('heavy_lift_transport')[0m
       [31m[0m
       [31m  expected: "heavy_lift_transport"[0m
       [31m       got: "heavy_lift_transport_standard"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/craft/variant_manager_spec.rb:105:in 'block (3 levels) in <main>'[0m

  153) Craft::VariantManager#get_variant merges base data with lunar variant data
       [31mFailure/Error: expect(merged_data['systems']['life_support']['capacity']).to eq('enhanced')[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method '[]' for nil[0m
       [36m# ./spec/models/craft/variant_manager_spec.rb:121:in 'block (3 levels) in <main>'[0m

  154) Craft::VariantManager#get_variant properly merges nested hashes
       [31mFailure/Error: expect(merged_data['resource_management']['consumables']['fuel']['current']).to eq(0)[0m
       [31m[0m
       [31m  expected: 0[0m
       [31m       got: nil[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/craft/variant_manager_spec.rb:148:in 'block (3 levels) in <main>'[0m

  155) Settlement::Dome calculates used capacity (current occupancy) correctly
       [31mFailure/Error: dome = Dome.create(name: "Research Dome", capacity: 100, current_occupancy: 50)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Dome[0m
       [36m# ./spec/models/dome_spec.rb:6:in 'block (2 levels) in <main>'[0m

  156) Settlement::Dome calculates remaining capacity correctly
       [31mFailure/Error: dome = Dome.create(name: "Living Dome", capacity: 200, current_occupancy: 50)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Dome[0m
       [36m# ./spec/models/dome_spec.rb:11:in 'block (2 levels) in <main>'[0m

  157) Settlement::Dome ensures current occupancy does not exceed total capacity
       [31mFailure/Error: dome = Dome.new(name: "Living Dome", capacity: 100, current_occupancy: 150)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Dome[0m
       [36m# ./spec/models/dome_spec.rb:16:in 'block (2 levels) in <main>'[0m

  158) CelestialBodies::DwarfPlanet#calculate_surface_conditions calculates surface conditions specific to dwarf planets
       [31mFailure/Error:[0m
       [31m  DwarfPlanet.create!([0m
       [31m    name: "Pluto",[0m
       [31m    size: 0.18,[0m
       [31m    gravity: 0.62,[0m
       [31m    density: 1.86,[0m
       [31m    orbital_period: 90560,[0m
       [31m    mass: 1.303e22, # Example mass in kg[0m
       [31m    radius: 1.19e6, # Example radius in meters[0m
       [31m    gas_quantities: { "Nitrogen" => 8000, "Methane" => 1000 },[0m
       [31m    temperature: 44.0 # Example temperature[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant DwarfPlanet[0m
       [36m# ./spec/models/dwarf_planet_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/dwarf_planet_spec.rb:20:in 'block (3 levels) in <main>'[0m

  159) CelestialBodies::DwarfPlanet#update_biomes updates biomes specific to dwarf planets
       [31mFailure/Error:[0m
       [31m  DwarfPlanet.create!([0m
       [31m    name: "Pluto",[0m
       [31m    size: 0.18,[0m
       [31m    gravity: 0.62,[0m
       [31m    density: 1.86,[0m
       [31m    orbital_period: 90560,[0m
       [31m    mass: 1.303e22, # Example mass in kg[0m
       [31m    radius: 1.19e6, # Example radius in meters[0m
       [31m    gas_quantities: { "Nitrogen" => 8000, "Methane" => 1000 },[0m
       [31m    temperature: 44.0 # Example temperature[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant DwarfPlanet[0m
       [36m# ./spec/models/dwarf_planet_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/dwarf_planet_spec.rb:27:in 'block (3 levels) in <main>'[0m

  160) Environment validations is valid with valid attributes
       [31mFailure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'biome' for Environment.[0m
       [36m# ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/environment_spec.rb:12:in 'block (3 levels) in <main>'[0m

  161) Environment validations is not valid without a biome
       [31mFailure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'biome' for Environment.[0m
       [36m# ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/environment_spec.rb:16:in 'block (3 levels) in <main>'[0m

  162) Environment validations is not valid without a planet
       [31mFailure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'biome' for Environment.[0m
       [36m# ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/environment_spec.rb:21:in 'block (3 levels) in <main>'[0m

  163) Environment validations is not valid without a temperature
       [31mFailure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'biome' for Environment.[0m
       [36m# ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/environment_spec.rb:26:in 'block (3 levels) in <main>'[0m

  164) Environment validations is not valid without a pressure
       [31mFailure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'biome' for Environment.[0m
       [36m# ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/environment_spec.rb:31:in 'block (3 levels) in <main>'[0m

  165) Environment validations is not valid without a humidity
       [31mFailure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'biome' for Environment.[0m
       [36m# ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/environment_spec.rb:36:in 'block (3 levels) in <main>'[0m

  166) Environment associations belongs to a biome
       [31mFailure/Error: should belong_to(:biome)[0m
       [31m  Expected Environment to have a belongs_to association called biome (no association called biome)[0m
       [36m# ./spec/models/environment_spec.rb:43:in 'block (3 levels) in <main>'[0m

  167) Environment associations belongs to a celestial_body
       [31mFailure/Error: should belong_to(:celestial_body)[0m
       [31m  Expected Environment to have a belongs_to association called celestial_body (no association called celestial_body)[0m
       [36m# ./spec/models/environment_spec.rb:47:in 'block (3 levels) in <main>'[0m

  168) Game#assign_task adds a new task to the task list with correct completion time
       [31mFailure/Error:[0m
       [31m  @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|[0m
       [31m    c.name = 'Galactic Crypto Currency'[0m
       [31m    c.is_system_currency = true[0m
       [31m    c.precision = 8[0m
       [31m  end[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Currency[0m
       [36m# ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'[0m

  169) Game#advance_time advances game time and completes a task
       [31mFailure/Error:[0m
       [31m  @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|[0m
       [31m    c.name = 'Galactic Crypto Currency'[0m
       [31m    c.is_system_currency = true[0m
       [31m    c.precision = 8[0m
       [31m  end[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Currency[0m
       [36m# ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'[0m

  170) Game#advance_time with no tasks prints a message when there are no tasks
       [31mFailure/Error:[0m
       [31m  @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|[0m
       [31m    c.name = 'Galactic Crypto Currency'[0m
       [31m    c.is_system_currency = true[0m
       [31m    c.precision = 8[0m
       [31m  end[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Currency[0m
       [36m# ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'[0m

  171) CelestialBodies::GasGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
       [31mFailure/Error:[0m
       [31m  GasGiant.create!([0m
       [31m    name: "Jupiter",[0m
       [31m    size: 11.2,[0m
       [31m    gravity: 24.79,[0m
       [31m    density: 1.33,[0m
       [31m    orbital_period: 4331,[0m
       [31m    mass: 1.898e27, # Example mass in kg[0m
       [31m    radius: 6.99e7, # Example radius in meters[0m
       [31m    gas_quantities: { "Hydrogen" => 8580000, "Helium" => 1520000 },[0m
       [31m    temperature: 165.0 # Example temperature[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant GasGiant[0m
       [36m# ./spec/models/gas_giant_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/gas_giant_spec.rb:20:in 'block (3 levels) in <main>'[0m

  172) CelestialBodies::GasGiant#calculate_gravity calculates gravity based on mass and radius
       [31mFailure/Error:[0m
       [31m  GasGiant.create!([0m
       [31m    name: "Jupiter",[0m
       [31m    size: 11.2,[0m
       [31m    gravity: 24.79,[0m
       [31m    density: 1.33,[0m
       [31m    orbital_period: 4331,[0m
       [31m    mass: 1.898e27, # Example mass in kg[0m
       [31m    radius: 6.99e7, # Example radius in meters[0m
       [31m    gas_quantities: { "Hydrogen" => 8580000, "Helium" => 1520000 },[0m
       [31m    temperature: 165.0 # Example temperature[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant GasGiant[0m
       [36m# ./spec/models/gas_giant_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/gas_giant_spec.rb:27:in 'block (3 levels) in <main>'[0m

  173) CelestialBodies::Spheres::Hydrosphere#reset resets to base values
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: H2O. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'[0m
       [36m# ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'[0m
       [36m# ./app/models/celestial_bodies/spheres/hydrosphere.rb:316:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'[0m
       [36m# ./spec/models/hydrosphere_spec.rb:47:in 'block (3 levels) in <main>'[0m

  174) CelestialBodies::IceGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
       [31mFailure/Error:[0m
       [31m  IceGiant.create!([0m
       [31m    name: "Uranus",[0m
       [31m    size: 4.0,[0m
       [31m    gravity: 8.69,[0m
       [31m    density: 1.27,[0m
       [31m    orbital_period: 30660,[0m
       [31m    mass: 8.681e25, # Example mass in kg[0m
       [31m    radius: 2.54e7, # Example radius in meters[0m
       [31m    gas_quantities: { "Hydrogen" => 830000, "Helium" => 140000 },[0m
       [31m    temperature: 76.0 # Example temperature[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant IceGiant[0m
       [36m# ./spec/models/ice_giant_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/ice_giant_spec.rb:20:in 'block (3 levels) in <main>'[0m

  175) CelestialBodies::IceGiant#calculate_gravity calculates gravity based on mass and radius
       [31mFailure/Error:[0m
       [31m  IceGiant.create!([0m
       [31m    name: "Uranus",[0m
       [31m    size: 4.0,[0m
       [31m    gravity: 8.69,[0m
       [31m    density: 1.27,[0m
       [31m    orbital_period: 30660,[0m
       [31m    mass: 8.681e25, # Example mass in kg[0m
       [31m    radius: 2.54e7, # Example radius in meters[0m
       [31m    gas_quantities: { "Hydrogen" => 830000, "Helium" => 140000 },[0m
       [31m    temperature: 76.0 # Example temperature[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant IceGiant[0m
       [36m# ./spec/models/ice_giant_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/ice_giant_spec.rb:27:in 'block (3 levels) in <main>'[0m

  176) Item regolith handling gets composition from celestial body geosphere
       [31mFailure/Error: expect(luna.identifier).to eq('LUNA-01')[0m
       [31m[0m
       [31m  expected: "LUNA-01"[0m
       [31m       got: "LUNA-38"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/item_spec.rb:300:in 'block (3 levels) in <main>'[0m

  177) CelestialBodies::Materials::Liquid associations 
       [31mFailure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "celestial_bodies_spheres_hydrosphere"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:9:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "celestial_bodies_spheres_hydrosphere"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  178) CelestialBodies::Materials::Liquid validations is valid with valid attributes
       [31mFailure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "celestial_bodies_spheres_hydrosphere"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:14:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "celestial_bodies_spheres_hydrosphere"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  179) CelestialBodies::Materials::Liquid validations is not valid without a name
       [31mFailure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "celestial_bodies_spheres_hydrosphere"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:18:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "celestial_bodies_spheres_hydrosphere"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  180) CelestialBodies::Materials::Liquid validations is not valid without an amount
       [31mFailure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "celestial_bodies_spheres_hydrosphere"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:24:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "celestial_bodies_spheres_hydrosphere"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  181) CelestialBodies::Materials::Liquid validations is not valid with a negative amount
       [31mFailure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "celestial_bodies_spheres_hydrosphere"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/liquid_material_spec.rb:30:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "celestial_bodies_spheres_hydrosphere"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  182) Location::CelestialLocation validations is expected to validate that :name cannot be empty/falsy
       [31mFailure/Error: it { is_expected.to validate_presence_of(:name) }[0m
       [31m[0m
       [31m  Expected Location::CelestialLocation to validate that :name cannot be[0m
       [31m  empty/falsy, but this could not be proved.[0m
       [31m    After setting :name to ‹""›, the matcher expected the[0m
       [31m    Location::CelestialLocation to be invalid, but it was valid instead.[0m
       [36m# ./spec/models/location/celestial_location_spec.rb:15:in 'block (3 levels) in <main>'[0m

  183) Location::CelestialLocation#description describes surface locations
       [31mFailure/Error:[0m
       [31m  location = Location::CelestialLocation.new([0m
       [31m    name: 'Surface Location',[0m
       [31m    celestial_body: body,[0m
       [31m    coordinates: '28.50°N 80.60°W',[0m
       [31m    altitude: 0[0m
       [31m  )[0m
       [31m[0m
       [31mActiveRecord::AssociationTypeMismatch:[0m
       [31m  CelestialBodies::CelestialBody(#24760) expected, got #<Double "Body"> which is an instance of RSpec::Mocks::Double(#142944)[0m
       [36m# ./spec/models/location/celestial_location_spec.rb:401:in 'block (3 levels) in <main>'[0m

  184) Location::CelestialLocation#description describes orbital locations
       [31mFailure/Error:[0m
       [31m  location = Location::CelestialLocation.new([0m
       [31m    name: 'Orbital Location',[0m
       [31m    celestial_body: body,[0m
       [31m    coordinates: '0.00°N 0.00°E',[0m
       [31m    altitude: 400_000[0m
       [31m  )[0m
       [31m[0m
       [31mActiveRecord::AssociationTypeMismatch:[0m
       [31m  CelestialBodies::CelestialBody(#24760) expected, got #<Double "Body"> which is an instance of RSpec::Mocks::Double(#142944)[0m
       [36m# ./spec/models/location/celestial_location_spec.rb:415:in 'block (3 levels) in <main>'[0m

  185) Market::TransactionFee validations is expected to validate that :fee_type cannot be empty/falsy
       [31mFailure/Error: it { should validate_presence_of(:fee_type) }[0m
       [31m[0m
       [31mShoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:[0m
       [31m  The matcher attempted to set :fee_type on the Market::TransactionFee to[0m
       [31m  nil, but that attribute does not exist.[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#run_allow_or_disallow_matcher'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:103:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#disallows_value_of'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:258:in 'Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#disallows_original_or_typecast_value?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:180:in 'block in Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:179:in 'Array#all?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#matches?'[0m
       [36m# ./spec/models/market/transaction_fee_spec.rb:5:in 'block (3 levels) in <main>'[0m

  186) Market::TransactionFee validations is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"›
       [31mFailure/Error: it { should validate_inclusion_of(:fee_type).in_array(%w[percentage fixed]) }[0m
       [31m[0m
       [31mShoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:[0m
       [31m  The matcher attempted to set :fee_type on the Market::TransactionFee to[0m
       [31m  "percentage", but that attribute does not exist.[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:42:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#does_not_match?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Enumerable#detect'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_failing'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:395:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#run_allow_or_disallow_matcher'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:98:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#allows_value_of'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:468:in 'block in Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#allows_all_values_in_array?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:467:in 'Array#all?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:467:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#allows_all_values_in_array?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:417:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#matches_for_array?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:376:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#matches?'[0m
       [36m# ./spec/models/market/transaction_fee_spec.rb:6:in 'block (3 levels) in <main>'[0m

  187) Market::TransactionFee validations is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil
       [31mFailure/Error: it { should validate_numericality_of(:percentage).is_greater_than_or_equal_to(0).allow_nil }[0m
       [31m[0m
       [31mShoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:[0m
       [31m  The matcher attempted to set :percentage on the Market::TransactionFee[0m
       [31m  to "-1", but that attribute does not exist.[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:36:in 'block in Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Array#reject'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:13:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/comparison_matcher.rb:79:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::ComparisonMatcher#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'[0m
       [36m# ./spec/models/market/transaction_fee_spec.rb:7:in 'block (3 levels) in <main>'[0m

  188) Market::TransactionFee validations is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil
       [31mFailure/Error: it { should validate_numericality_of(:fixed_amount).is_greater_than_or_equal_to(0).allow_nil }[0m
       [31m[0m
       [31mShoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:[0m
       [31m  The matcher attempted to set :fixed_amount on the Market::TransactionFee[0m
       [31m  to "-1", but that attribute does not exist.[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:36:in 'block in Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Array#reject'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:13:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/comparison_matcher.rb:79:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::ComparisonMatcher#matches?'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'[0m
       [36m# /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'[0m
       [36m# ./spec/models/market/transaction_fee_spec.rb:8:in 'block (3 levels) in <main>'[0m

  189) Market::TransactionFee#calculate calculates percentage fee
       [31mFailure/Error: fee = build(:transaction_fee, fee_type: 'percentage', percentage: 5, fixed_amount: nil)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'fee_type=' for an instance of Market::TransactionFee[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/market/transaction_fee_spec.rb:13:in 'block (3 levels) in <main>'[0m

  190) Market::TransactionFee#calculate calculates fixed fee
       [31mFailure/Error: fee = build(:transaction_fee, fee_type: 'fixed', percentage: nil, fixed_amount: 10)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'fee_type=' for an instance of Market::TransactionFee[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/market/transaction_fee_spec.rb:18:in 'block (3 levels) in <main>'[0m

  191) Market::TransactionFee#calculate returns 0 for unknown fee_type
       [31mFailure/Error: fee = build(:transaction_fee, fee_type: 'other', percentage: nil, fixed_amount: nil)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'fee_type=' for an instance of Market::TransactionFee[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/market/transaction_fee_spec.rb:23:in 'block (3 levels) in <main>'[0m

  192) MaterialRequest instance methods #gas_request? returns true when material is a gas
       [31mFailure/Error: material_data = lookup_service.find_material(material_name)[0m
       [31m  #<InstanceDouble(Lookup::MaterialLookupService) (anonymous)> received unexpected message :find_material with ("aluminum")[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:355:in 'GeosphereConcern#physical_state'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:271:in 'block in GeosphereConcern#update_material_states'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:269:in 'GeosphereConcern#update_material_states'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/factories/terrestrial_planets.rb:47:in 'block (4 levels) in <main>'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'FactoryBot::Callback#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:11:in 'block in FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:20:in 'FactoryBot::Evaluation#notify'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:13:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/material_request_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:222:in 'block (4 levels) in <main>'[0m

  193) MaterialRequest instance methods #gas_request? returns false when material is not a gas
       [31mFailure/Error: material_data = lookup_service.find_material(material_name)[0m
       [31m  #<InstanceDouble(Lookup::MaterialLookupService) (anonymous)> received unexpected message :find_material with ("iron_oxide")[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:355:in 'GeosphereConcern#physical_state'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:271:in 'block in GeosphereConcern#update_material_states'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:269:in 'GeosphereConcern#update_material_states'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/factories/terrestrial_planets.rb:47:in 'block (4 levels) in <main>'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'FactoryBot::Callback#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:11:in 'block in FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:20:in 'FactoryBot::Evaluation#notify'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:13:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/material_request_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:229:in 'block (4 levels) in <main>'[0m

  194) MaterialRequest instance methods #gas_request? returns false when material data is not found
       [31mFailure/Error: material_data = lookup_service.find_material(material_name)[0m
       [31m  #<InstanceDouble(Lookup::MaterialLookupService) (anonymous)> received unexpected message :find_material with ("iron_oxide")[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:355:in 'GeosphereConcern#physical_state'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:271:in 'block in GeosphereConcern#update_material_states'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:269:in 'GeosphereConcern#update_material_states'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/factories/terrestrial_planets.rb:47:in 'block (4 levels) in <main>'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'FactoryBot::Callback#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:11:in 'block in FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:20:in 'FactoryBot::Evaluation#notify'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:13:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/material_request_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:235:in 'block (4 levels) in <main>'[0m

  195) MaterialRequest instance methods #gas_request? returns false when material data has no category
       [31mFailure/Error: material_data = lookup_service.find_material(material_name)[0m
       [31m  #<InstanceDouble(Lookup::MaterialLookupService) (anonymous)> received unexpected message :find_material with ("iron_oxide")[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:355:in 'GeosphereConcern#physical_state'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:271:in 'block in GeosphereConcern#update_material_states'[0m
       [36m# ./app/models/concerns/geosphere_concern.rb:269:in 'GeosphereConcern#update_material_states'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/factories/terrestrial_planets.rb:47:in 'block (4 levels) in <main>'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'FactoryBot::Callback#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:11:in 'block in FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:20:in 'FactoryBot::Evaluation#notify'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:13:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/material_request_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/models/material_request_spec.rb:242:in 'block (4 levels) in <main>'[0m

  196) CelestialBodies::Material validations is not valid with non-numeric melting and boiling points
       [31mFailure/Error: expect(material).to_not be_valid[0m
       [31m  expected #<CelestialBodies::Material id: 38638, name: "Material 15", amount: 100.0, boiling_point: 0.0, melting_point: 0.0, state_at_room_temp: nil, state: "solid", location: "surface", is_volatile: false, materializable_type: nil, materializable_id: nil, celestial_body_id: 46148, created_at: "2026-01-19 04:30:10.407334000 +0000", updated_at: "2026-01-19 04:30:10.407334000 +0000", layer: nil> not to be valid[0m
       [36m# ./spec/models/material_spec.rb:52:in 'block (3 levels) in <main>'[0m

  197) CelestialBodies::Material#state_at returns "solid" when temperature is below the adjusted melting point
       [31mFailure/Error: expect(material.state_at(250, 1.0)).to eq('solid')[0m
       [31m[0m
       [31m  expected: "solid"[0m
       [31m       got: "gas"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/material_spec.rb:64:in 'block (3 levels) in <main>'[0m

  198) CelestialBodies::Material#state_at returns "liquid" when temperature is between the adjusted melting and boiling points
       [31mFailure/Error: expect(material.state_at(400, 1.0)).to eq('liquid')[0m
       [31m[0m
       [31m  expected: "liquid"[0m
       [31m       got: "gas"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/material_spec.rb:68:in 'block (3 levels) in <main>'[0m

  199) Modules::BaseModule callbacks before_validation :load_module_data on create when module data is found loads CO2 scrubber data from lookup service
       [31mFailure/Error: expect(module_obj.name).to eq('CO2 Scrubber Module')[0m
       [31m[0m
       [31m  expected: "CO2 Scrubber Module"[0m
       [31m       got: nil[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/modules/base_module_spec.rb:73:in 'block (5 levels) in <main>'[0m

  200) Modules::BaseModule instance methods #operational_status returns operational status from loaded data
       [31mFailure/Error: create(:base_module, :from_lookup, module_type: 'co2_scrubber')[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:159:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:164:in 'block (4 levels) in <main>'[0m

  201) Modules::BaseModule instance methods #operational_status returns inactive when operational_data is missing
       [31mFailure/Error: create(:base_module, :from_lookup, module_type: 'co2_scrubber')[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:159:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:168:in 'block (4 levels) in <main>'[0m

  202) Modules::BaseModule instance methods #input_resources returns input resources from loaded data
       [31mFailure/Error: create(:base_module, :from_lookup, module_type: 'co2_scrubber')[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:159:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:175:in 'block (4 levels) in <main>'[0m

  203) Modules::BaseModule instance methods #input_resources returns empty array when operational_data is missing
       [31mFailure/Error: create(:base_module, :from_lookup, module_type: 'co2_scrubber')[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:159:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:183:in 'block (4 levels) in <main>'[0m

  204) Modules::BaseModule instance methods #output_resources returns output resources from loaded data
       [31mFailure/Error: create(:base_module, :from_lookup, module_type: 'co2_scrubber')[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:159:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:190:in 'block (4 levels) in <main>'[0m

  205) Modules::BaseModule instance methods #consumables returns consumables from loaded data
       [31mFailure/Error: create(:base_module, :from_lookup, module_type: 'co2_scrubber')[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:159:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:200:in 'block (4 levels) in <main>'[0m

  206) Modules::BaseModule AtmosphericProcessing integration #can_process_atmosphere? returns true for CO2 scrubber module
       [31mFailure/Error: let(:co2_scrubber_module) { create(:base_module, :from_lookup, module_type: 'co2_scrubber') }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:210:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:215:in 'block (4 levels) in <main>'[0m

  207) Modules::BaseModule AtmosphericProcessing integration #can_process_atmosphere? returns false for basic life support module
       [31mFailure/Error: let(:life_support_module) { create(:base_module, :from_lookup, module_type: 'life_support') }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:211:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:219:in 'block (4 levels) in <main>'[0m

  208) Modules::BaseModule AtmosphericProcessing integration #atmospheric_capabilities identifies CO2 scrubbing capability
       [31mFailure/Error: let(:co2_scrubber_module) { create(:base_module, :from_lookup, module_type: 'co2_scrubber') }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:210:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:225:in 'block (4 levels) in <main>'[0m

  209) Modules::BaseModule AtmosphericProcessing integration #max_processing_rate returns correct rates for CO2 scrubber
       [31mFailure/Error: let(:co2_scrubber_module) { create(:base_module, :from_lookup, module_type: 'co2_scrubber') }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Name can't be blank[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:210:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/models/modules/base_module_spec.rb:234:in 'block (4 levels) in <main>'[0m

  210) Organizations::BaseOrganization distributes profits to members based on ownership
       [31mFailure/Error: allow(consortium).to receive(:calculate_revenue).and_return(1_000_000)[0m
       [31m  #<Organizations::BaseOrganization id: 2968, name: "Test Organization 62", identifier: "ORG67", organization_type: "consortium", operational_data: {}, description: nil, owner_type: nil, owner_id: nil, created_at: "2026-01-19 04:30:25.740058000 +0000", updated_at: "2026-01-19 04:30:25.740058000 +0000"> does not implement: calculate_revenue[0m
       [36m# ./spec/models/organizations/base_organization_profit_spec.rb:9:in 'block (2 levels) in <main>'[0m

  211) Organizations::TaxAuthority.instance always returns the same single instance
       [31mFailure/Error: expect(Organizations::TaxAuthority.count).to eq(1)[0m
       [31m[0m
       [31m  expected: 1[0m
       [31m       got: 2[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/organizations/tax_authority_spec.rb:24:in 'block (3 levels) in <main>'[0m

  212) PlanetBiome 
       [31mFailure/Error:[0m
       [31m  described_class.new([0m
       [31m    biome: biome,[0m
       [31m    celestial_body: celestial_body[0m
       [31m  )[0m
       [31m[0m
       [31mNameError:[0m
       [31m  Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.[0m
       [36m# ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/planet_biome_spec.rb:15:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# NameError:[0m
       [36m#   uninitialized constant PlanetBiome::CelestialBody[0m
       [36m#   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m

  213) PlanetBiome 
       [31mFailure/Error:[0m
       [31m  described_class.new([0m
       [31m    biome: biome,[0m
       [31m    celestial_body: celestial_body[0m
       [31m  )[0m
       [31m[0m
       [31mNameError:[0m
       [31m  Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.[0m
       [36m# ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/planet_biome_spec.rb:16:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# NameError:[0m
       [36m#   uninitialized constant PlanetBiome::CelestialBody[0m
       [36m#   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m

  214) PlanetBiome is valid with valid attributes
       [31mFailure/Error:[0m
       [31m  described_class.new([0m
       [31m    biome: biome,[0m
       [31m    celestial_body: celestial_body[0m
       [31m  )[0m
       [31m[0m
       [31mNameError:[0m
       [31m  Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.[0m
       [36m# ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/planet_biome_spec.rb:20:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# NameError:[0m
       [36m#   uninitialized constant PlanetBiome::CelestialBody[0m
       [36m#   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m

  215) PlanetBiome is not valid without a biome
       [31mFailure/Error:[0m
       [31m  described_class.new([0m
       [31m    biome: biome,[0m
       [31m    celestial_body: celestial_body[0m
       [31m  )[0m
       [31m[0m
       [31mNameError:[0m
       [31m  Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.[0m
       [36m# ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/planet_biome_spec.rb:24:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# NameError:[0m
       [36m#   uninitialized constant PlanetBiome::CelestialBody[0m
       [36m#   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m

  216) PlanetBiome is not valid without a celestial_body
       [31mFailure/Error:[0m
       [31m  described_class.new([0m
       [31m    biome: biome,[0m
       [31m    celestial_body: celestial_body[0m
       [31m  )[0m
       [31m[0m
       [31mNameError:[0m
       [31m  Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.[0m
       [36m# ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/planet_biome_spec.rb:29:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# NameError:[0m
       [36m#   uninitialized constant PlanetBiome::CelestialBody[0m
       [36m#   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'[0m

  217) PlantEnvironment validations is valid with valid attributes
       [31mFailure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Environment must exist[0m
       [36m# ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/plant_environment_spec.rb:14:in 'block (3 levels) in <main>'[0m

  218) PlantEnvironment validations is not valid without a plant
       [31mFailure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Environment must exist[0m
       [36m# ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/plant_environment_spec.rb:18:in 'block (3 levels) in <main>'[0m

  219) PlantEnvironment validations is not valid without an environment
       [31mFailure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Environment must exist[0m
       [36m# ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/plant_environment_spec.rb:23:in 'block (3 levels) in <main>'[0m

  220) PlantEnvironment validations is not valid with duplicate plant and environment pair
       [31mFailure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Environment must exist[0m
       [36m# ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/plant_environment_spec.rb:28:in 'block (3 levels) in <main>'[0m

  221) Plant validations is valid with valid attributes
       [31mFailure/Error: expect(plant).to be_valid[0m
       [31m  expected #<Plant id: nil, name: "Cactus", growth_temperature_range: "20..30", growth_humidity_range: "10..30", description: "A hardy plant adapted to dry environments", created_at: nil, updated_at: nil> to be valid, but got errors: Environment must exist[0m
       [36m# ./spec/models/plant_spec.rb:10:in 'block (3 levels) in <main>'[0m

  222) Plant methods can grow in a given environment if conditions are met
       [31mFailure/Error: environment = Environment.create(biome: biome, planet: Planet.first, temperature: 25.0, pressure: 1.0, humidity: 20.0)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Planet[0m
       [36m# ./spec/models/plant_spec.rb:37:in 'block (3 levels) in <main>'[0m

  223) Plant methods cannot grow in a given environment if conditions are not met
       [31mFailure/Error: environment = Environment.create(biome: biome, planet: Planet.first, temperature: 35.0, pressure: 1.0, humidity: 80.0)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Planet[0m
       [36m# ./spec/models/plant_spec.rb:43:in 'block (3 levels) in <main>'[0m

  224) Rigs::BaseRig#apply_rig_to_attachable applies rig effect to the attachable unit
       [31mFailure/Error: expect(base_unit).to receive(:update_consumables).at_least(:once)[0m
       [31m  #<Units::BaseUnit id: 5131, identifier: "UNIT57", name: "Test Unit 49", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 2975, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-19 04:30:28.356602000 +0000", updated_at: "2026-01-19 04:30:28.356602000 +0000"> does not implement: update_consumables[0m
       [36m# ./spec/models/rigs/base_rig_spec.rb:24:in 'block (3 levels) in <main>'[0m

  225) Rigs::BaseRig#remove_from removes rig effect from the attachable unit
       [31mFailure/Error: expect(base_unit).to receive(:update_consumables).at_least(:once)[0m
       [31m  #<Units::BaseUnit id: 5132, identifier: "UNIT58", name: "Test Unit 50", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 2976, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-19 04:30:28.411831000 +0000", updated_at: "2026-01-19 04:30:28.411831000 +0000"> does not implement: update_consumables[0m
       [36m# ./spec/models/rigs/base_rig_spec.rb:31:in 'block (3 levels) in <main>'[0m

  226) Rigs::BaseRig polymorphic association can belong to an attachable BaseUnit
       [31mFailure/Error: expect(base_unit.persisted_rigs).to include(rig)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'persisted_rigs' for an instance of Units::BaseUnit[0m
       [36m# ./spec/models/rigs/base_rig_spec.rb:39:in 'block (3 levels) in <main>'[0m

  227) Rigs::BaseRig#apply_output_effects and #revert_output_effects applies and reverts output effects if attachable responds to update_outputs
       [31mFailure/Error: allow(base_unit).to receive(:update_outputs)[0m
       [31m  #<Units::BaseUnit id: 5138, identifier: "UNIT64", name: "Test Unit 56", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 2982, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-19 04:30:28.787621000 +0000", updated_at: "2026-01-19 04:30:28.787621000 +0000"> does not implement: update_outputs[0m
       [36m# ./spec/models/rigs/base_rig_spec.rb:108:in 'block (3 levels) in <main>'[0m

  228) Rigs::BaseRig#apply_damage_effects and #revert_damage_effects applies and reverts damage effects if attachable responds to update_damage_risks
       [31mFailure/Error: allow(base_unit).to receive(:update_damage_risks)[0m
       [31m  #<Units::BaseUnit id: 5139, identifier: "UNIT65", name: "Test Unit 57", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 2983, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-19 04:30:28.845378000 +0000", updated_at: "2026-01-19 04:30:28.845378000 +0000"> does not implement: update_damage_risks[0m
       [36m# ./spec/models/rigs/base_rig_spec.rb:130:in 'block (3 levels) in <main>'[0m

  229) RouteProposal calculates vote outcome based on threshold
       [31mFailure/Error: votes_in_favor = votes.where(vote: 'approve').sum(:voting_power)[0m
       [31m[0m
       [31mActiveRecord::StatementInvalid:[0m
       [31m  PG::UndefinedColumn: ERROR:  column route_proposal_votes.route_proposal_id does not exist[0m
       [31m  LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...[0m
       [31m                                                               ^[0m
       [36m# ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'[0m
       [36m# ./spec/models/route_proposal_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# PG::UndefinedColumn:[0m
       [36m#   ERROR:  column route_proposal_votes.route_proposal_id does not exist[0m
       [36m#   LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...[0m
       [36m#                                                                ^[0m
       [36m#   ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'[0m

  230) RouteProposal fails if votes do not meet threshold
       [31mFailure/Error: votes_in_favor = votes.where(vote: 'approve').sum(:voting_power)[0m
       [31m[0m
       [31mActiveRecord::StatementInvalid:[0m
       [31m  PG::UndefinedColumn: ERROR:  column route_proposal_votes.route_proposal_id does not exist[0m
       [31m  LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...[0m
       [31m                                                               ^[0m
       [36m# ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'[0m
       [36m# ./spec/models/route_proposal_spec.rb:19:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# PG::UndefinedColumn:[0m
       [36m#   ERROR:  column route_proposal_votes.route_proposal_id does not exist[0m
       [36m#   LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...[0m
       [36m#                                                                ^[0m
       [36m#   ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'[0m

  231) RouteProposalVote is valid with valid attributes
       [31mFailure/Error: let(:proposal) { create(:route_proposal) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "route_proposal"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/route_proposal_vote_spec.rb:4:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/route_proposal_vote_spec.rb:8:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "route_proposal"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  232) RouteProposalVote is invalid with an invalid vote value
       [31mFailure/Error: let(:proposal) { create(:route_proposal) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "route_proposal"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/route_proposal_vote_spec.rb:4:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/route_proposal_vote_spec.rb:13:in 'block (2 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "route_proposal"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  233) Settlement::City validations is valid with valid attributes
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:21:in 'block (3 levels) in <main>'[0m

  234) Settlement::City validations is not valid without a location
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:25:in 'block (3 levels) in <main>'[0m

  235) Settlement::City validations is not valid without a name
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:30:in 'block (3 levels) in <main>'[0m

  236) Settlement::City validations is not valid with a negative current population
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:35:in 'block (3 levels) in <main>'[0m

  237) Settlement::City validations is not valid with food_per_person less than or equal to zero
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:40:in 'block (3 levels) in <main>'[0m

  238) Settlement::City validations is not valid with water_per_person less than or equal to zero
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:45:in 'block (3 levels) in <main>'[0m

  239) Settlement::City validations is not valid with energy_per_person less than or equal to zero
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:50:in 'block (3 levels) in <main>'[0m

  240) Settlement::City#resource_requirements calculates resource requirements correctly
       [31mFailure/Error:[0m
       [31m  build(:city, :independent, [0m
       [31m    location: location, [0m
       [31m    current_population: 100, [0m
       [31m    food_per_person: 2, [0m
       [31m    water_per_person: 1, [0m
       [31m    energy_per_person: 3[0m
       [31m  ) [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'food_per_person=' for an instance of Settlement::City[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/city_spec.rb:57:in 'block (3 levels) in <main>'[0m

  241) Settlement::NPCColony can build a unit
       [31mFailure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'population_capacity' for Settlement::NPCColony.[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'[0m

  242) Settlement::NPCColony can establish trade routes
       [31mFailure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'population_capacity' for Settlement::NPCColony.[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'[0m

  243) Settlement::NPCColony can perform autonomous tasks
       [31mFailure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'population_capacity' for Settlement::NPCColony.[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'[0m

  244) Settlement::NPCColony calculates total population across settlements
       [31mFailure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }[0m
       [31m[0m
       [31mActiveModel::UnknownAttributeError:[0m
       [31m  unknown attribute 'population_capacity' for Settlement::NPCColony.[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'[0m

  245) Settlement::Outpost population capacity calculates total capacity from habitat units
       [31mFailure/Error: expect(outpost.population_capacity).to eq(500)[0m
       [31m[0m
       [31m  expected: 500[0m
       [31m       got: 100[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/settlement/outpost_spec.rb:30:in 'block (3 levels) in <main>'[0m

  246) Settlement::Outpost population capacity calculates available capacity correctly
       [31mFailure/Error: expect(outpost.available_capacity).to eq(300) # 500 - 200[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'available_capacity' for an instance of Settlement::Outpost[0m
       [36m# ./spec/models/settlement/outpost_spec.rb:37:in 'block (3 levels) in <main>'[0m

  247) Settlement::Outpost population capacity checks if it has capacity for additional population
       [31mFailure/Error: expect(outpost.has_capacity_for?(150)).to be true[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'has_capacity_for?' for an instance of Settlement::Outpost[0m
       [36m# ./spec/models/settlement/outpost_spec.rb:43:in 'block (3 levels) in <main>'[0m

  248) Settlement::Settlement population capacity calculates total capacity from habitat units
       [31mFailure/Error: expect(settlement.population_capacity).to eq(500)[0m
       [31m[0m
       [31m  expected: 500[0m
       [31m       got: 100[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/settlement/settlement_spec.rb:33:in 'block (3 levels) in <main>'[0m

  249) Settlement::Settlement population capacity calculates available capacity correctly
       [31mFailure/Error: expect(settlement.available_capacity).to eq(300) # 500 - 200[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'available_capacity' for an instance of Settlement::Settlement[0m
       [36m# ./spec/models/settlement/settlement_spec.rb:39:in 'block (3 levels) in <main>'[0m

  250) Settlement::Settlement population capacity checks if it has capacity for additional population
       [31mFailure/Error: expect(settlement.has_capacity_for?(150)).to be true[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'has_capacity_for?' for an instance of Settlement::Settlement[0m
       [36m# ./spec/models/settlement/settlement_spec.rb:44:in 'block (3 levels) in <main>'[0m

  251) ShellPrintingJob scopes returns active jobs
       [31mFailure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "unit"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "unit"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  252) ShellPrintingJob scopes returns completed jobs
       [31mFailure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "unit"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "unit"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  253) ShellPrintingJob scopes returns in_progress jobs
       [31mFailure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "unit"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "unit"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  254) SolarSystem callbacks generates a unique name before create if name is not present
       [31mFailure/Error: expect(solar_system.name).to match(/^[A-Z]{2}-\d{2}$/)[0m
       [31m[0m
       [31m  expected "SS-1223" to match /^[A-Z]{2}-\d{2}$/[0m
       [31m  Diff:[0m[0m
       [31m  [0m[34m@@ -1 +1 @@[0m
       [31m  [0m[31m-/^[A-Z]{2}-\d{2}$/[0m
       [31m  [0m[32m+"SS-1223"[0m
       [31m  [0m[0m
       [36m# ./spec/models/solar_system_spec.rb:60:in 'block (3 levels) in <main>'[0m

  255) SolarSystem#total_mass calculates total mass of all planets and dwarf planets
       [31mFailure/Error: solar_system.terrestrial_planets.destroy_all[0m
       [31m[0m
       [31mActiveRecord::InvalidForeignKey:[0m
       [31m  PG::ForeignKeyViolation: ERROR:  update or delete on table "celestial_bodies" violates foreign key constraint "fk_rails_5421c80996" on table "atmospheres"[0m
       [31m  DETAIL:  Key (id)=(46441) is still referenced from table "atmospheres".[0m
       [36m# ./spec/models/solar_system_spec.rb:263:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# PG::ForeignKeyViolation:[0m
       [36m#   ERROR:  update or delete on table "celestial_bodies" violates foreign key constraint "fk_rails_5421c80996" on table "atmospheres"[0m
       [36m#   DETAIL:  Key (id)=(46441) is still referenced from table "atmospheres".[0m
       [36m#   ./spec/models/solar_system_spec.rb:263:in 'block (3 levels) in <main>'[0m

  256) Storage::BaseStorage#add_item adds item successfully
       [31mFailure/Error:[0m
       [31m    def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}[0m
       [31m      Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata[0m
       [31m  [0m
       [31m      return false unless can_store?(name, amount)[0m
       [31m      owner ||= determine_default_owner[0m
       [31m  [0m
       [31m      if specialized_storage_required?(name)[0m
       [31m        store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata[0m
       [31m      elsif capacity_exceeded?(amount + total_stored)[0m
       [31m        handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  wrong number of arguments (given 1, expected 2..4)[0m
       [36m# ./app/models/inventory.rb:18:in 'add_item'[0m
       [36m# ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'[0m
       [36m# ./spec/models/storage/base_storage_spec.rb:10:in 'block (3 levels) in <main>'[0m

  257) Storage::BaseStorage#remove_item removes item successfully
       [31mFailure/Error:[0m
       [31m    def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}[0m
       [31m      Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata[0m
       [31m  [0m
       [31m      return false unless can_store?(name, amount)[0m
       [31m      owner ||= determine_default_owner[0m
       [31m  [0m
       [31m      if specialized_storage_required?(name)[0m
       [31m        store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata[0m
       [31m      elsif capacity_exceeded?(amount + total_stored)[0m
       [31m        handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  wrong number of arguments (given 1, expected 2..4)[0m
       [36m# ./app/models/inventory.rb:18:in 'add_item'[0m
       [36m# ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'[0m
       [36m# ./spec/models/storage/base_storage_spec.rb:24:in 'block (3 levels) in <main>'[0m

  258) Storage::BaseStorage#remove_item fails to remove item if not enough available
       [31mFailure/Error:[0m
       [31m    def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}[0m
       [31m      Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata[0m
       [31m  [0m
       [31m      return false unless can_store?(name, amount)[0m
       [31m      owner ||= determine_default_owner[0m
       [31m  [0m
       [31m      if specialized_storage_required?(name)[0m
       [31m        store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata[0m
       [31m      elsif capacity_exceeded?(amount + total_stored)[0m
       [31m        handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  wrong number of arguments (given 1, expected 2..4)[0m
       [36m# ./app/models/inventory.rb:18:in 'add_item'[0m
       [36m# ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'[0m
       [36m# ./spec/models/storage/base_storage_spec.rb:31:in 'block (3 levels) in <main>'[0m

  259) Storage::GasStorage initializes with the correct type
       [31mFailure/Error:[0m
       [31m  def initialize(capacity, gas_type, pressure = 1.0) # Default pressure at 1.0 atm[0m
       [31m    super(capacity, 'Gas')                        # Specify type as 'Gas'[0m
       [31m    @gas_type = gas_type                          # Store the type of gas[0m
       [31m    @pressure = pressure                          # Store the pressure[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  wrong number of arguments (given 1, expected 2..3)[0m
       [36m# ./app/models/storage/gas_storage.rb:6:in 'initialize'[0m
       [36m# ./spec/models/storage/gas_storage_spec.rb:5:in 'Class#new'[0m
       [36m# ./spec/models/storage/gas_storage_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/storage/gas_storage_spec.rb:8:in 'block (2 levels) in <main>'[0m

  260) Storage::SolidStorage initializes with the correct type
       [31mFailure/Error:[0m
       [31m  def initialize(capacity, solid_type)[0m
       [31m    super(capacity, 'Solid')                      # Specify type as 'Solid'[0m
       [31m    @solid_type = solid_type                      # Store the type of solid[0m
       [31m  end[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  wrong number of arguments (given 1, expected 2)[0m
       [36m# ./app/models/storage/solid_storage.rb:6:in 'initialize'[0m
       [36m# ./spec/models/storage/solid_storage_spec.rb:5:in 'Class#new'[0m
       [36m# ./spec/models/storage/solid_storage_spec.rb:5:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/storage/solid_storage_spec.rb:8:in 'block (2 levels) in <main>'[0m

  261) Storage::SurfaceStorage#check_item_conditions when atmosphere contains corrosive gases applies surface conditions to the item
       [31mFailure/Error: return atmosphere&.temperature if atmosphere&.temperature.present?[0m
       [31m  #<Double "Atmosphere"> received unexpected message :temperature with (no args)[0m
       [36m# ./app/models/celestial_bodies/celestial_body.rb:144:in 'CelestialBodies::CelestialBody#temperature'[0m
       [36m# ./app/models/celestial_bodies/celestial_body.rb:162:in 'CelestialBodies::CelestialBody#surface_temperature'[0m
       [36m# ./app/models/storage/surface_storage.rb:58:in 'Storage::SurfaceStorage#apply_surface_conditions'[0m
       [36m# ./app/models/storage/surface_storage.rb:30:in 'Storage::SurfaceStorage#check_item_conditions'[0m
       [36m# ./spec/models/storage/surface_storage_spec.rb:67:in 'block (4 levels) in <main>'[0m

  262) Storage::SurfaceStorage#check_item_conditions when atmosphere does not contain corrosive gases does not corrode the item
       [31mFailure/Error: return atmosphere&.temperature if atmosphere&.temperature.present?[0m
       [31m  #<Double "Atmosphere"> received unexpected message :temperature with (no args)[0m
       [36m# ./app/models/celestial_bodies/celestial_body.rb:144:in 'CelestialBodies::CelestialBody#temperature'[0m
       [36m# ./app/models/celestial_bodies/celestial_body.rb:162:in 'CelestialBodies::CelestialBody#surface_temperature'[0m
       [36m# ./app/models/storage/surface_storage.rb:58:in 'Storage::SurfaceStorage#apply_surface_conditions'[0m
       [36m# ./app/models/storage/surface_storage.rb:30:in 'Storage::SurfaceStorage#check_item_conditions'[0m
       [36m# ./spec/models/storage/surface_storage_spec.rb:79:in 'block (4 levels) in <main>'[0m

  263) CelestialBodies::TerrestrialPlanet runs TerraSim on planet creation
       [31mFailure/Error: expect_any_instance_of(TerraSim).to receive(:calc_current)[0m
       [31m  TerraSim does not implement #calc_current[0m
       [36m# ./spec/models/terrestrial_planets_spec.rb:34:in 'block (2 levels) in <main>'[0m

  264) CelestialBodies::TerrestrialPlanet#update_biomes updates biomes specific to terrestrial planets
       [31mFailure/Error: planet.temperature = -60 # Example temperature for Mars[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'temperature=' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet[0m
       [36m# ./spec/models/terrestrial_planets_spec.rb:10:in 'block (3 levels) in <main>'[0m

  265) CelestialBodies::TerrestrialPlanet#add_gas adds gas and updates the mass
       [31mFailure/Error: planet.add_gas('Oxygen', 1000)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'add_gas' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet[0m
       [36m# ./spec/models/terrestrial_planets_spec.rb:20:in 'block (3 levels) in <main>'[0m

  266) CelestialBodies::TerrestrialPlanet#calculate_surface_conditions calculates surface conditions specific to terrestrial planets
       [31mFailure/Error: planet.calculate_surface_conditions[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'calculate_surface_conditions' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet[0m
       [36m# ./spec/models/terrestrial_planets_spec.rb:28:in 'block (3 levels) in <main>'[0m

  267) Transaction associations belongs to an account
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:25:in 'block (3 levels) in <main>'[0m

  268) Transaction associations belongs to a recipient
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:30:in 'block (3 levels) in <main>'[0m

  269) Transaction validations requires a transaction_type
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:37:in 'block (3 levels) in <main>'[0m

  270) Transaction validations requires a valid transaction_type
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:43:in 'block (3 levels) in <main>'[0m

  271) Transaction validations requires an amount
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:49:in 'block (3 levels) in <main>'[0m

  272) Transaction validations requires amount to be numeric
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:55:in 'block (3 levels) in <main>'[0m

  273) Transaction transaction types allows deposit transactions
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:63:in 'block (3 levels) in <main>'[0m

  274) Transaction transaction types allows withdraw transactions
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:68:in 'block (3 levels) in <main>'[0m

  275) Transaction transaction types allows transfer transactions
       [31mFailure/Error: let(:account) { create(:account, accountable: player) }[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:14:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/models/transaction_spec.rb:73:in 'block (3 levels) in <main>'[0m

  276) UnitAssemblyJob#materials_gathered? returns true when all materials are fulfilled
       [31mFailure/Error: expect(job.materials_gathered?).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/models/unit_assembly_job_spec.rb:59:in 'block (3 levels) in <main>'[0m

  277) UnitAssemblyJob#start_assembly starts assembly when materials are gathered
       [31mFailure/Error: expect(job.start_assembly).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/models/unit_assembly_job_spec.rb:99:in 'block (3 levels) in <main>'[0m

  278) UnitAssemblyJob#start_assembly consumes materials from inventory
       [31mFailure/Error:[0m
       [31m  expect { job.start_assembly }.to change { steel_item.reload.amount }.from(200).to(100)[0m
       [31m    .and change { electronics_item.reload.amount }.from(100).to(50)[0m
       [31m[0m
       [31m     expected `steel_item.reload.amount` to have changed from 200 to 100, but did not change[0m
       [31m[0m
       [31m  ...and:[0m
       [31m[0m
       [31m     expected `electronics_item.reload.amount` to have changed from 100 to 50, but did not change[0m
       [36m# ./spec/models/unit_assembly_job_spec.rb:111:in 'block (3 levels) in <main>'[0m

  279) Units::BaseUnit storage operations #store_resource stores oxygen in liquid state
       [31mFailure/Error: expect(lox_tank.store_resource('oxygen', 500)).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/models/units/base_unit_spec.rb:94:in 'block (4 levels) in <main>'[0m

  280) Units::BaseUnit general storage operations #store_resource can store items up to capacity
       [31mFailure/Error: expect(storage_tank.store_resource('oxygen', 500)).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/models/units/base_unit_spec.rb:157:in 'block (4 levels) in <main>'[0m

  281) Units::BaseUnit general storage operations #store_resource tracks available capacity
       [31mFailure/Error: expect(storage_tank.available_capacity).to eq(400)[0m
       [31m[0m
       [31m  expected: 400[0m
       [31m       got: 1000[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/models/units/base_unit_spec.rb:163:in 'block (4 levels) in <main>'[0m

  282) Units::BaseUnit inventory integration #store_resource creates inventory items when storing resources
       [31mFailure/Error: expect { storage_unit.store_resource('hematite', 100) }.to change { storage_unit.inventory.items.count }.by(1)[0m
       [31m  expected `storage_unit.inventory.items.count` to have changed by 1, but was changed by 0[0m
       [36m# ./spec/models/units/base_unit_spec.rb:175:in 'block (4 levels) in <main>'[0m

  283) Units::BaseUnit inventory integration #store_resource updates inventory when removing resources
       [31mFailure/Error: expect { storage_unit.remove_resource('hematite', 50) }.to change { storage_unit.inventory.items.find_by(name: 'hematite').amount }.by(-50)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'amount' for nil[0m
       [36m# ./spec/models/units/base_unit_spec.rb:180:in 'block (5 levels) in <main>'[0m
       [36m# ./spec/models/units/base_unit_spec.rb:180:in 'block (4 levels) in <main>'[0m

  284) Units::Battery interaction with BatteryManagement concern prefers specialized methods over concern methods
       [31mFailure/Error: expect(battery).to receive(:charge_battery).with(20.0)[0m
       [31m[0m
       [31m  (#<Units::Battery id: nil, identifier: "BATTERY_001", name: "Test Battery", unit_type: "satellite_battery", operational_data: {"battery" => {"capacity" => 500.0, "current_charge" => 420.0, "max_charge_rate_kw" => 50.0, "max_discharge_rate_kw" => 75.0, "efficiency" => 0.95}}, location_type: nil, location_id: nil, owner_type: nil, owner_id: nil, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: nil, updated_at: nil>).charge_battery(20.0)[0m
       [31m      expected: 1 time with arguments: (20.0)[0m
       [31m      received: 0 times[0m
       [36m# ./spec/models/units/battery_spec.rb:107:in 'block (3 levels) in <main>'[0m

  285) AIManager::DecisionTree#handle_mars_oxygen_maintenance calls prioritize_energy_for_o2_generation on resource_planner
       [31mFailure/Error: production_units = unit_lookup.find_units_by_trait('production_output', gas_type)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'find_units_by_trait' for an instance of Lookup::UnitLookupService[0m
       [36m# ./app/services/ai_manager/decision_tree.rb:212:in 'AIManager::DecisionTree#handle_atmospheric_maintenance'[0m
       [36m# ./app/services/ai_manager/decision_tree.rb:229:in 'AIManager::DecisionTree#handle_mars_oxygen_maintenance'[0m
       [36m# ./spec/services/ai_manager/decision_tree_spec.rb:84:in 'block (3 levels) in <main>'[0m

  286) AIManager::DecisionTree#handle_mars_nitrogen_import finds closest resource source and creates interplanetary contract
       [31mFailure/Error: production_units = unit_lookup.find_units_by_trait('production_output', gas_type)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'find_units_by_trait' for an instance of Lookup::UnitLookupService[0m
       [36m# ./app/services/ai_manager/decision_tree.rb:212:in 'AIManager::DecisionTree#handle_atmospheric_maintenance'[0m
       [36m# ./app/services/ai_manager/decision_tree.rb:233:in 'AIManager::DecisionTree#handle_mars_nitrogen_import'[0m
       [36m# ./spec/services/ai_manager/decision_tree_spec.rb:101:in 'block (3 levels) in <main>'[0m

  287) AIManager::ManifestParser#extract_equipment_from_manifest extracts complete equipment data from manifest
       [31mFailure/Error: expect(result).to have_key(:craft_fit)[0m
       [31m  expected `{}.has_key?(:craft_fit)` to be truthy, got false[0m
       [36m# ./spec/services/ai_manager/manifest_parser_spec.rb:13:in 'block (3 levels) in <main>'[0m

  288) AIManager::MissionPlannerService MaterialLookupService integration uses MaterialLookupService to get chemical formulas
       [31mFailure/Error: allow(AIManager::PatternTargetMapper).to receive(:target_location).and_return(mars)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  undefined local variable or method 'mars' for #<RSpec::ExampleGroups::AIManagerMissionPlannerService::MaterialLookupServiceIntegration:0x00007f0106070810>[0m
       [36m# ./spec/services/ai_manager/mission_planner_service_spec.rb:183:in 'block (3 levels) in <main>'[0m

  289) AIManager::MissionPlannerService MaterialLookupService integration handles materials not in lookup gracefully
       [31mFailure/Error: allow(AIManager::PatternTargetMapper).to receive(:target_location).and_return(mars)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  undefined local variable or method 'mars' for #<RSpec::ExampleGroups::AIManagerMissionPlannerService::MaterialLookupServiceIntegration:0x00007f01066ba478>[0m
       [36m# ./spec/services/ai_manager/mission_planner_service_spec.rb:183:in 'block (3 levels) in <main>'[0m

  290) AIManager::OperationalManager#make_decision when stable and expansion is feasible considers expansion
       [31mFailure/Error:[0m
       [31m  allow(operational_manager).to receive(:consider_expansion).and_return({[0m
       [31m    action: :expansion, pattern: :venus_pattern, reason: :pattern_match[0m
       [31m  })[0m
       [31m[0m
       [31m  #<AIManager::OperationalManager:0x00007f010af19c50 @settlement=#<Double "Settlement">, @patterns={}, @priorities=#<AIManager::AiPrioritySystem:0x00007f0106229350 @last_check=Mon, 19 Jan 2026 04:31:45.856073370 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f0106228e78 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f010af191b0 @settlement_id=1, @decision_history=[{timestamp: "2026-01-18 23:01:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:01:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:01:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:01:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:52:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:52:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:52:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:52:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 00:05:13 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 00:05:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 00:05:13 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 00:05:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:37:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:37:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:37:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:37:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:45:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:45:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:45:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:45:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:51:44 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:51:44 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:51:44 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:51:44 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:59:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:59:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:59:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:59:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:16:30 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:16:30 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:16:30 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:16:30 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:25:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:25:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:25:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:25:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:33:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:33:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:33:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:33:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:42:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:42:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:42:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:42:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:52:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:52:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:52:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:52:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:01:05 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:01:05 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:01:05 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:01:05 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:10:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:10:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:10:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:10:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:19:51 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:19:51 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:19:51 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:19:51 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:31:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:31:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:31:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:31:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion[0m
       [36m# ./spec/services/ai_manager/operational_manager_spec.rb:54:in 'block (4 levels) in <main>'[0m

  291) AIManager::OperationalManager#make_decision when stable with no expansion opportunities maintains current operations
       [31mFailure/Error:[0m
       [31m  allow(operational_manager).to receive(:consider_expansion).and_return({[0m
       [31m    action: :maintain, reason: :no_suitable_expansion[0m
       [31m  })[0m
       [31m[0m
       [31m  #<AIManager::OperationalManager:0x00007f010afd0d38 @settlement=#<Double "Settlement">, @patterns={}, @priorities=#<AIManager::AiPrioritySystem:0x00007f01062603a0 @last_check=Mon, 19 Jan 2026 04:31:45.868210071 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f01062afea0 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f010afd09c8 @settlement_id=1, @decision_history=[{timestamp: "2026-01-18 23:01:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:01:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:01:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:01:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:52:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:52:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:52:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:52:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 00:05:13 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 00:05:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 00:05:13 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 00:05:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:37:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:37:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:37:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:37:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:45:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:45:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:45:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:45:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:51:44 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:51:44 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:51:44 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:51:44 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:59:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:59:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:59:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:59:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:16:30 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:16:30 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:16:30 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:16:30 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:25:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:25:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:25:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:25:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:33:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:33:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:33:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:33:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:42:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:42:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:42:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:42:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:52:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:52:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:52:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:52:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:01:05 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:01:05 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:01:05 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:01:05 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:10:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:10:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:10:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:10:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:19:51 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:19:51 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:19:51 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:19:51 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:31:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:31:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:31:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:31:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion[0m
       [36m# ./spec/services/ai_manager/operational_manager_spec.rb:71:in 'block (4 levels) in <main>'[0m

  292) AIManager::OperationalManager decision logging logs decisions with timestamps and categories
       [31mFailure/Error: allow(operational_manager).to receive(:consider_expansion).and_return({ action: :maintain, reason: :stable })[0m
       [31m  #<AIManager::OperationalManager:0x00007f0116041780 @settlement=#<Double "Settlement">, @patterns={}, @priorities=#<AIManager::AiPrioritySystem:0x00007f010679fb68 @last_check=Mon, 19 Jan 2026 04:31:45.974632121 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f010679f0f0 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f0116041500 @settlement_id=1, @decision_history=[{timestamp: "2026-01-18 23:01:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:01:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:01:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:01:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:52:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:52:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-18 23:52:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-18 23:52:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 00:05:13 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 00:05:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 00:05:13 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 00:05:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:37:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:37:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:37:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:37:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:45:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:45:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:45:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:45:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:51:44 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:51:44 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:51:44 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:51:44 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:59:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:59:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 02:59:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 02:59:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:16:30 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:16:30 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:16:30 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:16:30 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:25:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:25:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:25:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:25:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:33:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:33:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:33:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:33:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:42:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:42:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:42:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:42:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:52:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:52:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 03:52:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 03:52:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:01:05 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:01:05 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:01:05 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:01:05 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:10:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:10:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:10:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:10:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:19:51 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:19:51 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:19:51 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:19:51 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:31:45 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:31:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-19 04:31:45 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-19 04:31:45 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion[0m
       [36m# ./spec/services/ai_manager/operational_manager_spec.rb:185:in 'block (3 levels) in <main>'[0m

  293) AIManager::PriorityHeuristic#get_priorities on Mars when oxygen is critical on Mars returns local_oxygen_generation priority instead of refill_oxygen
       [31mFailure/Error: co2_gas.update!(percentage: 95.97)[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Molar mass is not a number, Molar mass can't be blank[0m
       [36m# ./spec/services/ai_manager/priority_heuristic_spec.rb:131:in 'block (4 levels) in <main>'[0m

  294) AIManager::PriorityHeuristic#get_priorities on Mars when nitrogen is critical on Mars returns local_argon_extraction priority
       [31mFailure/Error: ar_gas.update!(percentage: 1.93)[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Molar mass is not a number, Molar mass can't be blank[0m
       [36m# ./spec/services/ai_manager/priority_heuristic_spec.rb:157:in 'block (4 levels) in <main>'[0m

  295) AIManager::PriorityHeuristic Environmental System Integration with procedurally generated planet having 95% CO2 and 0.0 Tesla magnetic field correctly chooses local O2 production
       [31mFailure/Error: co2_gas.update!(percentage: 95.0)[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Molar mass is not a number, Molar mass can't be blank[0m
       [36m# ./spec/services/ai_manager/priority_heuristic_spec.rb:192:in 'block (4 levels) in <main>'[0m

  296) AIManager::PriorityHeuristic Environmental System Integration with planet having low CO2 and weak magnetic field chooses oxygen refill instead of local generation
       [31mFailure/Error: co2_gas.update!(percentage: 0.5)[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Molar mass is not a number, Molar mass can't be blank[0m
       [36m# ./spec/services/ai_manager/priority_heuristic_spec.rb:216:in 'block (4 levels) in <main>'[0m

  297) AIManager::SystemArchitect Sabatier Refinements #get_maintenance_tax_em applies 25% discount when sabatier units are active
       [31mFailure/Error: expect(architect.send(:get_maintenance_tax_em, 'SOL-AC-01')).to eq(564.38)[0m
       [31m[0m
       [31m  expected: 564.38[0m
       [31m       got: 750.0[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/ai_manager/sabatier_refinements_spec.rb:15:in 'block (4 levels) in <main>'[0m

  298) AIManager::SystemArchitect Sabatier Refinements #get_maintenance_tax_em does not apply discount when sabatier units are not active
       [31mFailure/Error: expect(architect.send(:get_maintenance_tax_em, 'SOL-SYSA-01')).to eq(25.0)[0m
       [31m[0m
       [31m  expected: 25.0[0m
       [31m       got: 1000[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/ai_manager/sabatier_refinements_spec.rb:23:in 'block (4 levels) in <main>'[0m

  299) AIManager::SystemArchitect#deploy_subsurface_foothold creates subsurface location
       [31mFailure/Error: expect { architect.send(:deploy_subsurface_foothold) }.to change(CelestialLocation, :count).by(1)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant CelestialLocation[0m
       [36m# ./spec/services/ai_manager/system_architect_spec.rb:100:in 'block (3 levels) in <main>'[0m

  300) AIManager::SystemArchitect#deploy_subsurface_foothold creates settlement
       [31mFailure/Error:[0m
       [31m  Structures::BaseStructure.create!([0m
       [31m    name: "Primary Habitat Module - #{settlement.name} - #{Time.now.to_i}-#{rand(1000)}",[0m
       [31m    structure_name: 'habitat',[0m
       [31m    settlement: settlement,[0m
       [31m    owner: settlement.owner,[0m
       [31m    operational_data: { [0m
       [31m      pressurized: true, [0m
       [31m      radiation_shielded: true, [0m
       [31m      structure_type: 'habitat',[0m
       [31m      status: 'operational'[0m
       [31m[0m
       [31mActiveRecord::RecordInvalid:[0m
       [31m  Validation failed: Structure type can't be blank[0m
       [36m# ./app/services/ai_manager/system_architect.rb:471:in 'AIManager::SystemArchitect#create_habitat_structures'[0m
       [36m# ./app/services/ai_manager/system_architect.rb:385:in 'AIManager::SystemArchitect#deploy_initial_habitats'[0m
       [36m# ./app/services/ai_manager/system_architect.rb:152:in 'AIManager::SystemArchitect#deploy_subsurface_foothold'[0m
       [36m# ./spec/services/ai_manager/system_architect_spec.rb:104:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/services/ai_manager/system_architect_spec.rb:104:in 'block (3 levels) in <main>'[0m

  301) AIManager::SystemIntelligenceService#system_status with operational structures returns correct operational ratio and status
       [31mFailure/Error: create(:unit, :power, attachable: structure)[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "unit"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/factories/structures/base_structure.rb:66:in 'block (3 levels) in <main>'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'FactoryBot::Callback#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:11:in 'block in FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:20:in 'FactoryBot::Evaluation#notify'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:13:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/ai_manager/system_intelligence_service_spec.rb:12:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "unit"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  302) AIManager::SystemIntelligenceService#system_status with all operational structures returns healthy status
       [31mFailure/Error: create(:unit, :power, attachable: structure)[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "unit"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/factories/structures/base_structure.rb:66:in 'block (3 levels) in <main>'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'BasicObject#instance_exec'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callback.rb:12:in 'FactoryBot::Callback#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:11:in 'block in FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'Array#each'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/callbacks_observer.rb:10:in 'FactoryBot::CallbacksObserver#update'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:20:in 'FactoryBot::Evaluation#notify'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:13:in 'block in FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/ai_manager/system_intelligence_service_spec.rb:35:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "unit"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  303) AIManager::TerraformingManager#calculate_gas_needs with magnetosphere protection returns gas needs for warming phase
       [31mFailure/Error: resources << 'H2' if world.atmosphere&.h2_percentage.to_f > 0.1[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'h2_percentage' for an instance of CelestialBodies::Spheres::Atmosphere[0m
       [36m# ./app/services/ai_manager/terraforming_manager.rb:320:in 'AIManager::TerraformingManager#identify_available_resources'[0m
       [36m# ./app/services/ai_manager/terraforming_manager.rb:60:in 'AIManager::TerraformingManager#calculate_gas_needs'[0m
       [36m# ./spec/services/ai_manager/terraforming_manager_spec.rb:21:in 'block (4 levels) in <main>'[0m

  304) AIManager::TerraformingManager#determine_terraforming_phase maintenance phase returns maintenance when conditions are met
       [31mFailure/Error: expect(result).to eq(:maintenance)[0m
       [31m[0m
       [31m  expected: :maintenance[0m
       [31m       got: :warming[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [31m[0m
       [31m  Diff:[0m[0m
       [31m  [0m[34m@@ -1 +1 @@[0m
       [31m  [0m[31m-:maintenance[0m
       [31m  [0m[32m+:warming[0m
       [31m  [0m[0m
       [36m# ./spec/services/ai_manager/terraforming_manager_spec.rb:108:in 'block (4 levels) in <main>'[0m

  305) AIManager::TerraformingManager#should_seed_biosphere? without biosphere and suitable conditions returns true
       [31mFailure/Error: expect(result).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/ai_manager/terraforming_manager_spec.rb:133:in 'block (4 levels) in <main>'[0m

  306) CraterDomeConstructionService#construct when entity is different from service provider processes a payment
       [31mFailure/Error: create(:account, accountable: service_provider, balance: 100_000)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Account[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/crater_dome_construction_service_spec.rb:113:in 'block (4 levels) in <main>'[0m

  307) FittingService fits all components from inventory
       [31mFailure/Error: expect(result.success?).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/fitting_service_spec.rb:33:in 'block (2 levels) in <main>'[0m

  308) FittingService fits components without inventory if inventory is nil
       [31mFailure/Error: expect(result.success?).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/fitting_service_spec.rb:49:in 'block (2 levels) in <main>'[0m

  309) Game#advance_by_days advances the simulation by the given number of days
       [31mFailure/Error: settlement.manage_shared_services!(time_skipped)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  private method 'manage_shared_services!' called for an instance of Settlement::BaseSettlement[0m
       [36m# ./app/services/game.rb:53:in 'block in Game#process_settlements'[0m
       [36m# ./app/services/game.rb:36:in 'Game#process_settlements'[0m
       [36m# ./app/services/game.rb:16:in 'Game#advance_by_days'[0m
       [36m# ./spec/services/game_spec.rb:68:in 'block (3 levels) in <main>'[0m

  310) Generators::LavaTubeGenerator#generate with random generation creates a lava tube with random features
       [31mFailure/Error: expect(lava_tube.static_data).to be_present[0m
       [31m  expected `nil.present?` to be truthy, got false[0m
       [36m# ./spec/services/generators/lava_tube_generator_spec.rb:18:in 'block (4 levels) in <main>'[0m

  311) Generators::LavaTubeGenerator#generate with random generation generates random dimensions
       [31mFailure/Error: expect(lava_tube.length_m).to be_between(1000, 5000)[0m
       [31m  expected nil to be between 1000 and 5000 (inclusive), but it does not respond to `<=` and `>=`[0m
       [36m# ./spec/services/generators/lava_tube_generator_spec.rb:25:in 'block (4 levels) in <main>'[0m

  312) Generators::LavaTubeGenerator#generate with random generation generates random attributes
       [31mFailure/Error: expect(lava_tube.natural_shielding).to be_between(0.1, 0.9)[0m
       [31m  expected nil to be between 0.1 and 0.9 (inclusive), but it does not respond to `<=` and `>=`[0m
       [36m# ./spec/services/generators/lava_tube_generator_spec.rb:34:in 'block (4 levels) in <main>'[0m

  313) Generators::LavaTubeGenerator#generate with predefined parameters creates a lava tube with specified parameters
       [31mFailure/Error: expect(lava_tube.length_m).to eq(2500)[0m
       [31m[0m
       [31m  expected: 2500[0m
       [31m       got: nil[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/generators/lava_tube_generator_spec.rb:95:in 'block (4 levels) in <main>'[0m

  314) Generators::LavaTubeGenerator#generate with predefined parameters creates predefined skylights and access points
       [31mFailure/Error: expect(first_skylight.static_data['dimensions']['diameter_m']).to eq(12)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method '[]' for nil[0m
       [36m# ./spec/services/generators/lava_tube_generator_spec.rb:116:in 'block (4 levels) in <main>'[0m

  315) Generators::LavaTubeGenerator#generate with minimal parameters creates a lava tube with defaults
       [31mFailure/Error: expect(lava_tube.static_data).to be_present[0m
       [31m  expected `nil.present?` to be truthy, got false[0m
       [36m# ./spec/services/generators/lava_tube_generator_spec.rb:135:in 'block (4 levels) in <main>'[0m

  316) Generators::ValleyGenerator#generate with random generation creates a valley with random features
       [31mFailure/Error: expect(valley.static_data).to be_present[0m
       [31m  expected `nil.present?` to be truthy, got false[0m
       [36m# ./spec/services/generators/valley_generator_spec.rb:17:in 'block (4 levels) in <main>'[0m

  317) Generators::ValleyGenerator#generate with random generation generates random dimensions
       [31mFailure/Error: expect(valley.length_m).to be_between(5000, 50000)[0m
       [31m  expected nil to be between 5000 and 50000 (inclusive), but it does not respond to `<=` and `>=`[0m
       [36m# ./spec/services/generators/valley_generator_spec.rb:24:in 'block (4 levels) in <main>'[0m

  318) Generators::ValleyGenerator#generate with random generation generates segments
       [31mFailure/Error: segments = valley.segments[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'segments' for an instance of CelestialBodies::Features::Valley[0m
       [36m# ./spec/services/generators/valley_generator_spec.rb:33:in 'block (4 levels) in <main>'[0m

  319) Generators::ValleyGenerator#generate with predefined parameters creates a valley with specified parameters
       [31mFailure/Error: expect(valley.length_m).to eq(15000)[0m
       [31m[0m
       [31m  expected: 15000[0m
       [31m       got: nil[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/generators/valley_generator_spec.rb:88:in 'block (4 levels) in <main>'[0m

  320) Generators::ValleyGenerator#generate with predefined parameters creates predefined access points
       [31mFailure/Error: expect(access_point.static_data['dimensions']['width_m']).to eq(50)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method '[]' for nil[0m
       [36m# ./spec/services/generators/valley_generator_spec.rb:102:in 'block (4 levels) in <main>'[0m

  321) Logistics::ContractService.create_internal_transfer with valid settlements creates a logistics contract for internal transfer
       [31mFailure/Error: expect(contract).to be_persisted[0m
       [31m  expected nil to respond to `persisted?`[0m
       [36m# ./spec/services/logistics/contract_service_spec.rb:23:in 'block (4 levels) in <main>'[0m

  322) Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects intercepts materials for orbital construction
       [31mFailure/Error: to_inventory.inventoryable.orbital? &&[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'orbital?' for an instance of Settlement::BaseSettlement[0m
       [36m# ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'[0m
       [36m# ./spec/services/logistics/inventory_manager_spec.rb:28:in 'block (4 levels) in <main>'[0m

  323) Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects does not add materials to station inventory if all consumed by projects
       [31mFailure/Error: to_inventory.inventoryable.orbital? &&[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'orbital?' for an instance of Settlement::BaseSettlement[0m
       [36m# ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'[0m
       [36m# ./spec/services/logistics/inventory_manager_spec.rb:45:in 'block (4 levels) in <main>'[0m

  324) Logistics::InventoryManager.transfer_item when transferring orbital construction materials to non-orbital settlement transfers materials normally without interception
       [31mFailure/Error: to_inventory.inventoryable.orbital? &&[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'orbital?' for an instance of Settlement::BaseSettlement[0m
       [36m# ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'[0m
       [36m# ./spec/services/logistics/inventory_manager_spec.rb:65:in 'block (4 levels) in <main>'[0m

  325) Logistics::InventoryManager.transfer_item when transferring non-orbital materials to orbital station transfers materials normally without interception
       [31mFailure/Error: to_inventory.inventoryable.orbital? &&[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'orbital?' for an instance of Settlement::BaseSettlement[0m
       [36m# ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'[0m
       [36m# ./spec/services/logistics/inventory_manager_spec.rb:84:in 'block (4 levels) in <main>'[0m

  326) Lookup::CraftLookupService#find_craft loads crafts from the correct file structure
       [31mFailure/Error: expect(File.directory?(crafts_path)).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/lookup/craft_lookup_service_spec.rb:9:in 'block (3 levels) in <main>'[0m

  327) Lookup::CraftLookupService#debug_paths outputs correct path information
       [31mFailure/Error: expect(output).to include("(exists: true)")[0m
       [31m[0m
       [31m  expected "DEBUG: Craft Lookup Paths\nBase crafts path: /home/galaxy_game/app/data/operational_data/crafts (exi... (exists: false)\nspace: /home/galaxy_game/app/data/operational_data/crafts/space (exists: false)\n" to include "(exists: true)"[0m
       [31m  Diff:[0m[0m
       [31m  [0m[34m@@ -1,5 +1,9 @@[0m
       [31m  [0m[31m-(exists: true)[0m
       [31m  [0m[32m+DEBUG: Craft Lookup Paths[0m
       [31m  [0m[32m+Base crafts path: /home/galaxy_game/app/data/operational_data/crafts (exists: false)[0m
       [31m  [0m[32m+atmospheric: /home/galaxy_game/app/data/operational_data/crafts/atmospheric (exists: false)[0m
       [31m  [0m[32m+ground: /home/galaxy_game/app/data/operational_data/crafts/ground (exists: false)[0m
       [31m  [0m[32m+space: /home/galaxy_game/app/data/operational_data/crafts/space (exists: false)[0m
       [31m  [0m[0m
       [36m# ./spec/services/lookup/craft_lookup_service_spec.rb:208:in 'block (3 levels) in <main>'[0m

  328) Lookup::ItemLookupService#find_item loads items from the correct file structure
       [31mFailure/Error: items_path = described_class.base_items_path.to_s[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'base_items_path' for class Lookup::ItemLookupService[0m
       [36m# ./spec/services/lookup/item_lookup_service_spec.rb:9:in 'block (3 levels) in <main>'[0m

  329) Lookup::ItemLookupService#find_item handles scrap items dynamically
       [31mFailure/Error: expect(result).to be_a(Hash)[0m
       [31m  expected nil to be a kind of Hash[0m
       [36m# ./spec/services/lookup/item_lookup_service_spec.rb:63:in 'block (3 levels) in <main>'[0m

  330) Lookup::ItemLookupService dynamic item creation creates scrap items on the fly
       [31mFailure/Error: expect(result).to be_a(Hash)[0m
       [31m  expected nil to be a kind of Hash[0m
       [36m# ./spec/services/lookup/item_lookup_service_spec.rb:126:in 'block (3 levels) in <main>'[0m

  331) Lookup::ItemLookupService dynamic item creation creates processed items on the fly
       [31mFailure/Error: expect(result).to be_a(Hash)[0m
       [31m  expected nil to be a kind of Hash[0m
       [36m# ./spec/services/lookup/item_lookup_service_spec.rb:134:in 'block (3 levels) in <main>'[0m

  332) Lookup::ItemLookupService dynamic item creation creates used items on the fly
       [31mFailure/Error: expect(result).to be_a(Hash)[0m
       [31m  expected nil to be a kind of Hash[0m
       [36m# ./spec/services/lookup/item_lookup_service_spec.rb:142:in 'block (3 levels) in <main>'[0m

  333) Lookup::MaterialLookupService#find_material loads materials from the correct file structure
       [31mFailure/Error: expect(File.directory?(gases_path)).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/lookup/material_lookup_service_spec.rb:40:in 'block (3 levels) in <main>'[0m

  334) Lookup::MaterialLookupService#find_material finds atmospheric gases by chemical formula
       [31mFailure/Error: expect(oxygen).not_to be_nil[0m
       [31m[0m
       [31m  expected: not nil[0m
       [31m       got: nil[0m
       [36m# ./spec/services/lookup/material_lookup_service_spec.rb:45:in 'block (3 levels) in <main>'[0m

  335) Lookup::MaterialLookupService#find_material finds materials case-insensitively
       [31mFailure/Error: expect(@service.get_material_property(o2_material, 'chemical_formula')).to eq("O2")[0m
       [31m[0m
       [31m  expected: "O2"[0m
       [31m       got: nil[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/lookup/material_lookup_service_spec.rb:53:in 'block (3 levels) in <main>'[0m

  336) Lookup::MaterialLookupService.locate_gases_path uses GalaxyGame::Paths consistently
       [31mFailure/Error: expect(path).to eq(expected_path)[0m
       [31m[0m
       [31m  expected: "/home/galaxy_game/app/data/resources/materials/gases"[0m
       [31m       got: "/home/galaxy_game/home/galaxy_game/app/data/resources/materials/gases"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/lookup/material_lookup_service_spec.rb:210:in 'block (3 levels) in <main>'[0m

  337) Lookup::MaterialLookupService error handling with corrupted JSON files handles JSON parsing errors gracefully
       [31mFailure/Error: Rails.logger.error "Error parsing #{file}: #{e.message}"[0m
       [31m[0m
       [31m  #<ActiveSupport::Logger:0x00007f011cf6b638 @level=0, @progname=nil, @default_formatter=#<Logger::Formatter:0x00007f011f2b5e90 @datetime_format=nil>, @formatter=#<ActiveSupport::Logger::SimpleFormatter:0x00007f011f2b3b40 @datetime_format=nil>, @logdev=#<Logger::LogDevice:0x00007f011d184618 @shift_period_suffix=nil, @shift_size=nil, @shift_age=nil, @filename=nil, @dev=#<IO:<STDOUT>>, @binmode=false, @reraise_write_errors=[], @mon_data=#<Monitor:0x00007f011f2b4fe0>, @mon_data_owner_object_id=3056>, @level_override={}> received :error with unexpected arguments[0m
       [31m    expected: (/Invalid JSON in file:/)[0m
       [31m         got: ("Error parsing /tmp/d20260119-1203-83kjtv/corrupted.json: expected object key, got 'invalid json }")[0m
       [31m  Diff:[0m[0m
       [31m  [0m[34m@@ -1 +1 @@[0m
       [31m  [0m[31m-[/Invalid JSON in file:/][0m
       [31m  [0m[32m+["Error parsing /tmp/d20260119-1203-83kjtv/corrupted.json: expected object key, got 'invalid json }"][0m
       [31m  [0m[0m
       [36m# ./app/services/lookup/material_lookup_service.rb:201:in 'block in Lookup::MaterialLookupService#load_json_files'[0m
       [36m# ./app/services/lookup/material_lookup_service.rb:195:in 'Array#map'[0m
       [36m# ./app/services/lookup/material_lookup_service.rb:195:in 'Lookup::MaterialLookupService#load_json_files'[0m
       [36m# ./spec/services/lookup/material_lookup_service_spec.rb:256:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# JSON::ParserError:[0m
       [36m#   expected object key, got 'invalid json }[0m
       [36m#   /usr/local/bundle/gems/json-2.10.2/lib/json/common.rb:248:in 'JSON::Ext::Parser.parse'[0m

  338) Lookup::MaterialLookupService integration with AtmosphereConcern provides materials needed for atmospheric calculations
       [31mFailure/Error: expect(found_gases.size).to be > 0[0m
       [31m[0m
       [31m  expected: > 0[0m
       [31m       got:   0[0m
       [36m# ./spec/services/lookup/material_lookup_service_spec.rb:333:in 'block (3 levels) in <main>'[0m

  339) Lookup::ModuleLookupService#find_module loads modules from the correct file structure
       [31mFailure/Error: expect(File.directory?(modules_path)).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/lookup/module_lookup_service_spec.rb:10:in 'block (3 levels) in <main>'[0m

  340) Lookup::ModuleLookupService#find_module finds modules by module_type FIXED
       [34mExpected pending 'co2_scrubber module not found - check if file exists in life_support directory' to fail. No error was raised.[0m
       [36m# ./spec/services/lookup/module_lookup_service_spec.rb:16[0m

  341) Lookup::ModuleLookupService service configuration has the correct base path
       [31mFailure/Error: expect(actual_path).to eq(expected_path)[0m
       [31m[0m
       [31m  expected: "/home/galaxy_game/data/json-data/operational_data/modules"[0m
       [31m       got: "/home/galaxy_game/app/data/operational_data/modules"[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/lookup/module_lookup_service_spec.rb:52:in 'block (3 levels) in <main>'[0m

  342) Lookup::UnitLookupService#find_unit loads units from the correct file structure
       [31mFailure/Error: expect(File.directory?(units_base_path)).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/lookup/unit_lookup_service_spec.rb:40:in 'block (3 levels) in <main>'[0m

  343) ManufacturingService.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
       [31mFailure/Error: expect(result[:success]).to be true[0m
       [31m[0m
       [31m  expected true[0m
       [31m       got false[0m
       [36m# ./spec/services/manfacturing_service_spec.rb:74:in 'block (4 levels) in <main>'[0m

  344) ManufacturingService.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
       [31mFailure/Error: expect(blueprint).to be_present, "Raptor Engine blueprint should exist"[0m
       [31m  Raptor Engine blueprint should exist[0m
       [36m# ./spec/services/manfacturing_service_spec.rb:117:in 'block (4 levels) in <main>'[0m

  345) ManufacturingService.manufacture with different construction cost percentages uses settlement's custom construction percentage
       [31mFailure/Error: purchase_cost = blueprint.dig('cost_data', 'purchase_cost', 'amount')[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'dig' for nil[0m
       [36m# ./spec/services/manfacturing_service_spec.rb:143:in 'block (4 levels) in <main>'[0m

  346) ManufacturingService.manufacture with real blueprint data automatically fulfills material requirements when materials are available
       [31mFailure/Error:[0m
       [31m  required_materials = blueprint['production_data']&.dig('required_materials') || [0m
       [31m                      blueprint['required_materials'] || [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method '[]' for nil[0m
       [36m# ./spec/services/manfacturing_service_spec.rb:211:in 'block (4 levels) in <main>'[0m

  347) ManufacturingService.manufacture with real blueprint data stores actual blueprint data in specifications
       [31mFailure/Error: expect(job.specifications['name']).to eq(blueprint['name'])[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'specifications' for nil[0m
       [36m# ./spec/services/manfacturing_service_spec.rb:276:in 'block (4 levels) in <main>'[0m

  348) Manufacturing::AssemblyService.start_assembly with all materials available charges the tenant fee
       [31mFailure/Error: expect(player.account.reload.balance).to eq(initial_player_balance)[0m
       [31m[0m
       [31m  expected: 0.1e4[0m
       [31m       got: 0.964e3[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/manufacturing/assembly_service_spec.rb:70:in 'block (4 levels) in <main>'[0m

  349) Component Production Integration with real blueprint files finds the 3d_printed_ibeam_mk1 blueprint
       [31mFailure/Error: expect(blueprint).to be_present[0m
       [31m  expected `nil.present?` to be truthy, got false[0m
       [36m# ./spec/services/manufacturing/component_production_integration_spec.rb:27:in 'block (3 levels) in <main>'[0m

  350) Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) creates a production job using real blueprint
       [31mFailure/Error: raise "Blueprint not found: #{blueprint_id}" unless blueprint[0m
       [31m[0m
       [31mRuntimeError:[0m
       [31m  Blueprint not found: 3d_printed_ibeam_mk1[0m
       [36m# ./app/services/manufacturing/component_production_service.rb:53:in 'Manufacturing::ComponentProductionService#load_blueprint'[0m
       [36m# ./app/services/manufacturing/component_production_service.rb:13:in 'Manufacturing::ComponentProductionService#produce_component'[0m
       [36m# ./spec/services/manufacturing/component_production_integration_spec.rb:84:in 'block (5 levels) in <main>'[0m
       [36m# ./spec/services/manufacturing/component_production_integration_spec.rb:83:in 'block (4 levels) in <main>'[0m

  351) Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) consumes depleted_regolith from inventory
       [31mFailure/Error: raise "Blueprint not found: #{blueprint_id}" unless blueprint[0m
       [31m[0m
       [31mRuntimeError:[0m
       [31m  Blueprint not found: 3d_printed_ibeam_mk1[0m
       [36m# ./app/services/manufacturing/component_production_service.rb:53:in 'Manufacturing::ComponentProductionService#load_blueprint'[0m
       [36m# ./app/services/manufacturing/component_production_service.rb:13:in 'Manufacturing::ComponentProductionService#produce_component'[0m
       [36m# ./spec/services/manufacturing/component_production_integration_spec.rb:94:in 'block (4 levels) in <main>'[0m

  352) Manufacturing::CostCalculator Earth-Imported COGS (EAP-COGS) calculates the EAP-COGS (Earth Import Cost) for the unit
       [31mFailure/Error: base_efficiency = @blueprint.dig('production_data', 'base_material_efficiency') || @blueprint['waste_factor'] ? (1.0 - @blueprint['waste_factor']) : 1.0[0m
       [31m[0m
       [31mTypeError:[0m
       [31m  nil can't be coerced into Float[0m
       [36m# ./app/services/manufacturing/cost_calculator.rb:83:in 'Float#-'[0m
       [36m# ./app/services/manufacturing/cost_calculator.rb:83:in 'Manufacturing::CostCalculator#print_breakdown'[0m
       [36m# ./spec/services/manufacturing/cost_calculator_spec.rb:68:in 'block (3 levels) in <main>'[0m

  353) Manufacturing::CostCalculator Local Production COGS (LAP-COGS) calculates the LAP-COGS (Local Production Cost) for the unit
       [31mFailure/Error: base_efficiency = @blueprint.dig('production_data', 'base_material_efficiency') || @blueprint['waste_factor'] ? (1.0 - @blueprint['waste_factor']) : 1.0[0m
       [31m[0m
       [31mTypeError:[0m
       [31m  nil can't be coerced into Float[0m
       [36m# ./app/services/manufacturing/cost_calculator.rb:83:in 'Float#-'[0m
       [36m# ./app/services/manufacturing/cost_calculator.rb:83:in 'Manufacturing::CostCalculator#print_breakdown'[0m
       [36m# ./spec/services/manufacturing/cost_calculator_spec.rb:89:in 'block (3 levels) in <main>'[0m

  354) Manufacturing::MaterialRequest.create_material_requests creates requests for all required materials
       [31mFailure/Error: expect(construction_job.material_requests.count).to eq(4)[0m
       [31m[0m
       [31m  expected: 4[0m
       [31m       got: 0[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/manufacturing/material_request_system_spec.rb:10:in 'block (3 levels) in <main>'[0m

  355) Manufacturing::Processing#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
       [31mFailure/Error: celestial_location = CelestialLocation.find_by(name: @owner.active_location)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant Manufacturing::Processing::CelestialLocation[0m
       [36m# ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'[0m
       [36m# ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'[0m
       [36m# ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'[0m
       [36m# ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/manufacturing/processing_spec.rb:102:in 'block (4 levels) in <main>'[0m

  356) Manufacturing::Processing#process when owner does not have enough resources returns an error when resources are insufficient
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    service.process[0m
       [31m  }.to raise_error(RuntimeError, /Insufficient resources: Steel/)[0m
       [31m[0m
       [31m  expected RuntimeError with message matching /Insufficient resources: Steel/, got #<NameError: uninitialized constant Manufacturing::Processing::CelestialLocation> with backtrace:[0m
       [31m    # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'[0m
       [31m    # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:116:in 'block (5 levels) in <main>'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:115:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/services/manufacturing/processing_spec.rb:115:in 'block (4 levels) in <main>'[0m

  357) Manufacturing::Processing#process when owner does not have enough GCC raises an error when GCC is insufficient
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    service.process[0m
       [31m  }.to raise_error(RuntimeError, "Insufficient GCC")[0m
       [31m[0m
       [31m  expected RuntimeError with "Insufficient GCC", got #<NameError: uninitialized constant Manufacturing::Processing::CelestialLocation> with backtrace:[0m
       [31m    # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'[0m
       [31m    # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:128:in 'block (5 levels) in <main>'[0m
       [31m    # ./spec/services/manufacturing/processing_spec.rb:127:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/services/manufacturing/processing_spec.rb:127:in 'block (4 levels) in <main>'[0m

  358) Manufacturing::Service.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
       [31mFailure/Error: expect(blueprint).to be_present, "Liquid Rocket Engine blueprint should exist"[0m
       [31m  Liquid Rocket Engine blueprint should exist[0m
       [36m# ./spec/services/manufacturing/service_spec.rb:115:in 'block (4 levels) in <main>'[0m

  359) Manufacturing::Service.manufacture with different construction cost percentages uses settlement's custom construction percentage
       [31mFailure/Error: purchase_cost = blueprint.dig('cost_data', 'purchase_cost', 'amount')[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'dig' for nil[0m
       [36m# ./spec/services/manufacturing/service_spec.rb:141:in 'block (4 levels) in <main>'[0m

  360) Manufacturing::Service.manufacture with real blueprint data automatically fulfills material requirements when materials are available
       [31mFailure/Error:[0m
       [31m  required_materials = blueprint['production_data']&.dig('required_materials') || [0m
       [31m                      blueprint['required_materials'] || [0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method '[]' for nil[0m
       [36m# ./spec/services/manufacturing/service_spec.rb:209:in 'block (4 levels) in <main>'[0m

  361) Manufacturing::Service.manufacture with real blueprint data stores actual blueprint data in specifications
       [31mFailure/Error: expect(job.specifications['name']).to eq(blueprint['name'])[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'specifications' for nil[0m
       [36m# ./spec/services/manufacturing/service_spec.rb:278:in 'block (4 levels) in <main>'[0m

  362) Market::TradeExecutionService returns true on successful execution
       [31mFailure/Error:[0m
       [31m  Market::Order.new([0m
       [31m    id: 1,[0m
       [31m    market_condition: market_condition,[0m
       [31m    orderable: seller_organization,[0m
       [31m    base_settlement_id: settlement.id,[0m
       [31m    resource: 'LOX',[0m
       [31m    quantity: 100,[0m
       [31m    order_type: 'Sell'[0m
       [31m  )[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  'Sell' is not a valid order_type[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:45:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:84:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:88:in 'block (2 levels) in <main>'[0m

  363) Market::TradeExecutionService calls the TaxCollectionService with gross revenue and seller
       [31mFailure/Error:[0m
       [31m  Market::Order.new([0m
       [31m    id: 1,[0m
       [31m    market_condition: market_condition,[0m
       [31m    orderable: seller_organization,[0m
       [31m    base_settlement_id: settlement.id,[0m
       [31m    resource: 'LOX',[0m
       [31m    quantity: 100,[0m
       [31m    order_type: 'Sell'[0m
       [31m  )[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  'Sell' is not a valid order_type[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:45:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:84:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:94:in 'block (2 levels) in <main>'[0m

  364) Market::TradeExecutionService calls TransactionManager.create_transfer with the NET amount
       [31mFailure/Error:[0m
       [31m  Market::Order.new([0m
       [31m    id: 1,[0m
       [31m    market_condition: market_condition,[0m
       [31m    orderable: seller_organization,[0m
       [31m    base_settlement_id: settlement.id,[0m
       [31m    resource: 'LOX',[0m
       [31m    quantity: 100,[0m
       [31m    order_type: 'Sell'[0m
       [31m  )[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  'Sell' is not a valid order_type[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:45:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:84:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:104:in 'block (2 levels) in <main>'[0m

  365) Market::TradeExecutionService removes inventory from seller
       [31mFailure/Error:[0m
       [31m  Market::Order.new([0m
       [31m    id: 1,[0m
       [31m    market_condition: market_condition,[0m
       [31m    orderable: seller_organization,[0m
       [31m    base_settlement_id: settlement.id,[0m
       [31m    resource: 'LOX',[0m
       [31m    quantity: 100,[0m
       [31m    order_type: 'Sell'[0m
       [31m  )[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  'Sell' is not a valid order_type[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:45:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:84:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:120:in 'block (2 levels) in <main>'[0m

  366) Market::TradeExecutionService creates a trade record
       [31mFailure/Error:[0m
       [31m  Market::Order.new([0m
       [31m    id: 1,[0m
       [31m    market_condition: market_condition,[0m
       [31m    orderable: seller_organization,[0m
       [31m    base_settlement_id: settlement.id,[0m
       [31m    resource: 'LOX',[0m
       [31m    quantity: 100,[0m
       [31m    order_type: 'Sell'[0m
       [31m  )[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  'Sell' is not a valid order_type[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:45:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:84:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:126:in 'block (2 levels) in <main>'[0m

  367) Market::TradeExecutionService creates a price history record
       [31mFailure/Error:[0m
       [31m  Market::Order.new([0m
       [31m    id: 1,[0m
       [31m    market_condition: market_condition,[0m
       [31m    orderable: seller_organization,[0m
       [31m    base_settlement_id: settlement.id,[0m
       [31m    resource: 'LOX',[0m
       [31m    quantity: 100,[0m
       [31m    order_type: 'Sell'[0m
       [31m  )[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  'Sell' is not a valid order_type[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:45:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:84:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:131:in 'block (2 levels) in <main>'[0m

  368) Market::TradeExecutionService creates a supply chain record
       [31mFailure/Error:[0m
       [31m  Market::Order.new([0m
       [31m    id: 1,[0m
       [31m    market_condition: market_condition,[0m
       [31m    orderable: seller_organization,[0m
       [31m    base_settlement_id: settlement.id,[0m
       [31m    resource: 'LOX',[0m
       [31m    quantity: 100,[0m
       [31m    order_type: 'Sell'[0m
       [31m  )[0m
       [31m[0m
       [31mArgumentError:[0m
       [31m  'Sell' is not a valid order_type[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:45:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:84:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/market/trade_execution_service_spec.rb:136:in 'block (2 levels) in <main>'[0m

  369) MaterialGeneratorService.generate_material returns material data for water
       [31mFailure/Error: JSON.parse(File.read(TEMPLATE_PATH))[0m
       [31m[0m
       [31mErrno::ENOENT:[0m
       [31m  No such file or directory @ rb_sysopen - /home/galaxy_game/app/data/templates/material_v1.4.json[0m
       [36m# ./app/services/material_generator_service.rb:27:in 'IO.read'[0m
       [36m# ./app/services/material_generator_service.rb:27:in 'MaterialGeneratorService.load_template'[0m
       [36m# ./app/services/material_generator_service.rb:20:in 'MaterialGeneratorService.generate_material'[0m
       [36m# ./spec/services/material_generator_service_spec.rb:23:in 'block (3 levels) in <main>'[0m

  370) MaterialLookupService#find_material returns the correct material
       [31mFailure/Error: item = items.find { |i| i['chemical_formula'].casecmp?(name) }[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'casecmp?' for nil[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'block (2 levels) in MaterialLookupService#find_material'[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'Array#each'[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'Enumerable#find'[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'block in MaterialLookupService#find_material'[0m
       [36m# ./app/services/material_lookup_service.rb:8:in 'Hash#each'[0m
       [36m# ./app/services/material_lookup_service.rb:8:in 'MaterialLookupService#find_material'[0m
       [36m# ./spec/services/material_lookup_service_spec.rb:17:in 'block (3 levels) in <main>'[0m

  371) MaterialLookupService#find_material returns nil for a nonexistent material
       [31mFailure/Error: item = items.find { |i| i['chemical_formula'].casecmp?(name) }[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'casecmp?' for nil[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'block (2 levels) in MaterialLookupService#find_material'[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'Array#each'[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'Enumerable#find'[0m
       [36m# ./app/services/material_lookup_service.rb:14:in 'block in MaterialLookupService#find_material'[0m
       [36m# ./app/services/material_lookup_service.rb:8:in 'Hash#each'[0m
       [36m# ./app/services/material_lookup_service.rb:8:in 'MaterialLookupService#find_material'[0m
       [36m# ./spec/services/material_lookup_service_spec.rb:22:in 'block (3 levels) in <main>'[0m

  372) MaterialRequestService.create_material_requests creates requests for all required materials
       [31mFailure/Error: expect(construction_job.material_requests.count).to eq(4)[0m
       [31m[0m
       [31m  expected: 4[0m
       [31m       got: 0[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/material_request_service_spec.rb:10:in 'block (3 levels) in <main>'[0m

  373) Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available sources gases from depot tanks
       [31mFailure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "depot_tank"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/pressurization/structure_pressurization_service_spec.rb:10:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "depot_tank"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  374) Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available uses depot tank gases for pressurization
       [31mFailure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "depot_tank"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/pressurization/structure_pressurization_service_spec.rb:10:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "depot_tank"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  375) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks aggregates gases from all depot tanks
       [31mFailure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "depot_tank"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/pressurization/structure_pressurization_service_spec.rb:48:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "depot_tank"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  376) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks returns empty hash when no gases are stored
       [31mFailure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "depot_tank"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/pressurization/structure_pressurization_service_spec.rb:48:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "depot_tank"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  377) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when depot tanks have no gas_storage data returns empty hash
       [31mFailure/Error: let!(:depot_tank) { create(:depot_tank, settlement: settlement) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "depot_tank"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/pressurization/structure_pressurization_service_spec.rb:83:in 'block (4 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "depot_tank"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  378) Pressurization::StructurePressurizationService mining byproduct integration when mining Si produces O2 byproduct increases available gases from depot tanks for pressurization
       [31mFailure/Error: let!(:depot_tank) { create(:depot_tank, settlement: settlement) }[0m
       [31m[0m
       [31mKeyError:[0m
       [31m  Factory not registered: "depot_tank"[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'[0m
       [36m# /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'[0m
       [36m# ./spec/services/pressurization/structure_pressurization_service_spec.rb:100:in 'block (3 levels) in <main>'[0m
       [36m# ------------------[0m
       [36m# --- Caused by: ---[0m
       [36m# KeyError:[0m
       [36m#   key not found: "depot_tank"[0m
       [36m#   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'[0m

  379) ProcessingService#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
       [31mFailure/Error: celestial_location = CelestialLocation.find_by(name: @owner.active_location)[0m
       [31m[0m
       [31mNameError:[0m
       [31m  uninitialized constant ProcessingService::CelestialLocation[0m
       [36m# ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'[0m
       [36m# ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'[0m
       [36m# ./spec/services/processing_service_spec.rb:97:in 'Class#new'[0m
       [36m# ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'[0m
       [36m# ./spec/services/processing_service_spec.rb:102:in 'block (4 levels) in <main>'[0m

  380) ProcessingService#process when owner does not have enough resources returns an error when resources are insufficient
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    service.process[0m
       [31m  }.to raise_error(RuntimeError, /Insufficient resources: Steel/)[0m
       [31m[0m
       [31m  expected RuntimeError with message matching /Insufficient resources: Steel/, got #<NameError: uninitialized constant ProcessingService::CelestialLocation> with backtrace:[0m
       [31m    # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'[0m
       [31m    # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'[0m
       [31m    # ./spec/services/processing_service_spec.rb:97:in 'Class#new'[0m
       [31m    # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'[0m
       [31m    # ./spec/services/processing_service_spec.rb:116:in 'block (5 levels) in <main>'[0m
       [31m    # ./spec/services/processing_service_spec.rb:115:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/services/processing_service_spec.rb:115:in 'block (4 levels) in <main>'[0m

  381) ProcessingService#process when owner does not have enough GCC raises an error when GCC is insufficient
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    service.process[0m
       [31m  }.to raise_error(RuntimeError, "Insufficient GCC")[0m
       [31m[0m
       [31m  expected RuntimeError with "Insufficient GCC", got #<NameError: uninitialized constant ProcessingService::CelestialLocation> with backtrace:[0m
       [31m    # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'[0m
       [31m    # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'[0m
       [31m    # ./spec/services/processing_service_spec.rb:97:in 'Class#new'[0m
       [31m    # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'[0m
       [31m    # ./spec/services/processing_service_spec.rb:128:in 'block (5 levels) in <main>'[0m
       [31m    # ./spec/services/processing_service_spec.rb:127:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/services/processing_service_spec.rb:127:in 'block (4 levels) in <main>'[0m

  382) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates uses templates for approximately 40% of planets
       [31mFailure/Error: expect(template_based.length).to be_between(2, 6) # Approximately 40% of 10[0m
       [31m  expected 1 to be between 2 and 6 (inclusive)[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:160:in 'block (4 levels) in <main>'[0m

  383) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests terraformed names for template-based planets
       [31mFailure/Error:[0m
       [31m  count.times do |i|[0m
       [31m    @planet_counter += 1[0m
       [31m    moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"[0m
       [31m    moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"[0m
       [31m    [0m
       [31m    # Moons are smaller, with random sizes[0m
       [31m    mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses[0m
       [31m    radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii[0m
       [31m    [0m
       [31m    volume = (4.0/3.0) * Math::PI * (radius ** 3)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'times' for an instance of Float[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:1093:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:533:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:475:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:166:in 'block (4 levels) in <main>'[0m

  384) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests neutral names for procedural planets
       [31mFailure/Error:[0m
       [31m  count.times do |i|[0m
       [31m    @planet_counter += 1[0m
       [31m    moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"[0m
       [31m    moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"[0m
       [31m    [0m
       [31m    # Moons are smaller, with random sizes[0m
       [31m    mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses[0m
       [31m    radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii[0m
       [31m    [0m
       [31m    volume = (4.0/3.0) * Math::PI * (radius ** 3)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'times' for an instance of Float[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:1093:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:533:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:475:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:178:in 'block (4 levels) in <main>'[0m

  385) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates applies orbital optimization for template-based planets
       [31mFailure/Error:[0m
       [31m  count.times do |i|[0m
       [31m    @planet_counter += 1[0m
       [31m    moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"[0m
       [31m    moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"[0m
       [31m    [0m
       [31m    # Moons are smaller, with random sizes[0m
       [31m    mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses[0m
       [31m    radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii[0m
       [31m    [0m
       [31m    volume = (4.0/3.0) * Math::PI * (radius ** 3)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'times' for an instance of Float[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:1093:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:533:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:475:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:196:in 'block (4 levels) in <main>'[0m

  386) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates generates procedural planets when not using templates
       [31mFailure/Error:[0m
       [31m  count.times do |i|[0m
       [31m    @planet_counter += 1[0m
       [31m    moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"[0m
       [31m    moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"[0m
       [31m    [0m
       [31m    # Moons are smaller, with random sizes[0m
       [31m    mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses[0m
       [31m    radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii[0m
       [31m    [0m
       [31m    volume = (4.0/3.0) * Math::PI * (radius ** 3)[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method 'times' for an instance of Float[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:1093:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:533:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./app/services/star_sim/procedural_generator.rb:475:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:204:in 'block (4 levels) in <main>'[0m

  387) StarSim::ProceduralGenerator#generate_biosphere_data provides enhanced biosphere for template-based planets
       [31mFailure/Error: expect(result[:biodiversity_index]).to be > 0[0m
       [31m[0m
       [31m  expected: > 0[0m
       [31m       got:   nil[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:324:in 'block (3 levels) in <main>'[0m

  388) StarSim::ProceduralGenerator#generate_biosphere_data provides basic biosphere for planets with good conditions
       [31mFailure/Error: expect(result[:biodiversity_index]).to be >= 0[0m
       [31m[0m
       [31m  expected: >= 0[0m
       [31m       got:    nil[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:338:in 'block (3 levels) in <main>'[0m

  389) StarSim::ProceduralGenerator#generate_biosphere_data returns empty biosphere for unsuitable planets
       [31mFailure/Error: expect(result[:biodiversity_index]).to eq(0.0)[0m
       [31m[0m
       [31m  expected: 0.0[0m
       [31m       got: nil[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:350:in 'block (3 levels) in <main>'[0m

  390) StarSim::ProceduralGenerator integration test generates a complete, valid system
       [31mFailure/Error: expect(planet).to have_key(:atmosphere)[0m
       [31m  expected `{"albedo" => 0.29431406056907033, "atmosphere" => {"composition" => {"Ar" => 2.0, "CO2" => 20.0, "N2"...ficulty" => 5.0, "type" => "terrestrial", "volatile_reservoir" => {"CO2" => 1000.0, "H2O" => 500.0}}.has_key?(:atmosphere)` to be truthy, got false[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:467:in 'block (4 levels) in <main>'[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:455:in 'Array#each'[0m
       [36m# ./spec/services/star_sim/procedural_generator_spec.rb:455:in 'block (3 levels) in <main>'[0m

  391) TerraSim::BiosphereSimulationService#influence_atmosphere simulates gas exchange with the atmosphere
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: O2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:143:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
       [36m# ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:236:in 'block (3 levels) in <module:TerraSim>'[0m

  392) TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms uses life form effects when available
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: O2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:143:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
       [36m# ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:405:in 'block (4 levels) in <module:TerraSim>'[0m

  393) TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms scales effects by time
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: O2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:143:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
       [36m# ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:429:in 'block (4 levels) in <module:TerraSim>'[0m

  394) TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms falls back to hardcoded values when no life forms
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: O2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:143:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
       [36m# ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:455:in 'block (4 levels) in <module:TerraSim>'[0m

  395) TerraSim::BiosphereSimulationService terraforming integration #simulate with time parameter stores time_skipped for use in other methods
       [31mFailure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."[0m
       [31m[0m
       [31mAtmosphereConcern::InvalidGasError:[0m
       [31m  Unknown chemical formula or name: O2. Check materials database.[0m
       [36m# ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'[0m
       [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:143:in 'TerraSim::BiosphereSimulationService#influence_atmosphere'[0m
       [36m# ./app/services/terra_sim/biosphere_simulation_service.rb:29:in 'TerraSim::BiosphereSimulationService#simulate'[0m
       [36m# ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:471:in 'block (4 levels) in <module:TerraSim>'[0m

  396) TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants FIXED
       [34mExpected pending 'ice_tectonics_enabled attribute doesn't exist in Geosphere model' to fail. No error was raised.[0m
       [36m# ./spec/services/terra_sim/geosphere_initializer_spec.rb:88[0m

  397) TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for planets with atmospheres
       [31mFailure/Error: allow_any_instance_of(TerraSim::GeosphereInitializer).to receive(:determine_regolith_depth).and_return(3.0)[0m
       [31m  TerraSim::GeosphereInitializer does not implement #determine_regolith_depth[0m
       [36m# ./spec/services/terra_sim/geosphere_initializer_spec.rb:155:in 'block (3 levels) in <main>'[0m

  398) TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for airless bodies
       [31mFailure/Error: allow_any_instance_of(TerraSim::GeosphereInitializer).to receive(:determine_regolith_depth).and_return(3.0)[0m
       [31m  TerraSim::GeosphereInitializer does not implement #determine_regolith_depth[0m
       [36m# ./spec/services/terra_sim/geosphere_initializer_spec.rb:155:in 'block (3 levels) in <main>'[0m

  399) TerraSim::GeosphereSimulationService#simulate_tectonic_activity updates plate positions when tectonic activity is enabled
       [31mFailure/Error: if @geosphere.ice_tectonic_enabled[0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  private method 'ice_tectonic_enabled' called for #<CelestialBodies::Spheres::Geosphere:0x00007f0107122820>[0m
       [36m# ./app/services/terra_sim/geosphere_simulation_service.rb:56:in 'TerraSim::GeosphereSimulationService#simulate_tectonic_activity'[0m
       [36m# ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:52:in 'block (3 levels) in <main>'[0m

  400) TerraSim::GeosphereSimulationService#eruption adds volcanic gases to the atmosphere
       [31mFailure/Error:[0m
       [31m  expect {[0m
       [31m    service.send(:eruption)[0m
       [31m  }.to change { atmosphere.reload.gases.count }[0m
       [31m[0m
       [31m  expected `atmosphere.reload.gases.count` to have changed, but is still 0[0m
       [36m# ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:123:in 'block (3 levels) in <main>'[0m

  401) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing melts ice from polar caps
       [31mFailure/Error: expect(hydrosphere.liquid_bodies['ice_caps']['volume']).to be < initial_ice_volume[0m
       [31m[0m
       [31m  expected: < 100000000000000.0[0m
       [31m       got:   100000000000000.0[0m
       [36m# ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:234:in 'block (4 levels) in <main>'[0m

  402) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to decrease solid percentage
       [31mFailure/Error: expect(hydrosphere.state_distribution['solid']).to be < initial_solid_pct[0m
       [31m[0m
       [31m  expected: < 50.0[0m
       [31m       got:   50.0[0m
       [36m# ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:245:in 'block (4 levels) in <main>'[0m

  403) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to increase liquid percentage
       [31mFailure/Error: expect(hydrosphere.state_distribution['liquid']).to be > initial_liquid_pct[0m
       [31m[0m
       [31m  expected: > 40.0[0m
       [31m       got:   40.0[0m
       [36m# ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:256:in 'block (4 levels) in <main>'[0m

  404) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing adds some melted water as vapor to atmosphere
       [31mFailure/Error: expect(atmosphere).to receive(:add_gas).with('H2O', anything)[0m
       [31m[0m
       [31m  (#<CelestialBodies::Spheres::Atmosphere id: 53650, celestial_body_id: 47303, temperature: 250.0, pressure: 1.0, composition: {}, total_atmospheric_mass: 5.0e+18, dust: {}, pollution: 0, environment_type: "planetary", sealing_status: false, gas_changes: {}, dynamic_pressure: nil, base_values: {}, temperature_data: {}, created_at: "2026-01-19 04:33:45.370888000 +0000", updated_at: "2026-01-19 04:33:45.370888000 +0000", craft_id: nil, structure_id: nil, structure_type: nil>).add_gas("H2O", anything)[0m
       [31m      expected: 1 time with arguments: ("H2O", anything)[0m
       [31m      received: 0 times[0m
       [36m# ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:274:in 'block (4 levels) in <main>'[0m

  405) TerraSim::Simulator#calc_current when star is present updates the surface temperature
       [31mFailure/Error: expect(planet.reload.surface_temperature).to be > 0[0m
       [31m[0m
       [31m  expected: > 0[0m
       [31m       got:   0.0[0m
       [36m# ./spec/services/terra_sim/simulator_spec.rb:71:in 'block (4 levels) in <main>'[0m

  406) TerraSim::Simulator#calc_current when no star is present sets the temperature to space background temperature
       [31mFailure/Error: expect(isolated_planet.reload.surface_temperature).to eq(3)[0m
       [31m[0m
       [31m  expected: 3[0m
       [31m       got: 0.0[0m
       [31m[0m
       [31m  (compared using ==)[0m
       [36m# ./spec/services/terra_sim/simulator_spec.rb:110:in 'block (4 levels) in <main>'[0m

  407) WormholeConsortiumFormationService creates memberships for founding members and updates consortium operational_data
       [31mFailure/Error: member.operational_data['consortium_memberships'] ||= [][0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method '[]' for nil[0m
       [36m# ./app/services/wormhole_consortium_formation_service.rb:44:in 'block in WormholeConsortiumFormationService.form_consortium'[0m
       [36m# ./app/services/wormhole_consortium_formation_service.rb:27:in 'Hash#each'[0m
       [36m# ./app/services/wormhole_consortium_formation_service.rb:27:in 'WormholeConsortiumFormationService.form_consortium'[0m
       [36m# ./spec/services/wormhole_consortium_formation_service_spec.rb:12:in 'block (3 levels) in <main>'[0m
       [36m# ./spec/services/wormhole_consortium_formation_service_spec.rb:11:in 'block (2 levels) in <main>'[0m

  408) WormholeConsortiumFormationService updates member operational_data with consortium membership
       [31mFailure/Error: member.operational_data['consortium_memberships'] ||= [][0m
       [31m[0m
       [31mNoMethodError:[0m
       [31m  undefined method '[]' for nil[0m
       [36m# ./app/services/wormhole_consortium_formation_service.rb:44:in 'block in WormholeConsortiumFormationService.form_consortium'[0m
       [36m# ./app/services/wormhole_consortium_formation_service.rb:27:in 'Hash#each'[0m
       [36m# ./app/services/wormhole_consortium_formation_service.rb:27:in 'WormholeConsortiumFormationService.form_consortium'[0m
       [36m# ./spec/services/wormhole_consortium_formation_service_spec.rb:22:in 'block (2 levels) in <main>'[0m

Finished in 9 minutes 36 seconds (files took 32.2 seconds to load)
[31m3215 examples, 408 failures, 56 pending[0m

Failed examples:

[31mrspec ./spec/controllers/admin/ai_manager_controller_spec.rb:147[0m [36m# Admin::AiManagerController GET #planner runs simulation when pattern is provided[0m
[31mrspec ./spec/controllers/admin/ai_manager_controller_spec.rb:160[0m [36m# Admin::AiManagerController GET #planner uses default parameters if not provided[0m
[31mrspec ./spec/controllers/admin/ai_manager_controller_spec.rb:171[0m [36m# Admin::AiManagerController POST #export_plan exports simulation plan as JSON[0m
[31mrspec ./spec/controllers/terrestrial_planets_spec.rb:87[0m [36m# TerrestrialPlanetsController PATCH/PUT #update with valid parameters updates the requested terrestrial_planet[0m
[31mrspec ./spec/data/alien_world_templates_integrity_spec.rb:83[0m [36m# Alien World Template Integrity atmosphere rules has pressure > 0[0m
[31mrspec ./spec/data/alien_world_templates_integrity_spec.rb:110[0m [36m# Alien World Template Integrity volatile reservoirs has CO2 and H2O reservoirs defined[0m
[31mrspec ./spec/data/alien_world_templates_integrity_spec.rb:120[0m [36m# Alien World Template Integrity material yield bias contains all yield bias categories[0m
[31mrspec ./spec/features/terrestrial_planets_feature_spec.rb:4[0m [36m# TerrestrialPlanets User views a planet detail[0m
[31mrspec ./spec/features/terrestrial_planets_feature_spec.rb:26[0m [36m# TerrestrialPlanets User updates a planet's name only[0m
[31mrspec ./spec/features/terrestrial_planets_feature_spec.rb:64[0m [36m# TerrestrialPlanets User updates a planet with all attributes[0m
[31mrspec ./spec/integration/component_production_game_loop_spec.rb:117[0m [36m# Component Production Game Loop Integration full production cycle produces components through game loop progression[0m
[31mrspec ./spec/integration/component_production_game_loop_spec.rb:148[0m [36m# Component Production Game Loop Integration full production cycle handles partial progress over multiple ticks[0m
[31mrspec ./spec/integration/component_production_game_loop_spec.rb:164[0m [36m# Component Production Game Loop Integration full production cycle processes multiple jobs simultaneously[0m
[31mrspec ./spec/integration/covering_system_integration_spec.rb:43[0m [36m# Covering System Integration Lava tube worldhouse covering workflow seals skylights when worldhouse construction completes[0m
[31mrspec ./spec/integration/covering_system_integration_spec.rb:155[0m [36m# Covering System Integration Worldhouse segment covering workflow handles massive scale covering[0m
[31mrspec ./spec/integration/covering_system_integration_spec.rb:176[0m [36m# Covering System Integration Multi-scale comparison uses same system for different scales[0m
[31mrspec ./spec/integration/manufacturing_pipeline_e2e_spec.rb:277[0m [36m# Manufacturing Pipeline End-to-End complete ISRU to enclosed tank pipeline processes raw regolith through all stages to produce an enclosed tank[0m
[31mrspec ./spec/integration/manufacturing_pipeline_e2e_spec.rb:544[0m [36m# Manufacturing Pipeline End-to-End pipeline with multiple batches can process multiple batches concurrently[0m
[31mrspec ./spec/integration/manufacturing_pipeline_e2e_spec.rb:589[0m [36m# Manufacturing Pipeline End-to-End material tracking through pipeline preserves composition metadata through processing chain[0m
[31mrspec ./spec/integration/shell_printing_game_loop_spec.rb:131[0m [36m# Shell Printing Game Loop Integration full shell printing cycle encloses inflatable tank through game loop progression[0m
[31mrspec ./spec/integration/shell_printing_game_loop_spec.rb:160[0m [36m# Shell Printing Game Loop Integration full shell printing cycle tracks material composition in shell metadata[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:67[0m [36m# Terraforming Integration end-to-end terraforming simulation creates a barren planet with correct initial conditions[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:120[0m [36m# Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time increases oxygen levels after 1 day[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:130[0m [36m# Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time decreases CO2 levels after 1 day[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:140[0m [36m# Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time shows progressive changes over 100 days[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:171[0m [36m# Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time scales effects by time parameter[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:199[0m [36m# Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed life form populations over time maintains or grows populations under favorable conditions[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:217[0m [36m# Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed combined effects from multiple species aggregates atmospheric effects from all life forms[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:244[0m [36m# Terraforming Integration end-to-end terraforming simulation without life forms uses fallback values when no terraforming organisms exist[0m
[31mrspec ./spec/integration/terraforming_integration_spec.rb:258[0m [36m# Terraforming Integration realistic terraforming scenario demonstrates full terraforming workflow[0m
[31mrspec ./spec/integration/terraforming_workflow_spec.rb:69[0m [36m# Terraforming Workflow Integration transforms atmosphere over time with deployed organisms[0m
[31mrspec ./spec/integration/terraforming_workflow_spec.rb:107[0m [36m# Terraforming Workflow Integration allows monitoring of terraforming progress[0m
[31mrspec ./spec/jobs/concurrent_task_worker_job_spec.rb:34[0m [36m# ConcurrentTaskWorkerJob#perform with manufacturing task during daylight executes the task successfully[0m
[31mrspec ./spec/jobs/concurrent_task_worker_job_spec.rb:41[0m [36m# ConcurrentTaskWorkerJob#perform with manufacturing task during daylight generates manufacturing byproducts[0m
[31mrspec ./spec/jobs/concurrent_task_worker_job_spec.rb:54[0m [36m# ConcurrentTaskWorkerJob#perform with manufacturing task during low light does not generate byproducts[0m
[31mrspec ./spec/jobs/concurrent_task_worker_job_spec.rb:70[0m [36m# ConcurrentTaskWorkerJob#perform with non-manufacturing task does not attempt byproduct generation[0m
[31mrspec ./spec/models/account_spec.rb:18[0m [36m# Financial::Account validations is expected to validate that :balance looks like a number greater than or equal to 0[0m
[31mrspec ./spec/models/account_spec.rb:23[0m [36m# Financial::Account#deposit with a valid amount increases the account balance[0m
[31mrspec ./spec/models/account_spec.rb:37[0m [36m# Financial::Account#deposit with an invalid amount (negative) raises an error and does not modify the balance[0m
[31mrspec ./spec/models/account_spec.rb:48[0m [36m# Financial::Account#withdraw when funds are sufficient decreases the account balance[0m
[31mrspec ./spec/models/account_spec.rb:62[0m [36m# Financial::Account#withdraw when funds are insufficient raises an error and does not modify the balance[0m
[31mrspec ./spec/models/account_spec.rb:73[0m [36m# Financial::Account#transfer_funds when funds are sufficient transfers the amount from one account to another[0m
[31mrspec ./spec/models/account_spec.rb:95[0m [36m# Financial::Account#transfer_funds when funds are insufficient raises an error and does not modify balances[0m
[31mrspec ./spec/models/account_spec.rb:111[0m [36m# Financial::Account edge cases when balance is exactly zero prevents withdrawals or transfers[0m
[31mrspec ./spec/models/account_spec.rb:119[0m [36m# Financial::Account edge cases when balance is exactly zero allows deposits[0m
[31mrspec ./spec/models/account_spec.rb:127[0m [36m# Financial::Account different accountable types works with a player account[0m
[31mrspec ./spec/models/account_spec.rb:132[0m [36m# Financial::Account different accountable types works with a settlement account[0m
[31mrspec ./spec/models/account_spec.rb:137[0m [36m# Financial::Account different accountable types works with an organization account[0m
[31mrspec ./spec/models/biogas_generator_spec.rb:18[0m [36m# Units::BiogasGenerator#operate consumes biomass, organic waste, and energy, producing biogas and fertilizer[0m
[31mrspec ./spec/models/biogas_generator_spec.rb:27[0m [36m# Units::BiogasGenerator#operate returns false if insufficient biomass is available[0m
[31mrspec ./spec/models/biogas_generator_spec.rb:32[0m [36m# Units::BiogasGenerator#operate returns false if insufficient organic waste is available[0m
[31mrspec ./spec/models/biogas_generator_spec.rb:37[0m [36m# Units::BiogasGenerator#operate returns false if insufficient energy is available[0m
[31mrspec ./spec/models/biology/life_form_library_spec.rb:51[0m [36m# Biology::LifeForm#simulate_growth uses _calculate_base_growth_rate to modify population[0m
[31mrspec ./spec/models/biology/life_form_library_spec.rb:66[0m [36m# Biology::LifeForm#simulate_growth is affected by biosphere habitability[0m
[31mrspec ./spec/models/biology/life_form_spec.rb:51[0m [36m# Biology::LifeForm#simulate_growth uses _calculate_base_growth_rate to modify population[0m
[31mrspec ./spec/models/biology/life_form_spec.rb:66[0m [36m# Biology::LifeForm#simulate_growth is affected by biosphere habitability[0m
[31mrspec ./spec/models/biomass_recycler_spec.rb:18[0m [36m# Units::BiomassRecycler#operate consumes biomass and energy, producing fertilizer and biofuel[0m
[31mrspec ./spec/models/biomass_recycler_spec.rb:26[0m [36m# Units::BiomassRecycler#operate returns false if insufficient biomass is available[0m
[31mrspec ./spec/models/biomass_recycler_spec.rb:31[0m [36m# Units::BiomassRecycler#operate returns false if insufficient energy is available[0m
[31mrspec ./spec/models/blueprint_spec.rb:14[0m [36m# Blueprint#materials returns a hash of required materials from JSON[0m
[31mrspec ./spec/models/celestial_bodies/brown_dwarf_spec.rb:99[0m [36m# CelestialBodies::BrownDwarf atmospheric and other properties can have an atmosphere[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:20[0m [36m# CelestialBodies::CelestialBody material management #add_material creates or updates material properly[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:26[0m [36m# CelestialBodies::CelestialBody material management #add_material updates atmosphere gases if material is a gas[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:35[0m [36m# CelestialBodies::CelestialBody material management #remove_material reduces material amount and deletes if zero[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:42[0m [36m# CelestialBodies::CelestialBody material management #remove_material updates atmosphere gases accordingly[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:94[0m [36m# CelestialBodies::CelestialBody properties JSONB accessors can read and write last_simulated_at[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:102[0m [36m# CelestialBodies::CelestialBody#planet_class? returns true for a planet type[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:107[0m [36m# CelestialBodies::CelestialBody#planet_class? returns false for nil type[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:112[0m [36m# CelestialBodies::CelestialBody#planet_class? returns false for non-planet type[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:119[0m [36m# CelestialBodies::CelestialBody#should_simulate? returns false if not active[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:124[0m [36m# CelestialBodies::CelestialBody#should_simulate? returns false if radius is too small[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:129[0m [36m# CelestialBodies::CelestialBody#should_simulate? returns true for planet_class? or is_moon[0m
[31mrspec ./spec/models/celestial_bodies/celestial_body_spec.rb:136[0m [36m# CelestialBodies::CelestialBody#should_simulate? returns true if force_simulate property is set[0m
[31mrspec ./spec/models/celestial_bodies/materials/gas_spec.rb:18[0m [36m# CelestialBodies::Materials::Gas associations can be accessed through atmosphere.gases[0m
[31mrspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:36[0m [36m# CelestialBodies::Planets::Ocean::HyceanPlanet validations inherits ocean planet water coverage validation[0m
[31mrspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:162[0m [36m# CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry returns unknown when hydrosphere composition is missing[0m
[31mrspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:283[0m [36m# CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet can analyze water chemistry[0m
[31mrspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:85[0m [36m# CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors includes temperature state for liquid water range[0m
[31mrspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:103[0m [36m# CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors identifies vapor dominated state for high temperatures[0m
[31mrspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:149[0m [36m# CelestialBodies::Planets::Ocean::OceanPlanet#surface_features includes liquid oceans for moderate temperatures[0m
[31mrspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:158[0m [36m# CelestialBodies::Planets::Ocean::OceanPlanet#surface_features includes vapor clouds for high temperatures[0m
[31mrspec ./spec/models/celestial_bodies/planets/rocky/terrestrial_planets_spec.rb:76[0m [36m# CelestialBodies::Planets::Rocky::TerrestrialPlanet#calculated_atmospheric_pressure returns a numeric value for calculated atmospheric pressure[0m
[31mrspec ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:41[0m [36m# CelestialBodies::Spheres::Atmosphere#initialize_gases creates gases based on the composition[0m
[31mrspec ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:54[0m [36m# CelestialBodies::Spheres::Atmosphere#add_gas adds gas using chemical formula[0m
[31mrspec ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:77[0m [36m# CelestialBodies::Spheres::Atmosphere#remove_gas removes gas and updates total atmospheric mass[0m
[31mrspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:79[0m [36m# CelestialBodies::Spheres::Biosphere defaults accesses default temperature values via delegation methods[0m
[31mrspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:58[0m [36m# CelestialBodies::Spheres::Geosphere#add_material adds a material and updates the celestial body and geosphere[0m
[31mrspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:101[0m [36m# CelestialBodies::Spheres::Geosphere#add_material adds material to the specified layer[0m
[31mrspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:130[0m [36m# CelestialBodies::Spheres::Geosphere#remove_material removes material from the specified layer[0m
[31mrspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:175[0m [36m# CelestialBodies::Spheres::Geosphere material management creates materials in correct layer[0m
[31mrspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:192[0m [36m# CelestialBodies::Spheres::Geosphere material management updates composition percentages[0m
[31mrspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:275[0m [36m# CelestialBodies::Spheres::Geosphere#extract_volatiles extracts volatiles based on temperature increase[0m
[31mrspec ./spec/models/celestial_body_spec.rb:16[0m [36m# CelestialBodies::CelestialBody when not part of a solar system allows distance_from_star to be nil[0m
[31mrspec ./spec/models/celestial_body_spec.rb:24[0m [36m# CelestialBodies::CelestialBody#add_material creates a new material if it does not exist[0m
[31mrspec ./spec/models/celestial_body_spec.rb:30[0m [36m# CelestialBodies::CelestialBody#add_material updates the amount of an existing material[0m
[31mrspec ./spec/models/celestial_body_spec.rb:67[0m [36m# CelestialBodies::CelestialBody#update_gravity calculates and updates the gravity based on mass and radius[0m
[31mrspec ./spec/models/composting_unit_spec.rb:18[0m [36m# Units::CompostingUnit#operate consumes organic waste and energy, producing compost[0m
[31mrspec ./spec/models/composting_unit_spec.rb:25[0m [36m# Units::CompostingUnit#operate returns false if insufficient organic waste is available[0m
[31mrspec ./spec/models/composting_unit_spec.rb:30[0m [36m# Units::CompostingUnit#operate returns false if insufficient energy is available[0m
[31mrspec ./spec/models/concerns/atmosphere_concern_spec.rb:98[0m [36m# AtmosphereConcern#add_gas adds a new gas to the atmosphere[0m
[31mrspec ./spec/models/concerns/atmosphere_concern_spec.rb:114[0m [36m# AtmosphereConcern#add_gas updates existing gas[0m
[31mrspec ./spec/models/concerns/atmosphere_concern_spec.rb:137[0m [36m# AtmosphereConcern#remove_gas removes gas from the atmosphere[0m
[31mrspec ./spec/models/concerns/atmosphere_concern_spec.rb:156[0m [36m# AtmosphereConcern#remove_gas deletes gas when amount becomes zero[0m
[31mrspec ./spec/models/concerns/atmosphere_concern_spec.rb:302[0m [36m# AtmosphereConcern#estimate_molar_mass calculates different molar mass for different compositions[0m
[31mrspec ./spec/models/concerns/atmosphere_concern_spec.rb:462[0m [36m# AtmosphereConcern#initialize_gases creates gases based on composition[0m
[31mrspec ./spec/models/concerns/energy_management_spec.rb:196[0m [36m# EnergyManagement solar output factor #current_solar_output_factor queries location solar output factor[0m
[31mrspec ./spec/models/concerns/energy_management_spec.rb:201[0m [36m# EnergyManagement solar output factor #current_solar_output_factor returns 1.0 when no settlement[0m
[31mrspec ./spec/models/concerns/energy_management_spec.rb:208[0m [36m# EnergyManagement solar output factor #solar_daylight? returns true when solar factor > 0.1[0m
[31mrspec ./spec/models/concerns/energy_management_spec.rb:213[0m [36m# EnergyManagement solar output factor #solar_daylight? returns false when solar factor <= 0.1[0m
[31mrspec ./spec/models/concerns/energy_management_spec.rb:243[0m [36m# EnergyManagement solar output factor power generation with solar scaling scales solar unit output by solar factor[0m
[31mrspec ./spec/models/concerns/energy_management_spec.rb:249[0m [36m# EnergyManagement solar output factor power generation with solar scaling does not scale non-solar units[0m
[31mrspec ./spec/models/concerns/geosphere_concern_spec.rb:76[0m [36m# GeosphereConcern#reset returns false if base_values lack required keys[0m
[31mrspec ./spec/models/concerns/geosphere_concern_spec.rb:96[0m [36m# GeosphereConcern#reset does not modify attributes when base_values are empty[0m
[31mrspec ./spec/models/concerns/geosphere_concern_spec.rb:171[0m [36m# GeosphereConcern#extract_volatiles extracts volatiles based on temperature increase[0m
[31mrspec ./spec/models/concerns/geosphere_concern_spec.rb:180[0m [36m# GeosphereConcern#extract_volatiles adds gases to atmosphere using chemical formula[0m
[31mrspec ./spec/models/concerns/geosphere_concern_spec.rb:212[0m [36m# GeosphereConcern#add_material adds material to the specified layer[0m
[31mrspec ./spec/models/concerns/geosphere_concern_spec.rb:344[0m [36m# GeosphereConcern#physical_state returns liquid for temperature between melting and boiling points[0m
[31mrspec ./spec/models/concerns/geosphere_concern_spec.rb:350[0m [36m# GeosphereConcern#physical_state returns gas for temperature above boiling point[0m
[31mrspec ./spec/models/concerns/housing_spec.rb:57[0m [36m# Housing population management calculates population capacity from habitat units[0m
[31mrspec ./spec/models/concerns/housing_spec.rb:61[0m [36m# Housing population management uses alias total_capacity for population_capacity[0m
[31mrspec ./spec/models/concerns/housing_spec.rb:65[0m [36m# Housing population management calculates available capacity[0m
[31mrspec ./spec/models/concerns/housing_spec.rb:70[0m [36m# Housing population management checks if it has capacity for additional population[0m
[31mrspec ./spec/models/concerns/housing_spec.rb:76[0m [36m# Housing population management ignores non-habitat units when calculating capacity[0m
[31mrspec ./spec/models/concerns/housing_spec.rb:81[0m [36m# Housing population management calculates total population from base units[0m
[31mrspec ./spec/models/concerns/hydrosphere_concern_spec.rb:82[0m [36m# HydrosphereConcern#calculate_evaporation_rate calculates higher evaporation at higher temperatures[0m
[31mrspec ./spec/models/concerns/hydrosphere_concern_spec.rb:191[0m [36m# HydrosphereConcern#add_liquid validates material exists in lookup service[0m
[31mrspec ./spec/models/concerns/hydrosphere_concern_spec.rb:218[0m [36m# HydrosphereConcern#remove_liquid removes liquid from the hydrosphere[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:61[0m [36m# MaterialManagementConcern#add_material with valid inputs looks up material data using real service[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:73[0m [36m# MaterialManagementConcern#add_material with valid inputs creates material with standardized ID[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:83[0m [36m# MaterialManagementConcern#add_material with valid inputs adds to existing material amount[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:103[0m [36m# MaterialManagementConcern#add_material when material is a gas updates atmosphere composition[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:145[0m [36m# MaterialManagementConcern#remove_material with valid inputs raises error for insufficient material[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:153[0m [36m# MaterialManagementConcern#remove_material with valid inputs raises error when material not found[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:161[0m [36m# MaterialManagementConcern#remove_material with valid inputs reduces material amount and saves[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:170[0m [36m# MaterialManagementConcern#remove_material with valid inputs sets amount to zero when fully removed[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:189[0m [36m# MaterialManagementConcern#remove_material when material is a gas updates atmosphere composition[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:200[0m [36m# MaterialManagementConcern#has_gas_properties? returns true for gases[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:223[0m [36m# MaterialManagementConcern integration with CelestialBody works with actual celestial body materials association[0m
[31mrspec ./spec/models/concerns/material_management_concern_spec.rb:239[0m [36m# MaterialManagementConcern integration with CelestialBody correctly identifies gas materials from fixtures[0m
[31mrspec ./spec/models/concerns/material_properties_concern_spec.rb:204[0m [36m# MaterialPropertiesConcern exotic state handling identifies exotic states[0m
[31mrspec ./spec/models/concerns/material_properties_concern_spec.rb:218[0m [36m# MaterialPropertiesConcern exotic state handling calculates phase transitions for exotic conditions[0m
[31mrspec ./spec/models/concerns/mineable_spec.rb:29[0m [36m# Mineable#mine_gcc mines from satellites and computers[0m
[31mrspec ./spec/models/concerns/mineable_spec.rb:34[0m [36m# Mineable#mine_gcc does not exceed available power[0m
[31mrspec ./spec/models/craft/harvester_spec.rb:18[0m [36m# Craft::Harvester validations is valid with a positive extraction_rate[0m
[31mrspec ./spec/models/craft/harvester_spec.rb:23[0m [36m# Craft::Harvester validations is invalid with a negative extraction_rate[0m
[31mrspec ./spec/models/craft/harvester_spec.rb:31[0m [36m# Craft::Harvester#extract_resources when extracting from a valid target increases inventory with extracted resources[0m
[31mrspec ./spec/models/craft/harvester_spec.rb:40[0m [36m# Craft::Harvester#extract_resources when extracting from an invalid target raises an error[0m
[31mrspec ./spec/models/craft/harvester_spec.rb:51[0m [36m# Craft::Harvester#extract_resources when storage is full raises an error[0m
[31mrspec ./spec/models/craft/harvester_spec.rb:63[0m [36m# Craft::Harvester#process_resources converts raw material into refined material[0m
[31mrspec ./spec/models/craft/harvester_spec.rb:73[0m [36m# Craft::Harvester#process_resources does nothing if no processable materials are present[0m
[31mrspec ./spec/models/craft/variant_manager_spec.rb:66[0m [36m# Craft::VariantManager#initialize loads base data and variants[0m
[31mrspec ./spec/models/craft/variant_manager_spec.rb:102[0m [36m# Craft::VariantManager#get_variant merges base data with standard variant data[0m
[31mrspec ./spec/models/craft/variant_manager_spec.rb:113[0m [36m# Craft::VariantManager#get_variant merges base data with lunar variant data[0m
[31mrspec ./spec/models/craft/variant_manager_spec.rb:124[0m [36m# Craft::VariantManager#get_variant properly merges nested hashes[0m
[31mrspec ./spec/models/dome_spec.rb:5[0m [36m# Settlement::Dome calculates used capacity (current occupancy) correctly[0m
[31mrspec ./spec/models/dome_spec.rb:10[0m [36m# Settlement::Dome calculates remaining capacity correctly[0m
[31mrspec ./spec/models/dome_spec.rb:15[0m [36m# Settlement::Dome ensures current occupancy does not exceed total capacity[0m
[31mrspec ./spec/models/dwarf_planet_spec.rb:19[0m [36m# CelestialBodies::DwarfPlanet#calculate_surface_conditions calculates surface conditions specific to dwarf planets[0m
[31mrspec ./spec/models/dwarf_planet_spec.rb:26[0m [36m# CelestialBodies::DwarfPlanet#update_biomes updates biomes specific to dwarf planets[0m
[31mrspec ./spec/models/environment_spec.rb:11[0m [36m# Environment validations is valid with valid attributes[0m
[31mrspec ./spec/models/environment_spec.rb:15[0m [36m# Environment validations is not valid without a biome[0m
[31mrspec ./spec/models/environment_spec.rb:20[0m [36m# Environment validations is not valid without a planet[0m
[31mrspec ./spec/models/environment_spec.rb:25[0m [36m# Environment validations is not valid without a temperature[0m
[31mrspec ./spec/models/environment_spec.rb:30[0m [36m# Environment validations is not valid without a pressure[0m
[31mrspec ./spec/models/environment_spec.rb:35[0m [36m# Environment validations is not valid without a humidity[0m
[31mrspec ./spec/models/environment_spec.rb:42[0m [36m# Environment associations belongs to a biome[0m
[31mrspec ./spec/models/environment_spec.rb:46[0m [36m# Environment associations belongs to a celestial_body[0m
[31mrspec ./spec/models/game_spec.rb:61[0m [36m# Game#assign_task adds a new task to the task list with correct completion time[0m
[31mrspec ./spec/models/game_spec.rb:85[0m [36m# Game#advance_time advances game time and completes a task[0m
[31mrspec ./spec/models/game_spec.rb:94[0m [36m# Game#advance_time with no tasks prints a message when there are no tasks[0m
[31mrspec ./spec/models/gas_giant_spec.rb:19[0m [36m# CelestialBodies::GasGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities[0m
[31mrspec ./spec/models/gas_giant_spec.rb:26[0m [36m# CelestialBodies::GasGiant#calculate_gravity calculates gravity based on mass and radius[0m
[31mrspec ./spec/models/hydrosphere_spec.rb:45[0m [36m# CelestialBodies::Spheres::Hydrosphere#reset resets to base values[0m
[31mrspec ./spec/models/ice_giant_spec.rb:19[0m [36m# CelestialBodies::IceGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities[0m
[31mrspec ./spec/models/ice_giant_spec.rb:26[0m [36m# CelestialBodies::IceGiant#calculate_gravity calculates gravity based on mass and radius[0m
[31mrspec ./spec/models/item_spec.rb:296[0m [36m# Item regolith handling gets composition from celestial body geosphere[0m
[31mrspec ./spec/models/liquid_material_spec.rb:9[0m [36m# CelestialBodies::Materials::Liquid associations [0m
[31mrspec ./spec/models/liquid_material_spec.rb:13[0m [36m# CelestialBodies::Materials::Liquid validations is valid with valid attributes[0m
[31mrspec ./spec/models/liquid_material_spec.rb:17[0m [36m# CelestialBodies::Materials::Liquid validations is not valid without a name[0m
[31mrspec ./spec/models/liquid_material_spec.rb:23[0m [36m# CelestialBodies::Materials::Liquid validations is not valid without an amount[0m
[31mrspec ./spec/models/liquid_material_spec.rb:29[0m [36m# CelestialBodies::Materials::Liquid validations is not valid with a negative amount[0m
[31mrspec ./spec/models/location/celestial_location_spec.rb:15[0m [36m# Location::CelestialLocation validations is expected to validate that :name cannot be empty/falsy[0m
[31mrspec ./spec/models/location/celestial_location_spec.rb:400[0m [36m# Location::CelestialLocation#description describes surface locations[0m
[31mrspec ./spec/models/location/celestial_location_spec.rb:414[0m [36m# Location::CelestialLocation#description describes orbital locations[0m
[31mrspec ./spec/models/market/transaction_fee_spec.rb:5[0m [36m# Market::TransactionFee validations is expected to validate that :fee_type cannot be empty/falsy[0m
[31mrspec ./spec/models/market/transaction_fee_spec.rb:6[0m [36m# Market::TransactionFee validations is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"›[0m
[31mrspec ./spec/models/market/transaction_fee_spec.rb:7[0m [36m# Market::TransactionFee validations is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil[0m
[31mrspec ./spec/models/market/transaction_fee_spec.rb:8[0m [36m# Market::TransactionFee validations is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil[0m
[31mrspec ./spec/models/market/transaction_fee_spec.rb:12[0m [36m# Market::TransactionFee#calculate calculates percentage fee[0m
[31mrspec ./spec/models/market/transaction_fee_spec.rb:17[0m [36m# Market::TransactionFee#calculate calculates fixed fee[0m
[31mrspec ./spec/models/market/transaction_fee_spec.rb:22[0m [36m# Market::TransactionFee#calculate returns 0 for unknown fee_type[0m
[31mrspec ./spec/models/material_request_spec.rb:220[0m [36m# MaterialRequest instance methods #gas_request? returns true when material is a gas[0m
[31mrspec ./spec/models/material_request_spec.rb:227[0m [36m# MaterialRequest instance methods #gas_request? returns false when material is not a gas[0m
[31mrspec ./spec/models/material_request_spec.rb:234[0m [36m# MaterialRequest instance methods #gas_request? returns false when material data is not found[0m
[31mrspec ./spec/models/material_request_spec.rb:240[0m [36m# MaterialRequest instance methods #gas_request? returns false when material data has no category[0m
[31mrspec ./spec/models/material_spec.rb:49[0m [36m# CelestialBodies::Material validations is not valid with non-numeric melting and boiling points[0m
[31mrspec ./spec/models/material_spec.rb:63[0m [36m# CelestialBodies::Material#state_at returns "solid" when temperature is below the adjusted melting point[0m
[31mrspec ./spec/models/material_spec.rb:67[0m [36m# CelestialBodies::Material#state_at returns "liquid" when temperature is between the adjusted melting and boiling points[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:65[0m [36m# Modules::BaseModule callbacks before_validation :load_module_data on create when module data is found loads CO2 scrubber data from lookup service[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:163[0m [36m# Modules::BaseModule instance methods #operational_status returns operational status from loaded data[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:167[0m [36m# Modules::BaseModule instance methods #operational_status returns inactive when operational_data is missing[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:174[0m [36m# Modules::BaseModule instance methods #input_resources returns input resources from loaded data[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:182[0m [36m# Modules::BaseModule instance methods #input_resources returns empty array when operational_data is missing[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:189[0m [36m# Modules::BaseModule instance methods #output_resources returns output resources from loaded data[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:199[0m [36m# Modules::BaseModule instance methods #consumables returns consumables from loaded data[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:214[0m [36m# Modules::BaseModule AtmosphericProcessing integration #can_process_atmosphere? returns true for CO2 scrubber module[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:218[0m [36m# Modules::BaseModule AtmosphericProcessing integration #can_process_atmosphere? returns false for basic life support module[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:224[0m [36m# Modules::BaseModule AtmosphericProcessing integration #atmospheric_capabilities identifies CO2 scrubbing capability[0m
[31mrspec ./spec/models/modules/base_module_spec.rb:233[0m [36m# Modules::BaseModule AtmosphericProcessing integration #max_processing_rate returns correct rates for CO2 scrubber[0m
[31mrspec ./spec/models/organizations/base_organization_profit_spec.rb:13[0m [36m# Organizations::BaseOrganization distributes profits to members based on ownership[0m
[31mrspec ./spec/models/organizations/tax_authority_spec.rb:19[0m [36m# Organizations::TaxAuthority.instance always returns the same single instance[0m
[31mrspec ./spec/models/planet_biome_spec.rb:15[0m [36m# PlanetBiome [0m
[31mrspec ./spec/models/planet_biome_spec.rb:16[0m [36m# PlanetBiome [0m
[31mrspec ./spec/models/planet_biome_spec.rb:19[0m [36m# PlanetBiome is valid with valid attributes[0m
[31mrspec ./spec/models/planet_biome_spec.rb:23[0m [36m# PlanetBiome is not valid without a biome[0m
[31mrspec ./spec/models/planet_biome_spec.rb:28[0m [36m# PlanetBiome is not valid without a celestial_body[0m
[31mrspec ./spec/models/plant_environment_spec.rb:13[0m [36m# PlantEnvironment validations is valid with valid attributes[0m
[31mrspec ./spec/models/plant_environment_spec.rb:17[0m [36m# PlantEnvironment validations is not valid without a plant[0m
[31mrspec ./spec/models/plant_environment_spec.rb:22[0m [36m# PlantEnvironment validations is not valid without an environment[0m
[31mrspec ./spec/models/plant_environment_spec.rb:27[0m [36m# PlantEnvironment validations is not valid with duplicate plant and environment pair[0m
[31mrspec ./spec/models/plant_spec.rb:9[0m [36m# Plant validations is valid with valid attributes[0m
[31mrspec ./spec/models/plant_spec.rb:35[0m [36m# Plant methods can grow in a given environment if conditions are met[0m
[31mrspec ./spec/models/plant_spec.rb:41[0m [36m# Plant methods cannot grow in a given environment if conditions are not met[0m
[31mrspec ./spec/models/rigs/base_rig_spec.rb:23[0m [36m# Rigs::BaseRig#apply_rig_to_attachable applies rig effect to the attachable unit[0m
[31mrspec ./spec/models/rigs/base_rig_spec.rb:30[0m [36m# Rigs::BaseRig#remove_from removes rig effect from the attachable unit[0m
[31mrspec ./spec/models/rigs/base_rig_spec.rb:37[0m [36m# Rigs::BaseRig polymorphic association can belong to an attachable BaseUnit[0m
[31mrspec ./spec/models/rigs/base_rig_spec.rb:106[0m [36m# Rigs::BaseRig#apply_output_effects and #revert_output_effects applies and reverts output effects if attachable responds to update_outputs[0m
[31mrspec ./spec/models/rigs/base_rig_spec.rb:128[0m [36m# Rigs::BaseRig#apply_damage_effects and #revert_damage_effects applies and reverts damage effects if attachable responds to update_damage_risks[0m
[31mrspec ./spec/models/route_proposal_spec.rb:12[0m [36m# RouteProposal calculates vote outcome based on threshold[0m
[31mrspec ./spec/models/route_proposal_spec.rb:17[0m [36m# RouteProposal fails if votes do not meet threshold[0m
[31mrspec ./spec/models/route_proposal_vote_spec.rb:7[0m [36m# RouteProposalVote is valid with valid attributes[0m
[31mrspec ./spec/models/route_proposal_vote_spec.rb:12[0m [36m# RouteProposalVote is invalid with an invalid vote value[0m
[31mrspec ./spec/models/settlement/city_spec.rb:20[0m [36m# Settlement::City validations is valid with valid attributes[0m
[31mrspec ./spec/models/settlement/city_spec.rb:24[0m [36m# Settlement::City validations is not valid without a location[0m
[31mrspec ./spec/models/settlement/city_spec.rb:29[0m [36m# Settlement::City validations is not valid without a name[0m
[31mrspec ./spec/models/settlement/city_spec.rb:34[0m [36m# Settlement::City validations is not valid with a negative current population[0m
[31mrspec ./spec/models/settlement/city_spec.rb:39[0m [36m# Settlement::City validations is not valid with food_per_person less than or equal to zero[0m
[31mrspec ./spec/models/settlement/city_spec.rb:44[0m [36m# Settlement::City validations is not valid with water_per_person less than or equal to zero[0m
[31mrspec ./spec/models/settlement/city_spec.rb:49[0m [36m# Settlement::City validations is not valid with energy_per_person less than or equal to zero[0m
[31mrspec ./spec/models/settlement/city_spec.rb:56[0m [36m# Settlement::City#resource_requirements calculates resource requirements correctly[0m
[31mrspec ./spec/models/settlement/n_p_c_colony_spec.rb:13[0m [36m# Settlement::NPCColony can build a unit[0m
[31mrspec ./spec/models/settlement/n_p_c_colony_spec.rb:19[0m [36m# Settlement::NPCColony can establish trade routes[0m
[31mrspec ./spec/models/settlement/n_p_c_colony_spec.rb:25[0m [36m# Settlement::NPCColony can perform autonomous tasks[0m
[31mrspec ./spec/models/settlement/n_p_c_colony_spec.rb:29[0m [36m# Settlement::NPCColony calculates total population across settlements[0m
[31mrspec ./spec/models/settlement/outpost_spec.rb:27[0m [36m# Settlement::Outpost population capacity calculates total capacity from habitat units[0m
[31mrspec ./spec/models/settlement/outpost_spec.rb:34[0m [36m# Settlement::Outpost population capacity calculates available capacity correctly[0m
[31mrspec ./spec/models/settlement/outpost_spec.rb:40[0m [36m# Settlement::Outpost population capacity checks if it has capacity for additional population[0m
[31mrspec ./spec/models/settlement/settlement_spec.rb:32[0m [36m# Settlement::Settlement population capacity calculates total capacity from habitat units[0m
[31mrspec ./spec/models/settlement/settlement_spec.rb:37[0m [36m# Settlement::Settlement population capacity calculates available capacity correctly[0m
[31mrspec ./spec/models/settlement/settlement_spec.rb:42[0m [36m# Settlement::Settlement population capacity checks if it has capacity for additional population[0m
[31mrspec ./spec/models/shell_printing_job_spec.rb:36[0m [36m# ShellPrintingJob scopes returns active jobs[0m
[31mrspec ./spec/models/shell_printing_job_spec.rb:40[0m [36m# ShellPrintingJob scopes returns completed jobs[0m
[31mrspec ./spec/models/shell_printing_job_spec.rb:44[0m [36m# ShellPrintingJob scopes returns in_progress jobs[0m
[31mrspec ./spec/models/solar_system_spec.rb:48[0m [36m# SolarSystem callbacks generates a unique name before create if name is not present[0m
[31mrspec ./spec/models/solar_system_spec.rb:261[0m [36m# SolarSystem#total_mass calculates total mass of all planets and dwarf planets[0m
[31mrspec ./spec/models/storage/base_storage_spec.rb:8[0m [36m# Storage::BaseStorage#add_item adds item successfully[0m
[31mrspec ./spec/models/storage/base_storage_spec.rb:22[0m [36m# Storage::BaseStorage#remove_item removes item successfully[0m
[31mrspec ./spec/models/storage/base_storage_spec.rb:29[0m [36m# Storage::BaseStorage#remove_item fails to remove item if not enough available[0m
[31mrspec ./spec/models/storage/gas_storage_spec.rb:7[0m [36m# Storage::GasStorage initializes with the correct type[0m
[31mrspec ./spec/models/storage/solid_storage_spec.rb:7[0m [36m# Storage::SolidStorage initializes with the correct type[0m
[31mrspec ./spec/models/storage/surface_storage_spec.rb:66[0m [36m# Storage::SurfaceStorage#check_item_conditions when atmosphere contains corrosive gases applies surface conditions to the item[0m
[31mrspec ./spec/models/storage/surface_storage_spec.rb:78[0m [36m# Storage::SurfaceStorage#check_item_conditions when atmosphere does not contain corrosive gases does not corrode the item[0m
[31mrspec ./spec/models/terrestrial_planets_spec.rb:33[0m [36m# CelestialBodies::TerrestrialPlanet runs TerraSim on planet creation[0m
[31mrspec ./spec/models/terrestrial_planets_spec.rb:9[0m [36m# CelestialBodies::TerrestrialPlanet#update_biomes updates biomes specific to terrestrial planets[0m
[31mrspec ./spec/models/terrestrial_planets_spec.rb:18[0m [36m# CelestialBodies::TerrestrialPlanet#add_gas adds gas and updates the mass[0m
[31mrspec ./spec/models/terrestrial_planets_spec.rb:27[0m [36m# CelestialBodies::TerrestrialPlanet#calculate_surface_conditions calculates surface conditions specific to terrestrial planets[0m
[31mrspec ./spec/models/transaction_spec.rb:24[0m [36m# Transaction associations belongs to an account[0m
[31mrspec ./spec/models/transaction_spec.rb:29[0m [36m# Transaction associations belongs to a recipient[0m
[31mrspec ./spec/models/transaction_spec.rb:36[0m [36m# Transaction validations requires a transaction_type[0m
[31mrspec ./spec/models/transaction_spec.rb:42[0m [36m# Transaction validations requires a valid transaction_type[0m
[31mrspec ./spec/models/transaction_spec.rb:48[0m [36m# Transaction validations requires an amount[0m
[31mrspec ./spec/models/transaction_spec.rb:54[0m [36m# Transaction validations requires amount to be numeric[0m
[31mrspec ./spec/models/transaction_spec.rb:62[0m [36m# Transaction transaction types allows deposit transactions[0m
[31mrspec ./spec/models/transaction_spec.rb:67[0m [36m# Transaction transaction types allows withdraw transactions[0m
[31mrspec ./spec/models/transaction_spec.rb:72[0m [36m# Transaction transaction types allows transfer transactions[0m
[31mrspec ./spec/models/unit_assembly_job_spec.rb:57[0m [36m# UnitAssemblyJob#materials_gathered? returns true when all materials are fulfilled[0m
[31mrspec ./spec/models/unit_assembly_job_spec.rb:98[0m [36m# UnitAssemblyJob#start_assembly starts assembly when materials are gathered[0m
[31mrspec ./spec/models/unit_assembly_job_spec.rb:107[0m [36m# UnitAssemblyJob#start_assembly consumes materials from inventory[0m
[31mrspec ./spec/models/units/base_unit_spec.rb:93[0m [36m# Units::BaseUnit storage operations #store_resource stores oxygen in liquid state[0m
[31mrspec ./spec/models/units/base_unit_spec.rb:156[0m [36m# Units::BaseUnit general storage operations #store_resource can store items up to capacity[0m
[31mrspec ./spec/models/units/base_unit_spec.rb:161[0m [36m# Units::BaseUnit general storage operations #store_resource tracks available capacity[0m
[31mrspec ./spec/models/units/base_unit_spec.rb:174[0m [36m# Units::BaseUnit inventory integration #store_resource creates inventory items when storing resources[0m
[31mrspec ./spec/models/units/base_unit_spec.rb:178[0m [36m# Units::BaseUnit inventory integration #store_resource updates inventory when removing resources[0m
[31mrspec ./spec/models/units/battery_spec.rb:101[0m [36m# Units::Battery interaction with BatteryManagement concern prefers specialized methods over concern methods[0m
[31mrspec ./spec/services/ai_manager/decision_tree_spec.rb:81[0m [36m# AIManager::DecisionTree#handle_mars_oxygen_maintenance calls prioritize_energy_for_o2_generation on resource_planner[0m
[31mrspec ./spec/services/ai_manager/decision_tree_spec.rb:97[0m [36m# AIManager::DecisionTree#handle_mars_nitrogen_import finds closest resource source and creates interplanetary contract[0m
[31mrspec ./spec/services/ai_manager/manifest_parser_spec.rb:10[0m [36m# AIManager::ManifestParser#extract_equipment_from_manifest extracts complete equipment data from manifest[0m
[31mrspec ./spec/services/ai_manager/mission_planner_service_spec.rb:186[0m [36m# AIManager::MissionPlannerService MaterialLookupService integration uses MaterialLookupService to get chemical formulas[0m
[31mrspec ./spec/services/ai_manager/mission_planner_service_spec.rb:200[0m [36m# AIManager::MissionPlannerService MaterialLookupService integration handles materials not in lookup gracefully[0m
[31mrspec ./spec/services/ai_manager/operational_manager_spec.rb:59[0m [36m# AIManager::OperationalManager#make_decision when stable and expansion is feasible considers expansion[0m
[31mrspec ./spec/services/ai_manager/operational_manager_spec.rb:76[0m [36m# AIManager::OperationalManager#make_decision when stable with no expansion opportunities maintains current operations[0m
[31mrspec ./spec/services/ai_manager/operational_manager_spec.rb:181[0m [36m# AIManager::OperationalManager decision logging logs decisions with timestamps and categories[0m
[31mrspec ./spec/services/ai_manager/priority_heuristic_spec.rb:136[0m [36m# AIManager::PriorityHeuristic#get_priorities on Mars when oxygen is critical on Mars returns local_oxygen_generation priority instead of refill_oxygen[0m
[31mrspec ./spec/services/ai_manager/priority_heuristic_spec.rb:160[0m [36m# AIManager::PriorityHeuristic#get_priorities on Mars when nitrogen is critical on Mars returns local_argon_extraction priority[0m
[31mrspec ./spec/services/ai_manager/priority_heuristic_spec.rb:195[0m [36m# AIManager::PriorityHeuristic Environmental System Integration with procedurally generated planet having 95% CO2 and 0.0 Tesla magnetic field correctly chooses local O2 production[0m
[31mrspec ./spec/services/ai_manager/priority_heuristic_spec.rb:219[0m [36m# AIManager::PriorityHeuristic Environmental System Integration with planet having low CO2 and weak magnetic field chooses oxygen refill instead of local generation[0m
[31mrspec ./spec/services/ai_manager/sabatier_refinements_spec.rb:10[0m [36m# AIManager::SystemArchitect Sabatier Refinements #get_maintenance_tax_em applies 25% discount when sabatier units are active[0m
[31mrspec ./spec/services/ai_manager/sabatier_refinements_spec.rb:18[0m [36m# AIManager::SystemArchitect Sabatier Refinements #get_maintenance_tax_em does not apply discount when sabatier units are not active[0m
[31mrspec ./spec/services/ai_manager/system_architect_spec.rb:99[0m [36m# AIManager::SystemArchitect#deploy_subsurface_foothold creates subsurface location[0m
[31mrspec ./spec/services/ai_manager/system_architect_spec.rb:103[0m [36m# AIManager::SystemArchitect#deploy_subsurface_foothold creates settlement[0m
[31mrspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:24[0m [36m# AIManager::SystemIntelligenceService#system_status with operational structures returns correct operational ratio and status[0m
[31mrspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:47[0m [36m# AIManager::SystemIntelligenceService#system_status with all operational structures returns healthy status[0m
[31mrspec ./spec/services/ai_manager/terraforming_manager_spec.rb:17[0m [36m# AIManager::TerraformingManager#calculate_gas_needs with magnetosphere protection returns gas needs for warming phase[0m
[31mrspec ./spec/services/ai_manager/terraforming_manager_spec.rb:106[0m [36m# AIManager::TerraformingManager#determine_terraforming_phase maintenance phase returns maintenance when conditions are met[0m
[31mrspec ./spec/services/ai_manager/terraforming_manager_spec.rb:131[0m [36m# AIManager::TerraformingManager#should_seed_biosphere? without biosphere and suitable conditions returns true[0m
[31mrspec ./spec/services/crater_dome_construction_service_spec.rb:110[0m [36m# CraterDomeConstructionService#construct when entity is different from service provider processes a payment[0m
[31mrspec ./spec/services/fitting_service_spec.rb:30[0m [36m# FittingService fits all components from inventory[0m
[31mrspec ./spec/services/fitting_service_spec.rb:47[0m [36m# FittingService fits components without inventory if inventory is nil[0m
[31mrspec ./spec/services/game_spec.rb:66[0m [36m# Game#advance_by_days advances the simulation by the given number of days[0m
[31mrspec ./spec/services/generators/lava_tube_generator_spec.rb:9[0m [36m# Generators::LavaTubeGenerator#generate with random generation creates a lava tube with random features[0m
[31mrspec ./spec/services/generators/lava_tube_generator_spec.rb:21[0m [36m# Generators::LavaTubeGenerator#generate with random generation generates random dimensions[0m
[31mrspec ./spec/services/generators/lava_tube_generator_spec.rb:30[0m [36m# Generators::LavaTubeGenerator#generate with random generation generates random attributes[0m
[31mrspec ./spec/services/generators/lava_tube_generator_spec.rb:88[0m [36m# Generators::LavaTubeGenerator#generate with predefined parameters creates a lava tube with specified parameters[0m
[31mrspec ./spec/services/generators/lava_tube_generator_spec.rb:108[0m [36m# Generators::LavaTubeGenerator#generate with predefined parameters creates predefined skylights and access points[0m
[31mrspec ./spec/services/generators/lava_tube_generator_spec.rb:127[0m [36m# Generators::LavaTubeGenerator#generate with minimal parameters creates a lava tube with defaults[0m
[31mrspec ./spec/services/generators/valley_generator_spec.rb:8[0m [36m# Generators::ValleyGenerator#generate with random generation creates a valley with random features[0m
[31mrspec ./spec/services/generators/valley_generator_spec.rb:20[0m [36m# Generators::ValleyGenerator#generate with random generation generates random dimensions[0m
[31mrspec ./spec/services/generators/valley_generator_spec.rb:29[0m [36m# Generators::ValleyGenerator#generate with random generation generates segments[0m
[31mrspec ./spec/services/generators/valley_generator_spec.rb:81[0m [36m# Generators::ValleyGenerator#generate with predefined parameters creates a valley with specified parameters[0m
[31mrspec ./spec/services/generators/valley_generator_spec.rb:95[0m [36m# Generators::ValleyGenerator#generate with predefined parameters creates predefined access points[0m
[31mrspec ./spec/services/logistics/contract_service_spec.rb:18[0m [36m# Logistics::ContractService.create_internal_transfer with valid settlements creates a logistics contract for internal transfer[0m
[31mrspec ./spec/services/logistics/inventory_manager_spec.rb:23[0m [36m# Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects intercepts materials for orbital construction[0m
[31mrspec ./spec/services/logistics/inventory_manager_spec.rb:40[0m [36m# Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects does not add materials to station inventory if all consumed by projects[0m
[31mrspec ./spec/services/logistics/inventory_manager_spec.rb:62[0m [36m# Logistics::InventoryManager.transfer_item when transferring orbital construction materials to non-orbital settlement transfers materials normally without interception[0m
[31mrspec ./spec/services/logistics/inventory_manager_spec.rb:81[0m [36m# Logistics::InventoryManager.transfer_item when transferring non-orbital materials to orbital station transfers materials normally without interception[0m
[31mrspec ./spec/services/lookup/craft_lookup_service_spec.rb:7[0m [36m# Lookup::CraftLookupService#find_craft loads crafts from the correct file structure[0m
[31mrspec ./spec/services/lookup/craft_lookup_service_spec.rb:200[0m [36m# Lookup::CraftLookupService#debug_paths outputs correct path information[0m
[31mrspec ./spec/services/lookup/item_lookup_service_spec.rb:8[0m [36m# Lookup::ItemLookupService#find_item loads items from the correct file structure[0m
[31mrspec ./spec/services/lookup/item_lookup_service_spec.rb:61[0m [36m# Lookup::ItemLookupService#find_item handles scrap items dynamically[0m
[31mrspec ./spec/services/lookup/item_lookup_service_spec.rb:124[0m [36m# Lookup::ItemLookupService dynamic item creation creates scrap items on the fly[0m
[31mrspec ./spec/services/lookup/item_lookup_service_spec.rb:132[0m [36m# Lookup::ItemLookupService dynamic item creation creates processed items on the fly[0m
[31mrspec ./spec/services/lookup/item_lookup_service_spec.rb:140[0m [36m# Lookup::ItemLookupService dynamic item creation creates used items on the fly[0m
[31mrspec ./spec/services/lookup/material_lookup_service_spec.rb:38[0m [36m# Lookup::MaterialLookupService#find_material loads materials from the correct file structure[0m
[31mrspec ./spec/services/lookup/material_lookup_service_spec.rb:43[0m [36m# Lookup::MaterialLookupService#find_material finds atmospheric gases by chemical formula[0m
[31mrspec ./spec/services/lookup/material_lookup_service_spec.rb:51[0m [36m# Lookup::MaterialLookupService#find_material finds materials case-insensitively[0m
[31mrspec ./spec/services/lookup/material_lookup_service_spec.rb:207[0m [36m# Lookup::MaterialLookupService.locate_gases_path uses GalaxyGame::Paths consistently[0m
[31mrspec ./spec/services/lookup/material_lookup_service_spec.rb:254[0m [36m# Lookup::MaterialLookupService error handling with corrupted JSON files handles JSON parsing errors gracefully[0m
[31mrspec ./spec/services/lookup/material_lookup_service_spec.rb:322[0m [36m# Lookup::MaterialLookupService integration with AtmosphereConcern provides materials needed for atmospheric calculations[0m
[31mrspec ./spec/services/lookup/module_lookup_service_spec.rb:8[0m [36m# Lookup::ModuleLookupService#find_module loads modules from the correct file structure[0m
[31mrspec ./spec/services/lookup/module_lookup_service_spec.rb:16[0m [36m# Lookup::ModuleLookupService#find_module finds modules by module_type[0m
[31mrspec ./spec/services/lookup/module_lookup_service_spec.rb:49[0m [36m# Lookup::ModuleLookupService service configuration has the correct base path[0m
[31mrspec ./spec/services/lookup/unit_lookup_service_spec.rb:38[0m [36m# Lookup::UnitLookupService#find_unit loads units from the correct file structure[0m
[31mrspec ./spec/services/manfacturing_service_spec.rb:52[0m [36m# ManufacturingService.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint[0m
[31mrspec ./spec/services/manfacturing_service_spec.rb:112[0m [36m# ManufacturingService.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost[0m
[31mrspec ./spec/services/manfacturing_service_spec.rb:138[0m [36m# ManufacturingService.manufacture with different construction cost percentages uses settlement's custom construction percentage[0m
[31mrspec ./spec/services/manfacturing_service_spec.rb:208[0m [36m# ManufacturingService.manufacture with real blueprint data automatically fulfills material requirements when materials are available[0m
[31mrspec ./spec/services/manfacturing_service_spec.rb:266[0m [36m# ManufacturingService.manufacture with real blueprint data stores actual blueprint data in specifications[0m
[31mrspec ./spec/services/manufacturing/assembly_service_spec.rb:56[0m [36m# Manufacturing::AssemblyService.start_assembly with all materials available charges the tenant fee[0m
[31mrspec ./spec/services/manufacturing/component_production_integration_spec.rb:23[0m [36m# Component Production Integration with real blueprint files finds the 3d_printed_ibeam_mk1 blueprint[0m
[31mrspec ./spec/services/manufacturing/component_production_integration_spec.rb:82[0m [36m# Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) creates a production job using real blueprint[0m
[31mrspec ./spec/services/manufacturing/component_production_integration_spec.rb:93[0m [36m# Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) consumes depleted_regolith from inventory[0m
[31mrspec ./spec/services/manufacturing/cost_calculator_spec.rb:65[0m [36m# Manufacturing::CostCalculator Earth-Imported COGS (EAP-COGS) calculates the EAP-COGS (Earth Import Cost) for the unit[0m
[31mrspec ./spec/services/manufacturing/cost_calculator_spec.rb:86[0m [36m# Manufacturing::CostCalculator Local Production COGS (LAP-COGS) calculates the LAP-COGS (Local Production Cost) for the unit[0m
[31mrspec ./spec/services/manufacturing/material_request_system_spec.rb:8[0m [36m# Manufacturing::MaterialRequest.create_material_requests creates requests for all required materials[0m
[31mrspec ./spec/services/manufacturing/processing_spec.rb:101[0m [36m# Manufacturing::Processing#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items[0m
[31mrspec ./spec/services/manufacturing/processing_spec.rb:114[0m [36m# Manufacturing::Processing#process when owner does not have enough resources returns an error when resources are insufficient[0m
[31mrspec ./spec/services/manufacturing/processing_spec.rb:126[0m [36m# Manufacturing::Processing#process when owner does not have enough GCC raises an error when GCC is insufficient[0m
[31mrspec ./spec/services/manufacturing/service_spec.rb:110[0m [36m# Manufacturing::Service.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost[0m
[31mrspec ./spec/services/manufacturing/service_spec.rb:136[0m [36m# Manufacturing::Service.manufacture with different construction cost percentages uses settlement's custom construction percentage[0m
[31mrspec ./spec/services/manufacturing/service_spec.rb:206[0m [36m# Manufacturing::Service.manufacture with real blueprint data automatically fulfills material requirements when materials are available[0m
[31mrspec ./spec/services/manufacturing/service_spec.rb:268[0m [36m# Manufacturing::Service.manufacture with real blueprint data stores actual blueprint data in specifications[0m
[31mrspec ./spec/services/market/trade_execution_service_spec.rb:87[0m [36m# Market::TradeExecutionService returns true on successful execution[0m
[31mrspec ./spec/services/market/trade_execution_service_spec.rb:93[0m [36m# Market::TradeExecutionService calls the TaxCollectionService with gross revenue and seller[0m
[31mrspec ./spec/services/market/trade_execution_service_spec.rb:103[0m [36m# Market::TradeExecutionService calls TransactionManager.create_transfer with the NET amount[0m
[31mrspec ./spec/services/market/trade_execution_service_spec.rb:119[0m [36m# Market::TradeExecutionService removes inventory from seller[0m
[31mrspec ./spec/services/market/trade_execution_service_spec.rb:124[0m [36m# Market::TradeExecutionService creates a trade record[0m
[31mrspec ./spec/services/market/trade_execution_service_spec.rb:129[0m [36m# Market::TradeExecutionService creates a price history record[0m
[31mrspec ./spec/services/market/trade_execution_service_spec.rb:134[0m [36m# Market::TradeExecutionService creates a supply chain record[0m
[31mrspec ./spec/services/material_generator_service_spec.rb:22[0m [36m# MaterialGeneratorService.generate_material returns material data for water[0m
[31mrspec ./spec/services/material_lookup_service_spec.rb:15[0m [36m# MaterialLookupService#find_material returns the correct material[0m
[31mrspec ./spec/services/material_lookup_service_spec.rb:21[0m [36m# MaterialLookupService#find_material returns nil for a nonexistent material[0m
[31mrspec ./spec/services/material_request_service_spec.rb:8[0m [36m# MaterialRequestService.create_material_requests creates requests for all required materials[0m
[31mrspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:21[0m [36m# Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available sources gases from depot tanks[0m
[31mrspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:27[0m [36m# Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available uses depot tank gases for pressurization[0m
[31mrspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:59[0m [36m# Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks aggregates gases from all depot tanks[0m
[31mrspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:66[0m [36m# Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks returns empty hash when no gases are stored[0m
[31mrspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:92[0m [36m# Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when depot tanks have no gas_storage data returns empty hash[0m
[31mrspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:108[0m [36m# Pressurization::StructurePressurizationService mining byproduct integration when mining Si produces O2 byproduct increases available gases from depot tanks for pressurization[0m
[31mrspec ./spec/services/processing_service_spec.rb:101[0m [36m# ProcessingService#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items[0m
[31mrspec ./spec/services/processing_service_spec.rb:114[0m [36m# ProcessingService#process when owner does not have enough resources returns an error when resources are insufficient[0m
[31mrspec ./spec/services/processing_service_spec.rb:126[0m [36m# ProcessingService#process when owner does not have enough GCC raises an error when GCC is insufficient[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:144[0m [36m# StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates uses templates for approximately 40% of planets[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:163[0m [36m# StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests terraformed names for template-based planets[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:175[0m [36m# StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests neutral names for procedural planets[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:187[0m [36m# StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates applies orbital optimization for template-based planets[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:201[0m [36m# StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates generates procedural planets when not using templates[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:313[0m [36m# StarSim::ProceduralGenerator#generate_biosphere_data provides enhanced biosphere for template-based planets[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:328[0m [36m# StarSim::ProceduralGenerator#generate_biosphere_data provides basic biosphere for planets with good conditions[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:341[0m [36m# StarSim::ProceduralGenerator#generate_biosphere_data returns empty biosphere for unsuitable planets[0m
[31mrspec ./spec/services/star_sim/procedural_generator_spec.rb:447[0m [36m# StarSim::ProceduralGenerator integration test generates a complete, valid system[0m
[31mrspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:214[0m [36m# TerraSim::BiosphereSimulationService#influence_atmosphere simulates gas exchange with the atmosphere[0m
[31mrspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:390[0m [36m# TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms uses life form effects when available[0m
[31mrspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:418[0m [36m# TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms scales effects by time[0m
[31mrspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:451[0m [36m# TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms falls back to hardcoded values when no life forms[0m
[31mrspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:470[0m [36m# TerraSim::BiosphereSimulationService terraforming integration #simulate with time parameter stores time_skipped for use in other methods[0m
[31mrspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:88[0m [36m# TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants[0m
[31mrspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:159[0m [36m# TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for planets with atmospheres[0m
[31mrspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:175[0m [36m# TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for airless bodies[0m
[31mrspec ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:50[0m [36m# TerraSim::GeosphereSimulationService#simulate_tectonic_activity updates plate positions when tectonic activity is enabled[0m
[31mrspec ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:114[0m [36m# TerraSim::GeosphereSimulationService#eruption adds volcanic gases to the atmosphere[0m
[31mrspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:226[0m [36m# TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing melts ice from polar caps[0m
[31mrspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:237[0m [36m# TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to decrease solid percentage[0m
[31mrspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:248[0m [36m# TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to increase liquid percentage[0m
[31mrspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:272[0m [36m# TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing adds some melted water as vapor to atmosphere[0m
[31mrspec ./spec/services/terra_sim/simulator_spec.rb:70[0m [36m# TerraSim::Simulator#calc_current when star is present updates the surface temperature[0m
[31mrspec ./spec/services/terra_sim/simulator_spec.rb:109[0m [36m# TerraSim::Simulator#calc_current when no star is present sets the temperature to space background temperature[0m
[31mrspec ./spec/services/wormhole_consortium_formation_service_spec.rb:10[0m [36m# WormholeConsortiumFormationService creates memberships for founding members and updates consortium operational_data[0m
[31mrspec ./spec/services/wormhole_consortium_formation_service_spec.rb:21[0m [36m# WormholeConsortiumFormationService updates member operational_data with consortium membership[0m

