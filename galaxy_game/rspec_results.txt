
GameController
  GET #index
    initializes a game state if none exists
    uses an existing game state if one exists
    updates time if game is running
    doesn't update time if game is not running
    solar system seeding and display
      assigns the Sol solar system and its celestial bodies
      calls SystemBuilderService to build the system if no solar system exists (FAILED - 1)
      correctly calculates @planet_count excluding satellites (FAILED - 2)
      defines is_moon and body_category singleton methods on celestial bodies (FAILED - 3)
      generates correct JSON with parent_body_identifier for moons (FAILED - 4)
      returns JSON with correct celestial bodies data (FAILED - 5)
      logs celestial body attributes for debugging
  POST #toggle_running
    toggles the running state from false to true (FAILED - 6)
    toggles the running state from true to false (FAILED - 7)
    returns JSON with the updated state (FAILED - 8)
  POST #set_speed
    updates the game speed (FAILED - 9)
    clamps the speed value between 1 and 5 (FAILED - 10)
  POST #jump_time
    adds the specified number of days (FAILED - 11)
    handles year rollover (FAILED - 12)
    clamps days between 1 and 365 (FAILED - 13)
  GET #state
    returns the current game state (FAILED - 14)
    updates time if running (FAILED - 15)
  GET #simulation
    assigns the correct solar system and its primary star (FAILED - 16)
    redirects to root_path if solar system not found (FAILED - 17)
  GET #index edge cases
    handles missing solar system gracefully (FAILED - 18)
    handles celestial bodies with no parent or atmosphere
  private get_or_create_game_state
    creates a new game state if none exists (FAILED - 19)
    returns the existing game state if present (FAILED - 20)

SimulationController
  GET #index
    with existing solar system
      assigns solar system and its celestial bodies
      assigns the primary star
    without solar system
      assigns all celestial bodies
  GET #run
    runs simulation for specific celestial body
    handles errors gracefully
  GET #run_all
    with existing solar system
      runs simulation for all celestial bodies
    without solar system
      handles missing solar system gracefully

StarsController
  GET #index
    returns a success response
  GET #show
    returns a success response
  POST #create
    with valid parameters
      creates a new Star
      renders a JSON response with the new star
    with invalid parameters
      renders a JSON response with errors for the new star
  PATCH/PUT #update
    with valid parameters
      updates the requested star
      renders a JSON response with the star
    with invalid parameters
      renders a JSON response with errors for the star
  DELETE #destroy
    destroys the requested star

TerrestrialPlanetsController
  GET #index
    returns a success response
  GET #show
    returns a success response
  POST #create
    with valid parameters
      creates a new TerrestrialPlanet with star distance
      renders a JSON response with the new terrestrial_planet
    with invalid parameters
      renders a JSON response with errors for the new terrestrial_planet
  PATCH/PUT #update
    with valid parameters
      updates the requested terrestrial_planet
      renders a JSON response with the terrestrial_planet
    with invalid parameters
      renders a JSON response with errors for the terrestrial_planet
  DELETE #destroy
    destroys the requested terrestrial_planet
    returns a no content response

TransactionsController
  POST #create
    with valid parameters
      creates a new financial transaction (FAILED - 21)
      creates the transaction with correct account information and amount (FAILED - 22)
      does not attempt to collect tax (enforces separation of concerns) (FAILED - 23)
      returns a success message (FAILED - 24)
    with invalid parameters
      does not create a transaction if amount is missing (FAILED - 25)
      returns an error message if amount is missing or invalid (FAILED - 26)

Alien World Template Integrity
  template file exists (FAILED - 27)
  is valid JSON (FAILED - 28)
  contains terrestrial_planets array (FAILED - 29)
  contains exactly 25 templates (A01 → A25) (FAILED - 30)
  has unique identifiers (FAILED - 31)
  has unique template names (FAILED - 32)
  required schema fields
    each template contains all required fields (FAILED - 33)
  atmosphere rules
    contains no oxygen by default (FAILED - 34)
    has pressure > 0 (FAILED - 35)
  terraforming metadata
    terraforming_difficulty is between 1 and 10 (FAILED - 36)
    engineered_atmosphere defaults to false (FAILED - 37)
  volatile reservoirs
    has CO2 and H2O reservoirs defined (FAILED - 38)
  material yield bias
    contains all yield bias categories (FAILED - 39)

Alien World Templates Integrity
  exists and is valid JSON (FAILED - 40)
  metadata
    exists (FAILED - 41)
    has required fields (FAILED - 42)
    is versioned correctly (FAILED - 43)
  terrestrial planet templates
    exists and is an array (FAILED - 44)
    contains exactly 25 templates (FAILED - 45)
    has unique identifiers (FAILED - 46)
    covers Template-A01 through Template-A25 (FAILED - 47)
    all templates are terrestrial (FAILED - 48)
  template schema validation
    each template contains all required fields (FAILED - 49)
  atmospheric constraints
    contains no oxygen by default (FAILED - 50)
  sanity checks
    has realistic gravity values (FAILED - 51)
    has positive pressure (FAILED - 52)
    terraforming difficulty is bounded (FAILED - 53)

TerrestrialPlanets
  User views a planet detail
  User updates a planet's name only
  User updates a planet with all attributes

GameDataPaths
  sets the correct path based on environment (FAILED - 54)

Component Production Game Loop Integration
  full production cycle
    produces components through game loop progression (FAILED - 55)
    handles partial progress over multiple ticks (FAILED - 56)
    processes multiple jobs simultaneously (FAILED - 57)

Covering System Integration
  Lava tube worldhouse covering workflow
    seals skylights when worldhouse construction completes (FAILED - 58)
  Worldhouse segment covering workflow
    handles massive scale covering (FAILED - 59)
  Multi-scale comparison
    uses same system for different scales (FAILED - 60)

Manufacturing Pipeline End-to-End
  complete ISRU to enclosed tank pipeline
    processes raw regolith through all stages to produce an enclosed tank (FAILED - 61)
  pipeline with multiple batches
    can process multiple batches concurrently
  material tracking through pipeline
    preserves composition metadata through processing chain (FAILED - 62)

Shell Printing Game Loop Integration
  full shell printing cycle
    encloses inflatable tank through game loop progression
    tracks material composition in shell metadata

Terraforming Integration
  end-to-end terraforming simulation
    creates a barren planet with correct initial conditions (FAILED - 63)
    with starter ecosystem deployed
      deploys life forms successfully
      life forms have atmospheric contribution
      simulation over time
        increases oxygen levels after 1 day (FAILED - 64)
        decreases CO2 levels after 1 day (FAILED - 65)
        shows progressive changes over 100 days (FAILED - 66)
        scales effects by time parameter (FAILED - 67)
      life form populations over time
        maintains or grows populations under favorable conditions (FAILED - 68)
      combined effects from multiple species
        aggregates atmospheric effects from all life forms (FAILED - 69)
    without life forms
      uses fallback values when no terraforming organisms exist (FAILED - 70)
  realistic terraforming scenario
    demonstrates full terraforming workflow (FAILED - 71)

Terraforming Workflow Integration
  transforms atmosphere over time with deployed organisms (FAILED - 72)
  allows monitoring of terraforming progress (FAILED - 73)

ConcurrentTaskWorkerJob
  #perform
    with manufacturing task during daylight
      executes the task successfully (FAILED - 74)
      generates manufacturing byproducts (FAILED - 75)
    with manufacturing task during low light
      does not generate byproducts (FAILED - 76)
    with non-manufacturing task
      does not attempt byproduct generation (FAILED - 77)
    when task execution fails
      does not mark task as completed

Account
  associations
    is expected to belong to accountable required: true
    is expected to have many transactions dependent => destroy
  validations
    is expected to validate that :balance looks like a number greater than or equal to 0
  #deposit
    with a valid amount
      increases the account balance (FAILED - 78)
    with an invalid amount (negative)
      raises an error and does not modify the balance (FAILED - 79)
  #withdraw
    when funds are sufficient
      decreases the account balance (FAILED - 80)
    when funds are insufficient
      raises an error and does not modify the balance (FAILED - 81)
  #transfer_funds
    when funds are sufficient
      transfers the amount from one account to another (FAILED - 82)
    when funds are insufficient
      raises an error and does not modify balances (FAILED - 83)
  edge cases
    when balance is exactly zero
      prevents withdrawals or transfers (FAILED - 84)
      allows deposits (FAILED - 85)
  different accountable types
    works with a player account (FAILED - 86)
    works with a settlement account (FAILED - 87)
    works with an organization account (FAILED - 88)

Atmosphere
  associations
    is expected to belong to celestial_body optional: true
    is expected to have many gases class_name => CelestialBodies::Materials::Gas dependent => destroy
  validations
    example at ./spec/models/atmosphere_spec.rb:31 (FAILED - 89)
    example at ./spec/models/atmosphere_spec.rb:32 (FAILED - 90)
    example at ./spec/models/atmosphere_spec.rb:33 (FAILED - 91)
    example at ./spec/models/atmosphere_spec.rb:34 (FAILED - 92)
  enums
    defines environment_type enum with string values
  #volume
    when celestial_body responds to volume
      returns the celestial_body's volume (FAILED - 93)
    when celestial_body doesn't respond to volume
      returns 0
  sealing methods
    #sealed?
      returns the sealing status (FAILED - 94)
    #seal!
      sets sealing status to true (FAILED - 95)
    #unseal!
      sets sealing status to false (FAILED - 96)
  #habitable?
    with good conditions
      returns true (FAILED - 97)
    with low pressure
      returns false (FAILED - 98)
    with low oxygen
      returns false (FAILED - 99)
    with high CO2
      returns false (FAILED - 100)
    with extreme temperature
      returns false for too cold (FAILED - 101)
      returns false for too hot (FAILED - 102)
  AtmosphereConcern inclusion
    includes AtmosphereConcern methods (FAILED - 103)
  JSON fields
    initializes JSON fields with empty objects (FAILED - 104)
    allows storing data in JSON fields (FAILED - 105)
  parent validation
    requires exactly one parent
    rejects multiple parents (FAILED - 106)

Units::BiogasGenerator
  #operate
    consumes biomass, organic waste, and energy, producing biogas and fertilizer (FAILED - 107)
    returns false if insufficient biomass is available (FAILED - 108)
    returns false if insufficient organic waste is available (FAILED - 109)
    returns false if insufficient energy is available (FAILED - 110)

Biology::BaseLifeForm
  associations
    is expected to belong to biosphere required: true
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :population looks like a number greater than or equal to 0
  enums
    is expected to define :complexity as an enum backed by an integer with values ‹{microbial: 0, simple: 1, complex: 2, intelligent: 3}›
    is expected to define :domain as an enum backed by an integer with values ‹{aquatic: 0, terrestrial: 1, aerial: 2, subterranean: 3}›
  attributes
    stores additional properties in the properties column
    stores terraforming properties
  #total_biomass
    calculates biomass differently based on complexity
  #atmospheric_contribution
    with terraforming properties set
      calculates atmospheric effects based on population
      scales effects by population size
    with zero population
      returns zero effects
    without terraforming properties
      returns zero effects
  #type_identifier
    raises NotImplementedError when called on base class

Biosphere and Life Form Integration
  ecosystem simulation
    simulates population dynamics (FAILED - 111)
    handles biosphere changes
  food availability calculation
    calculates food availability for herbivores
    calculates food availability for carnivores
    returns nil for photosynthetic life forms
  environmental impact
    calculates the environmental impact of a life form
    considers soil impact for decomposers
  environmental impact
    calculates the environmental impact of a life form
    considers soil impact for decomposers
  interactions
    handles interactions between different life forms

Biology::LifeForm
  inheritance
    inherits from BaseLifeForm
  #type_identifier
    returns 'natural'
  #adapt_to_environment
    with poor adaptation score
      reduces population
    with neutral adaptation score
      keeps population stable
    with good adaptation score
      increases population
  #simulate_growth
    uses _calculate_base_growth_rate to modify population
    is affected by biosphere habitability
  #total_biomass
    with custom mass in properties
      uses custom mass instead of complexity-based calculation
    without custom mass in properties
      falls back to complexity-based calculation
  #atmospheric_contribution
    with no population
      returns zero contribution
    with photosynthetic organism
      calculates oxygen production and CO2 consumption
    with methane-producing organism
      calculates methane production
    with nitrogen-fixing organism
      calculates nitrogen fixation
    with soil-improving organism
      calculates soil improvement
    with multiple effects
      returns all contributions
    with population scaling
      scales contributions by population size

Biology::LifeFormParent
  associations
    is expected to belong to parent class_name => Biology::BaseLifeForm required: true
    is expected to belong to child class_name => Biology::BaseLifeForm required: true
  table name
    uses the correct table name

Biology::LifeForm
  inheritance
    inherits from BaseLifeForm
  #type_identifier
    returns 'natural'
  #adapt_to_environment
    with poor adaptation score
      reduces population
    with neutral adaptation score
      keeps population stable
    with good adaptation score
      increases population
  #simulate_growth
    uses _calculate_base_growth_rate to modify population
    is affected by biosphere habitability
  #total_biomass
    with custom mass in properties
      uses custom mass instead of complexity-based calculation
    without custom mass in properties
      falls back to complexity-based calculation

Units::BiomassRecycler
  #operate
    consumes biomass and energy, producing fertilizer and biofuel (FAILED - 112)
    returns false if insufficient biomass is available (FAILED - 113)
    returns false if insufficient energy is available (FAILED - 114)

Biome
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without a temperature range
    is not valid without a humidity range
    is not valid with a duplicate name
  associations
    has many planet_biomes
    has many celestial_bodies through planet_biomes
  .biomes_for_conditions
    returns biomes matching the temperature and humidity conditions
    returns an empty array when no biomes match the conditions
  suitability
    returns true when the biome is suitable for the given conditions
    returns false when the biome is not suitable for the given conditions
    returns true for suitable conditions in Kelvin

CelestialBodies::Spheres::Biosphere
  is expected to belong to celestial_body required: true
  is valid with valid attributes
  is not valid without a celestial_body

Blueprint
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :current_research_level looks like a number greater than or equal to 0
    is expected to validate that :material_efficiency looks like a number greater than or equal to 0
    is expected to validate that :time_efficiency looks like a number greater than or equal to 0
  #materials
    returns a hash of required materials from JSON
  #calculate_efficiencies
    calculates material and time efficiencies based on research level

CelestialBodies::AlienLifeForm
  associations
    is expected to belong to biosphere class_name => CelestialBodies::Spheres::Biosphere required: true
  enums
    is expected to define :complexity as an enum backed by an integer with values ‹[:microbial, :simple, :complex, :intelligent]›
    is expected to define :domain as an enum backed by an integer with values ‹[:aquatic, :terrestrial, :aerial, :subterranean]›
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :population looks like a number greater than or equal to 0
  store_accessors
    should define store accessors for description, biochemistry, and ecological_role
  #simulate_growth
    should update the population based on growth rate
    should save the updated population

CelestialBodies::BrownDwarf
  validations
    is valid with default attributes
    allows nil orbital_period
    validates orbital_period is greater than or equal to 0 when present
  default attributes
    sets default spectral type
    sets default luminosity
    sets default effective temperature
  #is_star?
    returns false
  #is_orbiting_star?
    returns false for isolated brown dwarfs
    returns true for brown dwarfs in a solar system
  #distance_from_star
    returns nil for isolated brown dwarfs
    when part of a solar system
      delegates to super when orbiting a star
      returns nil when no star distances exist
  physical properties
    has appropriate mass for a brown dwarf
    has appropriate surface temperature for a brown dwarf
  atmospheric and other properties
    can have an atmosphere
  habitable zones
    has a limited habitable zone (PENDING: Habitable zone calculations not yet implemented for brown dwarfs)
  relationships with planets
    can have orbiting planets (PENDING: Brown dwarf planetary systems not yet implemented)

CelestialBodies::CelestialBody
  associations
    is expected to belong to solar_system optional: true
    is expected to have one spatial_location dependent => destroy
    is expected to have many locations dependent => destroy
    is expected to have one atmosphere dependent => destroy
    is expected to have one biosphere dependent => destroy
    is expected to have one geosphere dependent => destroy
    is expected to have one hydrosphere dependent => destroy
  material management
    #add_material
      creates or updates material properly
      updates atmosphere gases if material is a gas
    #remove_material
      reduces material amount and deletes if zero
      updates atmosphere gases accordingly
  calculated properties
    calculates surface_area correctly
    calculates volume correctly
    calculates escape_velocity correctly
  #distance_from_star
    returns nil if no star distance
    returns distance when star_distances present
  #is_moon
    returns false for normal celestial bodies
    returns true if type is moon
  properties JSONB accessors
    can read and write last_simulated_at
  #planet_class?
    returns true for a planet type
    returns false for nil type
    returns false for non-planet type
  #should_simulate?
    returns false if not active
    returns false if radius is too small
    returns true for planet_class? or is_moon
    returns true if force_simulate property is set

CelestialBodies::Features::AccessPoint
  associations
    is expected to belong to parent_feature optional: true
  #set_feature_type
    automatically sets feature_type
  #sealed?
    returns false when natural
    returns true when enclosed
  #area_m2
    calculates area from length and width
    calculates area from diameter if no length/width

CelestialBodies::Features::AdaptedFeature
  validations
    is expected to validate that :feature_id cannot be empty/falsy
    is expected to validate that :feature_type cannot be empty/falsy
    is expected to belong to celestial_body required: true
  attributes
    has a default status of natural
    can set and get adapted_at
    can set and get settlement_id
    can set and get discovered_by
  #static_data
    returns static data hash
  #name
    returns the name from static data
  #coordinates
    returns coordinates from static data
  #feature_specific_data
    returns the full static data hash

CelestialBodies::Features::BaseFeature
  associations
    is expected to belong to celestial_body required: true
    is expected to belong to parent_feature optional: true
    is expected to have many child_features
  validations
    is expected to validate that :feature_id cannot be empty/falsy
    is expected to validate that :feature_type cannot be empty/falsy
    is expected to validate that :status cannot be empty/falsy
  #static_data
    fetches data from lookup service (FAILED - 115)
    caches the data (FAILED - 116)
  #discover!
    marks feature as discovered (FAILED - 117)
    sets discovered_at timestamp (FAILED - 118)
    does not overwrite existing discovery (FAILED - 119)
  status transitions
    transitions through states correctly (FAILED - 120)
    cannot skip states (FAILED - 121)
  tier helpers
    identifies strategic features (FAILED - 122)
    identifies catalog features

CelestialBodies::Features::Canyon
  validations
    is valid with valid attributes
    sets feature_type to canyon before validation
  dimensions
    returns correct length_m
    returns correct width_m
    returns correct depth_m
    returns correct volume_m3
  #formation
    returns the formation type
  #conversion_suitability
    returns the conversion suitability hash
  #segments
    returns the segments array
  #can_pressurize_section?
    returns false if not enclosed or openings not sealed
    returns true if enclosed and all openings sealed

CelestialBodies::Features::Cave
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  #cave_type
    returns cave type
  #conversion_suitability
    returns suitability data
  #can_pressurize?
    returns false when not enclosed or openings not sealed

CelestialBodies::Features::Crater
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  ice detection
    detects ice presence
    returns ice quantities
  #permanently_shadowed?
    returns true for Shackleton
  #solar_exposure_percent
    returns solar exposure data
  #conversion_suitability
    returns dome suitability
    returns advantages and challenges
  #size_category
    categorizes crater size
  #strategic_value
    includes water_ice for Shackleton

CelestialBodies::Features::LavaTube
  associations
    is expected to have many skylights
    is expected to have many access_points
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  #conversion_suitability
    returns suitability data
  #natural_openings
    returns openings from static data
  #create_openings_from_static_data!
    creates child opening features
    creates skylights for skylight openings
  #can_pressurize?
    returns false if openings are not sealed
    returns true when all openings are sealed
  #strategic_value
    returns strategic value array

CelestialBodies::Features::Skylight
  associations
    is expected to belong to parent_feature optional: true
  #set_feature_type
    automatically sets feature_type
  #parent_lava_tube
    returns the parent lava tube
  #area_m2
    calculates area from diameter
  #covered?
    returns false when natural
    returns true when enclosed
    returns true when pressurized

CelestialBodies::Features::Valley
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  #formation
    returns formation type
  #conversion_suitability
    returns suitability data
  #calculate_construction_segments
    returns predefined segments from static data

CelestialBodies::Material
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without an amount
    is not valid with a negative amount
    is valid with a valid state (solid, liquid, gas)
  associations
    belongs to a celestial body

CelestialBodies::Materials::Base
  inherits from the original Material class
  uses the materials table

CelestialBodies::Materials::ExoticMaterial
  uses the exotic_materials table
  associations
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:25 (FAILED - 123)
  validations
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:29 (FAILED - 124)
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:30 (FAILED - 125)
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:31 (FAILED - 126)
  state helper methods
    identifies metallic hydrogen state (FAILED - 127)
    identifies plasma state (FAILED - 128)
  #phase_transition_at
    returns metallic_hydrogen for hydrogen at extreme pressure (FAILED - 129)
    returns plasma at extreme temperatures (FAILED - 130)
    returns superfluid for helium at low temperatures (FAILED - 131)
    falls back to standard states otherwise (FAILED - 132)

CelestialBodies::Materials::Gas
  uses the gases table
  has the same behavior as the original Gas model
  associations
    belongs to atmosphere
    can be accessed through atmosphere.gases (FAILED - 133)
  validations
    is not valid without a name
    is not valid with a negative percentage
    is not valid with a percentage over 100
    is not valid with a negative mass
    is not valid with a negative ppm
  #moles
    calculates moles from mass and molar mass
    returns 0 if mass is nil
    returns 0 if molar_mass is nil
  before_validation callback
    sets molar_mass from material lookup if blank
    does not override existing molar_mass

CelestialBodies::Materials::GeologicalMaterial
  uses the geological_materials table
  associations
    belongs to geosphere
    can be accessed through geosphere.geological_materials (FAILED - 134)
  validations
    is not valid without a name (FAILED - 135)
    is not valid with an invalid layer (FAILED - 136)
    is not valid with a negative percentage (FAILED - 137)
    is not valid with a percentage over 100 (FAILED - 138)
    is not valid with a negative mass (FAILED - 139)
    is not valid with an invalid state (FAILED - 140)
  state helper methods
    returns true for solid? when state is 'solid'
    returns true for liquid? when state is 'liquid'
    returns true for gas? when state is 'gas'
  exotic state handling
    correctly reports state for exotic materials
    handles metallic hydrogen specifically
    handles plasma state

CelestialBodies::Materials::Liquid
  uses the liquid_materials table
  associations
    is expected to belong to hydrosphere required: true (FAILED - 141)
    associates with the correct class name
    can be accessed through hydrosphere.liquid_materials (FAILED - 142)
  validations
    is valid with valid attributes (FAILED - 143)
    is not valid without a name (FAILED - 144)
    is not valid without an amount (FAILED - 145)
    is not valid with a negative amount (FAILED - 146)

CelestialBodies::MinorBodies::DwarfPlanet
  validations
    is valid with valid attributes (FAILED - 147)
  #is_spherical?
    returns true for dwarf planets (FAILED - 148)
  #calculate_geological_activity
    calculates geological activity based on mass and age (FAILED - 149)

CelestialBodies::PlanetBiome
  has access to celestial_body through biosphere (FAILED - 150)
  associations
    example at ./spec/models/celestial_bodies/planet_biome_spec.rb:22 (FAILED - 151)
    example at ./spec/models/celestial_bodies/planet_biome_spec.rb:24 (FAILED - 152)
  validations
    is valid with valid attributes (FAILED - 153)
    is not valid without a biome (FAILED - 154)
    is not valid without a biosphere (FAILED - 155)
    example at ./spec/models/celestial_bodies/planet_biome_spec.rb:42 (FAILED - 156)
  jsonb properties
    can set and retrieve area_percentage (FAILED - 157)
    can set and retrieve vegetation_cover (FAILED - 158)
    can set and retrieve moisture_level (FAILED - 159)
    can set and retrieve latitude (FAILED - 160)
    can set and retrieve biodiversity (FAILED - 161)
    supports deprecated water_level with warning (FAILED - 162)
    default values for properties
      defaults area_percentage to 0.0 (FAILED - 163)
      defaults vegetation_cover to 0.0 (FAILED - 164)
      defaults moisture_level to 0.0 (FAILED - 165)
      defaults latitude to 0.0 (FAILED - 166)
      defaults biodiversity to 0.0 (FAILED - 167)
  callbacks
    updates biosphere biodiversity after creation (FAILED - 168)
    updates biosphere biodiversity after destruction (FAILED - 169)

CelestialBodies::Planets::Gaseous::GasGiant
  behaves like a gaseous planet
    is expected to validate that :density looks like a number less than 2.0
    has a low density
    doesn't have a solid surface
    calculates cloud bands based on rotation (FAILED - 170)
  gas giant specific methods
    #estimate_moon_count
      with Jupiter mass
        estimates a realistic moon count (FAILED - 171)
      with different masses
        scales moon count with mass (FAILED - 172)
    #ring_system_probability
      returns a high probability for gas giants (FAILED - 173)

CelestialBodies::Planets::Gaseous::GaseousPlanet
  validations
    is valid with valid attributes
    requires density to be less than 2.0
  #has_solid_surface?
    returns false for gaseous planets
  #calculate_bands
    with fast rotation
      calculates more cloud bands
    with slower rotation
      calculates fewer cloud bands
    with nil rotation period
      returns a default value
  #calculate_blackbody_temperature
    with valid star and semi-major axis
      calculates approximate blackbody temperature
    without valid star data
      returns a default temperature value

CelestialBodies::Planets::Gaseous::IceGiant
  behaves like a gaseous planet
    is expected to validate that :density looks like a number less than 2.0
    has a low density
    doesn't have a solid surface
    calculates cloud bands based on rotation (FAILED - 174)
  #calculate_gravity
    calculates gravity based on mass and radius
  #habitability_score
    returns not habitable for ice giants

CelestialBodies::Planets::Ocean::HyceanPlanet
  validations
    requires an atmosphere to be present (FAILED - 175)
    requires at least 10% hydrogen in atmosphere (FAILED - 176)
    requires significant atmospheric pressure (>1 atm) (FAILED - 177)
    is valid with proper hydrogen content and pressure (FAILED - 178)
    inherits ocean planet water coverage validation (FAILED - 179)
  #habitability_factors
    includes base ocean planet factors (FAILED - 180)
    includes hydrogen blanket greenhouse effect (FAILED - 181)
    calculates pressure habitability zones (FAILED - 182)
    indicates expanded habitable temperature range (FAILED - 183)
    rates optimal pressure range (10-100 atm) as level 3 (FAILED - 184)
    rates moderate pressure range (1-10 or 100-1000 atm) as level 2 (FAILED - 185)
    rates extreme pressure as level 1 (FAILED - 186)
  #surface_features
    includes base ocean planet features (FAILED - 187)
    includes hydrogen atmosphere features (FAILED - 188)
    includes extreme storm systems for high pressure atmospheres (FAILED - 189)
    does not include storm systems for lower pressure (FAILED - 190)
  #ocean_chemistry
    identifies hydrogen saturated oceans for high H2 content (FAILED - 191)
    identifies methane rich oceans when CH4 is present (FAILED - 192)
    returns unknown when hydrosphere composition is missing (FAILED - 193)
  #habitable_layer_depth
    calculates habitable depth range based on pressure (FAILED - 194)
    sets deeper minimum depth for higher pressure (FAILED - 195)
    ensures maximum depth is greater than minimum (FAILED - 196)
    returns nil when atmosphere is missing (FAILED - 197)
    returns nil when hydrosphere is missing (FAILED - 198)
  #hydrogen_percentage (private method)
    calculates hydrogen percentage from atmosphere (FAILED - 199)
    returns 0 when H2 gas is not present (FAILED - 200)
  STI type
    sets the correct STI type (FAILED - 201)
  with :extreme trait
    has very high surface temperature (FAILED - 202)
    has very high atmospheric pressure (FAILED - 203)
  with :cold trait
    has below-freezing surface temperature (FAILED - 204)
    has significant ice coverage (FAILED - 205)
    has higher ammonia content as antifreeze (FAILED - 206)
    has mixed liquid-solid state distribution (FAILED - 207)
  inheritance from OceanPlanet
    inherits water_volume calculation (FAILED - 208)
    can analyze water chemistry (FAILED - 209)

CelestialBodies::Planets::Ocean::OceanPlanet
  validations
    requires a hydrosphere to be present
    requires at least 30% water coverage (FAILED - 210)
    is valid with 30% or more water coverage
  #habitability_factors
    includes aquatic environment factors based on water coverage
    marks aquatic environment as 'significant' for coverage below 50%
    marks aquatic environment as 'dominant' for coverage above 50% (FAILED - 211)
    analyzes water chemistry from hydrosphere composition (FAILED - 212)
    includes temperature state for liquid water range
    identifies frozen surface for low temperatures
    identifies vapor dominated state for high temperatures
  #surface_features
    includes basic water features
    includes ocean_dominated for high water coverage (FAILED - 213)
    includes ice formations for cold temperatures
    includes liquid oceans for moderate temperatures
    includes vapor clouds for high temperatures
  #water_volume
    calculates water volume based on planet size and coverage
    returns 0 when radius is missing
    returns 0 when hydrosphere is missing
    increases with higher water coverage (FAILED - 214)
  #analyze_water_chemistry (protected method)
    identifies highly saline water (FAILED - 215)
    identifies moderately saline water (FAILED - 216)
    identifies low salinity water (FAILED - 217)
  STI type
    sets the correct STI type

CelestialBodies::Planets::Ocean::WaterWorld
  validations
    requires high water coverage (FAILED - 218)
    is valid with appropriate water coverage
  #surface_features
    includes oceanic features
    includes pelagic_world for extreme coverage (FAILED - 219)
  #average_ocean_depth
    calculates depth based on planet size and water coverage
    returns 0 when radius is missing
    returns 0 when hydrosphere is missing

CelestialBodies::Planets::Rocky::TerrestrialPlanet
  #atmosphere_composition
    returns a hash of gas names and percentages
  #habitable_zone?
    returns a boolean indicating if the planet is in the habitable zone
  #habitability_score
    returns a numeric score for habitability
  #classification
    returns a string classification for the planet
  #day_night_cycle
    returns nil or a numeric value for the day-night cycle
  #earth_masses
    returns the mass of the planet in Earth masses
  #earth_radii
    returns the radius of the planet in Earth radii
  #temperature_score
    returns a numeric score for temperature habitability
  #pressure_score
    returns a numeric score for pressure habitability
  #atmosphere_score
    returns a numeric score for atmosphere habitability
  #gravity_score
    returns a numeric score for gravity habitability
  #calculated_atmospheric_pressure
    returns a numeric value for calculated atmospheric pressure

CelestialBodies::Satellites::IceMoon
  is valid with valid attributes
  has ice composition

CelestialBodies::Satellites::LargeMoon
  is valid with valid attributes
  is classified as a large moon

CelestialBodies::Satellites::Moon
  STI configuration
    sets the correct type before validation
  #orbits_planet?
    returns true when parent celestial body is a planet
    returns false when parent celestial body is not set
    works with parent_body alias
  #calculate_tidal_forces
    returns 0 when parent celestial body is not set
    returns 0 when required attributes are missing
    calculates tidal forces based on parent mass and orbital period

CelestialBodies::Satellites::Satellite
  inheritance and concerns
    inherits from CelestialBody
    includes OrbitalMechanics concern
  associations
    belongs to parent_celestial_body
    has parent_body alias
  validations
    validates orbital_period is positive
    validates rotational_period is positive
    allows nil values for orbital and rotational periods
  rotational mechanics
    #tidally_locked?
      returns true when rotational and orbital periods are equal
      returns true when periods are within 5% tolerance
      returns false when periods differ significantly
      returns false when either period is missing
    #day_length_hours
      converts rotational period from days to hours
      returns nil when rotational_period is not set
    #temperature_variation
      returns :extreme for very long rotational periods
      returns :none for tidally locked satellites
      returns :normal for Earth-like rotation
      returns :extreme when rotational_period is nil
  orbital relationship methods
    #orbits_planet?
      returns true when parent is a terrestrial planet
      returns false when parent celestial body is not set
    #calculate_tidal_forces
      returns 0 when parent celestial body is not set
      returns 0 when mass is not set
      calculates tidal forces when all data is present

CelestialBodies::Satellites::SmallMoon
  is valid with valid attributes
  is classified as a small moon

CelestialBodies::Spheres::Atmosphere
  initialization
    creates an atmosphere with default attributes
    updates atmosphere with provided information
  #initialize_gases
    creates gases based on the composition (FAILED - 220)
  #add_gas
    adds gas using chemical formula (FAILED - 221)
  #remove_gas
    removes gas and updates total atmospheric mass
  temperature management
    stores various temperature types in temperature_data
    provides default values for temperature getters
    updates main temperature when greenhouse temperature changes
    persists temperature data across reloads
  gas percentage methods
    #gas_percentage
      returns percentage of existing gas in gases collection
      falls back to composition data when gas not found in gases collection
      returns 0.0 for non-existent gases
    convenience gas percentage methods
      returns O2 percentage via o2_percentage
      returns CO2 percentage via co2_percentage
      returns CH4 percentage via ch4_percentage
      correctly uses the gas_percentage method
  atmospheric density calculations
    #density
      calculates atmospheric density based on pressure, temperature and composition
      returns zero when pressure is zero
      returns zero when temperature is zero
      calculates different density for different gas compositions
    #calculate_gas_constant
      returns a weighted average of gas constants based on composition
      returns Earth default when no gases exist
    #scale_height
      calculates atmospheric scale height based on temperature, gravity and composition
      calculates larger scale height for hotter atmospheres
      calculates smaller scale height for higher gravity
    #calculate_average_molar_mass
      calculates weighted average molar mass from gas composition
      returns Earth default when no gases exist
      calculates different molar mass for different compositions

CelestialBodies::Spheres::Biosphere
  associations
    is expected to belong to celestial_body required: true
    is expected to have many materials dependent => destroy
    is expected to have many planet_biomes dependent => destroy
    is expected to have many biomes through planet_biomes
  life form associations
    is expected to have many life_forms dependent => destroy
    uses the Biology::LifeForm class for the association
    can create life forms
  validations
    can access temperature values via tropical_temperature method
    can access temperature values via polar_temperature method
    is expected to validate that :biodiversity_index looks like a number greater than or equal to 0 and less than or equal to 1 as long as it is not nil
    is expected to validate that :habitable_ratio looks like a number greater than or equal to 0 and less than or equal to 1 as long as it is not nil
  defaults
    accesses default temperature values via delegation methods (FAILED - 222)
  #reset
    coordinates with atmosphere for temperature reset
  #transfer_material
    transfers material to target sphere
    returns false if material not found
    returns false if not enough material available
    logs errors when transfer fails due to validation errors (FAILED - 223)
    logs errors when target material cannot be created
    logs errors when target material cannot be created
  biome management
    introduces a new biome (FAILED - 224)
    removes a biome (FAILED - 225)
  #calculate_biodiversity_index
    calculates biodiversity index based on biome diversity (FAILED - 226)
    returns 0 for a barren biosphere
  #calculate_habitability
    calculates habitability based on atmospheric conditions
    returns 0 with no atmosphere
    returns low habitability with poor conditions
  #discover_life
    discovers nothing with low biodiversity
    has a chance to discover life with moderate biodiversity
  ecological processes
    runs ecological cycle during simulation
  Material transfer edge cases
    correctly assigns celestial_body to target material
    initializes target material with amount 0 if it does not exist
    uses Material class with correct namespace for transaction
    handles nil amount in target material
  soil properties
    has soil_health attribute
    has soil_organic_content attribute
    has soil_microbial_activity attribute
    #update_soil_health updates soil health value
    initializes with default soil health of zero
  vegetation cover
    has vegetation_cover attribute
    defaults to 0.0 vegetation cover
    can update vegetation cover
  temperature delegation
    delegates tropical_temperature to atmosphere when available
    delegates polar_temperature to atmosphere when available
    falls back to default value when atmosphere is not available
  temperature delegation
    delegates tropical_temperature to atmosphere when available
    delegates polar_temperature to atmosphere when available
    falls back to default value when atmosphere is not available
  ecological simulation
    calculates total biomass
    calculates expanded biodiversity including life forms (FAILED - 227)
    simulates life cycle
    can occasionally create new derived life forms

CelestialBodies::Spheres::Geosphere
  validations
    is expected to validate that :total_crust_mass looks like a number as long as it is not nil
    is expected to validate that :total_mantle_mass looks like a number as long as it is not nil
    is expected to validate that :total_core_mass looks like a number as long as it is not nil
    is expected to validate that :geological_activity looks like a number greater than or equal to 0 and less than or equal to 100 as long as it is not nil
  associations
    is expected to belong to celestial_body required: true
  default values
    sets default values for compositions and masses
  #calculate_materials
    calculates and updates materials based on crust, mantle, and core composition (PENDING: calculate_materials method not yet implemented)
  #add_material
    adds a material and updates the celestial body and geosphere (FAILED - 228)
    raises an error if the material is not found in the lookup service
    does not add material if the mass is non-positive
    adds material to the specified layer (FAILED - 229)
    rejects invalid layers
  #remove_material
    removes material from the specified layer (FAILED - 230)
  #set_default_values
    sets default values after initialization
  callbacks
    triggers TerraSim service after adding a material (PENDING: run_terrasim_service method not yet implemented)
  material management
    creates materials in correct layer (FAILED - 231)
    updates composition percentages (FAILED - 232)
    prevents adding gas materials
  material transfers
    transfers material to atmosphere when heated (PENDING: heat_material method not yet implemented)
  #reset
    resets geosphere to base values
  #extract_volatiles
    extracts volatiles based on temperature increase (FAILED - 233)
  #reset
    resets both compositions and material records
  regolith properties
    has regolith_depth attribute
    has regolith_particle_size attribute
    has weathering_rate attribute
    initializes with default regolith depth of zero
    can update regolith properties
    calculates weathering rate based on atmosphere and activity
    updates regolith depth after erosion
    updates plate positions when tectonics are active

CelestialBodies::Spheres::Hydrosphere
  associations
    is expected to belong to celestial_body required: true
    is expected to have many materials dependent => destroy
  validations
    is expected to validate that :total_liquid_mass looks like a number greater than or equal to 0 as long as it is not nil
    is expected to validate that :temperature cannot be empty/falsy
    requires pressure to be present
  store accessors
    accesses water bodies attributes from JSONB store
    writes water bodies attributes to JSONB store
  #reset
    resets to base values
  concern methods
    #calculate_state_distributions
      calculates states based on temperature
    #water_cycle_tick
      calls evaporation and precipitation handlers
  #transfer_material
    transfers material between spheres
    returns false if material not found
    returns false if not enough material available

CelestialBodies::Star
  is valid with all attributes
  is not valid without a name
  is not valid without a type_of_star
  is not valid without an age
  is not valid without a mass
  is not valid without a radius
  is not valid without a temperature
  is not valid without life expectancy
  is not valid without an r_ecosphere
  should have a positive mass
  should have a positive radius
  should have a positive temperature
  responds to attributes
  sets default luminosity based on type_of_star
  sets default luminosity for a sun-like star
  correctly calculates habitable zone

CelestialBodies::CelestialBody
  when part of a solar system
    validates distance_from_star presence
  when not part of a solar system
    allows distance_from_star to be nil (FAILED - 234)
  #add_material
    creates a new material if it does not exist (FAILED - 235)
    updates the amount of an existing material (FAILED - 236)
  #update_gravity
    calculates and updates the gravity based on mass and radius (FAILED - 237)

Colony
  validations
    is valid with valid attributes
    requires at least two settlements
  associations
    has multiple settlements
    has an account
    has an inventory
  population calculations
    calculates total population

ComponentProductionJob
  associations
    is expected to belong to settlement required: true
    is expected to belong to printer_unit required: true
  validations
    is expected to validate that :component_blueprint_id cannot be empty/falsy
    is expected to validate that :component_name cannot be empty/falsy
    is expected to validate that :quantity cannot be empty/falsy
    is expected to validate that :quantity looks like an integer greater than 0
    is expected to validate that :status cannot be empty/falsy
    is expected to validate that :production_time_hours cannot be empty/falsy
    is expected to validate that :production_time_hours looks like a number greater than 0
  scopes
    returns active jobs
    returns completed jobs
    returns in_progress jobs
  #start!
    changes status to in_progress and sets started_at
  #complete!
    changes status to completed and sets completed_at
  #fail!
    changes status to failed with reason
  #cancel!
    changes status to cancelled
  #progress_percentage
    calculates progress percentage
  #time_remaining_hours
    calculates remaining time
    returns 0 when complete
  #estimated_completion
    returns nil for pending jobs
    calculates estimated completion time
  #process_tick
    when job is not complete
      increases progress_hours
    when job completes during tick
      completes the job
    when job is not in_progress
      does not process tick
  #active?
    returns true for pending jobs
    returns true for in_progress jobs
    returns false for completed jobs
  #finished?
    returns true for completed jobs
    returns true for failed jobs
    returns false for in_progress jobs

Units::CompostingUnit
  #operate
    consumes organic waste and energy, producing compost (FAILED - 238)
    returns false if insufficient organic waste is available (FAILED - 239)
    returns false if insufficient energy is available (FAILED - 240)

AtmosphereConcern
  #reset
    restores atmosphere to base values
    does nothing when base_values is empty
  #calculate_pressure
    calculates atmospheric pressure
    returns 0 for zero mass
  #add_gas
    adds a new gas to the atmosphere
    updates existing gas (FAILED - 241)
    raises error for invalid gas
  #remove_gas
    removes gas from the atmosphere (FAILED - 242)
    deletes gas when amount becomes zero
    raises error when removing non-existent gas
    raises error when removing more than exists
  #set_default_values
    sets initial values for a new atmosphere
  #gas_percentage
    returns percentage of existing gas in gases collection
    falls back to composition data when gas not found in gases collection
    returns 0.0 for non-existent gases
    returns fresh data after updating gases
  convenience gas percentage methods
    returns O2 percentage via o2_percentage
    returns CO2 percentage via co2_percentage
    returns CH4 percentage via ch4_percentage
  #estimate_molar_mass
    returns default air molar mass for empty composition
    calculates weighted average molar mass from gas composition
    calculates different molar mass for different compositions
    handles unknown gases gracefully
  #calculate_atmospheric_mass_for_volume
    calculates atmospheric mass for given volume and conditions
    returns 0 for invalid inputs
  #get_celestial_atmosphere_data
    with planetary atmosphere (no container)
      returns self data for planetary atmospheres
  #habitable?
    returns true for Earth-like conditions
    returns false for low pressure
    returns false for low oxygen
    returns false for high CO2
    returns false for extreme temperatures
  pressure conversion methods
    converts pressure to atmospheres
    converts pressure to PSI
    converts pressure to mmHg
  temperature conversion methods
    converts temperature to Celsius
    converts temperature to Fahrenheit
  #sealed?
    returns false by default for atmosphere concern
  #initialize_gases
    creates gases based on composition (FAILED - 243)
    returns false when no composition present
  #update_total_atmospheric_mass
    calculates total mass from gas masses
    sets zero when no gases exist
  #recalculate_gas_percentages
    updates gas percentages based on masses
    does nothing when no gases exist
  #increase_dust and #decrease_dust
    increases dust concentration and sets properties
    decreases dust concentration but not below zero
  #increase_pollution
    increases pollution value

AtmosphericProcessing
  when included in a unit (new template format)
    with atmospheric processing capabilities
      #can_process_atmosphere?
        returns true when atmospheric processing is enabled
        returns false when atmospheric processing is disabled
        returns false when processing_capabilities is missing
      #atmospheric_capabilities
        returns capabilities based on processing types
        returns empty hash when can't process atmosphere
      #max_processing_rate
        returns rate for CO₂ input
        returns rate for oxygen output
        returns 0 for unknown substance
      #process_atmosphere!
        returns false for unsupported processing type
        CO2 to oxygen conversion
          processes CO2 to oxygen successfully
          fails when insufficient CO2 available
          fails when no atmosphere available
    without atmospheric processing capabilities
      cannot process atmosphere
      returns empty atmospheric capabilities
      fails to process atmosphere
  when included in a module (existing JSON format)
    CO2 scrubber module
      #can_process_atmosphere?
        returns true when has atmospheric input/output resources
        returns false when no atmospheric resources
      #atmospheric_capabilities
        returns capabilities based on resource flow
      #process_atmosphere!
        CO2 scrubbing
          scrubs CO2 from atmosphere successfully
          fails when cartridge is full
          fails when insufficient CO2 in atmosphere
    air filtration module
      #atmospheric_capabilities
        identifies air filtration capability
      #process_atmosphere!
        air filtration
          filters air successfully
          fails when no contaminants removed
    CO2 venting module
      #atmospheric_capabilities
        identifies CO2 venting capability
      #process_atmosphere!
        CO2 venting
          vents CO2 to space successfully
          vents CO2 to atmosphere with different rate
          fails when operational mode doesn't exist
  error handling
    handles missing operational_data gracefully
    handles malformed operational_data gracefully
    handles missing attachable gracefully
  private helper methods
    #has_processing_capabilities?
      returns true when atmospheric processing enabled
      returns false when atmospheric processing disabled
    #has_atmospheric_operations?
      returns true when has atmospheric resources
      returns false when no atmospheric resources
    #has_resource_flow?
      returns true when both input and output exist
      returns false when input missing
      returns false when output missing

BatteryManagement
  initialization
    sets up default battery data
    uses default capacity of 100.0
    initializes current charge to full capacity
  battery_percentage
    calculates percentage correctly
    handles empty battery
    handles zero capacity
  consume_battery
    reduces battery level by specified amount
    doesn't allow battery to go below zero
    ignores nil or negative values
  recharge_battery
    increases battery level by specified amount
    doesn't allow battery to exceed capacity
    ignores nil or negative values
  charge_battery alias
    works the same as recharge_battery
  battery_drain
    returns the configured drain rate
    has a default value

CryptocurrencyMining
  #mine_gcc
    correctly updates the account balance with mined GCC
    updates internal funds after mining

EnergyManagement
  with test entity
    calculates power usage correctly
    calculates power generation correctly
    determines if power is sufficient
    battery management
      returns battery capacity
      returns current battery level
      calculates battery percentage
      consumes battery charge correctly
      does not allow battery to go below zero
      charges the battery correctly
      does not allow battery charge to exceed capacity
      calculates battery drain correctly with efficiency
  solar output factor
    #current_solar_output_factor
      queries location solar output factor (FAILED - 244)
      returns 1.0 when no settlement (FAILED - 245)
    #solar_daylight?
      returns true when solar factor > 0.1 (FAILED - 246)
      returns false when solar factor <= 0.1 (FAILED - 247)
    power generation with solar scaling
      scales solar unit output by solar factor (FAILED - 248)
      does not scale non-solar units (FAILED - 249)

FinancialManagement
  associations
    has an account
  #can_afford?
    returns true if account balance is sufficient
    returns false if account balance is insufficient
    handles zero balance
  #charge
    withdraws money from account
    creates a transaction record
    raises error when no account exists
  #credit
    deposits money to account
    creates a transaction record
  #balance
    returns account balance
    returns 0 when no account exists
  #manage_expenses (legacy)
    charges account when funds are sufficient
    returns false when funds are insufficient
  #update_balance
    credits positive amounts
    charges negative amounts
  account creation
    creates account after creation with appropriate starting balance and currency

GeosphereConcern
  #reset
    resets attributes to base values
    returns false if base_values are not present
    returns false if base_values lack required keys (FAILED - 250)
    does not modify attributes when base_values are empty (FAILED - 251)
    handles missing base values gracefully
  #extract_volatiles
    extracts volatiles based on temperature increase (FAILED - 252)
    adds gases to atmosphere using chemical formula (FAILED - 253)
    returns empty hash when no volatiles are present
  #add_material
    adds material to the specified layer (FAILED - 254)
    validates the material exists in lookup service
  #remove_material
    removes the specified amount of material
    destroys the material record if amount becomes zero
    returns false if material does not exist
    validates the layer parameter
  #calculate_tectonic_activity
    sets tectonic_activity to true when geological_activity > 50
    sets tectonic_activity to false when geological_activity <= 50
  #update_geological_activity
    calculates and updates geological_activity based on factors
    clamps activity to 0-100 range
  #physical_state
    returns solid for temperature below melting point
    returns liquid for temperature between melting and boiling points
    returns gas for temperature above boiling point
    returns solid as default when material data is missing
  callback hooks
    calls update_material_records when composition changes
    calls update_material_states when temperature changes

HasModules
  #add_module_effect
    applies efficiency boost effect
    applies power consumption reduction effect
  #remove_module_effect
    removes efficiency boost effect
    removes power consumption reduction effect

HasUnits
  #installed_units_count
    returns the total count of all units attached to the craft (FAILED - 255)
  #install_unit
    attaches a unit to the craft (FAILED - 256)
    adds errors if installation fails (FAILED - 257)
    prevents installing a unit that is already attached
      prevents installing a unit that is already attached (FAILED - 258)
  #remove_unit
    detaches a unit from the craft (FAILED - 259)
    returns "Unit not found" if the unit is not attached to this craft (FAILED - 260)
  unit management scenarios
    when max units reached does not create a new unit (FAILED - 261)
    when max units reached returns "Max units reached" (FAILED - 262)
    when unit type is not compatible does not create a new unit (FAILED - 263)
    when unit type is not compatible returns "Unit type ... is not compatible with this craft." (FAILED - 264)
    when unit type is invalid or data not found does not create a new unit (FAILED - 265)
    when unit type is invalid or data not found returns "Invalid unit blueprint ID or data not found." (FAILED - 266)
  #add_unit
    when unit type is valid creates a new persisted unit record (FAILED - 267)
    associates the unit with the craft polymorphically (FAILED - 268)
    applies unit effects to the craft (FAILED - 269)
    returns the created unit object (FAILED - 270)
    can add different types of units (FAILED - 271)
    can add a robot unit (FAILED - 272)

Housing
  population management
    calculates population capacity from habitat units (FAILED - 273)
    uses alias total_capacity for population_capacity (FAILED - 274)
    calculates available capacity (FAILED - 275)
    checks if it has capacity for additional population (FAILED - 276)
    ignores non-habitat units when calculating capacity (FAILED - 277)
    calculates total population from base units (FAILED - 278)

HydrosphereConcern
  #calculate_state_distributions
    calculates H2O state distributions based on temperature
    calculates distributions at boiling point
    uses default values when parameters are not provided
  #hydrosphere_cycle_tick
    handles both evaporation and precipitation
    does nothing when celestial body has no atmosphere
  #calculate_evaporation_rate
    calculates higher evaporation at higher temperatures (FAILED - 279)
    returns zero when there is no atmosphere
  #handle_evaporation
    adds H2O vapor to the atmosphere
    does nothing when evaporation rate is zero
  #handle_precipitation
    moves H2O from atmosphere to hydrosphere
    does nothing when no H2O vapor is in atmosphere
  #add_liquid
    adds H2O to the hydrosphere (FAILED - 280)
    validates material exists in lookup service
    validates amount is positive
  #remove_liquid
    removes liquid from the hydrosphere
    validates amount is positive
    validates material exists in hydrosphere

LifeSupport
  validations
    allows nil population
    validates population is not negative
  #calculate_life_support_requirements
    returns empty hash for zero population
    calculates requirements for given population
  #check_resource_availability
    handles starvation when food is below threshold
    handles resource shortages
  #handle_starvation
    reduces population by death rate

MaterialManagementConcern
  #add_material
    with valid inputs
      validates positive amount
      validates material name presence
      looks up material data using real service
      raises error for unknown material
      creates material with standardized ID
      adds to existing material amount
    when material is a gas
      updates atmosphere composition
  #remove_material
    with valid inputs
      validates positive amount
      validates material name presence
      raises error for unknown material
      raises error for insufficient material
      raises error when material not found
      reduces material amount and saves
      sets amount to zero when fully removed
    when material is a gas
      updates atmosphere composition
  #has_gas_properties?
    returns true for gases
    returns false for non-gas materials
    returns falsy when material not found
  integration with CelestialBody
    works with actual celestial body materials association
    handles material validation errors properly
    correctly identifies gas materials from fixtures

MaterialPropertiesConcern
  #properties
    fetches material properties from lookup service
  #molar_mass_from_properties
    returns molar mass from nested properties
    returns molar mass from top level if nested not available
    returns nil if molar mass not found
  #set_molar_mass_from_material
    sets molar_mass from properties if blank
    does not override existing molar_mass
  #state_at
    returns solid state when temperature is below melting point
    returns liquid state when temperature is between melting and boiling points
    returns gas state when temperature is above boiling point
    returns default state when temperature is nil
    uses default values when melting/boiling points are missing
  state helper methods
    #solid?
      returns true when temperature is below melting point
      returns false when temperature is above melting point
      returns true when default state is solid and no temperature given
    #liquid?
      returns true when temperature is between melting and boiling points
      returns false when temperature is below melting point or above boiling point
      returns true when default state is liquid and no temperature given
    #gas?
      returns true when temperature is above boiling point
      returns false when temperature is below boiling point
      returns true when default state is gas and no temperature given
  #default_state
    returns state_at_room_temp from properties if available
    returns solid if state_at_room_temp not available
  exotic state handling
    identifies exotic states (FAILED - 281)
    calculates phase transitions for exotic conditions (FAILED - 282)

MaterialTransferable
  #transfer_material
    transfers material between spheres
    prevents transfer if insufficient amount
    prevents transfer of non-existent material
    updates existing material in target

Mineable
  #mine_gcc
    mines from satellites and computers (FAILED - 283)
    does not exceed available power (FAILED - 284)

OrbitalMechanics
  #orbital_period_around
    calculates orbital period using Kepler's Third Law
    returns nil if spatial_location is missing
  #barycenter_with
    calculates center of mass for two bodies
    returns nil if spatial_location is missing

Structures::Coverable
  concern inclusion
    includes Enclosable
    inherits all Enclosable functionality
  required interface from Enclosable
    requires width_m to be implemented
    requires length_m to be implemented
  associations
    has construction_jobs association
    has material_requests association
    has equipment_requests association
  attributes
    has cover_status attribute
    defaults cover_status to uncovered
    has panel_type attribute
    has construction_date attribute
    has estimated_completion attribute
  status helpers
    #uncovered?
      returns true when uncovered
      returns true when natural
      returns false when covered
    #covered?
      returns false when uncovered
      returns false when materials requested
      returns false when under construction
      returns true when primary cover installed
      returns true when fully covered
    #under_construction?
      returns true when under construction
      returns false otherwise
    #materials_requested?
      returns true when materials requested
      returns false otherwise
  #schedule_covering!
    creates a construction job (FAILED - 285)
    returns success result (FAILED - 286)
    updates status to materials_requested (FAILED - 287)
    accepts custom panel type (FAILED - 288)
    stores panel_type on coverable (FAILED - 289)
    uses default panel type if not specified (FAILED - 290)
    creates material and equipment requests (FAILED - 291)
    updates shell composition (FAILED - 292)
    fails if already covered (FAILED - 293)
    requires settlement
  #complete_covering!
    completes covering when under construction
    sets construction_date
    fails if not under construction
  #active_construction_job
    returns nil when no construction jobs exist
    returns job with materials_pending status
    returns job with in_progress status
    ignores completed jobs
    returns the first active job if multiple exist
  #calculate_covering_materials
    returns materials hash
    accepts custom panel type
    does not create construction job
    scales materials by area
  #estimate_covering_time
    returns time estimate in hours
    scales with area
    accepts custom panel type
    uses blueprint installation time if available
  #calculate_equipment_needs
    returns array of equipment requirements
    includes tools from blueprint
    includes crew requirements
  area calculations from Enclosable
    #area_m2
      with rectangular dimensions
        calculates area as width × length
      with circular dimensions
        calculates area using diameter
      with very large dimensions
        handles worldhouse scale
    #area_km2
      converts square meters to square kilometers
  integration scenarios
    skylight covering
      handles small circular opening
    worldhouse segment covering
      handles massive rectangular span
    lava tube opening
      handles medium opening (FAILED - 294)
  complete covering workflow
    goes through full lifecycle (FAILED - 295)

Structures::Enclosable
  required interface
    requires width_m to be implemented
    requires length_m to be implemented
  #area_m2
    with rectangular dimensions
      calculates area as width × length
    with circular dimensions
      calculates area using diameter
    with very large dimensions
      handles worldhouse scale
  #area_km2
    converts square meters to square kilometers
    handles small areas
  #calculate_enclosure_materials
    calculates materials from blueprint data
    scales materials by area
    includes panel count in materials
    includes ibeam calculations
  #update_shell_composition
    stores panel composition in operational_data
    can track multiple panel types
  #total_power_generation
    calculates power from solar panels
    returns 0 for non-solar panels
    accounts for failed panels
    accounts for degradation
    combines failures and degradation
  #simulate_panel_degradation
    reduces health percentage over time
    uses degradation_rate from blueprint
    can cause random panel failures
    health cannot go below 0
  #repair_panels
    reduces failed_count
    cannot repair more than failed
    returns materials needed for repair
  #replace_degraded_panels
    improves health percentage
    calculates panels to replace based on percentage
    returns materials needed
    health cannot exceed 100%
  #shell_status_report
    returns comprehensive status
    calculates total panels correctly
    calculates total failed correctly
    calculates average health
    flags maintenance needs when health is low
    provides breakdown per panel type
  #light_transmission
    reads from blueprint properties
    returns 0 if not specified
  #thermal_rating
    reads from blueprint properties
    returns 0 if not specified
  panel blueprint loading
    loads blueprint data flexibly
  scale comparison
    handles small enclosures (skylight)
    handles massive enclosures (worldhouse)

Structures::HasProcessing
  #run_processing_cycle
    runs a complete processing cycle
    returns false if structure cannot process
  #can_process?
    returns true when structure is operational and in production mode
    returns false when not in production mode
    returns false when not operational
    returns false when no processing units are available
  #processing_units
    returns units that can process resources
    filters out non-operational units
    filters out units that cannot process
  #check_resource_levels
    returns true when all required resources are available
    returns false when a required resource is insufficient
    returns false when inventory is nil
  #delegate_processing_to_units
    delegates processing to each unit
    provides resources to units
    returns a hash of processed resources
    returns empty hash when no units can process
  #collect_processing_results
    collects output from processing units
    clears unit output buffers
    returns a hash of collected resources
    returns empty hash when no units have output
  #apply_structure_bonuses
    applies quality bonuses from modules
    returns false when no modules are present
    returns false when no quality modules are present

Structures::Shell
  concern inclusion
    includes Enclosable
    inherits all Enclosable functionality
  associations
    has construction_jobs association
    has material_requests association
    has equipment_requests association
  status helpers
    #shell_planned?
      returns true when planned
      returns false when not planned
    #framework_construction?
      returns true when framework under construction
    #panel_installation?
      returns true when panels being installed
    #sealed?
      returns true when sealed
      returns true when pressurized
      returns false when operational
      returns false when under construction
    #pressurized?
      returns true when pressurized
      returns false when operational
      returns false when only sealed
    #pressurize_shell!
      pressurizes when sealed
      creates atmosphere when pressurized
      fails if not sealed
      fails if already pressurized
    #shell_operational?
      returns true when operational
      returns false when not operational
    #shell_under_construction?
      returns true during framework construction
      returns true during panel installation
      returns false when sealed
  #schedule_shell_construction!
    creates a construction job
    returns success result
    updates status to framework_construction
    accepts custom panel type
    stores panel_type on structure
    sets construction_date
    creates material and equipment requests
    updates shell composition
    fails if already sealed
    requires settlement
  #advance_shell_construction!
    advances from planned to framework_construction
    advances from framework_construction to panel_installation
    advances from panel_installation to operational
    advances from panel_installation to sealed when designed for sealing
    advances from sealed to pressurized
    calls on_shell_operational hook when operational
  #active_construction_job
    returns nil when no construction jobs exist
    returns job with materials_pending status
    returns job with in_progress status
    ignores completed jobs
  #calculate_shell_materials
    returns materials hash
    accepts custom panel type
    does not create construction job
    scales materials by area
  #estimate_shell_construction_time
    returns time estimate in hours
    scales with area
    takes longer than covering equivalent area
    accepts custom panel type
  #calculate_equipment_needs
    returns array of equipment requirements
    includes base construction equipment
    includes panel-specific tools from blueprint
    includes crew requirements
  #calculate_volume
    with rectangular dimensions
      calculates volume with assumed height
    with circular dimensions
      calculates spherical volume
  #create_shell_atmosphere
    creates atmosphere when sealed
    starts unpressurized
    accepts custom temperature
    does not create duplicate atmosphere
    returns nil if not sealed
  integration with space station
    provides all methods needed for space station shell
  complete construction workflow
    goes through full lifecycle

Transactable
  ensures player has an associated account

ConsortiumMembership
  is valid with valid attributes
  is invalid if member is not a corporation (FAILED - 296)
  is invalid with zero investment
  is invalid with ownership_percentage > 100
  scopes active memberships

ConstructionJob
  debug - shows actual database columns
  validations and attributes
    is valid with required attributes (FAILED - 297)
    requires a jobable (FAILED - 298)
    accepts a valid job_type (FAILED - 299)
    accepts a valid status (FAILED - 300)
    stores target_values as JSON (FAILED - 301)
  associations
    has many material_requests (FAILED - 302)
    has many equipment_requests (FAILED - 303)
    belongs to a jobable (FAILED - 304)
    belongs to a settlement (FAILED - 305)
  enum functionality
    correctly stores and retrieves job_type as an enum (FAILED - 306)
    correctly stores and retrieves status as an enum (FAILED - 307)
  convenience methods
    #materials_gathered?
      returns true when all material requests are fulfilled (FAILED - 308)
      returns false when some material requests are pending (FAILED - 309)
    #equipment_gathered?
      returns true when no equipment requests exist (FAILED - 310)
      returns true when all equipment requests are fulfilled (FAILED - 311)
      returns false when some equipment requests are pending (FAILED - 312)
    #infer_settlement
      returns the jobable's settlement if available (FAILED - 313)
      returns the jobable if it is a Settlement (FAILED - 314)
      finds a settlement by location if available (FAILED - 315)

Craft::BaseCraft
  associations
    example at ./spec/models/craft/base_craft_spec.rb:128 (FAILED - 316)
    example at ./spec/models/craft/base_craft_spec.rb:129 (FAILED - 317)
    example at ./spec/models/craft/base_craft_spec.rb:130 (FAILED - 318)
    example at ./spec/models/craft/base_craft_spec.rb:131 (FAILED - 319)
  location handling
    can access location through helper method (FAILED - 320)
    can switch between spatial and celestial locations (FAILED - 321)
  initialization
    assembles a new craft from inventory and applies the correct variant (FAILED - 322)
  loading craft info
    loads the correct craft data from the lookup service (FAILED - 323)
  player construction
    starts with no units (FAILED - 324)
    allows installing units (FAILED - 325)
    allows uninstalling units (FAILED - 326)
  variant configuration
    loads a variant configuration (FAILED - 327)
    changes between variants (FAILED - 328)
    provides a list of available variants (FAILED - 329)
    handles missing variants gracefully (FAILED - 330)
  atmosphere creation
    creates an atmosphere after creation (FAILED - 331)
  unit integration
    integrates with settlement units (FAILED - 332)
  
An error occurred in an `after(:context)` hook.
Failure/Error: @alpha_base_settlement_instance&.destroy # Destroy the settlement and its dependents

ActiveRecord::StatementInvalid:
  PG::UndefinedColumn: ERROR:  column market_marketplaces.settlement_id does not exist
  LINE 1: ..._marketplaces".* FROM "market_marketplaces" WHERE "market_ma...
                                                               ^
# ./spec/models/craft/base_craft_spec.rb:80:in 'block (2 levels) in <main>'
# ------------------
# --- Caused by: ---
# PG::UndefinedColumn:
#   ERROR:  column market_marketplaces.settlement_id does not exist
#   LINE 1: ..._marketplaces".* FROM "market_marketplaces" WHERE "market_ma...
#                                                                ^
#   ./spec/models/craft/base_craft_spec.rb:80:in 'block (2 levels) in <main>'

Craft::Harvester
  validations
    is valid with a positive extraction_rate (FAILED - 333)
    is invalid with a negative extraction_rate (FAILED - 334)
  #extract_resources
    when extracting from a valid target
      increases inventory with extracted resources (FAILED - 335)
    when extracting from an invalid target
      raises an error (FAILED - 336)
    when storage is full
      raises an error (FAILED - 337)
  #process_resources
    converts raw material into refined material (FAILED - 338)
    does nothing if no processable materials are present (FAILED - 339)

Craft::Satellite::BaseSatellite
  associations and basic attributes
    has the correct current location string
    can access its location helper
    #needs_atmosphere? returns false for satellites
  #valid_deployment_location?
    when operational data defines specific deployment locations
      permits locations defined in its operational data
      rejects locations not defined in its operational data, even if generally space-based
      rejects clearly non-space deployment locations
    when operational data does NOT define specific deployment locations
      permits general space-based locations from BaseSatellite fallback list
      rejects clearly non-space deployment locations
  #deploy
    updates location string and deployment status if valid
    raises if given invalid deployment location string
  unit loading
    installs the correct recommended units
    when recommended units are specified in operational data
      installs the correct recommended units

Craft::Transport::Cycler
  validations
    is expected to validate that :cycler_type cannot be empty/falsy
    is expected to validate that :orbital_period cannot be empty/falsy
  associations
    is expected to have many docked_crafts
    is expected to have many scheduled_arrivals
    is expected to have many scheduled_departures
  #initialize_trajectory
    sets correct orbital period for earth_mars cycler
    sets correct orbital period for earth_venus cycler
    sets correct orbital period for venus_mars cycler
  #validate_cycler_requirements
    adds error if craft_type is not cycler

Craft::VariantManager
  #initialize
    loads base data and variants (FAILED - 340)
    handles non-existent craft types gracefully
  #available_variants
    returns a list of available variant IDs
    returns an empty array when no variants exist
  #get_variant
    returns nil for non-existent variant
    merges base data with standard variant data (FAILED - 341)
    merges base data with lunar variant data (FAILED - 342)
    properly merges nested hashes (FAILED - 343)

Settlement::Dome
  calculates used capacity (current occupancy) correctly (FAILED - 344)
  calculates remaining capacity correctly (FAILED - 345)
  ensures current occupancy does not exceed total capacity (FAILED - 346)

CelestialBodies::DwarfPlanet
  #calculate_surface_conditions
    calculates surface conditions specific to dwarf planets (FAILED - 347)
  #update_biomes
    updates biomes specific to dwarf planets (FAILED - 348)

Environment
  validations
    is valid with valid attributes (FAILED - 349)
    is not valid without a biome (FAILED - 350)
    is not valid without a planet (FAILED - 351)
    is not valid without a temperature (FAILED - 352)
    is not valid without a pressure (FAILED - 353)
    is not valid without a humidity (FAILED - 354)
  associations
    belongs to a biome (FAILED - 355)
    belongs to a celestial_body (FAILED - 356)

EquipmentRequest
  validations
    is valid with required attributes (FAILED - 357)
    requires an equipment_type (FAILED - 358)
    requires quantity_requested to be present (FAILED - 359)
    requires quantity_requested to be greater than 0 (FAILED - 360)
    requires quantity_requested to be a number (FAILED - 361)
    allows negative quantity_requested to be invalid (FAILED - 362)
  associations
    belongs to a requestable (polymorphic) (FAILED - 363)
    can be associated with different requestable types (FAILED - 364)
  enums
    status enum
      has correct status values
      defaults to pending status (FAILED - 365)
      can be set to different statuses (FAILED - 366)
      accepts string values for status (FAILED - 367)
      provides query methods for each status (FAILED - 368)
    priority enum
      has correct priority values
      defaults to normal priority (FAILED - 369)
      can be set to different priorities (FAILED - 370)
      accepts string values for priority (FAILED - 371)
      provides query methods for each priority (FAILED - 372)
  scopes
    .pending_requests
      returns pending and partially fulfilled requests (FAILED - 373)
    .fulfilled
      returns only fulfilled requests (FAILED - 374)
    .for_equipment
      returns requests for a specific equipment type (FAILED - 375)
      returns empty when no equipment of that type is requested (FAILED - 376)
  instance methods
    #quantity_still_needed
      returns the full quantity when quantity_fulfilled is nil (FAILED - 377)
      returns the difference when quantity_fulfilled is set (FAILED - 378)
      returns 0 when fully fulfilled (FAILED - 379)
      handles quantity_fulfilled being 0 (FAILED - 380)
  factory
    creates a valid equipment request with factory (FAILED - 381)
    creates equipment request with specific attributes (FAILED - 382)
  edge cases and data integrity
    handles very large quantity requests (FAILED - 383)
    maintains data integrity when updating status (FAILED - 384)
    handles equipment_type with special characters (FAILED - 385)

Financial::Account
  associations
    is expected to belong to accountable required: true
    is expected to have many transactions dependent => destroy
  validations
    is expected to validate that :balance looks like a number
  Virtual Ledger (Overdraft) Logic
    when owner is a Player
      strictly prevents negative balances
    when owner is a Colony
      allows the balance to drop below zero (Exodus Oligopoly logic)
  #deposit
    with a valid amount
      increases the account balance
    with an invalid amount (negative)
      raises an error and does not modify the balance
  #withdraw
    when funds are sufficient
      decreases the account balance
    when funds are insufficient
      raises an error for players
  #transfer_funds
    when funds are sufficient
      transfers the amount between accounts
    when currencies differ
      raises a currency mismatch error
  edge cases
    prevents withdrawals from zero balance for players
  different accountable types
    works with a player account
    works with a settlement account
    works with an organization account
  Development Corporation (DC) Trade
    allows creation of consortium organization
    allows DC-to-DC trade on the virtual ledger via operational_data flags (FAILED - 386)

Financial::BondRepayment
  associations
    is expected to belong to bond required: true
    is expected to belong to currency required: true

Financial::Bond
  associations
    is expected to belong to issuer required: true
    is expected to belong to holder required: true
    is expected to belong to currency required: true
    is expected to have many repayments class_name => Financial::BondRepayment dependent => destroy
  validations
    is expected to validate that :amount looks like a number greater than 0
    is expected to validate that :issued_at cannot be empty/falsy
    is expected to validate that :status cannot be empty/falsy
  methods
    calculates total repaid
    checks if paid off

Financial::Currency
  associations
    is expected to have many accounts
    is expected to have many transactions
    is expected to belong to issuer optional: true
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :name is case-sensitively unique
    is expected to validate that :symbol cannot be empty/falsy
    is expected to validate that :symbol is case-sensitively unique
    is expected to allow :is_system_currency to be ‹true› or ‹false›
    is expected to allow :precision to be ‹2›

Financial::Transaction
  associations
    belongs to an account
    belongs to a recipient
  validations
    requires a transaction_type
    requires a valid transaction_type
    requires an amount
    requires amount to be numeric
  transaction types
    allows deposit transactions
    allows withdraw transactions
    allows transfer transactions
    allows tax_collection transactions
  currency precision
    supports high precision for GCC (8 decimal places) (FAILED - 387)

Galaxy
  validations
    validates presence of identifier
    validates uniqueness of identifier
  associations
    has many solar systems
    has one spatial location
  callbacks
    generates a unique name before create if name is not present
    generates a random alphanumeric name if none provided
  galaxy type
    accepts different galaxy types
  #name
    returns the name if present
    returns the identifier if name is not present
  #total_mass
    calculates total mass properly (PENDING: Implement this when total_mass method exists)
  galaxy properties
    can store galaxy attributes
    has expected attributes
  spatial context
    can be assigned a spatial location
  .create_with_random_properties
    creates a galaxy with the given identifier
    uses provided options when given
    generates random properties when not specified
    handles a mix of specified and random properties

Game
  #assign_task
    adds a new task to the task list with correct completion time (FAILED - 388)
  #advance_time
    advances game time and completes a task (FAILED - 389)
  #advance_time with no tasks
    prints a message when there are no tasks (FAILED - 390)

GameState
  attributes
    has accessible year, day, running, speed and last_updated_at attributes
  #update_time!
    updates the game time based on elapsed time when running
    doesn't update time when not running
  #toggle_running!
    toggles the running state
    updates last_updated_at when turning on

CelestialBodies::GasGiant
  #calculate_atmospheric_pressure
    calculates atmospheric pressure based on gas quantities (FAILED - 391)
  #calculate_gravity
    calculates gravity based on mass and radius (FAILED - 392)

CelestialBodies::Spheres::Hydrosphere
  associations
    is expected to belong to celestial_body required: true
    is expected to have many liquid_materials dependent => destroy
  validations
    is expected to validate that :liquid_volume looks like a number (FAILED - 393)
    is expected to validate that :lakes looks like a number (FAILED - 394)
    is expected to validate that :rivers looks like a number (FAILED - 395)
    is expected to validate that :oceans looks like a number (FAILED - 396)
    is expected to validate that :ice looks like a number (FAILED - 397)
  #setup_liquid_materials
    calls update_liquid_materials_from_celestial_body (FAILED - 398)
    calculates the liquid volume after setup (FAILED - 399)
  #update_liquid_materials_from_celestial_body
    adds liquid materials to the hydrosphere (FAILED - 400)
    adds ice to the hydrosphere (FAILED - 401)
  #add_liquid
    distributes liquid between oceans, lakes, and rivers (FAILED - 402)
  #calculate_liquid_volume
    calculates the total liquid volume correctly (FAILED - 403)
  #update_water_cycle
    melts ice when temperature is above freezing (FAILED - 404)
    does not melt ice when temperature is below freezing (FAILED - 405)
  #evaporate_liquids
    evaporates liquids when conditions are met (FAILED - 406)

CelestialBodies::IceGiant
  #calculate_atmospheric_pressure
    calculates atmospheric pressure based on gas quantities (FAILED - 407)
  #calculate_gravity
    calculates gravity based on mass and radius (FAILED - 408)

Inventory
  validations
    is valid with valid attributes
    requires an inventoryable
  #available_capacity
    when surface storage is available
      returns infinity
    when using unit storage
      returns remaining capacity from units
      subtracts stored items from capacity
  #add_item
    when capacity is not exceeded
      stores item in inventory
    when capacity is exceeded
      uses surface storage
    when adding a new item with metadata
      creates a new item in the inventory with the specified metadata
    when adding more amount to an existing item with matching metadata
      updates the amount of the specific existing item
    when adding an item that exists but has different metadata
      creates a new item record with different metadata
  #remove_item
    removes items from storage
    when removing an item with specific metadata
      decreases the amount of the specific item matching metadata
      destroys the specific item if amount becomes zero or less
      returns false if not enough amount of the specific item
      returns false if item with matching name but different metadata not found
    when removing an item with matching name but different metadata exists
      only affects the item with the exactly matching metadata

Item
  associations
    is expected to belong to inventory optional: true
    is expected to belong to container class_name => Item optional: true
    is expected to belong to owner required: true
    is expected to belong to storage_unit optional: true
    is expected to have many contained_items class_name => Item dependent => destroy
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :amount looks like a number greater than or equal to 0
    is expected to validate that :storage_method cannot be empty/falsy
  lookup service integration
    loads properties from item lookup service with category (FAILED - 409)
    handles processed materials
    loads material properties for raw materials (FAILED - 410)
  #container operations
    identifies containers correctly (FAILED - 411)
    adds items to containers (FAILED - 412)
    removes items from containers (FAILED - 413)
    enforces weight capacity limits (FAILED - 414)
  #total_weight
    calculates base weight from properties (FAILED - 415)
    includes contained items in total weight (FAILED - 416)
  #tradeable?
    returns true for normal items with positive amount (FAILED - 417)
    returns false for items with zero amount (FAILED - 418)
    returns false for containers with items (FAILED - 419)
    returns true for empty containers (FAILED - 420)
  regolith handling
    gets composition from celestial body geosphere (FAILED - 421)
    includes source body in properties (FAILED - 422)

CelestialBodies::Materials::Liquid
  associations
    example at ./spec/models/liquid_material_spec.rb:9 (FAILED - 423)
  validations
    is valid with valid attributes (FAILED - 424)
    is not valid without a name (FAILED - 425)
    is not valid without an amount (FAILED - 426)
    is not valid with a negative amount (FAILED - 427)

Location::BaseLocation
  is an abstract class
  associations
    is expected to belong to locationable optional: true
  validations
    presence
      is expected to validate that :name cannot be empty/falsy
  #update_location
    with valid attributes
      updates the attributes

Location::CelestialLocation
  associations
    is expected to belong to celestial_body required: true
    is expected to belong to locationable optional: true
  validations
    is expected to validate that :name cannot be empty/falsy (FAILED - 428)
    is expected to validate that :celestial_body cannot be empty/falsy
    is invalid without coordinates
    is invalid with blank coordinates
    coordinate format
      accepts valid coordinates
      rejects invalid coordinates
    uniqueness validation
      validates that coordinates are case-insensitively unique within the same celestial body
      validates that coordinates are unique with the same case within the same celestial body
      allows the same coordinates on a different celestial body
      allows different coordinates on the same celestial body
    altitude validation
      accepts nil altitude (surface location)
      accepts zero altitude (surface location)
      accepts positive altitude (orbital location)
      rejects negative altitude
  scopes
    .surface_locations
      returns locations with nil or zero altitude
    .orbital_locations
      returns locations with positive altitude
    .low_orbit
      returns locations between 0 and 2,000 km
    .medium_orbit
      returns locations between 2,000 and 35,786 km
    .high_orbit
      returns locations above 35,786 km
  #surface?
    returns true for nil altitude
    returns true for zero altitude
    returns false for positive altitude
  #orbital?
    returns false for surface locations
    returns true for orbital locations
  #orbit_type
    returns nil for surface locations
    returns :low for low orbit (< 2,000 km)
    returns :medium for medium orbit (2,000-35,786 km)
    returns :high for high orbit (> 35,786 km)
  #altitude_km
    returns nil for surface locations
    converts meters to kilometers
  #altitude_km=
    sets altitude from kilometers
    sets nil from nil
  #latitude
    parses positive latitude from North coordinates
    parses negative latitude from South coordinates
    handles zero latitude
  #longitude
    parses positive longitude from East coordinates
    parses negative longitude from West coordinates
    handles zero longitude
  orbital mechanics
    #orbital_period
      returns nil for surface locations (FAILED - 429)
      calculates period for orbital locations (FAILED - 430)
      returns nil if celestial body lacks required methods
    #orbital_velocity
      returns nil for surface locations (FAILED - 431)
      calculates velocity for orbital locations (FAILED - 432)
      returns nil if celestial body lacks required methods
    #gravity
      returns surface gravity for surface locations (FAILED - 433)
      calculates reduced gravity at altitude (FAILED - 434)
      returns nil if celestial body lacks required methods
  #description
    describes surface locations (FAILED - 435)
    describes orbital locations (FAILED - 436)
  #full_coordinates
    returns coordinates for surface locations
    includes altitude for orbital locations

Location::SpatialLocation
  associations
    is expected to belong to spatial_context optional: true
    is expected to belong to locationable optional: true
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :x_coordinate cannot be empty/falsy
    is expected to validate that :y_coordinate cannot be empty/falsy
    is expected to validate that :z_coordinate cannot be empty/falsy
    is expected to validate that :x_coordinate looks like a number
    is expected to validate that :y_coordinate looks like a number
    is expected to validate that :z_coordinate looks like a number
    validates uniqueness of 3D position
    validates uniqueness of 3D position within same spatial context
    allows same coordinates in different spatial contexts
  #update_location
    updates coordinates (FAILED - 437)
  #distance_to
    calculates 3D distance between locations

Logistics::Contract
  validations
    is valid with required attributes
    requires material
    requires quantity greater than 0
  enums
    defines status enum
    defines transport_method enum
  scopes
    has active scope
    has completed scope
  instance methods
    #mark_delivered!
      updates status to delivered and sets completed_at
    #mark_failed!
      updates status to failed and records reason

Market::Condition
  associations
    is expected to belong to marketplace class_name => Market::Marketplace required: true
    is expected to have many market_orders class_name => Market::Order dependent => destroy
    is expected to have many price_histories dependent => destroy
    is expected to have many orders dependent => destroy
  #current_price
    returns the latest price from price_histories (FAILED - 438)
    returns default price if no price_histories exist (FAILED - 439)

Market::Marketplace
  associations
    is expected to belong to settlement class_name => Settlement::BaseSettlement required: true (FAILED - 440)
    is expected to have many market_conditions class_name => Market::Condition dependent => destroy
  table configuration
    uses the correct table name
  #current_market_condition
    returns the market condition for a given resource (FAILED - 441)
    returns nil for a resource that does not exist (FAILED - 442)
  #find_matching_orders
    when order is a Sell order
      calls the settlement NPC methods (FAILED - 443)
    when order is not a Sell order
      returns an empty array (FAILED - 444)
  #place_order
    creates an order (FAILED - 445)
    converts volume parameter to quantity (FAILED - 446)
    sets the base_settlement_id (FAILED - 447)
    removes unused parameters (FAILED - 448)
    when order is fully filled
      returns nil (FAILED - 449)
      sets order quantity to zero (FAILED - 450)
    when order is partially filled
      returns the order (FAILED - 451)
    when no matching orders exist
      returns the unfilled order (FAILED - 452)
  #execute_trades
    delegates the entire trade execution to Market::TradeExecutionService (FAILED - 453)
    updates the order quantity to zero when fully filled (FAILED - 454)
    wraps the execution in a transaction (FAILED - 455)
    when partially filled
      updates the order quantity to remaining amount (FAILED - 456)

Market::Order
  is valid with valid attributes (FAILED - 457)
  requires a market_condition (FAILED - 458)
  requires an orderable (FAILED - 459)
  belongs to market_condition (FAILED - 460)
  supports polymorphic orderable association (FAILED - 461)
  is invalid without quantity (FAILED - 462)
  is invalid without order_type (FAILED - 463)
  can be associated with a base_settlement_id (FAILED - 464)

Market::PriceHistory
  associations
    is expected to belong to market_condition class_name => Market::Condition required: true
  validations
    is valid with valid attributes (FAILED - 465)
    is not valid without a price (FAILED - 466)

Market::Settings
  can create a settings record
  defaults transportation_cost_per_kg to nil

Market::SupplyChain
  is valid with valid attributes (FAILED - 467)
  requires a market_order (FAILED - 468)
  can track status changes (FAILED - 469)
  scopes active supply chains (FAILED - 470)

Market::Trade
  associations
    is expected to belong to buyer required: true
    is expected to belong to seller required: true
    is expected to belong to buyer_settlement class_name => Settlement::BaseSettlement required: true
    is expected to belong to seller_settlement class_name => Settlement::BaseSettlement required: true
  validations
    is valid with valid attributes

Market::TransactionFee
  validations
    is expected to validate that :fee_type cannot be empty/falsy (FAILED - 471)
    is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"› (FAILED - 472)
    is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil (FAILED - 473)
    is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil (FAILED - 474)
  #calculate
    calculates percentage fee (FAILED - 475)
    calculates fixed fee (FAILED - 476)
    returns 0 for unknown fee_type (FAILED - 477)

MaterialRequest
  validations
    is valid with required attributes (FAILED - 478)
    requires a material_name (FAILED - 479)
    requires quantity_requested to be present (FAILED - 480)
    requires quantity_requested to be greater than 0 (FAILED - 481)
    requires quantity_requested to be a number (FAILED - 482)
  associations
    belongs to a requestable (polymorphic) (FAILED - 483)
    can be associated with different requestable types (FAILED - 484)
  enums
    status enum
      has correct status values
      defaults to pending status (FAILED - 485)
      can be set to different statuses (FAILED - 486)
      accepts string values for status (FAILED - 487)
    priority enum
      has correct priority values
      defaults to normal priority (FAILED - 488)
      can be set to different priorities (FAILED - 489)
      accepts string values for priority (FAILED - 490)
  scopes
    .pending_requests
      returns pending and partially fulfilled requests (FAILED - 491)
    .fulfilled
      returns only fulfilled requests (FAILED - 492)
    .for_material
      returns requests for a specific material (FAILED - 493)
  delegations
    delegates settlement to requestable (FAILED - 494)
    handles nil settlement gracefully (FAILED - 495)
  instance methods
    #quantity_still_needed
      returns the full quantity when quantity_fulfilled is nil (FAILED - 496)
      returns the difference when quantity_fulfilled is set (FAILED - 497)
      returns 0 when fully fulfilled (FAILED - 498)
    #gas_request?
      returns true when material is a gas (FAILED - 499)
      returns false when material is not a gas (FAILED - 500)
      returns false when material data is not found (FAILED - 501)
      returns false when material data has no category (FAILED - 502)
  factory
    creates a valid material request with factory (FAILED - 503)

CelestialBodies::Material
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without an amount
    is not valid with a negative amount
    is not valid without a state (FAILED - 504)
    is valid with a valid state (solid, liquid, gas)
    is not valid with an invalid state (FAILED - 505)
    is valid with valid melting and boiling points
    is not valid with non-numeric melting and boiling points (FAILED - 506)
  associations
    belongs to a celestial body
  #state_at
    returns "solid" when temperature is below the adjusted melting point (FAILED - 507)
    returns "liquid" when temperature is between the adjusted melting and boiling points (FAILED - 508)
    returns "gas" when temperature is above the adjusted boiling point (FAILED - 509)

Modules::BaseModule
  associations
    is expected to belong to attachable optional: true
    accepts craft as polymorphic attachable (FAILED - 510)
    accepts structure as polymorphic attachable
    can be created without attachable
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :module_type cannot be empty/falsy
    is expected to validate that :identifier cannot be empty/falsy
    creates valid module with all required fields
  callbacks
    before_validation :load_module_data on create
      when module data is found
        loads CO2 scrubber data from lookup service
        does not override existing name if already set
      when module data is not found
        does not crash when module type doesnt exist
    after_create :apply_module_to_attachable
      applies module to craft when created with craft attachable (FAILED - 511)
      applies module to structure when created with structure attachable
      does not crash when created without attachable
    before_destroy :remove_module_from_attachable
      removes module from craft when destroyed (FAILED - 512)
      removes module from structure when destroyed
      does not crash when destroyed without attachable
  instance methods
    #operational_status
      returns operational status from loaded data
      returns inactive when operational_data is missing
    #input_resources
      returns input resources from loaded data
      returns empty array when operational_data is missing
    #output_resources
      returns output resources from loaded data
    #consumables
      returns consumables from loaded data
  AtmosphericProcessing integration
    #can_process_atmosphere?
      returns true for CO2 scrubber module
      returns false for basic life support module
    #atmospheric_capabilities
      identifies CO2 scrubbing capability
    #max_processing_rate
      returns correct rates for CO2 scrubber
  factory integration
    creates valid module using existing factory
    creates CO2 scrubber with trait
  error handling
    handles missing operational_data gracefully
    handles empty operational_data gracefully

OrbitalConstructionProject
  associations
    is expected to belong to station class_name => Settlement::BaseSettlement required: true
  validations
    is expected to validate that :craft_blueprint_id cannot be empty/falsy
    is expected to validate that :progress_percentage looks like a number greater than or equal to 0 and less than or equal to 100
  enums
    is expected to define :status as an enum backed by an integer with values ‹{materials_pending: 0, in_progress: 1, completed: 2, failed: 3, canceled: 4}›
  #materials_complete?
    when all required materials are delivered
      returns true (FAILED - 513)
    when some materials are missing
      returns false (FAILED - 514)
    when materials exceed requirements
      returns true (FAILED - 515)
  #completion_percentage
    when no materials are delivered
      returns 0 (FAILED - 516)
    when half materials are delivered
      returns 50 (FAILED - 517)
    when all materials are delivered
      returns 100 (FAILED - 518)
  JSONB storage
    stores required_materials as JSONB (FAILED - 519)
    stores delivered_materials as JSONB (FAILED - 520)
    stores project_metadata as JSONB (FAILED - 521)

OrbitalRelationship
  associations
    belongs to primary_body polymorphically (FAILED - 522)
    belongs to secondary_body polymorphically (FAILED - 523)
  validations
    is valid with valid attributes (FAILED - 524)
    relationship_type validation
      requires relationship_type to be present (FAILED - 525)
      validates relationship_type inclusion (FAILED - 526)
    numerical validations
      validates distance is positive (FAILED - 527)
      validates semi_major_axis is positive (FAILED - 528)
      validates eccentricity is between 0 and 1 (FAILED - 529)
      validates orbital_period is positive (FAILED - 530)
    uniqueness validation
      prevents duplicate relationships between same bodies (FAILED - 531)
  backward compatibility methods
    #sun
      returns primary_body when it's a Star (FAILED - 532)
      returns nil when primary_body is not a Star (FAILED - 533)
    #sun=
      sets primary_body and relationship_type (FAILED - 534)
    #celestial_body
      returns secondary_body when it's a CelestialBody (FAILED - 535)
    #celestial_body=
      sets secondary_body (FAILED - 536)
  relationship type helpers
    identifies star_planet relationships (FAILED - 537)
    identifies planet_moon relationships (FAILED - 538)
    identifies binary_star relationships (FAILED - 539)
  energy calculations
    #stellar_energy_input
      calculates stellar energy based on luminosity and distance (FAILED - 540)
      returns 0 when primary_body doesn't have luminosity (FAILED - 541)
    #tidal_heating
      calculates tidal heating for planet-moon relationships (FAILED - 542)
      includes eccentricity factor in calculation (FAILED - 543)
    #energy_input
      returns stellar energy for star_planet relationships (FAILED - 544)
      returns combined tidal and reflected energy for planet_moon relationships (FAILED - 545)
  terraforming reflected_energy and energy_input
    returns extra energy for star_planet with orbital mirrors and albedo adjustment (FAILED - 546)
  orbital mechanics
    #orbital_distance
      returns semi_major_axis when available (FAILED - 547)
      falls back to distance when semi_major_axis is nil (FAILED - 548)
      returns 0 when both are nil (FAILED - 549)
    #calculated_orbital_period
      calculates orbital period using Kepler's Third Law (FAILED - 550)
      returns nil when primary_body has no mass (FAILED - 551)
    #current_orbital_position
      calculates orbital position based on time (FAILED - 552)
      returns nil when orbital_period or epoch_time is missing (FAILED - 553)
  private methods
    #masses_present?
      returns true when both bodies have mass (FAILED - 554)
      returns false when primary_body has no mass (FAILED - 555)
    #extract_mass
      extracts mass from Star objects (FAILED - 556)
      extracts and converts mass from CelestialBody objects (FAILED - 557)
      returns nil for unsupported object types (FAILED - 558)

Organizations::BaseOrganization
  renders a text-based dashboard for a member
  renders a text-based dashboard for a non-member

Organizations::BaseOrganization
  distributes profits to members based on ownership (FAILED - 559)

Organizations::TaxAuthority
  .instance
    creates the Tax Authority if it does not exist
    always returns the same single instance (FAILED - 560)
    initializes with the correct identifier and name
  #tax_rate
    always returns 0.0, as the Tax Authority does not pay tax

PlanetBiome
  example at ./spec/models/planet_biome_spec.rb:15 (FAILED - 561)
  example at ./spec/models/planet_biome_spec.rb:16 (FAILED - 562)
  is valid with valid attributes (FAILED - 563)
  is not valid without a biome (FAILED - 564)
  is not valid without a celestial_body (FAILED - 565)

PlantEnvironment
  validations
    is valid with valid attributes (FAILED - 566)
    is not valid without a plant (FAILED - 567)
    is not valid without an environment (FAILED - 568)
    is not valid with duplicate plant and environment pair (FAILED - 569)
  associations
    belongs to a plant
    belongs to an environment

Plant
  validations
    is valid with valid attributes (FAILED - 570)
    is not valid without a name
    is not valid without a growth temperature range
    is not valid without a growth humidity range
    is not valid with a duplicate name
  methods
    can grow in a given environment if conditions are met (FAILED - 571)
    cannot grow in a given environment if conditions are not met (FAILED - 572)

Player
  validations
    is valid with valid attributes (FAILED - 573)
    is not valid without a name (FAILED - 574)
    is not valid without an active_location (FAILED - 575)
  account balance
    has a balance of 1000 (FAILED - 576)
  inventory at active location
    raises an error if active location is not set (FAILED - 577)
    returns the inventory at the active location (FAILED - 578)

Rigs::BaseRig
  detach/destroy behavior
    destroys the rig when removed from attachable
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :description cannot be empty/falsy
    is expected to validate that :rig_type cannot be empty/falsy
    is expected to validate that :capacity cannot be empty/falsy
    is expected to validate that :capacity looks like a number greater than or equal to 0
  #apply_rig_to_attachable
    applies rig effect to the attachable unit (FAILED - 579)
  #remove_from
    removes rig effect from the attachable unit (FAILED - 580)
  polymorphic association
    can belong to an attachable BaseUnit (FAILED - 581)
    can be unattached from a unit
  operational data
    has an operational_data field with default values
    can store and update operational data
  .load_from_json
    creates a new rig instance from JSON data
  #process_tick
    does not raise error when called
  #apply_output_effects and #revert_output_effects
    applies and reverts output effects if attachable responds to update_outputs (FAILED - 582)
  #apply_damage_effects and #revert_damage_effects
    applies and reverts damage effects if attachable responds to update_damage_risks (FAILED - 583)

RouteProposal
  calculates vote outcome based on threshold (FAILED - 584)
  fails if votes do not meet threshold (FAILED - 585)

RouteProposalVote
  is valid with valid attributes (FAILED - 586)
  is invalid with an invalid vote value (FAILED - 587)

Settlement::BaseSettlement
  validations
    is valid with valid attributes (FAILED - 588)
    is not valid without a name (FAILED - 589)
    is not valid with a negative current population (FAILED - 590)
    is not valid with a non-integer current population (FAILED - 591)
  associations
    can belong to a player (FAILED - 592)
    has many docked crafts (FAILED - 593)
    has many base units (FAILED - 594)
    has a marketplace association using the correct foreign key (FAILED - 595)
    has a financial account (FAILED - 596)
    destroys the marketplace when destroyed (FAILED - 597)
  storage capacity
    calculates storage capacity by type (FAILED - 598)
    maintains backward compatibility with total storage capacity (liquid and gas only) (FAILED - 599)
    calculates total storage capacity (sum of all storage types) (FAILED - 600)
  Market Integration
    #npc_market_bid
      calls the NpcPriceCalculator with the correct arguments (FAILED - 601)
      returns the calculated price (FAILED - 602)
    #npc_buy_capacity
      when storage is the limiting factor (50 units)
        limits capacity by available storage (50) (FAILED - 603)
      when finances are the limiting factor (20 units)
        limits capacity by financial ability (20) (FAILED - 604)
      when bid price is zero
        returns 0 capacity (FAILED - 605)
      when account or inventory is missing
        returns 0 capacity if account is missing (FAILED - 606)
        returns 0 capacity if inventory is missing (FAILED - 607)
  after_create hooks
    creates a financial account and inventory (FAILED - 608)
  celestial body delegation
    delegates celestial_body to location (FAILED - 609)
  #process_materials
    processes materials using base units (FAILED - 610)
  operational_data
    can store and retrieve operational data (FAILED - 611)
    provides default empty hash if operational_data is empty (FAILED - 612)
    works with energy management methods (FAILED - 613)
  construction cost management
    #construction_cost_percentage
      returns default percentage when not set (FAILED - 614)
      returns custom percentage when set in operational_data (FAILED - 615)
      handles empty operational_data gracefully (FAILED - 616)
      handles missing manufacturing section gracefully (FAILED - 617)
      handles empty operational_data gracefully (FAILED - 618)
    #construction_cost_percentage=
      sets the construction cost percentage in operational_data (FAILED - 619)
      initializes operational_data manufacturing section if empty (FAILED - 620)
      preserves existing operational_data when setting percentage (FAILED - 621)
    #calculate_construction_cost
      calculates construction cost as percentage of purchase cost (FAILED - 622)
      rounds to 2 decimal places (FAILED - 623)
      handles zero purchase cost (FAILED - 624)
      handles string input by converting to float (FAILED - 625)
      handles nil input gracefully (FAILED - 626)
    manufacturing settings
      supports manufacturing efficiency setting (FAILED - 627)
      defaults manufacturing efficiency to 1.0 (FAILED - 628)
      supports equipment check setting (FAILED - 629)
      defaults equipment check to true (FAILED - 630)
  construction cost integration
    integrates construction cost calculations with settlement manufacturing data (FAILED - 631)
    preserves other operational_data when updating construction settings (FAILED - 632)
    works correctly when operational_data starts empty (FAILED - 633)

Settlement::City
  validations
    is valid with valid attributes (FAILED - 634)
    is not valid without a location (FAILED - 635)
    is not valid without a name (FAILED - 636)
    is not valid with a negative current population (FAILED - 637)
    is not valid with food_per_person less than or equal to zero (FAILED - 638)
    is not valid with water_per_person less than or equal to zero (FAILED - 639)
    is not valid with energy_per_person less than or equal to zero (FAILED - 640)
  #resource_requirements
    calculates resource requirements correctly (FAILED - 641)

Settlement::NPCColony
  can build a unit (FAILED - 642)
  can establish trade routes (FAILED - 643)
  can perform autonomous tasks (FAILED - 644)
  calculates total population across settlements (FAILED - 645)

Settlement::OrbitalDepot
  inheritance
    inherits from SpaceStation
    inherits from BaseSettlement
  #add_gas
    adds gas to inventory
    stores gas amount correctly
    accumulates multiple additions
    stores metadata with gas
    handles multiple gas types (FAILED - 646)
    raises error for negative amounts
  #remove_gas
    removes gas from inventory
    caps removal at available amount
    returns 0 when gas not available
    filters by metadata when provided
    raises error for negative amounts
  #get_gas
    returns 0 for non-existent gas
    returns correct amount for existing gas
    filters by metadata when provided
  #has_gas?
    returns true when sufficient gas available
    returns false when insufficient gas
    returns false for non-existent gas
  #total_gas_mass
    returns 0 when empty
    sums all gas types (FAILED - 647)
    excludes non-gas items if present
  #gas_inventory_summary
    returns empty hash when no gases
    groups by gas name (FAILED - 648)
  #depot_status
    returns comprehensive status hash (FAILED - 649)
  realistic terraforming scenario
    handles H2 import from Saturn for O2 management
    handles Sabatier reaction H2 consumption
    tracks multiple import batches
  integration with TerraformingManager
    provides interface compatible with PORO OrbitalDepot

Settlement::Outpost
  validations
    is valid with valid attributes (FAILED - 650)
    is not valid without a name (FAILED - 651)
  population capacity
    calculates total capacity from habitat units (FAILED - 652)
    calculates available capacity correctly (FAILED - 653)
    checks if it has capacity for additional population (FAILED - 654)

Settlement::Settlement
  validations
    is valid with valid attributes (FAILED - 655)
    is not valid without a name (FAILED - 656)
  population capacity
    calculates total capacity from habitat units (FAILED - 657)
    calculates available capacity correctly (FAILED - 658)
    checks if it has capacity for additional population (FAILED - 659)

Settlement::SpaceStation
  model structure
    inherits from BaseSettlement (FAILED - 660)
    includes LifeSupport (FAILED - 661)
    includes Docking (FAILED - 662)
    includes Shell concern (FAILED - 663)
    inherits Enclosable through Shell (FAILED - 664)
  validations
    validates settlement_type is station or outpost (FAILED - 665)
  associations
    example at ./spec/models/settlement/space_station_spec.rb:100 (FAILED - 666)
    example at ./spec/models/settlement/space_station_spec.rb:101 (FAILED - 667)
    example at ./spec/models/settlement/space_station_spec.rb:105 (FAILED - 668)
  dimensional interface (from Enclosable)
    #set_dimensions
      stores dimensions in operational_data (FAILED - 669)
      can set diameter for cylindrical stations (FAILED - 670)
    #area_m2
      calculates area for rectangular station (FAILED - 671)
      calculates area for cylindrical station (FAILED - 672)
    #calculate_volume
      calculates volume for rectangular station (FAILED - 673)
      calculates volume for cylindrical station (FAILED - 674)
  shell construction workflow (from Shell concern)
    #schedule_shell_construction!
      returns success result with materials and time estimate (FAILED - 675)
      updates status to framework_construction (FAILED - 676)
      accepts custom panel type (FAILED - 677)
      updates shell composition (FAILED - 678)
    construction phases
      advances through construction phases (FAILED - 679)
      creates atmosphere when sealed (FAILED - 680)
      does not initialize default modules when operational (FAILED - 681)
    status helpers
      responds to Shell concern status methods (FAILED - 682)
      checks sealed status correctly (FAILED - 683)
      checks pressurized status correctly (FAILED - 684)
  power generation (from Enclosable)
    calculates power generation from solar panels (FAILED - 685)
    accounts for panel degradation (FAILED - 686)
    accounts for failed panels (FAILED - 687)
  panel degradation and maintenance (from Enclosable)
    simulates panel degradation over time (FAILED - 688)
    can repair failed panels (FAILED - 689)
    can replace degraded panels (FAILED - 690)
    provides shell status report (FAILED - 691)
  storage capacity management
    #calculate_storage_capacity
      returns 0 when no storage units exist (FAILED - 692)
      sums capacity from all storage units (FAILED - 693)
      ignores units without storage capacity (FAILED - 694)
    #available_capacity
      returns total capacity when empty (FAILED - 695)
      subtracts current inventory mass (FAILED - 696)
    #can_store?
      returns true when sufficient capacity available (FAILED - 697)
      returns false when insufficient capacity (FAILED - 698)
  module management
    #add_module
      adds a new module to the station (FAILED - 699)
      requires station to be operational (FAILED - 700)
    module type queries
      filters modules by type (FAILED - 701)
    #habitat_capacity
      sums capacity from all habitat modules (FAILED - 702)
    #research_efficiency
      sums efficiency from all lab modules (FAILED - 703)
  operational status
    #fully_operational?
      requires shell to be operational (FAILED - 704)
      requires habitat modules (FAILED - 705)
    #station_status
      returns comprehensive status (FAILED - 706)
  damage and repair
    can damage modules (FAILED - 707)
    repairs damaged modules and shell (FAILED - 708)
  integration scenarios
    orbital depot inheriting from space station
      inherits all Shell/Enclosable functionality (FAILED - 709)
      adds depot-specific gas storage (FAILED - 710)
    complete station lifecycle
      goes from planned to fully operational (FAILED - 711)

ShellPrintingJob
  associations
    is expected to belong to settlement required: true
    is expected to belong to printer_unit required: true
    is expected to belong to inflatable_tank required: true
  validations
    is expected to validate that :status cannot be empty/falsy
    is expected to validate that :production_time_hours cannot be empty/falsy
    is expected to validate that :production_time_hours looks like a number greater than 0
  scopes
    returns active jobs (FAILED - 712)
    returns completed jobs (FAILED - 713)
    returns in_progress jobs (FAILED - 714)
  #start!
    changes status to in_progress and sets started_at (FAILED - 715)
  #complete!
    changes status to completed and sets completed_at (FAILED - 716)
  #progress_percentage
    calculates progress percentage (FAILED - 717)
  #time_remaining_hours
    calculates remaining time (FAILED - 718)
  #process_tick
    when job is not complete
      increases progress_hours (FAILED - 719)
    when job completes during tick
      completes the job (FAILED - 720)

SolarSystem
  associations
    has one spatial_location association (FAILED - 721)
    example at ./spec/models/solar_system_spec.rb:30 (FAILED - 722)
    example at ./spec/models/solar_system_spec.rb:31 (FAILED - 723)
    example at ./spec/models/solar_system_spec.rb:32 (FAILED - 724)
    example at ./spec/models/solar_system_spec.rb:33 (FAILED - 725)
    example at ./spec/models/solar_system_spec.rb:34 (FAILED - 726)
    example at ./spec/models/solar_system_spec.rb:35 (FAILED - 727)
    example at ./spec/models/solar_system_spec.rb:36 (FAILED - 728)
    example at ./spec/models/solar_system_spec.rb:38 (FAILED - 729)
  validations
    example at ./spec/models/solar_system_spec.rb:42 (FAILED - 730)
    example at ./spec/models/solar_system_spec.rb:43 (FAILED - 731)
  callbacks
    generates a unique name before create if name is not present (FAILED - 732)
    sets an initial star after create if no stars exist (FAILED - 733)
  #load_star
    loads or creates a star with the given parameters (FAILED - 734)
    updates an existing star if the name matches (FAILED - 735)
  #load_terrestrial_planet
    loads or creates a terrestrial planet (FAILED - 736)
    updates an existing terrestrial planet if the name matches (FAILED - 737)
  #load_gas_giant
    loads or creates a gas giant (FAILED - 738)
    updates an existing gas giant if the name matches (FAILED - 739)
  #load_ice_giant
    loads or creates an ice giant (FAILED - 740)
    updates an existing ice giant if the name matches (FAILED - 741)
  #load_moon
    loads or creates a moon (FAILED - 742)
    updates an existing moon if the name matches (FAILED - 743)
  #load_dwarf_planet
    loads or creates a dwarf planet (FAILED - 744)
    updates an existing dwarf planet if the name matches (FAILED - 745)
  #habitable_zone?
    when a planet is in the habitable zone of at least one star
      returns true (FAILED - 746)
    when a planet is outside the habitable zone of all stars
      returns false (FAILED - 747)
    when there are no stars
      returns false (FAILED - 748)
    when the planet does not have an orbital period
      returns false (FAILED - 749)
  #total_mass
    calculates total mass of all planets and dwarf planets (FAILED - 750)
  star relationships
    can have multiple stars (FAILED - 751)
    identifies the primary star by mass (FAILED - 752)
    supports binary star systems (FAILED - 753)

SpecialMission
  is expected to belong to settlement class_name => Settlement::BaseSettlement required: true
  is expected to validate that :material cannot be empty/falsy
  is expected to validate that :required_quantity cannot be empty/falsy
  is expected to validate that :required_quantity looks like a number greater than 0
  is expected to validate that :reward_eap cannot be empty/falsy
  is expected to validate that :reward_eap looks like a number greater than 0
  enums
    defines status enum
  scopes
    has open scope
  instance methods
    #accept!
      updates status to accepted
    #complete!
      updates status to completed
    #total_reward
      returns the reward_eap

Storage::BaseStorage
  #add_item
    adds item successfully (FAILED - 754)
    fails to add item if not enough capacity
  #remove_item
    removes item successfully (FAILED - 755)
    fails to remove item if not enough available (FAILED - 756)

Storage::GasStorage
  initializes with the correct type (FAILED - 757)

Storage::SolidStorage
  initializes with the correct type (FAILED - 758)

Storage::SurfaceStorage
  validations
    validates presence of required attributes
  #add_pile
    creates a new material pile
    updates existing pile amount
    returns false when material_name is invalid
  #check_item_conditions
    when atmosphere contains corrosive gases
      applies surface conditions to the item
    when atmosphere does not contain corrosive gases
      does not corrode the item

Structures::BaseStructure
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without a structure_name
    is not valid without a structure_type
  associations
    belongs to a settlement
    belongs to an owner
    has many base_units
    has many modules
  #operational?
    returns false when missing required units
    returns false when power system is offline
    returns true when all requirements are met
    returns false when in maintenance mode
  unit management
    #install_unit
      installs a unit if slot is available
      fails if no slot is available
    #uninstall_unit
      removes an installed unit
      fails for units not attached to the structure
    #build_recommended_units
      builds the recommended units
  module management
    #build_recommended_modules
      builds the recommended modules
  operational mode management
    #current_mode
      returns the current operational mode
      returns 'standby' as default if not set
    #set_operational_mode
      changes the operational mode if valid
      fails if mode is invalid
    #available_modes
      returns all available operational modes
      returns ['standby'] as default if not set
  module effect management
    supports adding and removing module effects via HasModules concern

CelestialBodies::TerrestrialPlanet
  runs TerraSim on planet creation (FAILED - 759)
  #update_biomes
    updates biomes specific to terrestrial planets (FAILED - 760)
  #add_gas
    adds gas and updates the mass (FAILED - 761)
  #calculate_surface_conditions
    calculates surface conditions specific to terrestrial planets (FAILED - 762)

Transaction
  associations
    belongs to an account (FAILED - 763)
    belongs to a recipient (FAILED - 764)
  validations
    requires a transaction_type (FAILED - 765)
    requires a valid transaction_type (FAILED - 766)
    requires an amount (FAILED - 767)
    requires amount to be numeric (FAILED - 768)
  transaction types
    allows deposit transactions (FAILED - 769)
    allows withdraw transactions (FAILED - 770)
    allows transfer transactions (FAILED - 771)

UnitAssemblyJob
  associations
    is expected to belong to base_settlement required: true
    is expected to have many material_requests
  validations
    is expected to validate that :base_settlement cannot be empty/falsy
    is expected to validate that :unit_type cannot be empty/falsy
    is expected to validate that :count cannot be empty/falsy
  #settlement delegation
    delegates settlement to base_settlement
  #materials_gathered?
    returns false when not all materials are fulfilled (FAILED - 772)
    returns true when all materials are fulfilled (FAILED - 773)
    returns true when no material requests exist (FAILED - 774)
  #start_assembly
    starts assembly when materials are gathered (FAILED - 775)
    consumes materials from inventory (FAILED - 776)
    returns false when not materials_pending status (FAILED - 777)
  #complete_assembly
    creates unassembled items in inventory
    marks job as completed
    returns false when not in_progress
  scopes
    .active
      returns jobs that are not completed/failed/canceled

Units::BaseUnit
  validations
    is expected to validate that :identifier cannot be empty/falsy
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :unit_type cannot be empty/falsy
  associations
    is expected to belong to owner required: true
    is expected to belong to attachable optional: true
    is expected to have many attached_units
    is expected to have one location
    is expected to have one inventory
  create new unit
    creates a valid unit with given attributes
  location and celestial body
    returns the correct location
    returns the correct celestial body
  storage operations
    #store_resource
      stores oxygen in liquid state
      prevents overfilling tank
      validates storage compatibility
    #store_item
      stores items in both inventory and operational data (FAILED - 778)
      respects storage capacity limits
      updates existing items (FAILED - 779)
  general storage operations
    #store_resource
      can store items up to capacity
      tracks available capacity
  inventory integration
    #store_resource
      creates inventory items when storing resources
      updates inventory when removing resources
  unit initialization
    loads correct storage configuration
  #process_resources
    processes material based on composition
  #store_on_surface
    calls add_pile on surface storage
    returns false if attachable does not respond to :surface_storage
    returns false if surface_storage returns nil

Units::Battery
  battery attributes
    reports correct battery capacity
    reports correct battery level
    calculates battery percentage correctly
    handles zero capacity
  #charge_battery
    charges the battery by the specified amount
    limits charging to max charge rate
    limits charging to battery capacity
  #discharge_battery
    discharges the battery by the specified amount
    limits discharging to max discharge rate
    limits discharging to available charge
  interaction with BatteryManagement concern
    has both specialized and concern methods
    prefers specialized methods over concern methods (FAILED - 780)

#overclock
  temporarily increases mining rate

Units::Computer
  attributes
    is expected to respond to #mining_rate_value
    is expected to respond to #efficiency_upgrade_value
    has default values
  #mine
    calculates GCC based on mining rate and efficiency
  #energy_required
    returns default energy required value
  #total_efficiency
    calculates total efficiency with upgrades
  #upgrade_efficiency
    increases efficiency upgrade value
  #overclock
    temporarily increases mining rate

Units::WasteTreatmentUnit
  #operate
    operates successfully and produces recycled and neutralized output (FAILED - 781)
    returns false if insufficient waste is available (FAILED - 782)
    returns false if insufficient power is available (FAILED - 783)

Wormhole
  associations
    is expected to belong to solar_system_a class_name => SolarSystem required: true
    is expected to belong to solar_system_b class_name => SolarSystem required: true
    is expected to have many endpoints class_name => SpatialLocation dependent => destroy (FAILED - 784)
    is expected to have many stabilizers class_name => Craft::BaseCraft inverse_of => stabilizing_wormhole
  validations
    is expected to validate that :solar_system_a cannot be empty/falsy
    is expected to validate that :solar_system_b cannot be empty/falsy
    is expected to validate that :wormhole_type cannot be empty/falsy
    validates different systems
    does not allow zero or negative mass limits
  after creation
    generates endpoints in both systems
  #stabilization_satellites
    returns deployed stabilization satellites within range of either endpoint (FAILED - 785)
  #operational_stabilizers
    returns a unique list of operational direct stabilizers and stabilization satellites (FAILED - 786)
  #appearance_profile
    when natural wormhole
      and stable without artificial station
        returns :naturally_anchored
      and unstable
        returns :exotic_anomalous
      and has hazard zone
        returns :exotic_anomalous
      and has exotic resources
        returns :exotic_anomalous
      and has artificial station built
        returns :artificial_only_stabilized
    when artificial wormhole
      returns :artificial_only_stabilized
  #safe_for_travel?
    with insufficient operational stabilizers
      is not safe (FAILED - 787)
    with enough operational stabilizers
      is safe (FAILED - 788)
  #can_traverse?
    with sufficient mass limit
      returns true (FAILED - 789)
    with insufficient mass limit
      returns false (FAILED - 790)
    when one-way and already traversed
      returns false (FAILED - 791)
  #traverse!
    with endpoint shifting
      randomizes coordinates of endpoint A when not stabilized and mass limit is hit (FAILED - 792)
      randomizes coordinates of endpoint B when not stabilized and mass limit is hit (FAILED - 793)
      does not shift stabilized endpoint A when mass limit is hit (FAILED - 794)
      does not shift stabilized endpoint B when mass limit is hit (FAILED - 795)
  #stabilization_satellites (integration)
    returns deployed stabilization satellites within range of either endpoint (FAILED - 796)

AIManager::AiPrioritySystem
  #check_critical
    sorts issues by priority descending
    when life support is critical
      returns life support issue with highest priority
    when atmospheric maintenance is critical
      returns atmospheric issue with high priority
    when debt is critical
      returns debt issue with medium-high priority
  #check_operational
    when resource procurement is needed
      returns resource procurement need
    when construction is needed
      returns construction need
  #can_expand?
    when settlement has critical issues
      returns false
    when settlement has operational needs
      returns false
    when settlement is stable
      returns true
  priority constants
    defines critical priorities
    defines operational priorities

AIManager::DecisionTree
  #make_decisions
    when oxygen is critical
      calls handle_oxygen_refill and returns (FAILED - 797)
    when account is negative
      calls handle_debt_repayment and returns (FAILED - 798)
    when no priorities
      proceeds with normal decision making (FAILED - 799)
  #handle_oxygen_refill
    calls prioritize_oxygen_refill on resource_planner (FAILED - 800)
  #handle_debt_repayment
    sets si_ask_ceiling in settlement operational_data (FAILED - 801)
  #handle_mars_oxygen_maintenance
    calls prioritize_energy_for_o2_generation on resource_planner (FAILED - 802)
  #handle_mars_nitrogen_import
    finds closest resource source and creates interplanetary contract (FAILED - 803)
  Mars planet-aware crisis handling
    when O2 crisis on Mars
      handles O2 crisis through local maintenance, not trade (FAILED - 804)
    when N2 crisis on Mars
      triggers interplanetary contract based on closest source (FAILED - 805)

AIManager::ExpansionService
  .expand_with_intelligence
    successfully expands with probe deployment and asteroid tug integration
    generates settlement plan with appropriate mission type
    includes probe data in the result
    links to appropriate mission profile based on system characteristics
    calculates success probability and ROI
    with moon target
      includes asteroid tug configuration for moon targets
      selects appropriate tug mission based on moon size
    with asteroid target
      includes asteroid tug for asteroid targets
  .expand_with_pattern (legacy)
    expands settlement with pattern when suitable
    fails expansion when pattern is not suitable

AIManager::ManifestParser
  #extract_equipment_from_manifest
    extracts complete equipment data from manifest
    handles missing manifest file gracefully
  #extract_craft_fit
    extracts modules and units from craft fit
    handles nil craft data
  #extract_inventory
    extracts deployable units, supplies, and consumables
  #calculate_economics
    calculates economic profile with path determination
    identifies Earth imports vs local production
  #determine_path
    returns Path A for high Earth dependency
    returns Path B for mixed approach
    returns Path C for mostly local production

AIManager::OperationalManager
  #initialize
    loads trained patterns
    initializes priority system
  #make_decision
    when critical issues exist
      handles critical issues
    when no critical issues but operational needs exist
      handles operational needs
    when stable and expansion is feasible
      considers expansion (FAILED - 806)
    when stable with no expansion opportunities
      maintains current operations (FAILED - 807)
  #execute_decision
    emergency procurement decision
      calls emergency mission service
    resource procurement decision
      calls procurement service
    construction decision
      calls construction service
    expansion decision
      calls expansion service
    debt repayment decision
      calls financial service
  pattern matching
    #find_expansion_pattern
      returns the highest-scoring suitable pattern
      scores patterns based on ISRU ratio and equipment count
    #pattern_suitable_for_expansion?
      accepts patterns with cost and equipment
      rejects patterns without equipment
  decision logging
    logs decisions with timestamps and categories (FAILED - 808)
  #determine_dc_type
    with Ceres
      forms Ceres Development Corporation aligned with Mars
    with Mars
      forms independent Mars Development Corporation
    with Titan
      forms Titan Development Corporation aligned with Saturn
    with unknown world
      falls back to world type classification

AIManager::PatternValidator
  #validate_pattern
    with a valid pattern
      returns valid status for well-formed pattern
    with insufficient life support
      flags insufficient resources
    with invalid equipment IDs
      flags invalid equipment
    with unrealistic cost
      flags suspicious costs
    with aggressive timeline
      flags unrealistic timelines
  helper methods
    #extract_id
      extracts ID from formatted strings
    #estimate_crew_size
      estimates crew based on habitat units
      reduces crew estimate with robots
    #find_consumable_amount
      extracts amounts from consumable strings

AIManager::PriorityHeuristic
  #oxygen_critical?
    when O2 mass is above 15% of target
      returns false (FAILED - 809)
    when O2 mass is below 15% of target
      returns true (FAILED - 810)
  #account_negative?
    when account balance is positive
      returns false (FAILED - 811)
    when account balance is negative
      returns true (FAILED - 812)
  #get_priorities
    when neither condition is met
      returns empty array (FAILED - 813)
    when oxygen is critical
      returns refill_oxygen priority (FAILED - 814)
    when account is negative
      returns debt_repayment priority (FAILED - 815)
    when both conditions are met
      returns both priorities (FAILED - 816)
  #get_priorities on Mars
    when oxygen is critical on Mars
      returns local_oxygen_generation priority instead of refill_oxygen (FAILED - 817)
    when nitrogen is critical on Mars
      returns local_argon_extraction priority (FAILED - 818)
  #calculate_si_ask_price
    returns 95% of the calculated ask price (FAILED - 819)
  Environmental System Integration
    with procedurally generated planet having 95% CO2 and 0.0 Tesla magnetic field
      correctly chooses local O2 production (FAILED - 820)
    with planet having low CO2 and weak magnetic field
      chooses oxygen refill instead of local generation (FAILED - 821)
    with settlement having excess CO and H2
      prioritizes methane synthesis (FAILED - 822)
    with settlement having critical storage capacity
      prioritizes storage module construction (FAILED - 823)

AIManager::SystemArchitect
  Sabatier Refinements
    #get_maintenance_tax_em
      applies 25% discount when sabatier units are active
      does not apply discount when sabatier units are not active
    #sabatier_units_active?
      returns true when contract flag is set

AIManager::SystemArchitect
  #initialize
    analyzes system configuration
  #analyze_system_configuration
    with moons
      identifies large and small moons
    without moons
      identifies moonless system
  #determine_deployment_template
    with 2+ small moons
      returns conversion template
    with large moon
      returns lunar_standard template
    moonless with nearby asteroid
      returns asteroid_capture template
    moonless without asteroid
      returns cycler_staging template
  #deploy_subsurface_foothold
    creates subsurface location (FAILED - 824)
    creates settlement (FAILED - 825)
  #find_nearby_asteroid
    with suitable asteroid
      finds the asteroid (FAILED - 826)
    without suitable asteroid
      returns nil
  #transfer_ownership_to_system_corp
    creates system specific corporation
    transfers settlements

AIManager::SystemIntelligenceService
  #system_status
    with operational structures
      returns correct operational ratio and status (FAILED - 827)
    with all operational structures
      returns healthy status (FAILED - 828)
    with mostly non-operational structures
      returns critical status (FAILED - 829)
  #narrative_status
    critical status
      returns critical narrative
    warning status
      returns warning narrative
    healthy status
      returns healthy narrative
  #licensing_runway
    with USD balance
      calculates runway correctly
    with zero balance
      returns zero runway
    no SSC found
      returns nil
  #sustainability_delta
    calculates positive delta
  #logistics_efficiency
    with contracts
      calculates efficiency
    no contracts
      returns 0.0
  #economic_health_score
    with balances
      calculates score
    no SSC
      returns 0

AIManager::TaskExecutionEngine
  #initialize
    loads mission and settlement
    loads task list from profile-based structure
    initializes current task index to 0
    initializes material tracking hashes
  #start
    executes all tasks synchronously
  #execute_next_task
    when all tasks are complete
      returns false
    when task execution succeeds
      increments the task index
      updates mission progress
      returns true
    when task execution fails
      logs error
      returns false
  #execute_task
    with effects-based task
      executes each effect
    with legacy task type
      calls legacy handler
  #execute_effect
    with deploy_unit effect
      calls deploy_unit_from_effect
    with set_unit_state effect
      calls set_unit_state
    with connect_units effect
      calls connect_units_from_effect
    with manufacture effect
      calls manufacture_from_effect
    with check_unit_state effect
      calls check_unit_state_from_effect
    with check_unit_connected effect
      calls check_unit_connected_from_effect
    with transfer_resource effect
      calls transfer_resource_from_effect
    with unknown effect
      returns false
  #deploy_unit_from_effect
    creates multiple units when count > 1
    returns true on success
    when blueprint not found
      returns false
  #set_unit_state
    updates state for all matching units
    returns true even if no units found
  #connect_units_from_effect
    connects units successfully
    returns true even if units not found (AI simulation)
  #manufacture_from_effect
    tracks input materials as consumed
    tracks output materials as produced
    calls ResourceTrackingService with correct parameters
    returns true on success
  #check_unit_state_from_effect
    when unit is in expected state
      returns true
    when unit is in different state
      returns true (soft check for AI simulation)
    when unit not found
      returns true (soft check for AI simulation)
  #check_unit_connected_from_effect
    returns true when unit exists
    returns true even when unit not found (soft check)
  #transfer_resource_from_effect
    with continuous transfer
      returns true
    with one-time transfer
      returns true
  #initiate_construction
    with crater_dome structure
      creates a crater dome structure (FAILED - 830)
      uses ConstructionJobService (FAILED - 831)
    with skylight_cover structure
      skips skylight for AI simulation
  #update_mission_progress
    calculates and updates progress percentage
    updates operational_data with task counts
  #complete_mission
    updates mission status to completed
    sets progress to 100
    sets completion_date
    calls ResourceTrackingService
  #production_summary
    generates summary of production
    generates summary of consumption
  .orbital_resupply_cycle
    when conditions are met for resupply
      schedules a material ferry mission (FAILED - 832)
      updates craft status (FAILED - 833)
    when no active projects
      does not schedule missions (FAILED - 834)
  .check_material_surplus
    returns surplus above threshold
    when below threshold
      returns 0

AIManager::TerraformingManager
  #calculate_gas_needs
    with magnetosphere protection
      returns gas needs for warming phase (FAILED - 835)
    without magnetosphere protection
      returns empty hash (FAILED - 836)
    with preservation mode and exceeded limit
      returns empty hash (FAILED - 837)
  #has_magnetosphere_protection?
    with natural magnetosphere
      returns true (FAILED - 838)
    without natural magnetosphere
      returns false (FAILED - 839)
  #atmospheric_reduction_exceeded?
    with preservation mode
      when reduction exceeds 5%
        returns true
      when reduction is below 5%
        returns false
    without preservation mode
      returns false
  #determine_terraforming_phase
    warming phase
      returns warming when temperature is low
    maintenance phase
      returns maintenance when conditions are met
  #should_seed_biosphere?
    with existing biosphere
      returns false
    without biosphere and suitable conditions
      returns true

AIManager::TestScenarioExtractor
  .extract_training_scenarios
    extracts realistic settlement scenarios from test mocks
    includes operational and expansion scenarios
  .convert_to_training_format
    converts scenarios to AI training format

AutonomousMissionService
  .find_or_create_worldhouse_feature
    when a lava tube exists
      returns the existing lava tube (FAILED - 840)
    when no lava tube exists but a valley exists
      returns the existing valley
    when no lava tube or valley exists but a canyon exists
      returns the existing canyon
    when no suitable features exist
      creates a new lava tube feature
    priority order
      prioritizes lava tube over valley and canyon (FAILED - 841)
    when valley exists but no lava tube
      prioritizes valley over canyon
  .execute_base_building_sequence
    calls the feature finding method (FAILED - 842)
    logs mission progress (FAILED - 843)

ConsortiumMembershipService
  allows a corporation to apply for membership with sufficient investment
  rejects non-corporation applicants
  rejects applications with insufficient investment
  dilutes existing members and assigns correct ownership

Construction::OrbitalShipyardService
  .create_shipyard_project
    with valid parameters
      creates a new orbital construction project (FAILED - 844)
      associates the project with the station (FAILED - 845)
      sets the correct blueprint_id (FAILED - 846)
      sets initial status to materials_pending (FAILED - 847)
      initializes progress_percentage to 0 (FAILED - 848)
      loads required materials from blueprint (FAILED - 849)
      initializes delivered_materials with zero values (FAILED - 850)
    with invalid blueprint_id
      raises an error (FAILED - 851)
  .deliver_materials
    when material is needed
      consumes the material for the project (FAILED - 852)
      returns the unconsumed quantity (FAILED - 853)
      does not consume more than needed (FAILED - 854)
    when material is not needed
      returns the full quantity (FAILED - 855)
      does not update any project materials (FAILED - 856)
    when project becomes ready
      changes status to in_progress when all materials are delivered (FAILED - 857)
    with multiple projects
      distributes materials across projects (FAILED - 858)
  .update_construction_progress
    increases progress percentage (FAILED - 859)
    does not exceed 100% (FAILED - 860)
    when progress reaches 100%
      completes the project (FAILED - 861)
  .complete_project
    marks the project as completed (FAILED - 862)
    spawns the completed craft (FAILED - 863)
  .spawn_completed_craft
    creates a new craft (FAILED - 864)
    associates the craft with the station (FAILED - 865)
    sets the craft status to docked (FAILED - 866)
    loads operational data from blueprint (FAILED - 867)
  .load_craft_blueprint
    with valid blueprint_id
      loads the blueprint from JSON file
    with invalid blueprint_id
      raises an error

CraterDomeConstructionService
  #construct
    creates a construction job successfully (FAILED - 868)
    when entity is different from service provider
      processes a payment (FAILED - 869)
  #start_construction
    starts the construction process (FAILED - 870)
  #complete_construction
    completes the construction process (FAILED - 871)

End-to-End Economic Simulation
  simulates the full pipeline to determine the initial market listing price (FAILED - 872)

EconomicConfig
  cryptocurrency mining methods
    returns the GCC max supply
    returns the GCC halving interval days
    returns the GCC issuance model
    returns the GCC difficulty scaling flag
    returns the GCC initial block reward
    returns the GCC minimum block reward
  transport methods
    returns transport rate for bulk_material
    returns transport rate for manufactured
    returns transport rate for high_tech
    falls back to bulk_material rate for unknown categories
  earth pricing methods
    returns earth spot price for known materials
    returns nil for unknown materials

Financial::ExchangeRateService
  #initialize
    initializes with empty rates by default
    initializes with provided rates
  #convert
    returns the amount unchanged when from and to currencies are the same
    converts using the stored rate
    defaults to 1.0 rate when no rate is found
    handles string and symbol currencies
  #get_rate
    returns the stored rate
    returns 1.0 for unknown rate pairs
    normalizes keys to strings
  #set_rate
    sets a new rate
    updates an existing rate
    normalizes keys to strings
  #value_of
    converts item quantity to target currency
    uses default rate when no specific rate exists
  #base_price_for
    when item is found with value
      returns the item value converted to target currency
      defaults to GCC currency when not specified
    when blueprint is found with cost_data
      returns the blueprint cost converted to target currency
    when neither item nor blueprint is found
      returns default value converted to target currency
  #market_price_for
    returns nil (TODO: implement market price lookup)
  #price_for
    returns market price when available
    falls back to base price when market price is not available
  integration with economic config
    works with the initial USD=GCC peg
    supports future currency decoupling

Financial::TaxCollectionService
  .collect_sales_tax
    when tax is applicable
      calculates the correct tax amount (FAILED - 873)
      calls the TransactionManager to move the tax funds
    when tax rate is zero (e.g., for Tax Authority)
      returns 0.0 and does not call the TransactionManager (FAILED - 874)
    when organization is missing a tax rate
      returns 0.0 and does not call the TransactionManager (FAILED - 875)

Financial::TransactionManager
  .create_transfer
    creates a new Financial::Transaction record
    sets the correct attributes on the created transaction
    raises an error if creation fails due to missing ActiveRecord validation (e.g., missing account)

FittingResult
  initializes with success true and empty arrays
  marks success false and adds error when add_error is called

FittingService
  fits all components from inventory (FAILED - 876)
  returns errors if inventory is missing items (FAILED - 877)
  fits components without inventory if inventory is nil (FAILED - 878)
  does not persist changes if dry_run is true (FAILED - 879)

GameSimulation
  #initialize
    sets the game_state
  #advance_by_days
    when days is zero or negative
      does not advance the game
    when days is positive
      advances the game time and saves the state
      handles year rollover correctly
  #process_celestial_bodies
    simulates only bodies that should be simulated
    logs errors if simulation fails

Game
  #advance_by_days
    advances the simulation by the given number of days (FAILED - 880)
    does not advance time if days is zero or negative (FAILED - 881)

Generators::GameDataGenerator
  generates and saves a valid JSON item

Generators::LavaTubeGenerator
  #generate
    with random generation
      creates a lava tube with random features (FAILED - 882)
      generates random dimensions (FAILED - 883)
      generates random attributes (FAILED - 884)
      creates random skylights and access points (FAILED - 885)
    with predefined parameters
      creates a lava tube with specified parameters (FAILED - 886)
      creates predefined skylights and access points (FAILED - 887)
    with minimal parameters
      creates a lava tube with defaults (FAILED - 888)

Generators::ValleyGenerator
  #generate
    with random generation
      creates a valley with random features (FAILED - 889)
      generates random dimensions (FAILED - 890)
      generates segments (FAILED - 891)
      creates random access points
    with predefined parameters
      creates a valley with specified parameters (FAILED - 892)
      creates predefined access points (FAILED - 893)

Logistics::ContractService
  .create_internal_transfer
    with valid settlements
      creates a logistics contract for internal transfer (FAILED - 894)
    with invalid settlements
      returns nil when from_settlement is not an NPC

Logistics::InternalTransferService
  .create_internal_contract
    when transfer is possible
      creates a logistics contract
      creates a provider if needed
    when transfer is not possible
      returns nil when from_settlement lacks material
      returns nil when to_settlement lacks storage
  .process_internal_transfers
    when transfer can be completed
      completes the transfer
    when transfer cannot be completed
      marks contract as failed when material unavailable

Logistics::InventoryManager
  .transfer_item
    when transferring to a station with orbital construction projects
      intercepts materials for orbital construction (FAILED - 895)
      does not add materials to station inventory if all consumed by projects (FAILED - 896)
    when transferring orbital construction materials to non-orbital settlement
      transfers materials normally without interception (FAILED - 897)
    when transferring non-orbital materials to orbital station
      transfers materials normally without interception (FAILED - 898)
  .should_check_orbital_projects?
    returns true for known orbital materials
    returns true for materials containing panel or beam
    returns false for non-orbital materials

Lookup::BlueprintLookupService
  #initialize
    initializes without error
    loads blueprints on initialization
  #find_blueprint
    with real blueprint files
      finds blueprints by exact name match
      finds blueprints by exact ID match
      is case insensitive
      returns nil for non-existent blueprints
      handles empty or nil queries gracefully
    with category filtering
      filters blueprints by category
      returns nil when blueprint exists but category does not match
    with aliases
      finds blueprints by alias
    with partial matches
      finds blueprints by partial name match for queries >= 3 characters
      does not match partial queries shorter than 3 characters
  #all_blueprints
    returns an array
    returns consistent results on multiple calls
    when blueprint files exist
      returns blueprints with expected structure
  #blueprints_by_category
    returns blueprints filtered by category
    returns empty array for non-existent category
    handles nil category gracefully
    is case insensitive for category matching
  #debug_paths
    runs without error
  error handling
    handles missing blueprint directories gracefully
    handles JSON parsing errors gracefully
  real world usage
    when blueprint files exist
      can find common blueprint types
      loads blueprints with valid JSON structure

Lookup::CraftLookupService
  #find_craft
    loads crafts from the correct file structure
    loads JSON files with correct format (FAILED - 899)
    returns nil for nonexistent crafts
    validates input parameters
    uses cached results for subsequent lookups
    with real craft data
      matches by category
      matches by id
      matches by name
      matches by subcategory if present
      matches by partial id with sufficient length
      is case insensitive
      matches by partial name with sufficient length
      handles special characters in queries (PENDING: No special characters in craft name)
      handles whitespace in queries
      can match by multiple criteria simultaneously
    with error handling
      handles JSON parsing errors
      handles IO errors
      handles file not found errors
      handles directory not found errors
      handles invalid path errors
  #debug_paths
    outputs path information without errors
    outputs correct path information
  error handling during initialization
    gracefully handles errors when loading crafts
    initializes successfully even with file system errors
  using actual data files
    finds a specific craft by id
    finds a craft by category
    can find crafts by folder structure

Lookup::EarthReferenceService
  Earth reference data
    loads Earth data from the fixture file
  fallback behavior
    uses fallback values when properties are missing

Lookup::ItemLookupService
  #find_item
    loads items from the correct file structure (FAILED - 900)
    finds consumable items with correct data (PENDING: No consumable item files found)
    finds equipment items with correct data (PENDING: No equipment item files found)
    returns nil when item does not exist
    handles dynamic unassembled items
    handles scrap items dynamically (FAILED - 901)
    caches results for subsequent lookups (PENDING: Item battery_cells not found)
    finds items by partial name match
    is case insensitive
  dynamic item creation
    creates scrap items on the fly (FAILED - 902)
    creates processed items on the fly (FAILED - 903)
    creates used items on the fly (FAILED - 904)
  integration with other lookup services
    converts materials to items when needed
  item loading
    loads items from all configured paths
    handles missing directories gracefully

Lookup::MaterialLookupService
  #find_material
    loads materials from the correct file structure
    finds atmospheric gases by chemical formula (FAILED - 905)
    finds materials case-insensitively (FAILED - 906)
    returns nil for nonexistent materials
  atmosphere gas creation behavior
    correctly maps chemical formulas for atmosphere creation
  material property access
    provides access to material properties directly from data
    has all expected material properties (FAILED - 907)
  #get_material_property
    with valid material
      returns top-level properties
      returns nested properties from properties hash
      returns nil for non-existent properties
    with nil material
      returns nil gracefully
    with nil property name
      returns nil gracefully
  #get_molar_mass
    returns molar mass for existing materials
    returns nil for non-existent materials
  #atmospheric_components
    converts chemical formulas to material data
    filters out unknown materials
    preserves percentage data
  .base_materials_path
    returns a Pathname object
    points to the correct materials directory
  .locate_gases_path
    returns the gases directory path
    uses GalaxyGame::Paths consistently (FAILED - 908)
  MATERIAL_PATHS configuration
    has all expected material types
    has valid path configurations
  #debug_paths
    prints path information without errors
    outputs expected format
  error handling
    with corrupted JSON files
      handles JSON parsing errors gracefully (FAILED - 909)
    with missing directories
      handles missing directories gracefully
      handles missing recursive directories gracefully
    with service initialization errors
      continues with empty materials on load failure
      logs errors when initialization fails
  material matching logic
    matches by exact chemical formula
    matches by material ID
    matches by name
    handles partial matches in name and ID
    returns false for non-matches
    handles nil inputs gracefully
  integration with AtmosphereConcern
    provides materials needed for atmospheric calculations

Lookup::ModuleLookupService
  #find_module
    loads modules from the correct file structure
    finds modules by module_type
    finds modules case-insensitively
    returns nil for nonexistent modules
    handles nil and blank module types
  service configuration
    has the correct base path (FAILED - 910)
    has all expected module categories
    includes life_support in module categories
  module data structure validation
    when co2_scrubber module exists
      has all expected module properties
      has correct energy consumption
      has input and output resources
      follows the operational data template
    when life_support module exists
      has basic life support properties
      follows the operational data template
  error handling
    handles JSON parsing errors gracefully
    handles missing base directory gracefully
  integration with BaseModule
    provides data needed for module creation

Lookup::PlanetaryGeologicalFeatureLookupService
  #initialize
    initializes with a celestial body (FAILED - 911)
    loads features during initialization (FAILED - 912)
  #all_features
    returns an empty array when no features exist
    returns all loaded features (FAILED - 913)
    handles multiple JSON files (FAILED - 914)
    handles single feature JSON files (FAILED - 915)
  #find_by_name
    finds a feature by exact name match (FAILED - 916)
    finds a feature by case-insensitive name match (FAILED - 917)
    finds a feature by lowercase name match (FAILED - 918)
    returns nil when feature is not found (FAILED - 919)
    handles symbol input (FAILED - 920)
    returns the first match when multiple features have the same name (FAILED - 921)
  #features_by_type
    returns features of a specific type (FAILED - 922)
    returns features by case-insensitive type match (FAILED - 923)
    returns empty array when no features of that type exist (FAILED - 924)
    handles symbol input (FAILED - 925)
  #feature_summary
    groups features by type (FAILED - 926)
    handles features with nil type (FAILED - 927)
    returns empty hash when no features exist (FAILED - 928)
  path construction
    constructs correct path for planet (FAILED - 929)
    handles missing solar system gracefully
  error handling
    handles JSON parse errors gracefully (FAILED - 930)
    handles missing directories gracefully
    logs debug information about found files (FAILED - 931)

Lookup::StructureLookupService
  #find_structure
    when searching by structure_id and category (type)
      returns the structure data when found in the specified type directory
      returns nil if the structure is not found in any directory
    when searching by structure_id without category (global search)
      returns the structure data if found in any directory
      searches through categories and returns the first match found
      returns nil if the structure is not found in any directory
    when the JSON file is invalid
      returns nil and logs an error
    caching behavior
      reads from the file system only once for the same query
      stores the result in the cache hash

Lookup::UnitLookupService
  #find_unit
    loads units from the correct file structure
    finds units case-insensitively by ID (FAILED - 932)
    returns nil for nonexistent units
    handles nil and blank unit queries gracefully
    with propulsion units
      finds propulsion units by their exact ID (FAILED - 933)
      has expected propulsion unit properties (FAILED - 934)
    with habitat units
      finds habitat units by their ID
    with robot units
      finds robot units by their ID (FAILED - 935)
  service configuration
    has all expected unit categories (FAILED - 936)
  unit data structure validation
    when any propulsion unit exists
      has all expected top-level unit properties (PENDING: No propulsion units found)
      has performance properties if applicable (PENDING: No propulsion units found)
      has operational properties (PENDING: No propulsion units found)
      has maintenance requirements if defined (PENDING: No propulsion units found)
      has operational modes if defined (PENDING: No propulsion units found)
      has telemetry metadata if defined (PENDING: No propulsion units found)
    when any storage unit exists
      has storage capacity properties (PENDING: No storage units found)
      has alias support if defined (PENDING: No storage units found)
  matching behavior
    matches by exact ID (FAILED - 937)
    matches by exact name (FAILED - 938)
    matches by partial ID with sufficient length (FAILED - 939)
    is case insensitive (FAILED - 940)
  #debug_paths
    outputs path information without errors

ManufacturingService
  .manufacture
    with real blueprints
      creates a UnitAssemblyJob and charges construction cost using real blueprint (FAILED - 941)
      works with different blueprint categories (FAILED - 942)
    with sufficient funds
      creates a UnitAssemblyJob and charges the player construction cost (FAILED - 943)
    with different construction cost percentages
      uses settlement's custom construction percentage (FAILED - 944)
    with real blueprint data
      creates material requests based on actual blueprint requirements (FAILED - 945)
      automatically fulfills material requirements when materials are available (FAILED - 946)
      stores actual blueprint data in specifications (FAILED - 947)
    with invalid blueprint
      returns failure when blueprint not found (FAILED - 948)

Manufacturing::AssemblyService
  .start_assembly
    with all materials available
      creates an assembly job successfully
      charges the tenant fee (FAILED - 949)
    with missing materials and buy_missing = false
      fails and reports missing materials
    with missing materials and buy_missing = true
      buys missing materials and creates job
      fails if cannot afford material costs
    with insufficient funds for tenant fee
      fails with insufficient funds error
    with invalid blueprint
      fails with invalid blueprint error
    with invalid settlement
      fails with invalid settlement error
  job type determination
    for unit blueprints
      creates a UnitAssemblyJob
    for structure blueprints
      creates a ConstructionJob

Component Production Integration
  with real blueprint files
    finds the 3d_printed_ibeam_mk1 blueprint
    producing mk1 I-beams (bootstrap version)
      creates a production job using real blueprint (FAILED - 950)
      consumes depleted_regolith from inventory (FAILED - 951)

Manufacturing::ComponentProductionService
  #produce_component
    with sufficient materials
      creates a component production job
      consumes materials from inventory
      stores material composition in job metadata
    with insufficient materials
      raises an error
    with incompatible printer
      raises an error
  #complete_job
    adds components to inventory
    stores source material composition in component metadata
    adds waste products to inventory
    marks job as completed

Manufacturing::Construction::ConstructionManager
  .assign_builders
    logs and returns true
  .complete?
    returns true if current time >= estimated_completion
    returns false if current time < estimated_completion
    returns false if entity does not respond to estimated_completion
    returns false if estimated_completion is nil

Manufacturing::Construction::CoveringCalculator
  .calculate_materials
    calculates required 3D-printed I-beams from regolith
  .calculate_printer_requirements
    calculates required 3D printer capacity
  .estimate_construction_time
    estimates construction time based on skylight size

Manufacturing::Construction::CoveringService
  #initialize
    initializes with coverable, panel type, and settlement (FAILED - 952)
    uses default panel type if not provided (FAILED - 953)
    finds settlement from coverable if not provided (FAILED - 954)
  #calculate_materials
    calculates base materials using CoveringCalculator (FAILED - 955)
    merges panel-specific materials (FAILED - 956)
    sums quantities for duplicate materials (FAILED - 957)
  #schedule_construction
    returns error if no settlement (FAILED - 958)
    returns error if no blueprint found (FAILED - 959)
    creates a construction job (FAILED - 960)
    creates material requests (FAILED - 961)
    creates equipment requests (FAILED - 962)
    updates coverable status to materials_requested (FAILED - 963)
    returns success with construction job (FAILED - 964)
  #start_construction
    returns false if materials not gathered (FAILED - 965)
    returns false if equipment not gathered (FAILED - 966)
    updates job status to in_progress (FAILED - 967)
    assigns builders through ConstructionManager (FAILED - 968)
    updates coverable status to under_construction (FAILED - 969)
  #track_progress
    returns false if job not in progress (FAILED - 970)
    returns false if construction not complete (FAILED - 971)
    completes construction when work is done (FAILED - 972)
    updates coverable status (FAILED - 973)
    releases equipment (FAILED - 974)
    returns true when complete (FAILED - 975)

Manufacturing::Construction::DomeCalculator
  .calculate_materials
    calculates materials using the same panel system as skylights
    supports different panel types like skylights
    adds dome-specific adjustments
  .calculate_anchor_points
    calculates anchor points based on circumference
    scales with dome size
  .calculate_pressure_sealing
    calculates sealing material based on circumference
  .calculate_construction_cost
    calculates cost based on dome size and materials
    applies complexity multiplier for dome shape
  .estimate_construction_time
    estimates construction time based on dome size
    applies curvature complexity factor

Manufacturing::Construction::DomeService
  #initialize
    initializes with default panel type (FAILED - 976)
    initializes with custom panel type (FAILED - 977)
    defaults service provider to entity (FAILED - 978)
  #schedule_construction
    creates a construction job successfully (FAILED - 979)
    fails when no settlement found (FAILED - 980)
    creates material and equipment requests for player construction (FAILED - 981)
    when entity is different from service provider
      processes payment for contracted construction (FAILED - 982)
      does not create material requests for contracted construction (FAILED - 983)
      marks materials and equipment as provided by contractor (FAILED - 984)
      handles payment failure gracefully (FAILED - 985)
  #start_construction
    starts construction when materials and equipment are ready (FAILED - 986)
    fails when materials not ready for player construction (FAILED - 987)
    bypasses checks for contracted construction (FAILED - 988)
  #track_progress
    completes construction when work is finished (FAILED - 989)
    returns false when construction not complete (FAILED - 990)
    sets correct status for different layer types (FAILED - 991)
    releases equipment when construction completes (FAILED - 992)
  #complete_construction
    completes the construction process (FAILED - 993)
  private methods
    #determine_completion_status
      returns correct status for primary layer (FAILED - 994)
      returns correct status for secondary layer (FAILED - 995)
      returns correct status for both layers (FAILED - 996)
      returns operational for unknown layer types (FAILED - 997)
    #is_player_construction?
      returns true when entity and provider are the same (FAILED - 998)
      returns false when entity and provider are different (FAILED - 999)

Manufacturing::Construction::HangarService
  #initialize
    initializes with default hangar type (FAILED - 1000)
    initializes with custom hangar type (FAILED - 1001)
    raises error for non-large access points (FAILED - 1002)
  #schedule_construction
    creates a hangar structure successfully (FAILED - 1003)
    creates a construction job (FAILED - 1004)
    connects the access point to the hangar (FAILED - 1005)
    fails when no settlement found (FAILED - 1006)
    fails when no blueprint found (FAILED - 1007)
    creates material and equipment requests (FAILED - 1008)
    calculates correct capacity for standard rover hangar (FAILED - 1009)
    calculates correct capacity for large craft hangar (FAILED - 1010)
  #start_construction
    starts construction when materials and equipment are ready (FAILED - 1011)
    fails when materials not ready (FAILED - 1012)
    fails when equipment not ready (FAILED - 1013)
  #track_progress
    completes construction when work is finished (FAILED - 1014)
    returns false when construction not complete (FAILED - 1015)
    releases equipment when construction completes (FAILED - 1016)
  #calculate_materials
    calculates materials for standard rover hangar (FAILED - 1017)
    calculates materials for large craft hangar (FAILED - 1018)
    merges blueprint materials with specific materials (FAILED - 1019)
  #calculate_construction_time
    calculates base time for standard hangar (FAILED - 1020)
    calculates longer time for large craft hangar (FAILED - 1021)
  #calculate_equipment_requirements
    calculates equipment requirements (FAILED - 1022)

Manufacturing::Construction::SegmentCoveringService
  #initialize
    uses modular_structural_panel as default (FAILED - 1023)
    finds settlement from worldhouse (FAILED - 1024)
  #calculate_panel_specific_materials
    calculates worldhouse-scale materials (FAILED - 1025)
    includes cable calculations for massive segments (FAILED - 1026)
    scales materials by panel count (FAILED - 1027)
  #complexity_factor
    returns 1.5 base factor for worldhouse (FAILED - 1028)
    increases factor for very large segments (FAILED - 1029)
  #calculate_equipment_requirements
    requires minimum 10 printers for worldhouse (FAILED - 1030)
    requires heavy equipment (FAILED - 1031)
    scales equipment for massive segments (FAILED - 1032)
  #schedule_construction
    creates construction phases for large segments (FAILED - 1033)
    includes phase names and durations (FAILED - 1034)

Manufacturing::Construction::SkylightService
  #initialize
    uses skylight-specific default panel type (FAILED - 1035)
    finds settlement from lava tube (FAILED - 1036)
  #calculate_panel_specific_materials
    calculates transparent panel materials (FAILED - 1037)
    calculates solar panel materials (FAILED - 1038)
    scales materials by panel count (FAILED - 1039)
  #complexity_factor
    returns 1.0 for basic transparent panels (FAILED - 1040)
    returns 1.5 for solar panels (FAILED - 1041)
    returns 1.3 for thermal insulation (FAILED - 1042)
  #determine_completion_status
    returns primary_cover for basic transparent (FAILED - 1043)
    returns solar_cover for solar panels (FAILED - 1044)
    returns full_cover for structural on primary cover (FAILED - 1045)

Manufacturing::CostCalculator
  Earth-Imported COGS (EAP-COGS)
    calculates the EAP-COGS (Earth Import Cost) for the unit (FAILED - 1046)
  Local Production COGS (LAP-COGS)
    calculates the LAP-COGS (Local Production Cost) for the unit (FAILED - 1047)

Manufacturing::MaterialProcessingService
  #thermal_extraction
    with valid inputs
      creates a material processing job record
      updates inventory correctly after job completion
    with insufficient raw regolith
      returns an error
  #volatiles_extraction
    with valid inputs
      creates a material processing job record (FAILED - 1048)
      produces gases with correct composition after job completion (FAILED - 1049)
    with insufficient processed regolith
      returns an error

Manufacturing::MaterialRequest
  .create_material_requests
    creates requests for all required materials (FAILED - 1050)

Manufacturing::Processing
  #process
    when owner has sufficient resources and funds
      successfully processes the blueprint and creates unassembled items (FAILED - 1051)
    when owner does not have enough resources
      returns an error when resources are insufficient (FAILED - 1052)
    when owner does not have enough GCC
      raises an error when GCC is insufficient (FAILED - 1053)

Manufacturing::Service
  .manufacture
    with real blueprints
      creates a UnitAssemblyJob and charges construction cost using real blueprint (FAILED - 1054)
      works with different blueprint categories (FAILED - 1055)
    with sufficient funds
      creates a UnitAssemblyJob and charges the player construction cost (FAILED - 1056)
    with different construction cost percentages
      uses settlement's custom construction percentage (FAILED - 1057)
    with real blueprint data
      creates material requests based on actual blueprint requirements (FAILED - 1058)
      automatically fulfills material requirements when materials are available (FAILED - 1059)
      stores actual blueprint data in specifications (FAILED - 1060)
    with invalid blueprint
      returns failure when blueprint not found (FAILED - 1061)

Manufacturing::ShellPrintingService
  #enclose_inflatable
    with sufficient materials
      creates a shell printing job
      consumes materials from inventory
      stores material composition in job metadata
    with insufficient materials
      raises an error
    with tank not ready
      raises error if tank not deployed
      raises error if tank already has shell
    with incompatible printer
      raises an error
  #complete_job
    marks tank as enclosed
    stores shell materials in tank metadata
    marks job as completed

Market::ConditionUpdaterService
  .call
    updates supply for all tracked resources (FAILED - 1062)
    updates demand for all tracked resources, respecting smoothing and growth (FAILED - 1063)
    creates a market condition if one does not exist (FAILED - 1064)
    initializes a marketplace if the settlement does not have one (FAILED - 1065)
  .calculate_new_supply
    returns zero if net change is a large negative and smooths current supply (FAILED - 1066)

Market::NpcPriceCalculator
  .calculate_ask
    with cost-based pricing (no market history)
      returns Earth import cost plus markup
      maintains minimum profit margin
    with market-based pricing (sufficient history)
      uses market average with markup (FAILED - 1067)
      never goes below cost floor (FAILED - 1068)
  .calculate_bid
    with cost-based pricing
      returns Earth import cost with discount
      returns nil if settlement does not want resource
    with inventory adjustments
      pays more when inventory is critical
      pays normal price when inventory is adequate
      does not buy when inventory is excess
  .calculate_spread
    calculates bid-ask spread
    calculates spread percentage correctly
  local production pricing
    when settlement can produce locally
      uses local production cost instead of import cost
      offers much cheaper prices than import
    when settlement cannot produce locally
      falls back to import pricing
  error handling
    returns nil gracefully for unknown materials
    handles settlements without location (FAILED - 1069)
    handles nil settlement (FAILED - 1070)
  integration with Tier1PriceModeler
    uses Tier1PriceModeler for base cost calculations
  integration with Market::PriceHistory
    queries price history for market-based pricing (FAILED - 1071)

Market::TradeExecutionService
  returns true on successful execution (FAILED - 1072)
  calls the TaxCollectionService with gross revenue and seller (FAILED - 1073)
  calls TransactionManager.create_transfer with the NET amount (FAILED - 1074)
  removes inventory from seller (FAILED - 1075)
  creates a trade record (FAILED - 1076)
  creates a price history record (FAILED - 1077)
  creates a supply chain record (FAILED - 1078)

MarketListingService
  when selling based on EAP-COGS (Initial Import Phase)
    sets the price exactly 5% below the Earth Price
  when selling based on LAP-COGS (Local Production Phase)
    sets the price exactly 5% below the Earth Price, maximizing margin
  when COGS is too high to undercut the Earth Price by 5%
    sets the price to the Minimum Acceptable Price (COGS + 1%)

MaterialGeneratorService
  .generate_material
    returns material data for water
    returns nil for unknown material

MaterialLookupService
  #find_material
    returns the correct material (FAILED - 1079)
    returns nil for a nonexistent material (FAILED - 1080)

MaterialRequestService
  .create_material_requests
    creates requests for all required materials (FAILED - 1081)

MissionContractService
  .create_supply_contract
    creates a supply contract with correct requirements and reward
  .create_construction_contract
    creates a construction contract with project specifications
  .accept
    when eligible accepter
      accepts the contract and updates status
    when ineligible accepter
      does not accept the contract
  .complete
    with valid delivery
      completes the contract and pays reward
    with invalid delivery
      does not complete the contract
  .cancel
    cancels the contract and updates status
  .check_expirations
    expires overdue contracts
  private methods
    .calculate_supply_reward
      calculates reward based on market price and contract terms
    .calculate_delivery_risk
      calculates risk premium based on distance and reliability

Naming::PlanetNameService
  #initialize
    loads name data from JSON file
    handles missing data file gracefully
  #generate_planet_name
    returns a terraformed name when terraformable is true
    returns a neutral name when terraformable is false
    adds suffix when name is not unique
    marks name as used after generation
  #find_unused_name
    uses deterministic selection based on system and index
  #add_suffix_to_name
    adds a suffix to the base name (FAILED - 1082)
  #unique?
    returns true for unused names
    returns false for used names
    checks database for existing planets

PlanetUpdateService
  #initialize
    sets up planet and time_skipped
  #run
    with non-planetary body
      returns immediately
    with a terrestrial planet
      simulates in detail for short time periods
      returns an array of events
    with a longer time period
      uses progressive simulation for longer periods
  private methods
    #simulate_detailed
      processes all spheres
      processes sphere interfaces
      updates planet properties
    #simulate_progressive
      uses the correct intervals for different time periods
      checks for events after each simulation step
    #sphere processing methods
      processes atmosphere correctly
      processes geosphere correctly
      processes hydrosphere correctly
      processes biosphere correctly

Pressurization::BasePressurizationService
  #initialize
    sets up the service with default values
    allows custom options
  #calculate_total_moles
    calculates moles based on ideal gas law
  #calculate_needed_gases
    calculates the mass of each gas needed
  #calculate_achievable_pressure
    with sufficient gases
      returns the target pressure
    with insufficient gases
      returns a reduced pressure based on the limiting gas
  #pressurize
    returns a success result with full pressure when gases are sufficient
    deducts the used gases from available gases
    returns partial success with reduced pressure when gases are insufficient

Pressurization::HabitatPressurizationService
  #calculate_habitat_volume
    calculates correct volume for crater dome (FAILED - 1083)

Pressurization::StructurePressurizationService
  .pressurize_structure
    when depot tanks are available
      sources gases from depot tanks (FAILED - 1084)
      uses depot tank gases for pressurization (FAILED - 1085)
    when no depot tanks are available
      falls back to standard pressurization logic (FAILED - 1086)
  .source_gases_from_depot_tanks
    when settlement has depot tanks
      aggregates gases from all depot tanks (FAILED - 1087)
      returns empty hash when no gases are stored (FAILED - 1088)
    when settlement has no depot tanks
      returns empty hash (FAILED - 1089)
    when depot tanks have no gas_storage data
      returns empty hash (FAILED - 1090)
  mining byproduct integration
    when mining Si produces O2 byproduct
      increases available gases from depot tanks for pressurization (FAILED - 1091)

PressurizationService
  #check_sealing_status
    with traditional sealed environment
      returns ready for sealed environment (FAILED - 1092)
      returns not ready for unsealed environment (FAILED - 1093)
    with pressurization target (lava tube)
      returns not ready when requirements not met (FAILED - 1094)
      returns ready when requirements met (FAILED - 1095)
    with pressurization target (canyon)
      returns not ready when requirements not met (FAILED - 1096)

ProcessingService
  #process
    when owner has sufficient resources and funds
      successfully processes the blueprint and creates unassembled items (FAILED - 1097)
    when owner does not have enough resources
      returns an error when resources are insufficient (FAILED - 1098)
    when owner does not have enough GCC
      raises an error when GCC is insufficient (FAILED - 1099)

RewardService
  .pay_out
    with credits reward
      creates a transaction for the player
      applies market adjustment when specified
    with resources reward
      adds resources to the settlement inventory
    with mixed reward
      pays both credits and resources
    with invalid reward data
      returns false for nil reward
      returns false for unknown reward type

SkylightArrayCalculator
  .calculate_materials
    calculates required 3D-printed I-beams from regolith
  .calculate_printer_requirements
    calculates required 3D printer capacity
  .estimate_construction_time
    estimates construction time based on skylight size

SpecialMissionService
  .generate_critical_mission
    when mission should be generated
      creates a special mission with EAP-based reward
      applies correct bonus multiplier for different urgency levels
      sets appropriate expiry times
    when mission should not be generated
      returns nil when EAP cannot be calculated
      returns nil when should_generate_mission? returns false
  .check_and_generate_missions
    generates missions for settlements with critical shortages
    does not generate missions for settlements with normal levels
  private methods
    .should_generate_mission?
      returns false when settlement has sufficient material
      returns false when internal logistics can handle the shortage
      returns false when mission already exists for material
      returns true when all conditions are met

StarSim::ProceduralGenerator
  #initialize
    loads terraformable templates if they exist
    handles missing template file gracefully
    handles malformed template JSON gracefully
  #generate_system_seed
    generates a complete system structure
    uses the correct system identifier format
  #generate_terrestrial_planets
    with available templates
      uses templates for approximately 40% of planets
      requests terraformed names for template-based planets (FAILED - 1100)
      requests neutral names for procedural planets (FAILED - 1101)
      applies orbital optimization for template-based planets (FAILED - 1102)
      generates procedural planets when not using templates (FAILED - 1103)
    without templates
      generates all planets procedurally
  #generate_from_template
    creates planet data based on template
    applies small variations to prevent identical planets
    recalculates dependent properties after variation
  #generate_optimized_orbital_parameters
    places planets near habitable zone for terraformable planets
    calculates orbital period correctly
  #calculate_habitable_zone_center
    returns 1 AU for sun-like stars
    scales with stellar luminosity
    defaults to 1 AU when no star provided
  #generate_biosphere_data
    provides enhanced biosphere for template-based planets (FAILED - 1104)
    provides basic biosphere for planets with good conditions (FAILED - 1105)
    returns empty biosphere for unsuitable planets (FAILED - 1106)
  #generate_stars
    generates stars with realistic spectral types
    respects spectral type probability distribution
  #generate_system_seed_file
    creates a JSON file with system data
    includes timestamp in filename
  #load_terraformable_templates
    loads templates successfully
    loads at least 4 templates
    only includes terrestrial planets
    ensures templates have required fields
  integration test
    generates a complete, valid system (FAILED - 1107)
    validates schema for all planet types
    uses terraformable templates at an expected rate
    generates large systems without structural degradation

StarSim::SystemGeneratorService
  #generate!
    when generating a random system
      creates the specified number of stars
      creates celestial bodies
      updates the solar system name and identifier
    with a predefined system
      delegates to SystemBuilderService for building the system

StarSim::ProceduralGenerator
  #generate_system
    creates the specified number of stars
    creates the specified number of celestial bodies

TerraSim::AtmosphereSimulationService
  #initialize
    initializes with a celestial body (FAILED - 1108)
    sets up the Stefan-Boltzmann constant (FAILED - 1109)
  #simulate
    updates the pressure (FAILED - 1110)
    calculates the greenhouse effect (FAILED - 1111)
    updates temperature data in the atmosphere (FAILED - 1112)
    simulates atmospheric loss (FAILED - 1113)
    decreases dust (FAILED - 1114)
  temperature calculation methods
    calculates stefan_boltzmann_temp correctly (FAILED - 1115)
    calculates greenhouse_adjusted_temp correctly (FAILED - 1116)
    calculates water_vapor_pressure correctly (FAILED - 1117)
  #update_temperatures
    updates all temperature types in atmosphere (FAILED - 1118)

TerraSim::BiosphereGeosphereInterfaceService
  #initialize
    sets the celestial body and sphere references
  #simulate
    calculates and updates soil health based on both spheres
    when spheres are missing
      returns nil if biosphere is missing
      returns nil if geosphere is missing

TerraSim::BiosphereSimulationService
  #initialize
    initializes with a celestial body and sets the biosphere (FAILED - 1119)
  #simulate
    runs the biosphere simulation steps (FAILED - 1120)
    prevents concurrent simulations (FAILED - 1121)
    does nothing if biosphere is nil (FAILED - 1122)
  #calculate_biosphere_conditions
    calculates and updates habitable ratio and ice latitude (FAILED - 1123)
    calls update_biodiversity and influence_atmosphere (FAILED - 1124)
  #simulate_ecosystem_interactions
    simulates plant growth and updates vegetation cover (FAILED - 1125)
    simulates basic animal activity (logging for now) (FAILED - 1126)
  #track_species_population
    updates species populations based on birth and death rates (FAILED - 1127)
  #manage_food_web
    simulates herbivore consumption and updates vegetation (FAILED - 1128)
    simulates carnivore predation and updates prey population (FAILED - 1129)
  #balance_biomes
    attempts to adjust global temperatures towards biome optima (FAILED - 1130)
    adjusts biome moisture levels based on climate type (FAILED - 1131)
    attempts to adjust biome area percentages (FAILED - 1132)
  #update_biodiversity
    calculates and updates the biodiversity index (FAILED - 1133)
  #calculate_biodiversity
    calculates the biodiversity index based on the number of biomes (FAILED - 1134)
  #influence_atmosphere
    simulates gas exchange with the atmosphere (FAILED - 1135)
  private #calculate_light_availability
    calculates light availability based on star luminosity and atmospheric dust (FAILED - 1136)
  private #calculate_temperature_suitability
    calculates temperature suitability for a given range when within range (FAILED - 1137)
    calculates temperature suitability for a given range when outside range (FAILED - 1138)
  terraforming integration
    #calculate_life_form_atmospheric_effects
      with no life forms
        returns zero effects (FAILED - 1139)
      with multiple life forms
        aggregates effects from all species (FAILED - 1140)
    #influence_atmosphere with life forms
      uses life form effects when available (FAILED - 1141)
      scales effects by time (FAILED - 1142)
      falls back to hardcoded values when no life forms (FAILED - 1143)
    #simulate with time parameter
      stores time_skipped for use in other methods (FAILED - 1144)
      passes time to influence_atmosphere (FAILED - 1145)

TerraSim::ExoticWorldSimulationService
  #initialize
    sets planet-specific options (FAILED - 1146)
    accepts custom options (FAILED - 1147)
  #planet_type
    determines planet type from temperature and elements (FAILED - 1148)
    uses planet_type from celestial body if available (FAILED - 1149)
    defaults to terrestrial for unknown combinations (FAILED - 1150)
  #simulate_planet_specific_processes
    with an ice giant
      calls ice-specific simulation methods (FAILED - 1151)
    with a carbon planet
      calls carbon planet-specific methods (FAILED - 1152)
  #simulate_diamond_formation
    converts carbon to diamond (FAILED - 1153)
  #simulate_cryovolcanism
    adds frozen materials to the planet (FAILED - 1154)
  #simulate_extreme_pressure
    converts hydrogen to metallic hydrogen at extreme pressure (FAILED - 1155)

TerraSim::GeosphereInitializer
  initializing terrestrial planet geosphere
    creates a geosphere with terrestrial properties (FAILED - 1156)
  ice giant initialization
    sets up ice_tectonics_enabled for ice giants (PENDING: ice_tectonics_enabled attribute doesn't exist in Geosphere model)
    creates appropriate ice materials (FAILED - 1157)
    creates appropriate mantle materials (FAILED - 1158)
  exotic materials initialization
    creates hydrogen in metallic state under extreme conditions (FAILED - 1159)
  material state determination
    creates hydrogen as gas in the crust (FAILED - 1160)
    creates water ice as solid (FAILED - 1161)
  #determine_state
    returns solid for materials with Ice in name
    returns gas for hydrogen and helium
    returns metallic_hydrogen for that specific material
  #calculate_layer_mass
    calculates different masses for different layers

TerraSim::GeosphereInitializer
  initializing terrestrial planet geosphere
    creates a geosphere with terrestrial properties (FAILED - 1162)
  ice giant initialization
    sets up ice_tectonics_enabled for ice giants (PENDING: ice_tectonics_enabled attribute doesn't exist in Geosphere model)
    creates appropriate ice materials (FAILED - 1163)
  exotic materials initialization
    creates hydrogen in metallic state under extreme conditions (FAILED - 1164)
  regolith property initialization
    initializes regolith properties for planets with atmospheres (FAILED - 1165)
    initializes regolith properties for airless bodies (FAILED - 1166)

TerraSim::GeosphereSimulationService
  #initialize
    initializes with a celestial body and its geosphere
    sets up initial values from the geosphere
  #simulate
    calls all the simulation methods in order
  #simulate_tectonic_activity
    updates plate positions when tectonic activity is enabled
    does nothing when tectonic activity is disabled
  #manage_regolith_properties
    calculates weathering rate and updates geosphere
  #calculate_weathering_rate
    returns a non-negative value
    with atmosphere and hydrosphere
      calculates a higher weathering rate
  #eruption
    adds volcanic gases to the atmosphere (FAILED - 1167)

TerraSim::HydrosphereSimulationService
  #initialize
    initializes with a celestial body and its spheres
    sets up material lookup service
  #simulate
    calls all simulation methods in order (FAILED - 1168)
    prevents recursive calls with simulation flag (FAILED - 1169)
    does not run if any required sphere is missing
  #calculate_region_temperatures
    calculates temperatures for all water bodies (FAILED - 1170)
    sets water temperatures cooler than surface temperature (FAILED - 1171)
  #handle_evaporation
    decreases water body volumes (FAILED - 1172)
    adds water vapor to the atmosphere (FAILED - 1173)
    handles numeric volume values (not hashes) (FAILED - 1174)
  #handle_precipitation
    increases water body volumes (FAILED - 1175)
    removes water vapor from the atmosphere (FAILED - 1176)
    decreases atmospheric dust concentration (FAILED - 1177)
  #calculate_state_distributions
    calculates state distribution based on temperature and pressure (FAILED - 1178)
  #handle_ice_melting
    when temperature is above freezing
      melts ice from polar caps (FAILED - 1179)
      updates state distribution to decrease solid percentage (FAILED - 1180)
      updates state distribution to increase liquid percentage (FAILED - 1181)
      does not allow solid percentage to go negative (FAILED - 1182)
      adds some melted water as vapor to atmosphere (FAILED - 1183)
      does not melt more than maximum allowed per cycle (FAILED - 1184)
    when temperature is below freezing
      does not melt any ice (FAILED - 1185)
    when ice caps do not exist
      returns early without error (FAILED - 1186)
  #update_hydrosphere_volume
    delegates to the hydrosphere model method (FAILED - 1187)
  integration: full simulation cycle
    runs a complete simulation without errors (FAILED - 1188)
    maintains valid state distribution percentages (FAILED - 1189)
    never produces negative state distribution values (FAILED - 1190)
  edge cases
    with extreme cold temperature
      handles extreme cold without errors (FAILED - 1191)
    with extreme hot temperature
      handles extreme heat without errors (FAILED - 1192)
    with zero water bodies
      handles zero volumes without errors (FAILED - 1193)

TerraSim::Simulator
  #calc_current
    when star is present
      updates the surface temperature
      simulates the atmosphere
      simulates the biosphere-geosphere interface
    when no star is present
      sets the temperature to space background temperature

Tier1PriceModeler
  #calculate_eap
    with titanium alloy
      calculates the correct EAP (FAILED - 1194)
      can print breakdown without errors (FAILED - 1195)
    with composite insulation
      calculates the correct EAP (FAILED - 1196)
    with pressure valves
      calculates the correct EAP (FAILED - 1197)
    with electronics
      calculates the correct EAP (FAILED - 1198)
    with different destinations
      calculates different costs for different routes
    with missing data
      returns 0.0 without crashing
  EAP storage for downstream use
    stores calculated EAPs in a hash (FAILED - 1199)
  integration with EconomicConfig
    uses transport costs from config
    uses earth spot prices from config when available (FAILED - 1200)
  #print_breakdown
    outputs detailed breakdown (FAILED - 1201)
    returns the calculated EAP (FAILED - 1202)

TradeService
  #dynamic_price
    calculates the dynamic price based on scarcity, transportation, and market conditions (FAILED - 1203)
  #base_price_for_type
    returns the correct base price for raw materials (FAILED - 1204)
    returns the correct base price for processed goods (FAILED - 1205)
  #fuel_cost_per_unit
    returns the correct fuel cost per unit (FAILED - 1206)
  #distance_to_buyer
    calculates the distance between colonies (FAILED - 1207)
  #market_conditions
    returns a random market condition modifier (FAILED - 1208)

TransactionService
  .process_transaction
    when the buyer has sufficient funds
      processes the transaction successfully
    when the buyer has insufficient funds
      raises an error and does not process the transaction

UnitModuleAssemblyService
  .build_units_and_modules
    creates units from the recommended fit (FAILED - 1209)
    creates modules from the recommended fit (FAILED - 1210)
    creates rigs from the recommended fit (FAILED - 1211)
    processes custom port configurations (FAILED - 1212)
    handles missing inventory items gracefully (FAILED - 1213)
    handles missing recommended fit data gracefully (FAILED - 1214)
    assigns correct port names to components (FAILED - 1215)
  .disconnect_unit
    disconnects a unit and returns it to inventory as an item (FAILED - 1216)

WormholeConsortiumFormationService
  creates memberships for founding members and updates consortium operational_data (FAILED - 1217)
  updates member operational_data with consortium membership (FAILED - 1218)

WormholeExpansionService
  #initialize
    initializes with default values
  #find_expansion_opportunities
    finds systems with available wormhole capacity
    excludes systems at maximum capacity
  #create_gate_construction_contract
    creates a contract for gate construction
  #create_rescue_contract
    creates a rescue contract for disconnected players

Guaranteed Market Sale Transaction
  guaranteed sell order execution
    executes atomically and creates all required records (FAILED - 1219)
    does not create a SupplyChain record if no matching buy order exists (FAILED - 1220)
    creates a Trade record with correct buyer and seller (FAILED - 1221)
    marks the order as filled by returning nil (FAILED - 1222)
    records a PriceHistory entry after trade execution (FAILED - 1223)
    calls TransactionManager.create_transfer with correct arguments (FAILED - 1224)
    creates a SupplyChain record with correct volume and status (FAILED - 1225)

Pending: (Failures listed here are expected and do not affect your suite's status)

  1) CelestialBodies::BrownDwarf habitable zones has a limited habitable zone
     # Habitable zone calculations not yet implemented for brown dwarfs
     # ./spec/models/celestial_bodies/brown_dwarf_spec.rb:127

  2) CelestialBodies::BrownDwarf relationships with planets can have orbiting planets
     # Brown dwarf planetary systems not yet implemented
     # ./spec/models/celestial_bodies/brown_dwarf_spec.rb:135

  3) CelestialBodies::Spheres::Geosphere#calculate_materials calculates and updates materials based on crust, mantle, and core composition
     # calculate_materials method not yet implemented
     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:45

  4) CelestialBodies::Spheres::Geosphere callbacks triggers TerraSim service after adding a material
     # run_terrasim_service method not yet implemented
     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:168

  5) CelestialBodies::Spheres::Geosphere material transfers transfers material to atmosphere when heated
     # heat_material method not yet implemented
     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:219

  6) Galaxy#total_mass calculates total mass properly
     # Implement this when total_mass method exists
     # ./spec/models/galaxy_spec.rb:89

  7) Lookup::CraftLookupService#find_craft with real craft data handles special characters in queries
     # No special characters in craft name
     # ./spec/services/lookup/craft_lookup_service_spec.rb:129

  8) Lookup::ItemLookupService#find_item finds consumable items with correct data
     # No consumable item files found
     # ./spec/services/lookup/item_lookup_service_spec.rb:17

  9) Lookup::ItemLookupService#find_item finds equipment items with correct data
     # No equipment item files found
     # ./spec/services/lookup/item_lookup_service_spec.rb:31

  10) Lookup::ItemLookupService#find_item caches results for subsequent lookups
     # Item battery_cells not found
     # ./spec/services/lookup/item_lookup_service_spec.rb:68

  11) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has all expected top-level unit properties
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:147

  12) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has performance properties if applicable
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:153

  13) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has operational properties
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:158

  14) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has maintenance requirements if defined
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:166

  15) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has operational modes if defined
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:171

  16) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has telemetry metadata if defined
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:179

  17) Lookup::UnitLookupService unit data structure validation when any storage unit exists has storage capacity properties
     # No storage units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:195

  18) Lookup::UnitLookupService unit data structure validation when any storage unit exists has alias support if defined
     # No storage units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:203

  19) TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants
      # ice_tectonics_enabled attribute doesn't exist in Geosphere model
      Failure/Error: @geosphere.save!

      ArgumentError:
        wrong number of arguments (given 0, expected 1..2)
      # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
      # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:80:in 'block (3 levels) in <main>'

  20) TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants
      # ice_tectonics_enabled attribute doesn't exist in Geosphere model
      Failure/Error: @geosphere.save!

      ArgumentError:
        wrong number of arguments (given 0, expected 1..2)
      # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
      # ./spec/services/terra_sim/geosphere_initializer_spec.rb:84:in 'block (3 levels) in <main>'

Failures:

  1) GameController GET #index solar system seeding and display calls SystemBuilderService to build the system if no solar system exists
     Failure/Error: expect(assigns(:solar_system)).to be_present
       expected `nil.present?` to be truthy, got false
     # ./spec/controllers/game_controller_spec.rb:79:in 'block (4 levels) in <main>'

  2) GameController GET #index solar system seeding and display correctly calculates @planet_count excluding satellites
     Failure/Error: expect(assigns(:planet_count)).to eq(2)

       expected: 2
            got: nil

       (compared using ==)
     # ./spec/controllers/game_controller_spec.rb:84:in 'block (4 levels) in <main>'

  3) GameController GET #index solar system seeding and display defines is_moon and body_category singleton methods on celestial bodies
     Failure/Error: expect(earth_body.body_category).to eq('terrestrial')

       expected: "terrestrial"
            got: "terrestrial_planet"

       (compared using ==)
     # ./spec/controllers/game_controller_spec.rb:95:in 'block (4 levels) in <main>'

  4) GameController GET #index solar system seeding and display generates correct JSON with parent_body_identifier for moons
     Failure/Error: get :index, format: :json

     ActionController::UnknownFormat:
       GameController#index is missing a template for this request format and variant.

       request.formats: ["application/json"]
       request.variant: []
     # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
     # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
     # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
     # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
     # ./spec/controllers/game_controller_spec.rb:103:in 'block (4 levels) in <main>'

  5) GameController GET #index solar system seeding and display returns JSON with correct celestial bodies data
     Failure/Error: get :index, format: :json

     ActionController::UnknownFormat:
       GameController#index is missing a template for this request format and variant.

       request.formats: ["application/json"]
       request.variant: []
     # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
     # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
     # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
     # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
     # ./spec/controllers/game_controller_spec.rb:119:in 'block (4 levels) in <main>'

  6) GameController POST #toggle_running toggles the running state from false to true
     Failure/Error: post :toggle_running

     AbstractController::ActionNotFound:
       The action 'toggle_running' could not be found for GameController
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
     # ./spec/controllers/game_controller_spec.rb:136:in 'block (3 levels) in <main>'

  7) GameController POST #toggle_running toggles the running state from true to false
     Failure/Error: post :toggle_running

     AbstractController::ActionNotFound:
       The action 'toggle_running' could not be found for GameController
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
     # ./spec/controllers/game_controller_spec.rb:142:in 'block (3 levels) in <main>'

  8) GameController POST #toggle_running returns JSON with the updated state
     Failure/Error: post :toggle_running

     AbstractController::ActionNotFound:
       The action 'toggle_running' could not be found for GameController
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
     # ./spec/controllers/game_controller_spec.rb:148:in 'block (3 levels) in <main>'

  9) GameController POST #set_speed updates the game speed
     Failure/Error: post :set_speed, params: { speed: 5 }

     AbstractController::ActionNotFound:
       The action 'set_speed' could not be found for GameController
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
     # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
     # ./spec/controllers/game_controller_spec.rb:159:in 'block (3 levels) in <main>'

  10) GameController POST #set_speed clamps the speed value between 1 and 5
      Failure/Error: post :set_speed, params: { speed: 10 }

      AbstractController::ActionNotFound:
        The action 'set_speed' could not be found for GameController
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/game_controller_spec.rb:165:in 'block (3 levels) in <main>'

  11) GameController POST #jump_time adds the specified number of days
      Failure/Error: post :jump_time, params: { days: 20 }

      AbstractController::ActionNotFound:
        The action 'jump_time' could not be found for GameController
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/game_controller_spec.rb:175:in 'block (3 levels) in <main>'

  12) GameController POST #jump_time handles year rollover
      Failure/Error: post :jump_time, params: { days: 20 }

      AbstractController::ActionNotFound:
        The action 'jump_time' could not be found for GameController
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/game_controller_spec.rb:181:in 'block (3 levels) in <main>'

  13) GameController POST #jump_time clamps days between 1 and 365
      Failure/Error: post :jump_time, params: { days: 500 }

      AbstractController::ActionNotFound:
        The action 'jump_time' could not be found for GameController
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/game_controller_spec.rb:188:in 'block (3 levels) in <main>'

  14) GameController GET #state returns the current game state
      Failure/Error: get :state

      AbstractController::ActionNotFound:
        The action 'state' could not be found for GameController
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/game_controller_spec.rb:197:in 'block (3 levels) in <main>'

  15) GameController GET #state updates time if running
      Failure/Error: get :state

      AbstractController::ActionNotFound:
        The action 'state' could not be found for GameController
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/game_controller_spec.rb:207:in 'block (3 levels) in <main>'

  16) GameController GET #simulation assigns the correct solar system and its primary star
      Failure/Error: expect(assigns(:solar_system)).to eq(solar_system)

        expected: #<SolarSystem id: 2262, identifier: "TEST-SIM", name: "Test System", galaxy_id: nil, current_star_id:...3:18:04.078062000 +0000", updated_at: "2026-01-11 23:18:04.078062000 +0000", wormhole_capacity: 0.0>
             got: nil

        (compared using ==)
      # ./spec/controllers/game_controller_spec.rb:221:in 'block (3 levels) in <main>'

  17) GameController GET #simulation redirects to root_path if solar system not found
      Failure/Error: expect(response).to redirect_to(root_path)

        Expected response to be a <3XX: redirect>, but was a <200: OK>
        Response body: 
      # ./spec/controllers/game_controller_spec.rb:228:in 'block (3 levels) in <main>'

  18) GameController GET #index edge cases handles missing solar system gracefully
      Failure/Error: expect(assigns(:solar_system)).to be_present
        expected `nil.present?` to be truthy, got false
      # ./spec/controllers/game_controller_spec.rb:245:in 'block (3 levels) in <main>'

  19) GameController private get_or_create_game_state creates a new game state if none exists
      Failure/Error: controller.send(:get_or_create_game_state)

      NoMethodError:
        undefined method 'get_or_create_game_state' for #<GameController:0x00007f7c94fe08e0>
      # ./spec/controllers/game_controller_spec.rb:268:in 'block (3 levels) in <main>'

  20) GameController private get_or_create_game_state returns the existing game state if present
      Failure/Error: expect(controller.send(:get_or_create_game_state)).to eq(gs)

      NoMethodError:
        undefined method 'get_or_create_game_state' for #<GameController:0x00007f7c94ef6420>
      # ./spec/controllers/game_controller_spec.rb:274:in 'block (3 levels) in <main>'

  21) TransactionsController POST #create with valid parameters creates a new financial transaction
      Failure/Error: buyer = Colony.find(params[:buyer_id])

      ActiveRecord::RecordNotFound:
        Couldn't find Colony with 'id'=2410
      # ./app/controllers/transactions_controller.rb:3:in 'TransactionsController#create'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/transactions_controller_spec.rb:34:in 'block (5 levels) in <main>'
      # ./spec/controllers/transactions_controller_spec.rb:33:in 'block (4 levels) in <main>'

  22) TransactionsController POST #create with valid parameters creates the transaction with correct account information and amount
      Failure/Error: buyer = Colony.find(params[:buyer_id])

      ActiveRecord::RecordNotFound:
        Couldn't find Colony with 'id'=2411
      # ./app/controllers/transactions_controller.rb:3:in 'TransactionsController#create'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/transactions_controller_spec.rb:39:in 'block (4 levels) in <main>'

  23) TransactionsController POST #create with valid parameters does not attempt to collect tax (enforces separation of concerns)
      Failure/Error: buyer = Colony.find(params[:buyer_id])

      ActiveRecord::RecordNotFound:
        Couldn't find Colony with 'id'=2412
      # ./app/controllers/transactions_controller.rb:3:in 'TransactionsController#create'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/transactions_controller_spec.rb:54:in 'block (4 levels) in <main>'

  24) TransactionsController POST #create with valid parameters returns a success message
      Failure/Error: buyer = Colony.find(params[:buyer_id])

      ActiveRecord::RecordNotFound:
        Couldn't find Colony with 'id'=2413
      # ./app/controllers/transactions_controller.rb:3:in 'TransactionsController#create'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/transactions_controller_spec.rb:58:in 'block (4 levels) in <main>'

  25) TransactionsController POST #create with invalid parameters does not create a transaction if amount is missing
      Failure/Error: buyer = Colony.find(params[:buyer_id])

      ActiveRecord::RecordNotFound:
        Couldn't find Colony with 'id'=2414
      # ./app/controllers/transactions_controller.rb:3:in 'TransactionsController#create'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/transactions_controller_spec.rb:70:in 'block (5 levels) in <main>'
      # ./spec/controllers/transactions_controller_spec.rb:69:in 'block (4 levels) in <main>'

  26) TransactionsController POST #create with invalid parameters returns an error message if amount is missing or invalid
      Failure/Error: buyer = Colony.find(params[:buyer_id])

      ActiveRecord::RecordNotFound:
        Couldn't find Colony with 'id'=2415
      # ./app/controllers/transactions_controller.rb:3:in 'TransactionsController#create'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # /usr/local/bundle/gems/turbo-rails-2.0.11/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/rendering.rb:20:in 'ActionText::Rendering::ClassMethods#with_renderer'
      # /usr/local/bundle/gems/actiontext-7.0.8.7/lib/action_text/engine.rb:69:in 'block (4 levels) in <class:Engine>'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/template_assertions.rb:62:in 'Rails::Controller::Testing::TemplateAssertions#process'
      # /usr/local/bundle/gems/rails-controller-testing-1.0.5/lib/rails/controller/testing/integration.rb:16:in 'block (2 levels) in <module:Integration>'
      # ./spec/controllers/transactions_controller_spec.rb:82:in 'block (4 levels) in <main>'

  27) Alien World Template Integrity template file exists
      Failure/Error:
        expect(File.exist?(template_path)).to be(true),
          "Expected alien_world_templates_v1.1.json at #{template_path}"

        Expected alien_world_templates_v1.1.json at /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:20:in 'block (2 levels) in <main>'

  28) Alien World Template Integrity is valid JSON
      Failure/Error: expect { JSON.parse(raw_json) }.not_to raise_error

        expected no Exception, got #<Errno::ENOENT: No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json> with backtrace:
          # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
          # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
          # ./spec/data/alien_world_templates_integrity_spec.rb:25:in 'block (3 levels) in <main>'
          # ./spec/data/alien_world_templates_integrity_spec.rb:25:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:25:in 'block (2 levels) in <main>'

  29) Alien World Template Integrity contains terrestrial_planets array
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:29:in 'block (2 levels) in <main>'

  30) Alien World Template Integrity contains exactly 25 templates (A01 → A25)
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:33:in 'block (2 levels) in <main>'

  31) Alien World Template Integrity has unique identifiers
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:41:in 'block (2 levels) in <main>'

  32) Alien World Template Integrity has unique template names
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:47:in 'block (2 levels) in <main>'

  33) Alien World Template Integrity required schema fields each template contains all required fields
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:64:in 'block (3 levels) in <main>'

  34) Alien World Template Integrity atmosphere rules contains no oxygen by default
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:75:in 'block (3 levels) in <main>'

  35) Alien World Template Integrity atmosphere rules has pressure > 0
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:84:in 'block (3 levels) in <main>'

  36) Alien World Template Integrity terraforming metadata terraforming_difficulty is between 1 and 10
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:94:in 'block (3 levels) in <main>'

  37) Alien World Template Integrity terraforming metadata engineered_atmosphere defaults to false
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:102:in 'block (3 levels) in <main>'

  38) Alien World Template Integrity volatile reservoirs has CO2 and H2O reservoirs defined
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:111:in 'block (3 levels) in <main>'

  39) Alien World Template Integrity material yield bias contains all yield bias categories
      Failure/Error: let(:raw_json) { File.read(template_path) }

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'IO.read'
      # ./spec/data/alien_world_templates_integrity_spec.rb:15:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:16:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:17:in 'block (2 levels) in <main>'
      # ./spec/data/alien_world_templates_integrity_spec.rb:121:in 'block (3 levels) in <main>'

  40) Alien World Templates Integrity exists and is valid JSON
      Failure/Error: expect(File.exist?(template_path)).to be true

        expected true
             got false
      # ./spec/data/templates/alien_world_templates_spec.rb:16:in 'block (2 levels) in <main>'

  41) Alien World Templates Integrity metadata exists
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:21:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:24:in 'block (3 levels) in <main>'

  42) Alien World Templates Integrity metadata has required fields
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:21:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:37:in 'block (4 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:36:in 'Array#each'
      # ./spec/data/templates/alien_world_templates_spec.rb:36:in 'block (3 levels) in <main>'

  43) Alien World Templates Integrity metadata is versioned correctly
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:21:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:42:in 'block (3 levels) in <main>'

  44) Alien World Templates Integrity terrestrial planet templates exists and is an array
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:51:in 'block (3 levels) in <main>'

  45) Alien World Templates Integrity terrestrial planet templates contains exactly 25 templates
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:55:in 'block (3 levels) in <main>'

  46) Alien World Templates Integrity terrestrial planet templates has unique identifiers
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:59:in 'block (3 levels) in <main>'

  47) Alien World Templates Integrity terrestrial planet templates covers Template-A01 through Template-A25
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:65:in 'block (3 levels) in <main>'

  48) Alien World Templates Integrity terrestrial planet templates all templates are terrestrial
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:70:in 'block (3 levels) in <main>'

  49) Alien World Templates Integrity template schema validation each template contains all required fields
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:89:in 'block (3 levels) in <main>'

  50) Alien World Templates Integrity atmospheric constraints contains no oxygen by default
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:100:in 'block (3 levels) in <main>'

  51) Alien World Templates Integrity sanity checks has realistic gravity values
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:110:in 'block (3 levels) in <main>'

  52) Alien World Templates Integrity sanity checks has positive pressure
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:116:in 'block (3 levels) in <main>'

  53) Alien World Templates Integrity sanity checks terraforming difficulty is bounded
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:122:in 'block (3 levels) in <main>'

  54) GameDataPaths sets the correct path based on environment
      Failure/Error: expect(GalaxyGame::Paths::JSON_DATA).to eq(Rails.root.join('data', 'json-data'))

        expected: #<Pathname:/home/galaxy_game/data/json-data>
             got: #<Pathname:/home/galaxy_game/app/data>

        (compared using ==)

        Diff:
        @@ -1 +1 @@
        -#<Pathname:/home/galaxy_game/data/json-data>
        +#<Pathname:/home/galaxy_game/app/data>
      # ./spec/initializers/game_data_paths_spec.rb:6:in 'block (2 levels) in <main>'

  55) Component Production Game Loop Integration full production cycle produces components through game loop progression
      Failure/Error: expect(job.status).to eq('completed')

        expected: "completed"
             got: "in_progress"

        (compared using ==)
      # ./spec/integration/component_production_game_loop_spec.rb:135:in 'block (3 levels) in <main>'

  56) Component Production Game Loop Integration full production cycle handles partial progress over multiple ticks
      Failure/Error: expect(job.status).to eq('completed')

        expected: "completed"
             got: "in_progress"

        (compared using ==)
      # ./spec/integration/component_production_game_loop_spec.rb:160:in 'block (3 levels) in <main>'

  57) Component Production Game Loop Integration full production cycle processes multiple jobs simultaneously
      Failure/Error: expect(job1.reload.status).to eq('completed')

        expected: "completed"
             got: "in_progress"

        (compared using ==)
      # ./spec/integration/component_production_game_loop_spec.rb:180:in 'block (3 levels) in <main>'

  58) Covering System Integration Lava tube worldhouse covering workflow seals skylights when worldhouse construction completes
      Failure/Error:
        Lookup::PlanetaryGeologicalFeatureLookupService
          .new(celestial_body)
          .find_by_id(feature_id)

      NoMethodError:
        undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
      # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
      # ./app/models/celestial_bodies/features/base_feature.rb:42:in 'CelestialBodies::Features::BaseFeature#name'
      # ./spec/integration/covering_system_integration_spec.rb:76:in 'block (3 levels) in <main>'

  59) Covering System Integration Worldhouse segment covering workflow handles massive scale covering
      Failure/Error:
        Structures::Worldhouse.create!(
          name: 'Valles Marineris Worldhouse',
          geological_feature: valley,
          settlement: mars_settlement,
          owner: mars_settlement.owner,
          structure_name: 'worldhouse',
          operational_data: {
            "structure_type" => "worldhouse",
            "connection_systems" => {
              "power_distribution" => {"status" => "offline", "efficiency" => 85}

      ActiveRecord::RecordInvalid:
        Validation failed: Structure type can't be blank
      # ./spec/integration/covering_system_integration_spec.rb:114:in 'block (3 levels) in <main>'
      # ./spec/integration/covering_system_integration_spec.rb:147:in 'block (3 levels) in <main>'
      # ./spec/integration/covering_system_integration_spec.rb:157:in 'block (3 levels) in <main>'

  60) Covering System Integration Multi-scale comparison uses same system for different scales
      Failure/Error:
        worldhouse = Structures::Worldhouse.create!(
          name: 'Test Worldhouse',
          geological_feature: valley,
          settlement: mars_settlement,
          owner: mars_settlement.owner,
          structure_name: 'worldhouse',
          operational_data: {
            "structure_type" => "worldhouse",
            "connection_systems" => {
              "power_distribution" => {"status" => "offline", "efficiency" => 85}

      ActiveRecord::RecordInvalid:
        Validation failed: Structure type can't be blank
      # ./spec/integration/covering_system_integration_spec.rb:193:in 'block (3 levels) in <main>'

  61) Manufacturing Pipeline End-to-End complete ISRU to enclosed tank pipeline processes raw regolith through all stages to produce an enclosed tank
      Failure/Error: expect(pve_job.status).to eq('completed')

        expected: #<Encoding:UTF-8> "completed"
             got: #<Encoding:US-ASCII> "in_progress"

        (compared using ==)
      # ./spec/integration/manufacturing_pipeline_e2e_spec.rb:365:in 'block (3 levels) in <main>'

  62) Manufacturing Pipeline End-to-End material tracking through pipeline preserves composition metadata through processing chain
      Failure/Error: expect(processed.metadata['composition']).to be_present

      NoMethodError:
        undefined method 'metadata' for nil
      # ./spec/integration/manufacturing_pipeline_e2e_spec.rb:615:in 'block (3 levels) in <main>'

  63) Terraforming Integration end-to-end terraforming simulation creates a barren planet with correct initial conditions
      Failure/Error: return composition[formula_or_name].to_f if composition[formula_or_name]

      NoMethodError:
        undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess
      # ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'
      # ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'
      # ./spec/integration/terraforming_integration_spec.rb:69:in 'block (3 levels) in <main>'

  64) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time increases oxygen levels after 1 day
      Failure/Error: return composition[formula_or_name].to_f if composition[formula_or_name]

      NoMethodError:
        undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess
      # ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'
      # ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'
      # ./spec/integration/terraforming_integration_spec.rb:121:in 'block (5 levels) in <main>'

  65) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time decreases CO2 levels after 1 day
      Failure/Error: total_area = @biosphere.planet_biomes.sum(:area_percentage)

      ActiveRecord::StatementInvalid:
        PG::UndefinedColumn: ERROR:  column "area_percentage" does not exist
        LINE 1: SELECT SUM(area_percentage) FROM "planet_biomes" WHERE "plan...
                           ^
      # ./app/services/terra_sim/biosphere_simulation_service.rb:429:in 'TerraSim::BiosphereSimulationService#balance_biomes'
      # ./app/services/terra_sim/biosphere_simulation_service.rb:28:in 'TerraSim::BiosphereSimulationService#simulate'
      # ./spec/integration/terraforming_integration_spec.rb:133:in 'block (5 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedColumn:
      #   ERROR:  column "area_percentage" does not exist
      #   LINE 1: SELECT SUM(area_percentage) FROM "planet_biomes" WHERE "plan...
      #                      ^
      #   ./app/services/terra_sim/biosphere_simulation_service.rb:429:in 'TerraSim::BiosphereSimulationService#balance_biomes'

  66) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time shows progressive changes over 100 days
      Failure/Error: return composition[formula_or_name].to_f if composition[formula_or_name]

      NoMethodError:
        undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess
      # ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'
      # ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'
      # ./spec/integration/terraforming_integration_spec.rb:141:in 'block (5 levels) in <main>'

  67) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time scales effects by time parameter
      Failure/Error: total_area = @biosphere.planet_biomes.sum(:area_percentage)

      ActiveRecord::StatementInvalid:
        PG::UndefinedColumn: ERROR:  column "area_percentage" does not exist
        LINE 1: SELECT SUM(area_percentage) FROM "planet_biomes" WHERE "plan...
                           ^
      # ./app/services/terra_sim/biosphere_simulation_service.rb:429:in 'TerraSim::BiosphereSimulationService#balance_biomes'
      # ./app/services/terra_sim/biosphere_simulation_service.rb:28:in 'TerraSim::BiosphereSimulationService#simulate'
      # ./spec/integration/terraforming_integration_spec.rb:173:in 'block (5 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedColumn:
      #   ERROR:  column "area_percentage" does not exist
      #   LINE 1: SELECT SUM(area_percentage) FROM "planet_biomes" WHERE "plan...
      #                      ^
      #   ./app/services/terra_sim/biosphere_simulation_service.rb:429:in 'TerraSim::BiosphereSimulationService#balance_biomes'

  68) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed life form populations over time maintains or grows populations under favorable conditions
      Failure/Error: total_area = @biosphere.planet_biomes.sum(:area_percentage)

      ActiveRecord::StatementInvalid:
        PG::UndefinedColumn: ERROR:  column "area_percentage" does not exist
        LINE 1: SELECT SUM(area_percentage) FROM "planet_biomes" WHERE "plan...
                           ^
      # ./app/services/terra_sim/biosphere_simulation_service.rb:429:in 'TerraSim::BiosphereSimulationService#balance_biomes'
      # ./app/services/terra_sim/biosphere_simulation_service.rb:28:in 'TerraSim::BiosphereSimulationService#simulate'
      # ./spec/integration/terraforming_integration_spec.rb:203:in 'block (5 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedColumn:
      #   ERROR:  column "area_percentage" does not exist
      #   LINE 1: SELECT SUM(area_percentage) FROM "planet_biomes" WHERE "plan...
      #                      ^
      #   ./app/services/terra_sim/biosphere_simulation_service.rb:429:in 'TerraSim::BiosphereSimulationService#balance_biomes'

  69) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed combined effects from multiple species aggregates atmospheric effects from all life forms
      Failure/Error: return composition[formula_or_name].to_f if composition[formula_or_name]

      NoMethodError:
        undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess
      # ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'
      # ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'
      # ./spec/integration/terraforming_integration_spec.rb:229:in 'block (5 levels) in <main>'

  70) Terraforming Integration end-to-end terraforming simulation without life forms uses fallback values when no terraforming organisms exist
      Failure/Error: return composition[formula_or_name].to_f if composition[formula_or_name]

      NoMethodError:
        undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess
      # ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'
      # ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'
      # ./spec/integration/terraforming_integration_spec.rb:245:in 'block (4 levels) in <main>'

  71) Terraforming Integration realistic terraforming scenario demonstrates full terraforming workflow
      Failure/Error: return composition[formula_or_name].to_f if composition[formula_or_name]

      NoMethodError:
        undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess
      # ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'
      # ./app/models/concerns/atmosphere_concern.rb:27:in 'AtmosphereConcern#o2_percentage'
      # ./spec/integration/terraforming_integration_spec.rb:300:in 'block (3 levels) in <main>'

  72) Terraforming Workflow Integration transforms atmosphere over time with deployed organisms
      Failure/Error: volume_effect = Math.log(volume + 1) # Larger volumes retain more cold temperature

      NoMethodError:
        undefined method '+' for nil
      # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
      # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
      # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
      # ./app/services/terra_sim/simulator.rb:74:in 'TerraSim::Simulator#update_spheres'
      # ./app/services/terra_sim/simulator.rb:26:in 'TerraSim::Simulator#calc_current'
      # ./app/models/celestial_bodies/celestial_body.rb:424:in 'CelestialBodies::CelestialBody#run_terra_sim'
      # ./spec/integration/terraforming_workflow_spec.rb:28:in 'block (2 levels) in <main>'

  73) Terraforming Workflow Integration allows monitoring of terraforming progress
      Failure/Error: volume_effect = Math.log(volume + 1) # Larger volumes retain more cold temperature

      NoMethodError:
        undefined method '+' for nil
      # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
      # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
      # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
      # ./app/services/terra_sim/simulator.rb:74:in 'TerraSim::Simulator#update_spheres'
      # ./app/services/terra_sim/simulator.rb:26:in 'TerraSim::Simulator#calc_current'
      # ./app/models/celestial_bodies/celestial_body.rb:424:in 'CelestialBodies::CelestialBody#run_terra_sim'
      # ./spec/integration/terraforming_workflow_spec.rb:28:in 'block (2 levels) in <main>'

  74) ConcurrentTaskWorkerJob#perform with manufacturing task during daylight executes the task successfully
      Failure/Error: allow(location).to receive(:solar_output_factor).and_return(1.0)
        #<Location::CelestialLocation id: 1349, name: "Location 4", coordinates: "44.72°S 67.14°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 1146, celestial_body_id: 3606, created_at: "2026-01-11 23:18:50.798423000 +0000", updated_at: "2026-01-11 23:18:50.820934000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:30:in 'block (4 levels) in <main>'

  75) ConcurrentTaskWorkerJob#perform with manufacturing task during daylight generates manufacturing byproducts
      Failure/Error: allow(location).to receive(:solar_output_factor).and_return(1.0)
        #<Location::CelestialLocation id: 1350, name: "Location 5", coordinates: "36.01°S 42.21°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 1147, celestial_body_id: 3607, created_at: "2026-01-11 23:18:51.039085000 +0000", updated_at: "2026-01-11 23:18:51.059303000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:30:in 'block (4 levels) in <main>'

  76) ConcurrentTaskWorkerJob#perform with manufacturing task during low light does not generate byproducts
      Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.05) # Below 0.1 threshold
        #<Location::CelestialLocation id: 1351, name: "Location 6", coordinates: "68.70°S 138.64°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 1148, celestial_body_id: 3608, created_at: "2026-01-11 23:18:51.211370000 +0000", updated_at: "2026-01-11 23:18:51.230713000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:51:in 'block (4 levels) in <main>'

  77) ConcurrentTaskWorkerJob#perform with non-manufacturing task does not attempt byproduct generation
      Failure/Error: solar_factor = settlement.location&.solar_output_factor || 1.0

      NoMethodError:
        undefined method 'solar_output_factor' for an instance of Location::CelestialLocation
      # ./app/jobs/concurrent_task_worker_job.rb:30:in 'ConcurrentTaskWorkerJob#handle_manufacturing_byproducts'
      # ./app/jobs/concurrent_task_worker_job.rb:12:in 'ConcurrentTaskWorkerJob#perform'
      # /usr/local/bundle/gems/i18n-1.14.7/lib/i18n.rb:348:in 'I18n::Base#with_locale'
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:73:in 'block (4 levels) in <main>'

  78) Account#deposit with a valid amount increases the account balance
      Failure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/account_spec.rb:25:in 'block (5 levels) in <main>'
      # ./spec/models/account_spec.rb:24:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  79) Account#deposit with an invalid amount (negative) raises an error and does not modify the balance
      Failure/Error:
        expect { player_account.deposit(-500, "Invalid deposit") }
          .to raise_error(ArgumentError, "Amount must be positive")

        expected ArgumentError with "Amount must be positive", got #<ActiveRecord::InvalidForeignKey:"PG::ForeignKeyViolation: ERROR:  insert or update on table \"accou... \"fk_rails_dd73f000d2\"\nDETAIL:  Key (currency_id)=(1) is not present in table \"currencies\".\n"> with backtrace:
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
          # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'
          # ./spec/models/account_spec.rb:38:in 'block (5 levels) in <main>'
          # ./spec/models/account_spec.rb:38:in 'block (4 levels) in <main>'
      # ./spec/models/account_spec.rb:38:in 'block (4 levels) in <main>'

  80) Account#withdraw when funds are sufficient decreases the account balance
      Failure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/account_spec.rb:50:in 'block (5 levels) in <main>'
      # ./spec/models/account_spec.rb:49:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  81) Account#withdraw when funds are insufficient raises an error and does not modify the balance
      Failure/Error:
        expect { player_account.withdraw(2_000, "Overdraft attempt") }
          .to raise_error("Insufficient funds")

        expected Exception with "Insufficient funds", got #<ActiveRecord::InvalidForeignKey:"PG::ForeignKeyViolation: ERROR:  insert or update on table \"accou... \"fk_rails_dd73f000d2\"\nDETAIL:  Key (currency_id)=(1) is not present in table \"currencies\".\n"> with backtrace:
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
          # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'
          # ./spec/models/account_spec.rb:63:in 'block (5 levels) in <main>'
          # ./spec/models/account_spec.rb:63:in 'block (4 levels) in <main>'
      # ./spec/models/account_spec.rb:63:in 'block (4 levels) in <main>'

  82) Account#transfer_funds when funds are sufficient transfers the amount from one account to another
      Failure/Error: let(:recipient_account) { create(:account, accountable: recipient_player, balance: 500) }

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:10:in 'block (2 levels) in <main>'
      # ./spec/models/account_spec.rb:76:in 'block (5 levels) in <main>'
      # ./spec/models/account_spec.rb:74:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  83) Account#transfer_funds when funds are insufficient raises an error and does not modify balances
      Failure/Error:
        expect { player_account.transfer_funds(2_000, recipient_account, "Overdraft transfer attempt") }
          .to raise_error("Insufficient funds")

        expected Exception with "Insufficient funds", got #<ActiveRecord::InvalidForeignKey:"PG::ForeignKeyViolation: ERROR:  insert or update on table \"accou... \"fk_rails_dd73f000d2\"\nDETAIL:  Key (currency_id)=(1) is not present in table \"currencies\".\n"> with backtrace:
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
          # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
          # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'
          # ./spec/models/account_spec.rb:96:in 'block (5 levels) in <main>'
          # ./spec/models/account_spec.rb:96:in 'block (4 levels) in <main>'
      # ./spec/models/account_spec.rb:96:in 'block (4 levels) in <main>'

  84) Account edge cases when balance is exactly zero prevents withdrawals or transfers
      Failure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/account_spec.rb:108:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  85) Account edge cases when balance is exactly zero allows deposits
      Failure/Error: let(:player_account) { create(:account, accountable: player, balance: 1_000) }

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/account_spec.rb:108:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  86) Account different accountable types works with a player account
      Failure/Error: account = create(:account, accountable: create(:player))

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:128:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  87) Account different accountable types works with a settlement account
      Failure/Error: account = create(:account, accountable: create(:base_settlement))

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:133:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  88) Account different accountable types works with an organization account
      Failure/Error: account = create(:account, accountable: create(:organization))

      ActiveRecord::InvalidForeignKey:
        PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
        DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/account_spec.rb:138:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::ForeignKeyViolation:
      #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
      #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  89) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:31:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  90) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:32:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  91) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:33:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  92) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:34:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  93) Atmosphere#volume when celestial_body responds to volume returns the celestial_body's volume
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:51:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  94) Atmosphere sealing methods #sealed? returns the sealing status
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:76:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:80:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  95) Atmosphere sealing methods #seal! sets sealing status to true
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:85:in 'block (4 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:88:in 'block (5 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:88:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  96) Atmosphere sealing methods #unseal! sets sealing status to false
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:76:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:94:in 'block (5 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:94:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  97) Atmosphere#habitable? with good conditions returns true
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:104:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  98) Atmosphere#habitable? with low pressure returns false
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:110:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  99) Atmosphere#habitable? with low oxygen returns false
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:117:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  100) Atmosphere#habitable? with high CO2 returns false
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:124:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  101) Atmosphere#habitable? with extreme temperature returns false for too cold
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:131:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  102) Atmosphere#habitable? with extreme temperature returns false for too hot
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:136:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  103) Atmosphere AtmosphereConcern inclusion includes AtmosphereConcern methods
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:143:in 'block (3 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:146:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  104) Atmosphere JSON fields initializes JSON fields with empty objects
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:153:in 'block (3 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:156:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  105) Atmosphere JSON fields allows storing data in JSON fields
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:153:in 'block (3 levels) in <main>'
       # ./spec/models/atmosphere_spec.rb:164:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  106) Atmosphere parent validation rejects multiple parents
       Failure/Error: craft = create(:base_craft, owner: player)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/atmosphere_spec.rb:191:in 'block (3 levels) in <main>'

  107) Units::BiogasGenerator#operate consumes biomass, organic waste, and energy, producing biogas and fertilizer
       Failure/Error:
         BiogasGenerator.new(
           name: 'Basic Biogas Generator',
           material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant BiogasGenerator
       # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/biogas_generator_spec.rb:19:in 'block (3 levels) in <main>'

  108) Units::BiogasGenerator#operate returns false if insufficient biomass is available
       Failure/Error:
         BiogasGenerator.new(
           name: 'Basic Biogas Generator',
           material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant BiogasGenerator
       # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/biogas_generator_spec.rb:29:in 'block (3 levels) in <main>'

  109) Units::BiogasGenerator#operate returns false if insufficient organic waste is available
       Failure/Error:
         BiogasGenerator.new(
           name: 'Basic Biogas Generator',
           material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant BiogasGenerator
       # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/biogas_generator_spec.rb:34:in 'block (3 levels) in <main>'

  110) Units::BiogasGenerator#operate returns false if insufficient energy is available
       Failure/Error:
         BiogasGenerator.new(
           name: 'Basic Biogas Generator',
           material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant BiogasGenerator
       # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/biogas_generator_spec.rb:39:in 'block (3 levels) in <main>'

  111) Biosphere and Life Form Integration ecosystem simulation simulates population dynamics
       Failure/Error: expect(@plants.reload.population).not_to eq(10_000)

         expected: value != 10000
              got: 10000

         (compared using ==)
       # ./spec/models/biology/biosphere_integration_spec.rb:54:in 'block (3 levels) in <main>'

  112) Units::BiomassRecycler#operate consumes biomass and energy, producing fertilizer and biofuel
       Failure/Error:
         BiomassRecycler.new(
           name: 'Basic Biomass Recycler',
           material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },
           energy_cost: 20  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant BiomassRecycler
       # ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/biomass_recycler_spec.rb:19:in 'block (3 levels) in <main>'

  113) Units::BiomassRecycler#operate returns false if insufficient biomass is available
       Failure/Error:
         BiomassRecycler.new(
           name: 'Basic Biomass Recycler',
           material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },
           energy_cost: 20  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant BiomassRecycler
       # ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/biomass_recycler_spec.rb:28:in 'block (3 levels) in <main>'

  114) Units::BiomassRecycler#operate returns false if insufficient energy is available
       Failure/Error:
         BiomassRecycler.new(
           name: 'Basic Biomass Recycler',
           material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },
           energy_cost: 20  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant BiomassRecycler
       # ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/biomass_recycler_spec.rb:33:in 'block (3 levels) in <main>'

  115) CelestialBodies::Features::BaseFeature#static_data fetches data from lookup service
       Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:39:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  116) CelestialBodies::Features::BaseFeature#static_data caches the data
       Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:44:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  117) CelestialBodies::Features::BaseFeature#discover! marks feature as discovered
       Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:51:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:62:in 'block (4 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:59:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  118) CelestialBodies::Features::BaseFeature#discover! sets discovered_at timestamp
       Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:51:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:66:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  119) CelestialBodies::Features::BaseFeature#discover! does not overwrite existing discovery
       Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:51:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:71:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  120) CelestialBodies::Features::BaseFeature status transitions transitions through states correctly
       Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:83:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:91:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  121) CelestialBodies::Features::BaseFeature status transitions cannot skip states
       Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:83:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:108:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  122) CelestialBodies::Features::BaseFeature tier helpers identifies strategic features
       Failure/Error: feature = build(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001', feature_type: 'lava_tube')

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:5:in 'FactoryBot::Strategy::Build#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/features/base_feature_spec.rb:119:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  123) CelestialBodies::Materials::ExoticMaterial associations 
       Failure/Error:
         described_class.new(
           name: 'Metallic Hydrogen', 
           state: 'metallic_hydrogen',
           geosphere: geosphere,
           rarity: 95,
           stability: 20,
           percentage: 10,
           mass: 1000
         ) 

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:25:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  124) CelestialBodies::Materials::ExoticMaterial validations 
       Failure/Error:
         described_class.new(
           name: 'Metallic Hydrogen', 
           state: 'metallic_hydrogen',
           geosphere: geosphere,
           rarity: 95,
           stability: 20,
           percentage: 10,
           mass: 1000
         ) 

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:29:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  125) CelestialBodies::Materials::ExoticMaterial validations 
       Failure/Error:
         described_class.new(
           name: 'Metallic Hydrogen', 
           state: 'metallic_hydrogen',
           geosphere: geosphere,
           rarity: 95,
           stability: 20,
           percentage: 10,
           mass: 1000
         ) 

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:30:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  126) CelestialBodies::Materials::ExoticMaterial validations 
       Failure/Error:
         described_class.new(
           name: 'Metallic Hydrogen', 
           state: 'metallic_hydrogen',
           geosphere: geosphere,
           rarity: 95,
           stability: 20,
           percentage: 10,
           mass: 1000
         ) 

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:31:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  127) CelestialBodies::Materials::ExoticMaterial state helper methods identifies metallic hydrogen state
       Failure/Error:
         described_class.new(
           name: 'Metallic Hydrogen', 
           state: 'metallic_hydrogen',
           geosphere: geosphere,
           rarity: 95,
           stability: 20,
           percentage: 10,
           mass: 1000
         ) 

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:36:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  128) CelestialBodies::Materials::ExoticMaterial state helper methods identifies plasma state
       Failure/Error:
         described_class.new(
           name: 'Metallic Hydrogen', 
           state: 'metallic_hydrogen',
           geosphere: geosphere,
           rarity: 95,
           stability: 20,
           percentage: 10,
           mass: 1000
         ) 

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:43:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  129) CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns metallic_hydrogen for hydrogen at extreme pressure
       Failure/Error: hydrogen = described_class.new(name: 'Hydrogen')

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:51:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:51:in 'block (3 levels) in <main>'

  130) CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns plasma at extreme temperatures
       Failure/Error: any_material = described_class.new(name: 'Oxygen')

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:56:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:56:in 'block (3 levels) in <main>'

  131) CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns superfluid for helium at low temperatures
       Failure/Error: helium = described_class.new(name: 'Helium')

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:61:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:61:in 'block (3 levels) in <main>'

  132) CelestialBodies::Materials::ExoticMaterial#phase_transition_at falls back to standard states otherwise
       Failure/Error: iron = described_class.new(name: 'Iron')

       ActiveRecord::StatementInvalid:
         PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
         LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                     ^
       # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:68:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedTable:
       #   ERROR:  relation "exotic_materials" does not exist
       #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
       #                               ^
       #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:68:in 'block (3 levels) in <main>'

  133) CelestialBodies::Materials::Gas associations can be accessed through atmosphere.gases
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: Oxygen. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./spec/models/celestial_bodies/materials/gas_spec.rb:22:in 'block (3 levels) in <main>'

  134) CelestialBodies::Materials::GeologicalMaterial associations can be accessed through geosphere.geological_materials
       Failure/Error:
         material = CelestialBodies::Materials::GeologicalMaterial.create!(
           name: "Silicon", 
           percentage: 25.0,
           geosphere: celestial_body.geosphere,
           layer: "crust",
           mass: 100,
           state: "solid"
         )

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/geological_material_spec.rb:20:in 'block (3 levels) in <main>'

  135) CelestialBodies::Materials::GeologicalMaterial validations is not valid without a name
       Failure/Error: expect(material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/geological_material_spec.rb:42:in 'block (3 levels) in <main>'

  136) CelestialBodies::Materials::GeologicalMaterial validations is not valid with an invalid layer
       Failure/Error: expect(material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/geological_material_spec.rb:49:in 'block (3 levels) in <main>'

  137) CelestialBodies::Materials::GeologicalMaterial validations is not valid with a negative percentage
       Failure/Error: expect(material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/geological_material_spec.rb:56:in 'block (3 levels) in <main>'

  138) CelestialBodies::Materials::GeologicalMaterial validations is not valid with a percentage over 100
       Failure/Error: expect(material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/geological_material_spec.rb:63:in 'block (3 levels) in <main>'

  139) CelestialBodies::Materials::GeologicalMaterial validations is not valid with a negative mass
       Failure/Error: expect(material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/geological_material_spec.rb:70:in 'block (3 levels) in <main>'

  140) CelestialBodies::Materials::GeologicalMaterial validations is not valid with an invalid state
       Failure/Error: expect(material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/geological_material_spec.rb:77:in 'block (3 levels) in <main>'

  141) CelestialBodies::Materials::Liquid associations is expected to belong to hydrosphere required: true
       Failure/Error: it { is_expected.to belong_to(:hydrosphere) }

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validator.rb:96:in 'Shoulda::Matchers::ActiveModel::Validator#perform_validation'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validator.rb:89:in 'Shoulda::Matchers::ActiveModel::Validator#validation_result'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validator.rb:85:in 'Shoulda::Matchers::ActiveModel::Validator#validation_error_messages'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validator.rb:64:in 'Shoulda::Matchers::ActiveModel::Validator#messages'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validator.rb:25:in 'Shoulda::Matchers::ActiveModel::Validator#has_messages?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validator.rb:55:in 'Shoulda::Matchers::ActiveModel::Validator#messages_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validator.rb:21:in 'Shoulda::Matchers::ActiveModel::Validator#call'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_record/association_matchers/required_matcher.rb:61:in 'Shoulda::Matchers::ActiveRecord::AssociationMatchers::RequiredMatcher#submatcher_passes?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_record/association_matchers/required_matcher.rb:23:in 'Shoulda::Matchers::ActiveRecord::AssociationMatchers::RequiredMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_record/association_matcher.rb:1220:in 'block in Shoulda::Matchers::ActiveRecord::AssociationMatcher#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_record/association_matcher.rb:1219:in 'Array#reject'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_record/association_matcher.rb:1219:in 'Shoulda::Matchers::ActiveRecord::AssociationMatcher#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_record/association_matcher.rb:1474:in 'Shoulda::Matchers::ActiveRecord::AssociationMatcher#submatchers_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_record/association_matcher.rb:1167:in 'Shoulda::Matchers::ActiveRecord::AssociationMatcher#matches?'
       # ./spec/models/celestial_bodies/materials/liquid_spec.rb:15:in 'block (3 levels) in <main>'

  142) CelestialBodies::Materials::Liquid associations can be accessed through hydrosphere.liquid_materials
       Failure/Error:
         liquid = CelestialBodies::Materials::Liquid.create!(
           name: "Methane", 
           amount: 500.0,
           hydrosphere: hydrosphere
         )

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/liquid_spec.rb:25:in 'block (3 levels) in <main>'

  143) CelestialBodies::Materials::Liquid validations is valid with valid attributes
       Failure/Error: expect(liquid_material).to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/liquid_spec.rb:41:in 'block (3 levels) in <main>'

  144) CelestialBodies::Materials::Liquid validations is not valid without a name
       Failure/Error: expect(liquid_material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/liquid_spec.rb:46:in 'block (3 levels) in <main>'

  145) CelestialBodies::Materials::Liquid validations is not valid without an amount
       Failure/Error: expect(liquid_material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/liquid_spec.rb:52:in 'block (3 levels) in <main>'

  146) CelestialBodies::Materials::Liquid validations is not valid with a negative amount
       Failure/Error: expect(liquid_material).not_to be_valid

       ArgumentError:
         wrong number of arguments (given 0, expected 1..2)
       # ./spec/models/celestial_bodies/materials/liquid_spec.rb:57:in 'block (3 levels) in <main>'

  147) CelestialBodies::MinorBodies::DwarfPlanet validations is valid with valid attributes
       Failure/Error: planet = create(:dwarf_planet, solar_system: solar_system)

       NameError:
         uninitialized constant DwarfPlanet
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:16:in 'block (3 levels) in <main>'

  148) CelestialBodies::MinorBodies::DwarfPlanet#is_spherical? returns true for dwarf planets
       Failure/Error: planet = create(:dwarf_planet, solar_system: solar_system)

       NameError:
         uninitialized constant DwarfPlanet
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:22:in 'block (3 levels) in <main>'

  149) CelestialBodies::MinorBodies::DwarfPlanet#calculate_geological_activity calculates geological activity based on mass and age
       Failure/Error: planet = create(:dwarf_planet, solar_system: solar_system)

       NameError:
         uninitialized constant DwarfPlanet
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:29:in 'block (3 levels) in <main>'

  150) CelestialBodies::PlanetBiome has access to celestial_body through biosphere
       Failure/Error: planet_biome = create(:celestial_bodies_planet_biome, biosphere: biosphere)

       KeyError:
         Factory not registered: "celestial_bodies_planet_biome"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:134:in 'block (2 levels) in <module:CelestialBodies>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_planet_biome"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  151) CelestialBodies::PlanetBiome associations 
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:22:in 'block (3 levels) in <module:CelestialBodies>'

  152) CelestialBodies::PlanetBiome associations 
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:24:in 'block (3 levels) in <module:CelestialBodies>'

  153) CelestialBodies::PlanetBiome validations is valid with valid attributes
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:29:in 'block (3 levels) in <module:CelestialBodies>'

  154) CelestialBodies::PlanetBiome validations is not valid without a biome
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:33:in 'block (3 levels) in <module:CelestialBodies>'

  155) CelestialBodies::PlanetBiome validations is not valid without a biosphere
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:38:in 'block (3 levels) in <module:CelestialBodies>'

  156) CelestialBodies::PlanetBiome validations 
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:42:in 'block (3 levels) in <module:CelestialBodies>'

  157) CelestialBodies::PlanetBiome jsonb properties can set and retrieve area_percentage
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:48:in 'block (3 levels) in <module:CelestialBodies>'

  158) CelestialBodies::PlanetBiome jsonb properties can set and retrieve vegetation_cover
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:53:in 'block (3 levels) in <module:CelestialBodies>'

  159) CelestialBodies::PlanetBiome jsonb properties can set and retrieve moisture_level
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:59:in 'block (3 levels) in <module:CelestialBodies>'

  160) CelestialBodies::PlanetBiome jsonb properties can set and retrieve latitude
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:64:in 'block (3 levels) in <module:CelestialBodies>'

  161) CelestialBodies::PlanetBiome jsonb properties can set and retrieve biodiversity
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:69:in 'block (3 levels) in <module:CelestialBodies>'

  162) CelestialBodies::PlanetBiome jsonb properties supports deprecated water_level with warning
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:15:in 'block (2 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:78:in 'block (3 levels) in <module:CelestialBodies>'

  163) CelestialBodies::PlanetBiome jsonb properties default values for properties defaults area_percentage to 0.0
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:86:in 'block (4 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:93:in 'block (4 levels) in <module:CelestialBodies>'

  164) CelestialBodies::PlanetBiome jsonb properties default values for properties defaults vegetation_cover to 0.0
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:86:in 'block (4 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:97:in 'block (4 levels) in <module:CelestialBodies>'

  165) CelestialBodies::PlanetBiome jsonb properties default values for properties defaults moisture_level to 0.0
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:86:in 'block (4 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:102:in 'block (4 levels) in <module:CelestialBodies>'

  166) CelestialBodies::PlanetBiome jsonb properties default values for properties defaults latitude to 0.0
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:86:in 'block (4 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:106:in 'block (4 levels) in <module:CelestialBodies>'

  167) CelestialBodies::PlanetBiome jsonb properties default values for properties defaults biodiversity to 0.0
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:86:in 'block (4 levels) in <module:CelestialBodies>'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:110:in 'block (4 levels) in <module:CelestialBodies>'

  168) CelestialBodies::PlanetBiome callbacks updates biosphere biodiversity after creation
       Failure/Error: create(:celestial_bodies_planet_biome, biome: biome, biosphere: biosphere)

       KeyError:
         Factory not registered: "celestial_bodies_planet_biome"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:121:in 'block (3 levels) in <module:CelestialBodies>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_planet_biome"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  169) CelestialBodies::PlanetBiome callbacks updates biosphere biodiversity after destruction
       Failure/Error: planet_biome = create(:celestial_bodies_planet_biome, biome: biome, biosphere: biosphere)

       KeyError:
         Factory not registered: "celestial_bodies_planet_biome"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planet_biome_spec.rb:126:in 'block (3 levels) in <module:CelestialBodies>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_planet_biome"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  170) CelestialBodies::Planets::Gaseous::GasGiant behaves like a gaseous planet calculates cloud bands based on rotation
       Failure/Error: expect(gaseous_planet.calculate_bands).to be_a(Integer)

       NoMethodError:
         undefined method 'calculate_bands' for an instance of CelestialBodies::GasGiant
       Shared Example Group: "a gaseous planet" called from ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:6
       # ./spec/support/shared_examples/gaseous_planet_examples.rb:34:in 'block (2 levels) in <main>'

  171) CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with Jupiter mass estimates a realistic moon count
       Failure/Error: moon_count = gas_giant.estimate_moon_count

       NoMethodError:
         undefined method 'estimate_moon_count' for an instance of CelestialBodies::GasGiant
       # ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:29:in 'block (5 levels) in <main>'

  172) CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with different masses scales moon count with mass
       Failure/Error: original_count = gas_giant.estimate_moon_count

       NoMethodError:
         undefined method 'estimate_moon_count' for an instance of CelestialBodies::GasGiant
       # ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:36:in 'block (5 levels) in <main>'

  173) CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #ring_system_probability returns a high probability for gas giants
       Failure/Error: probability = gas_giant.ring_system_probability

       NoMethodError:
         undefined method 'ring_system_probability' for an instance of CelestialBodies::GasGiant
       # ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:49:in 'block (4 levels) in <main>'

  174) CelestialBodies::Planets::Gaseous::IceGiant behaves like a gaseous planet calculates cloud bands based on rotation
       Failure/Error: expect(gaseous_planet.calculate_bands).to be_a(Integer)

       NoMethodError:
         undefined method 'calculate_bands' for an instance of CelestialBodies::GasGiant
       Shared Example Group: "a gaseous planet" called from ./spec/models/celestial_bodies/planets/gaseous/ice_giant_spec.rb:4
       # ./spec/support/shared_examples/gaseous_planet_examples.rb:34:in 'block (2 levels) in <main>'

  175) CelestialBodies::Planets::Ocean::HyceanPlanet validations requires an atmosphere to be present
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:8:in 'block (3 levels) in <main>'

  176) CelestialBodies::Planets::Ocean::HyceanPlanet validations requires at least 10% hydrogen in atmosphere
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:17:in 'block (3 levels) in <main>'

  177) CelestialBodies::Planets::Ocean::HyceanPlanet validations requires significant atmospheric pressure (>1 atm)
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:25:in 'block (3 levels) in <main>'

  178) CelestialBodies::Planets::Ocean::HyceanPlanet validations is valid with proper hydrogen content and pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:33:in 'block (3 levels) in <main>'

  179) CelestialBodies::Planets::Ocean::HyceanPlanet validations inherits ocean planet water coverage validation
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:38:in 'block (3 levels) in <main>'

  180) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes base ocean planet factors
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:57:in 'block (3 levels) in <main>'

  181) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes hydrogen blanket greenhouse effect
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:63:in 'block (3 levels) in <main>'

  182) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors calculates pressure habitability zones
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:69:in 'block (3 levels) in <main>'

  183) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors indicates expanded habitable temperature range
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:76:in 'block (3 levels) in <main>'

  184) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates optimal pressure range (10-100 atm) as level 3
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:82:in 'block (3 levels) in <main>'

  185) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates moderate pressure range (1-10 or 100-1000 atm) as level 2
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:91:in 'block (3 levels) in <main>'

  186) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates extreme pressure as level 1
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:100:in 'block (3 levels) in <main>'

  187) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes base ocean planet features
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:111:in 'block (3 levels) in <main>'

  188) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes hydrogen atmosphere features
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:117:in 'block (3 levels) in <main>'

  189) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes extreme storm systems for high pressure atmospheres
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:126:in 'block (3 levels) in <main>'

  190) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features does not include storm systems for lower pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:135:in 'block (3 levels) in <main>'

  191) CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies hydrogen saturated oceans for high H2 content
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:147:in 'block (3 levels) in <main>'

  192) CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies methane rich oceans when CH4 is present
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:154:in 'block (3 levels) in <main>'

  193) CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry returns unknown when hydrosphere composition is missing
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:163:in 'block (3 levels) in <main>'

  194) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth calculates habitable depth range based on pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:174:in 'block (3 levels) in <main>'

  195) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth sets deeper minimum depth for higher pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:182:in 'block (3 levels) in <main>'

  196) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth ensures maximum depth is greater than minimum
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:192:in 'block (3 levels) in <main>'

  197) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when atmosphere is missing
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:198:in 'block (3 levels) in <main>'

  198) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when hydrosphere is missing
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:205:in 'block (3 levels) in <main>'

  199) CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) calculates hydrogen percentage from atmosphere
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:215:in 'block (3 levels) in <main>'

  200) CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) returns 0 when H2 gas is not present
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:223:in 'block (3 levels) in <main>'

  201) CelestialBodies::Planets::Ocean::HyceanPlanet STI type sets the correct STI type
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:233:in 'block (3 levels) in <main>'

  202) CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high surface temperature
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:238:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:241:in 'block (3 levels) in <main>'

  203) CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high atmospheric pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:238:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:245:in 'block (3 levels) in <main>'

  204) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has below-freezing surface temperature
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:253:in 'block (3 levels) in <main>'

  205) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has significant ice coverage
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:257:in 'block (3 levels) in <main>'

  206) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has higher ammonia content as antifreeze
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:263:in 'block (3 levels) in <main>'

  207) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has mixed liquid-solid state distribution
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:269:in 'block (3 levels) in <main>'

  208) CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet inherits water_volume calculation
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:278:in 'block (3 levels) in <main>'

  209) CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet can analyze water chemistry
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:284:in 'block (3 levels) in <main>'

  210) CelestialBodies::Planets::Ocean::OceanPlanet validations requires at least 30% water coverage
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:18:in 'block (3 levels) in <main>'

  211) CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors marks aquatic environment as 'dominant' for coverage above 50%
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:58:in 'block (3 levels) in <main>'

  212) CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors analyzes water chemistry from hydrosphere composition
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:75:in 'block (3 levels) in <main>'

  213) CelestialBodies::Planets::Ocean::OceanPlanet#surface_features includes ocean_dominated for high water coverage
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:124:in 'block (3 levels) in <main>'

  214) CelestialBodies::Planets::Ocean::OceanPlanet#water_volume increases with higher water coverage
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:194:in 'block (3 levels) in <main>'

  215) CelestialBodies::Planets::Ocean::OceanPlanet#analyze_water_chemistry (protected method) identifies highly saline water
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:213:in 'block (3 levels) in <main>'

  216) CelestialBodies::Planets::Ocean::OceanPlanet#analyze_water_chemistry (protected method) identifies moderately saline water
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:225:in 'block (3 levels) in <main>'

  217) CelestialBodies::Planets::Ocean::OceanPlanet#analyze_water_chemistry (protected method) identifies low salinity water
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:236:in 'block (3 levels) in <main>'

  218) CelestialBodies::Planets::Ocean::WaterWorld validations requires high water coverage
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/water_world_spec.rb:15:in 'block (3 levels) in <main>'

  219) CelestialBodies::Planets::Ocean::WaterWorld#surface_features includes pelagic_world for extreme coverage
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:72:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/celestial_bodies/planets/ocean/water_world_spec.rb:55:in 'block (3 levels) in <main>'

  220) CelestialBodies::Spheres::Atmosphere#initialize_gases creates gases based on the composition
       Failure/Error: expect(atmosphere.gases.find_by(name: 'O2')).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:48:in 'block (3 levels) in <main>'

  221) CelestialBodies::Spheres::Atmosphere#add_gas adds gas using chemical formula
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: O2. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:56:in 'block (3 levels) in <main>'

  222) CelestialBodies::Spheres::Biosphere defaults accesses default temperature values via delegation methods
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: water. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:8:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:67:in 'block (3 levels) in <main>'

  223) CelestialBodies::Spheres::Biosphere#transfer_material logs errors when transfer fails due to validation errors
       Failure/Error: Rails.logger.error "Error parsing #{file}: #{e.message}"

         #<ActiveSupport::Logger:0x00007f7cac5f99e0 @level=0, @progname=nil, @default_formatter=#<Logger::Formatter:0x00007f7cac5e6098 @datetime_format=nil>, @formatter=#<ActiveSupport::Logger::SimpleFormatter:0x00007f7cac5e4068 @datetime_format=nil, @thread_key="activesupport_tagged_logging_tags:8632">, @logdev=#<Logger::LogDevice:0x00007f7cac5daf18 @shift_period_suffix="%Y%m%d", @shift_size=1048576, @shift_age=0, @filename="/home/galaxy_game/log/development.log", @dev=#<File:/home/galaxy_game/log/development.log>, @binmode=false, @reraise_write_errors=[], @mon_data=#<Monitor:0x00007f7cac5e5fa8>, @mon_data_owner_object_id=2824>, @level_override={}> received :error with unexpected arguments
           expected: (/Error transferring material/)
                got: ("Error parsing /home/galaxy_game/app/data/resources/materials/processed/geological/depleted_regolith.json: expected ',' or '}' after object value, got: '\"mechanical_properties\": {\n     '")
         Diff:
         @@ -1 +1 @@
         -[/Error transferring material/]
         +["Error parsing /home/galaxy_game/app/data/resources/materials/processed/geological/depleted_regolith.json: expected ',' or '}' after object value, got: '\"mechanical_properties\": {\n     '"]
       # ./app/services/lookup/material_lookup_service.rb:218:in 'block in Lookup::MaterialLookupService#load_json_files_recursively'
       # ./app/services/lookup/material_lookup_service.rb:212:in 'Array#map'
       # ./app/services/lookup/material_lookup_service.rb:212:in 'Lookup::MaterialLookupService#load_json_files_recursively'
       # ./app/services/lookup/material_lookup_service.rb:165:in 'block in Lookup::MaterialLookupService#load_materials'
       # ./app/services/lookup/material_lookup_service.rb:153:in 'Hash#each'
       # ./app/services/lookup/material_lookup_service.rb:153:in 'Lookup::MaterialLookupService#load_materials'
       # ./app/services/lookup/material_lookup_service.rb:47:in 'Lookup::MaterialLookupService#initialize'
       # ./app/models/concerns/geosphere_concern.rb:354:in 'Class#new'
       # ./app/models/concerns/geosphere_concern.rb:354:in 'GeosphereConcern#physical_state'
       # ./app/models/concerns/geosphere_concern.rb:271:in 'block in GeosphereConcern#update_material_states'
       # ./app/models/concerns/geosphere_concern.rb:269:in 'GeosphereConcern#update_material_states'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:156:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:204:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # JSON::ParserError:
       #   expected ',' or '}' after object value, got: '"mechanical_properties": {
       #        '
       #   /usr/local/bundle/gems/json-2.10.2/lib/json/common.rb:248:in 'JSON::Ext::Parser.parse'

  224) CelestialBodies::Spheres::Biosphere biome management introduces a new biome
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./app/models/celestial_bodies/spheres/biosphere.rb:58:in 'CelestialBodies::Spheres::Biosphere#introduce_biome'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:268:in 'block (4 levels) in <main>'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:267:in 'block (3 levels) in <main>'

  225) CelestialBodies::Spheres::Biosphere biome management removes a biome
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./app/models/celestial_bodies/spheres/biosphere.rb:58:in 'CelestialBodies::Spheres::Biosphere#introduce_biome'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:275:in 'block (3 levels) in <main>'

  226) CelestialBodies::Spheres::Biosphere#calculate_biodiversity_index calculates biodiversity index based on biome diversity
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./app/models/celestial_bodies/spheres/biosphere.rb:58:in 'CelestialBodies::Spheres::Biosphere#introduce_biome'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:291:in 'block (3 levels) in <main>'

  227) CelestialBodies::Spheres::Biosphere ecological simulation calculates expanded biodiversity including life forms
       Failure/Error: self.area_percentage = 0.0 if area_percentage.nil?

       NoMethodError:
         undefined method 'accessor' for an instance of ActiveModel::Type::Value
       # ./app/models/celestial_bodies/planet_biome.rb:45:in 'CelestialBodies::PlanetBiome#set_default_properties'
       # ./app/models/celestial_bodies/spheres/biosphere.rb:58:in 'CelestialBodies::Spheres::Biosphere#introduce_biome'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:594:in 'block (3 levels) in <main>'

  228) CelestialBodies::Spheres::Geosphere#add_material adds a material and updates the celestial body and geosphere
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:75:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  229) CelestialBodies::Spheres::Geosphere#add_material adds material to the specified layer
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:114:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  230) CelestialBodies::Spheres::Geosphere#remove_material removes material from the specified layer
       Failure/Error:
         layer_materials.each do |material|
           percentage = (material.amount.to_f / total_mass) * 100
           composition[material.name] = percentage
         end

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:563:in 'GeosphereConcern#update_composition_percentages'
       # ./app/models/concerns/geosphere_concern.rb:225:in 'GeosphereConcern#remove_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:144:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:563:in 'GeosphereConcern#update_composition_percentages'

  231) CelestialBodies::Spheres::Geosphere material management creates materials in correct layer
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:181:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  232) CelestialBodies::Spheres::Geosphere material management updates composition percentages
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:197:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  233) CelestialBodies::Spheres::Geosphere#extract_volatiles extracts volatiles based on temperature increase
       Failure/Error:
         volatile_material = materials.find_or_initialize_by(
           name: name,
           location: 'geosphere',
           layer: 'crust'
         )

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'Hash#each'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'GeosphereConcern#extract_volatiles'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:276:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'

  234) CelestialBodies::CelestialBody when not part of a solar system allows distance_from_star to be nil
       Failure/Error: expect(brown_dwarf.solar_system).to be_nil

         expected: nil
              got: #<SolarSystem id: 3118, identifier: "SS-486", name: "Solar System 423", galaxy_id: nil, current_star_...3:23:04.849986000 +0000", updated_at: "2026-01-11 23:23:04.849986000 +0000", wormhole_capacity: 0.0>
       # ./spec/models/celestial_body_spec.rb:19:in 'block (3 levels) in <main>'

  235) CelestialBodies::CelestialBody#add_material creates a new material if it does not exist
       Failure/Error: expect(mars.materials.last.name).to eq('Oxygen')

         expected: "Oxygen"
              got: "oxygen"

         (compared using ==)
       # ./spec/models/celestial_body_spec.rb:26:in 'block (3 levels) in <main>'

  236) CelestialBodies::CelestialBody#add_material updates the amount of an existing material
       Failure/Error: expect(mars.materials.find_by(name: 'Nitrogen').amount).to eq(150)

       NoMethodError:
         undefined method 'amount' for nil
       # ./spec/models/celestial_body_spec.rb:36:in 'block (3 levels) in <main>'

  237) CelestialBodies::CelestialBody#update_gravity calculates and updates the gravity based on mass and radius
       Failure/Error: mars.update_gravity

       NoMethodError:
         undefined method 'update_gravity' for an instance of CelestialBodies::CelestialBody
       # ./spec/models/celestial_body_spec.rb:68:in 'block (3 levels) in <main>'

  238) Units::CompostingUnit#operate consumes organic waste and energy, producing compost
       Failure/Error:
         CompostingUnit.new(
           name: 'Basic Composting Unit',
           material_list: { 'organic_waste' => 40, 'compost_output' => 25 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant CompostingUnit
       # ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/composting_unit_spec.rb:19:in 'block (3 levels) in <main>'

  239) Units::CompostingUnit#operate returns false if insufficient organic waste is available
       Failure/Error:
         CompostingUnit.new(
           name: 'Basic Composting Unit',
           material_list: { 'organic_waste' => 40, 'compost_output' => 25 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant CompostingUnit
       # ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/composting_unit_spec.rb:27:in 'block (3 levels) in <main>'

  240) Units::CompostingUnit#operate returns false if insufficient energy is available
       Failure/Error:
         CompostingUnit.new(
           name: 'Basic Composting Unit',
           material_list: { 'organic_waste' => 40, 'compost_output' => 25 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant CompostingUnit
       # ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/composting_unit_spec.rb:32:in 'block (3 levels) in <main>'

  241) AtmosphereConcern#add_gas updates existing gas
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: O2. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./spec/models/concerns/atmosphere_concern_spec.rb:124:in 'block (3 levels) in <main>'

  242) AtmosphereConcern#remove_gas removes gas from the atmosphere
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: O2. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:127:in 'AtmosphereConcern#remove_gas'
       # ./spec/models/concerns/atmosphere_concern_spec.rb:149:in 'block (3 levels) in <main>'

  243) AtmosphereConcern#initialize_gases creates gases based on composition
       Failure/Error: expect(atmosphere.gases.count).to eq(2)

         expected: 2
              got: 1

         (compared using ==)
       # ./spec/models/concerns/atmosphere_concern_spec.rb:471:in 'block (3 levels) in <main>'

  244) EnergyManagement solar output factor #current_solar_output_factor queries location solar output factor
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.8)
         #<Location::CelestialLocation id: 1411, name: "Location 49", coordinates: "2.49°N 91.25°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 1208, celestial_body_id: 4627, created_at: "2026-01-11 23:23:52.329346000 +0000", updated_at: "2026-01-11 23:23:52.370378000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:197:in 'block (4 levels) in <main>'

  245) EnergyManagement solar output factor #current_solar_output_factor returns 1.0 when no settlement
       Failure/Error: expect(settlement.current_solar_output_factor).to eq(1.0)

       NoMethodError:
         undefined method 'current_solar_output_factor' for #<Settlement::BaseSettlement:0x00007f7c941b3218>
       # ./spec/models/concerns/energy_management_spec.rb:203:in 'block (4 levels) in <main>'

  246) EnergyManagement solar output factor #solar_daylight? returns true when solar factor > 0.1
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)
         #<Location::CelestialLocation id: 1413, name: "Location 51", coordinates: "45.67°N 147.85°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 1210, celestial_body_id: 4629, created_at: "2026-01-11 23:23:52.726771000 +0000", updated_at: "2026-01-11 23:23:52.763930000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:209:in 'block (4 levels) in <main>'

  247) EnergyManagement solar output factor #solar_daylight? returns false when solar factor <= 0.1
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.05)
         #<Location::CelestialLocation id: 1414, name: "Location 52", coordinates: "17.70°N 171.59°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 1211, celestial_body_id: 4630, created_at: "2026-01-11 23:23:52.910140000 +0000", updated_at: "2026-01-11 23:23:52.947256000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:214:in 'block (4 levels) in <main>'

  248) EnergyManagement solar output factor power generation with solar scaling scales solar unit output by solar factor
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)
         #<Location::CelestialLocation id: 1415, name: "Location 53", coordinates: "14.85°N 130.72°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 1212, celestial_body_id: 4631, created_at: "2026-01-11 23:23:53.118406000 +0000", updated_at: "2026-01-11 23:23:53.157536000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:245:in 'block (4 levels) in <main>'

  249) EnergyManagement solar output factor power generation with solar scaling does not scale non-solar units
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)
         #<Location::CelestialLocation id: 1416, name: "Location 54", coordinates: "61.58°N 26.54°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 1213, celestial_body_id: 4632, created_at: "2026-01-11 23:23:53.343061000 +0000", updated_at: "2026-01-11 23:23:53.403685000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:251:in 'block (4 levels) in <main>'

  250) GeosphereConcern#reset returns false if base_values lack required keys
       Failure/Error: geosphere.update!(base_values: {})

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
         DETAIL:  Failing row contains (2260, 4639, {"silicon":45.0,"oxygen":45.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 1e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-11 23:23:59.962342, 2026-01-11 23:24:02.374314, 0, 0, 0, {}, null, f, 0).
       # ./spec/models/concerns/geosphere_concern_spec.rb:81:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
       #   DETAIL:  Failing row contains (2260, 4639, {"silicon":45.0,"oxygen":45.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 1e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-11 23:23:59.962342, 2026-01-11 23:24:02.374314, 0, 0, 0, {}, null, f, 0).
       #   ./spec/models/concerns/geosphere_concern_spec.rb:81:in 'block (3 levels) in <main>'

  251) GeosphereConcern#reset does not modify attributes when base_values are empty
       Failure/Error: geosphere.update!(base_values: {})

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
         DETAIL:  Failing row contains (2271, 4650, {"silicon":30.0,"oxygen":60.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 2e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-11 23:24:02.458627, 2026-01-11 23:24:04.931383, 0, 0, 0, {}, null, f, 0).
       # ./spec/models/concerns/geosphere_concern_spec.rb:111:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
       #   DETAIL:  Failing row contains (2271, 4650, {"silicon":30.0,"oxygen":60.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 2e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-11 23:24:02.458627, 2026-01-11 23:24:04.931383, 0, 0, 0, {}, null, f, 0).
       #   ./spec/models/concerns/geosphere_concern_spec.rb:111:in 'block (3 levels) in <main>'

  252) GeosphereConcern#extract_volatiles extracts volatiles based on temperature increase
       Failure/Error:
         volatile_material = materials.find_or_initialize_by(
           name: name,
           location: 'geosphere',
           layer: 'crust'
         )

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'Hash#each'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'GeosphereConcern#extract_volatiles'
       # ./spec/models/concerns/geosphere_concern_spec.rb:173:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'

  253) GeosphereConcern#extract_volatiles adds gases to atmosphere using chemical formula
       Failure/Error:
         volatile_material = materials.find_or_initialize_by(
           name: name,
           location: 'geosphere',
           layer: 'crust'
         )

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'Hash#each'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'GeosphereConcern#extract_volatiles'
       # ./spec/models/concerns/geosphere_concern_spec.rb:193:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'

  254) GeosphereConcern#add_material adds material to the specified layer
       Failure/Error:
         materials.where(location: 'geosphere', layer: layer.to_s).each do |material|
           percentage = (material.amount.to_f / layer_mass) * 100
           composition[material.name.to_s] = percentage
         end

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:466:in 'GeosphereConcern#update_layer_composition'
       # ./app/models/concerns/geosphere_concern.rb:159:in 'GeosphereConcern#add_material'
       # ./spec/models/concerns/geosphere_concern_spec.rb:213:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:466:in 'GeosphereConcern#update_layer_composition'

  255) HasUnits#installed_units_count returns the total count of all units attached to the craft
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  256) HasUnits#install_unit attaches a unit to the craft
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  257) HasUnits#install_unit adds errors if installation fails
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  258) HasUnits#install_unit prevents installing a unit that is already attached prevents installing a unit that is already attached
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  259) HasUnits#remove_unit detaches a unit from the craft
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  260) HasUnits#remove_unit returns "Unit not found" if the unit is not attached to this craft
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  261) HasUnits unit management scenarios when max units reached does not create a new unit
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  262) HasUnits unit management scenarios when max units reached returns "Max units reached"
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  263) HasUnits unit management scenarios when unit type is not compatible does not create a new unit
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  264) HasUnits unit management scenarios when unit type is not compatible returns "Unit type ... is not compatible with this craft."
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  265) HasUnits unit management scenarios when unit type is invalid or data not found does not create a new unit
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  266) HasUnits unit management scenarios when unit type is invalid or data not found returns "Invalid unit blueprint ID or data not found."
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  267) HasUnits#add_unit when unit type is valid creates a new persisted unit record
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  268) HasUnits#add_unit associates the unit with the craft polymorphically
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  269) HasUnits#add_unit applies unit effects to the craft
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  270) HasUnits#add_unit returns the created unit object
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  271) HasUnits#add_unit can add different types of units
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  272) HasUnits#add_unit can add a robot unit
       Failure/Error: c = create(:base_craft, owner: owner_org)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/has_units_spec.rb:55:in 'block (2 levels) in <main>'

  273) Housing population management calculates population capacity from habitat units
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f7c9629c268>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  274) Housing population management uses alias total_capacity for population_capacity
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f7c9629a8c8>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  275) Housing population management calculates available capacity
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f7c96298e88>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  276) Housing population management checks if it has capacity for additional population
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f7c96297628>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  277) Housing population management ignores non-habitat units when calculating capacity
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f7c96295a08>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  278) Housing population management calculates total population from base units
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f7c96293fc8>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  279) HydrosphereConcern#calculate_evaporation_rate calculates higher evaporation at higher temperatures
       Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

       AtmosphereConcern::InvalidGasError:
         Unknown chemical formula or name: H2O. Check materials database.
       # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
       # ./app/models/concerns/hydrosphere_concern.rb:75:in 'HydrosphereConcern#handle_evaporation'
       # ./app/models/concerns/hydrosphere_concern.rb:22:in 'HydrosphereConcern#water_cycle_tick'
       # ./app/models/celestial_bodies/spheres/hydrosphere.rb:233:in 'CelestialBodies::Spheres::Hydrosphere#run_simulation'
       # ./spec/models/concerns/hydrosphere_concern_spec.rb:88:in 'block (3 levels) in <main>'

  280) HydrosphereConcern#add_liquid adds H2O to the hydrosphere
       Failure/Error:
         expect {
           hydrosphere.add_liquid('H2O', 1.0e18)
         }.not_to raise_error

         expected no Exception, got #<ArgumentError: wrong number of arguments (given 0, expected 1..2)> with backtrace:
           # ./app/models/celestial_bodies/spheres/hydrosphere.rb:63:in 'CelestialBodies::Spheres::Hydrosphere#add_liquid'
           # ./spec/models/concerns/hydrosphere_concern_spec.rb:185:in 'block (4 levels) in <main>'
           # ./spec/models/concerns/hydrosphere_concern_spec.rb:184:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/hydrosphere_concern_spec.rb:184:in 'block (3 levels) in <main>'

  281) MaterialPropertiesConcern exotic state handling identifies exotic states
       Failure/Error: expect(material.exotic_state?).to be false

       NoMethodError:
         undefined method 'exotic_state?' for an instance of #<Class:0x00007f7c95476d78>(id: integer, geosphere_id: integer, name: string, layer: string, percentage: decimal, mass: decimal, state: string, melting_point: decimal, boiling_point: decimal, is_volatile: boolean, category: string, created_at: datetime, updated_at: datetime)
       # ./spec/models/concerns/material_properties_concern_spec.rb:206:in 'block (3 levels) in <main>'

  282) MaterialPropertiesConcern exotic state handling calculates phase transitions for exotic conditions
       Failure/Error: expect(hydrogen.state_at(300, 1_500_000)).to eq('metallic_hydrogen')

         expected: "metallic_hydrogen"
              got: "gas"

         (compared using ==)
       # ./spec/models/concerns/material_properties_concern_spec.rb:239:in 'block (3 levels) in <main>'

  283) Mineable#mine_gcc mines from satellites and computers
       Failure/Error: @account = double('Account', update: true) # Mocking the account

       NoMethodError:
         undefined method 'double' for an instance of TestModel
       # ./spec/models/concerns/mineable_spec.rb:11:in 'TestModel#initialize'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'Class#new'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/mineable_spec.rb:24:in 'block (3 levels) in <main>'

  284) Mineable#mine_gcc does not exceed available power
       Failure/Error: @account = double('Account', update: true) # Mocking the account

       NoMethodError:
         undefined method 'double' for an instance of TestModel
       # ./spec/models/concerns/mineable_spec.rb:11:in 'TestModel#initialize'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'Class#new'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/mineable_spec.rb:24:in 'block (3 levels) in <main>'

  285) Structures::Coverable#schedule_covering! creates a construction job
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:255:in 'block (4 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:254:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  286) Structures::Coverable#schedule_covering! returns success result
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:260:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  287) Structures::Coverable#schedule_covering! updates status to materials_requested
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:270:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  288) Structures::Coverable#schedule_covering! accepts custom panel type
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:278:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  289) Structures::Coverable#schedule_covering! stores panel_type on coverable
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:288:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  290) Structures::Coverable#schedule_covering! uses default panel type if not specified
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:295:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  291) Structures::Coverable#schedule_covering! creates material and equipment requests
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:305:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  292) Structures::Coverable#schedule_covering! updates shell composition
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:311:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  293) Structures::Coverable#schedule_covering! fails if already covered
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:320:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  294) Structures::Coverable integration scenarios lava tube opening handles medium opening
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:586:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  295) Structures::Coverable complete covering workflow goes through full lifecycle
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:602:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  296) ConsortiumMembership is invalid if member is not a corporation
       Failure/Error:
         membership = ConsortiumMembership.new(
           consortium: consortium,
           member: non_corp,
           investment_amount: 1_000_000,
           ownership_percentage: 10.0,
           voting_power: 1000
         )

       ActiveRecord::AssociationTypeMismatch:
         Organizations::BaseOrganization(#9528) expected, got #<Double "Player"> which is an instance of RSpec::Mocks::Double(#114712)
       # ./spec/models/consortium_membership_spec.rb:23:in 'block (2 levels) in <main>'

  297) ConstructionJob validations and attributes is valid with required attributes
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:14:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  298) ConstructionJob validations and attributes requires a jobable
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:23:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  299) ConstructionJob validations and attributes accepts a valid job_type
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:30:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  300) ConstructionJob validations and attributes accepts a valid status
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:46:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  301) ConstructionJob validations and attributes stores target_values as JSON
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:65:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  302) ConstructionJob associations has many material_requests
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  303) ConstructionJob associations has many equipment_requests
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  304) ConstructionJob associations belongs to a jobable
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  305) ConstructionJob associations belongs to a settlement
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  306) ConstructionJob enum functionality correctly stores and retrieves job_type as an enum
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:133:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  307) ConstructionJob enum functionality correctly stores and retrieves status as an enum
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:133:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  308) ConstructionJob convenience methods #materials_gathered? returns true when all material requests are fulfilled
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  309) ConstructionJob convenience methods #materials_gathered? returns false when some material requests are pending
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  310) ConstructionJob convenience methods #equipment_gathered? returns true when no equipment requests exist
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  311) ConstructionJob convenience methods #equipment_gathered? returns true when all equipment requests are fulfilled
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  312) ConstructionJob convenience methods #equipment_gathered? returns false when some equipment requests are pending
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  313) ConstructionJob convenience methods #infer_settlement returns the jobable's settlement if available
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  314) ConstructionJob convenience methods #infer_settlement returns the jobable if it is a Settlement
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  315) ConstructionJob convenience methods #infer_settlement finds a settlement by location if available
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  316) Craft::BaseCraft associations 
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  317) Craft::BaseCraft associations 
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  318) Craft::BaseCraft associations 
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  319) Craft::BaseCraft associations 
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  320) Craft::BaseCraft location handling can access location through helper method
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  321) Craft::BaseCraft location handling can switch between spatial and celestial locations
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  322) Craft::BaseCraft initialization assembles a new craft from inventory and applies the correct variant
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  323) Craft::BaseCraft loading craft info loads the correct craft data from the lookup service
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  324) Craft::BaseCraft player construction starts with no units
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  325) Craft::BaseCraft player construction allows installing units
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  326) Craft::BaseCraft player construction allows uninstalling units
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  327) Craft::BaseCraft variant configuration loads a variant configuration
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  328) Craft::BaseCraft variant configuration changes between variants
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  329) Craft::BaseCraft variant configuration provides a list of available variants
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  330) Craft::BaseCraft variant configuration handles missing variants gracefully
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  331) Craft::BaseCraft atmosphere creation creates an atmosphere after creation
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  332) Craft::BaseCraft unit integration integrates with settlement units
       Failure/Error: @craft_instance = FactoryBot.create(:base_craft, owner: @alpha_base_settlement_instance.owner)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:40:in 'block (2 levels) in <main>'

  333) Craft::Harvester validations is valid with a positive extraction_rate
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  334) Craft::Harvester validations is invalid with a negative extraction_rate
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  335) Craft::Harvester#extract_resources when extracting from a valid target increases inventory with extracted resources
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  336) Craft::Harvester#extract_resources when extracting from an invalid target raises an error
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  337) Craft::Harvester#extract_resources when storage is full raises an error
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  338) Craft::Harvester#process_resources converts raw material into refined material
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  339) Craft::Harvester#process_resources does nothing if no processable materials are present
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  340) Craft::VariantManager#initialize loads base data and variants
       Failure/Error: expect(variant_manager.instance_variable_get(:@base_data)).to be_present
         expected `{}.present?` to be truthy, got false
       # ./spec/models/craft/variant_manager_spec.rb:67:in 'block (3 levels) in <main>'

  341) Craft::VariantManager#get_variant merges base data with standard variant data
       Failure/Error: expect(merged_data['id']).to eq('heavy_lift_transport')

         expected: "heavy_lift_transport"
              got: "heavy_lift_transport_standard"

         (compared using ==)
       # ./spec/models/craft/variant_manager_spec.rb:105:in 'block (3 levels) in <main>'

  342) Craft::VariantManager#get_variant merges base data with lunar variant data
       Failure/Error: expect(merged_data['systems']['life_support']['capacity']).to eq('enhanced')

       NoMethodError:
         undefined method '[]' for nil
       # ./spec/models/craft/variant_manager_spec.rb:121:in 'block (3 levels) in <main>'

  343) Craft::VariantManager#get_variant properly merges nested hashes
       Failure/Error: expect(merged_data['resource_management']['consumables']['fuel']['current']).to eq(0)

         expected: 0
              got: nil

         (compared using ==)
       # ./spec/models/craft/variant_manager_spec.rb:148:in 'block (3 levels) in <main>'

  344) Settlement::Dome calculates used capacity (current occupancy) correctly
       Failure/Error: dome = Dome.create(name: "Research Dome", capacity: 100, current_occupancy: 50)

       NameError:
         uninitialized constant Dome
       # ./spec/models/dome_spec.rb:6:in 'block (2 levels) in <main>'

  345) Settlement::Dome calculates remaining capacity correctly
       Failure/Error: dome = Dome.create(name: "Living Dome", capacity: 200, current_occupancy: 50)

       NameError:
         uninitialized constant Dome
       # ./spec/models/dome_spec.rb:11:in 'block (2 levels) in <main>'

  346) Settlement::Dome ensures current occupancy does not exceed total capacity
       Failure/Error: dome = Dome.new(name: "Living Dome", capacity: 100, current_occupancy: 150)

       NameError:
         uninitialized constant Dome
       # ./spec/models/dome_spec.rb:16:in 'block (2 levels) in <main>'

  347) CelestialBodies::DwarfPlanet#calculate_surface_conditions calculates surface conditions specific to dwarf planets
       Failure/Error:
         DwarfPlanet.create!(
           name: "Pluto",
           size: 0.18,
           gravity: 0.62,
           density: 1.86,
           orbital_period: 90560,
           mass: 1.303e22, # Example mass in kg
           radius: 1.19e6, # Example radius in meters
           gas_quantities: { "Nitrogen" => 8000, "Methane" => 1000 },
           temperature: 44.0 # Example temperature

       NameError:
         uninitialized constant DwarfPlanet
       # ./spec/models/dwarf_planet_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/dwarf_planet_spec.rb:20:in 'block (3 levels) in <main>'

  348) CelestialBodies::DwarfPlanet#update_biomes updates biomes specific to dwarf planets
       Failure/Error:
         DwarfPlanet.create!(
           name: "Pluto",
           size: 0.18,
           gravity: 0.62,
           density: 1.86,
           orbital_period: 90560,
           mass: 1.303e22, # Example mass in kg
           radius: 1.19e6, # Example radius in meters
           gas_quantities: { "Nitrogen" => 8000, "Methane" => 1000 },
           temperature: 44.0 # Example temperature

       NameError:
         uninitialized constant DwarfPlanet
       # ./spec/models/dwarf_planet_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/dwarf_planet_spec.rb:27:in 'block (3 levels) in <main>'

  349) Environment validations is valid with valid attributes
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:12:in 'block (3 levels) in <main>'

  350) Environment validations is not valid without a biome
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:16:in 'block (3 levels) in <main>'

  351) Environment validations is not valid without a planet
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:21:in 'block (3 levels) in <main>'

  352) Environment validations is not valid without a temperature
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:26:in 'block (3 levels) in <main>'

  353) Environment validations is not valid without a pressure
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:31:in 'block (3 levels) in <main>'

  354) Environment validations is not valid without a humidity
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:36:in 'block (3 levels) in <main>'

  355) Environment associations belongs to a biome
       Failure/Error: should belong_to(:biome)
         Expected Environment to have a belongs_to association called biome (no association called biome)
       # ./spec/models/environment_spec.rb:43:in 'block (3 levels) in <main>'

  356) Environment associations belongs to a celestial_body
       Failure/Error: should belong_to(:celestial_body)
         Expected Environment to have a belongs_to association called celestial_body (no association called celestial_body)
       # ./spec/models/environment_spec.rb:47:in 'block (3 levels) in <main>'

  357) EquipmentRequest validations is valid with required attributes
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (653, Test Dome, Crater Dome, null, 1509, Player, 3318, null, Location::CelestialLocation, 1765, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:47.19786, 2026-01-11 23:28:47.19786, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:15:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (653, Test Dome, Crater Dome, null, 1509, Player, 3318, null, Location::CelestialLocation, 1765, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:47.19786, 2026-01-11 23:28:47.19786, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  358) EquipmentRequest validations requires an equipment_type
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (655, Test Dome, Crater Dome, null, 1511, Player, 3321, null, Location::CelestialLocation, 1767, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:47.491768, 2026-01-11 23:28:47.491768, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (655, Test Dome, Crater Dome, null, 1511, Player, 3321, null, Location::CelestialLocation, 1767, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:47.491768, 2026-01-11 23:28:47.491768, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  359) EquipmentRequest validations requires quantity_requested to be present
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (656, Test Dome, Crater Dome, null, 1512, Player, 3325, null, Location::CelestialLocation, 1770, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:47.779927, 2026-01-11 23:28:47.779927, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:33:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (656, Test Dome, Crater Dome, null, 1512, Player, 3325, null, Location::CelestialLocation, 1770, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:47.779927, 2026-01-11 23:28:47.779927, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  360) EquipmentRequest validations requires quantity_requested to be greater than 0
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (658, Test Dome, Crater Dome, null, 1514, Player, 3330, null, Location::CelestialLocation, 1773, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:48.082543, 2026-01-11 23:28:48.082543, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (658, Test Dome, Crater Dome, null, 1514, Player, 3330, null, Location::CelestialLocation, 1773, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:48.082543, 2026-01-11 23:28:48.082543, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  361) EquipmentRequest validations requires quantity_requested to be a number
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (660, Test Dome, Crater Dome, null, 1516, Player, 3333, null, Location::CelestialLocation, 1775, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:48.374638, 2026-01-11 23:28:48.374638, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:52:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (660, Test Dome, Crater Dome, null, 1516, Player, 3333, null, Location::CelestialLocation, 1775, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:48.374638, 2026-01-11 23:28:48.374638, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  362) EquipmentRequest validations allows negative quantity_requested to be invalid
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (661, Test Dome, Crater Dome, null, 1517, Player, 3338, null, Location::CelestialLocation, 1778, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:48.713323, 2026-01-11 23:28:48.713323, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (661, Test Dome, Crater Dome, null, 1517, Player, 3338, null, Location::CelestialLocation, 1778, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:48.713323, 2026-01-11 23:28:48.713323, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  363) EquipmentRequest associations belongs to a requestable (polymorphic)
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (663, Test Dome, Crater Dome, null, 1519, Player, 3342, null, Location::CelestialLocation, 1781, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:49.039384, 2026-01-11 23:28:49.039384, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:72:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:75:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (663, Test Dome, Crater Dome, null, 1519, Player, 3342, null, Location::CelestialLocation, 1781, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:49.039384, 2026-01-11 23:28:49.039384, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  364) EquipmentRequest associations can be associated with different requestable types
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (665, Test Dome, Crater Dome, null, 1521, Player, 3345, null, Location::CelestialLocation, 1783, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:49.326767, 2026-01-11 23:28:49.326767, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:80:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (665, Test Dome, Crater Dome, null, 1521, Player, 3345, null, Location::CelestialLocation, 1783, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:49.326767, 2026-01-11 23:28:49.326767, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  365) EquipmentRequest enums status enum defaults to pending status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (667, Test Dome, Crater Dome, null, 1523, Player, 3350, null, Location::CelestialLocation, 1786, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:49.733803, 2026-01-11 23:28:49.733803, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:102:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (667, Test Dome, Crater Dome, null, 1523, Player, 3350, null, Location::CelestialLocation, 1786, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:49.733803, 2026-01-11 23:28:49.733803, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  366) EquipmentRequest enums status enum can be set to different statuses
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (669, Test Dome, Crater Dome, null, 1525, Player, 3355, null, Location::CelestialLocation, 1789, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:50.269148, 2026-01-11 23:28:50.269148, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:106:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (669, Test Dome, Crater Dome, null, 1525, Player, 3355, null, Location::CelestialLocation, 1789, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:50.269148, 2026-01-11 23:28:50.269148, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  367) EquipmentRequest enums status enum accepts string values for status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (671, Test Dome, Crater Dome, null, 1527, Player, 3360, null, Location::CelestialLocation, 1792, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:50.692273, 2026-01-11 23:28:50.692273, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:112:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (671, Test Dome, Crater Dome, null, 1527, Player, 3360, null, Location::CelestialLocation, 1792, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:50.692273, 2026-01-11 23:28:50.692273, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  368) EquipmentRequest enums status enum provides query methods for each status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (673, Test Dome, Crater Dome, null, 1529, Player, 3365, null, Location::CelestialLocation, 1795, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.010313, 2026-01-11 23:28:51.010313, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:117:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (673, Test Dome, Crater Dome, null, 1529, Player, 3365, null, Location::CelestialLocation, 1795, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.010313, 2026-01-11 23:28:51.010313, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  369) EquipmentRequest enums priority enum defaults to normal priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (674, Test Dome, Crater Dome, null, 1530, Player, 3369, null, Location::CelestialLocation, 1798, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.310821, 2026-01-11 23:28:51.310821, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:137:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (674, Test Dome, Crater Dome, null, 1530, Player, 3369, null, Location::CelestialLocation, 1798, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.310821, 2026-01-11 23:28:51.310821, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  370) EquipmentRequest enums priority enum can be set to different priorities
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (676, Test Dome, Crater Dome, null, 1532, Player, 3373, null, Location::CelestialLocation, 1801, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.631473, 2026-01-11 23:28:51.631473, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:141:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (676, Test Dome, Crater Dome, null, 1532, Player, 3373, null, Location::CelestialLocation, 1801, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.631473, 2026-01-11 23:28:51.631473, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  371) EquipmentRequest enums priority enum accepts string values for priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (677, Test Dome, Crater Dome, null, 1533, Player, 3378, null, Location::CelestialLocation, 1804, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.944448, 2026-01-11 23:28:51.944448, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:147:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (677, Test Dome, Crater Dome, null, 1533, Player, 3378, null, Location::CelestialLocation, 1804, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:51.944448, 2026-01-11 23:28:51.944448, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  372) EquipmentRequest enums priority enum provides query methods for each priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (679, Test Dome, Crater Dome, null, 1535, Player, 3381, null, Location::CelestialLocation, 1807, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:52.225235, 2026-01-11 23:28:52.225235, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:152:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (679, Test Dome, Crater Dome, null, 1535, Player, 3381, null, Location::CelestialLocation, 1807, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:52.225235, 2026-01-11 23:28:52.225235, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  373) EquipmentRequest scopes .pending_requests returns pending and partially fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (680, Test Dome, Crater Dome, null, 1537, Player, 3385, null, Location::CelestialLocation, 1810, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:52.551576, 2026-01-11 23:28:52.551576, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (680, Test Dome, Crater Dome, null, 1537, Player, 3385, null, Location::CelestialLocation, 1810, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:52.551576, 2026-01-11 23:28:52.551576, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  374) EquipmentRequest scopes .fulfilled returns only fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (682, Test Dome, Crater Dome, null, 1538, Player, 3388, null, Location::CelestialLocation, 1813, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:52.923574, 2026-01-11 23:28:52.923574, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (682, Test Dome, Crater Dome, null, 1538, Player, 3388, null, Location::CelestialLocation, 1813, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:52.923574, 2026-01-11 23:28:52.923574, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  375) EquipmentRequest scopes .for_equipment returns requests for a specific equipment type
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (684, Test Dome, Crater Dome, null, 1540, Player, 3392, null, Location::CelestialLocation, 1816, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:53.254421, 2026-01-11 23:28:53.254421, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (684, Test Dome, Crater Dome, null, 1540, Player, 3392, null, Location::CelestialLocation, 1816, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:53.254421, 2026-01-11 23:28:53.254421, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  376) EquipmentRequest scopes .for_equipment returns empty when no equipment of that type is requested
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (686, Test Dome, Crater Dome, null, 1542, Player, 3395, null, Location::CelestialLocation, 1818, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:53.590364, 2026-01-11 23:28:53.590364, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (686, Test Dome, Crater Dome, null, 1542, Player, 3395, null, Location::CelestialLocation, 1818, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:53.590364, 2026-01-11 23:28:53.590364, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  377) EquipmentRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (688, Test Dome, Crater Dome, null, 1544, Player, 3399, null, Location::CelestialLocation, 1821, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:53.905233, 2026-01-11 23:28:53.905233, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:204:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (688, Test Dome, Crater Dome, null, 1544, Player, 3399, null, Location::CelestialLocation, 1821, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:53.905233, 2026-01-11 23:28:53.905233, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  378) EquipmentRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (689, Test Dome, Crater Dome, null, 1545, Player, 3402, null, Location::CelestialLocation, 1824, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:54.204769, 2026-01-11 23:28:54.204769, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:213:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (689, Test Dome, Crater Dome, null, 1545, Player, 3402, null, Location::CelestialLocation, 1824, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:54.204769, 2026-01-11 23:28:54.204769, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  379) EquipmentRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (691, Test Dome, Crater Dome, null, 1547, Player, 3405, null, Location::CelestialLocation, 1826, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:54.49091, 2026-01-11 23:28:54.49091, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:222:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (691, Test Dome, Crater Dome, null, 1547, Player, 3405, null, Location::CelestialLocation, 1826, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:54.49091, 2026-01-11 23:28:54.49091, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  380) EquipmentRequest instance methods #quantity_still_needed handles quantity_fulfilled being 0
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (693, Test Dome, Crater Dome, null, 1549, Player, 3409, null, Location::CelestialLocation, 1829, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:54.865046, 2026-01-11 23:28:54.865046, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:231:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (693, Test Dome, Crater Dome, null, 1549, Player, 3409, null, Location::CelestialLocation, 1829, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:54.865046, 2026-01-11 23:28:54.865046, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  381) EquipmentRequest factory creates a valid equipment request with factory
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (694, Test Dome, Crater Dome, null, 1551, Player, 3413, null, Location::CelestialLocation, 1832, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:55.190265, 2026-01-11 23:28:55.190265, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:242:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (694, Test Dome, Crater Dome, null, 1551, Player, 3413, null, Location::CelestialLocation, 1832, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:55.190265, 2026-01-11 23:28:55.190265, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  382) EquipmentRequest factory creates equipment request with specific attributes
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (696, Test Dome, Crater Dome, null, 1552, Player, 3416, null, Location::CelestialLocation, 1835, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:55.50155, 2026-01-11 23:28:55.50155, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:249:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (696, Test Dome, Crater Dome, null, 1552, Player, 3416, null, Location::CelestialLocation, 1835, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:55.50155, 2026-01-11 23:28:55.50155, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  383) EquipmentRequest edge cases and data integrity handles very large quantity requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (698, Test Dome, Crater Dome, null, 1554, Player, 3419, null, Location::CelestialLocation, 1837, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:55.815112, 2026-01-11 23:28:55.815112, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:263:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (698, Test Dome, Crater Dome, null, 1554, Player, 3419, null, Location::CelestialLocation, 1837, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:55.815112, 2026-01-11 23:28:55.815112, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  384) EquipmentRequest edge cases and data integrity maintains data integrity when updating status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (700, Test Dome, Crater Dome, null, 1556, Player, 3423, null, Location::CelestialLocation, 1840, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:56.140692, 2026-01-11 23:28:56.140692, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:271:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (700, Test Dome, Crater Dome, null, 1556, Player, 3423, null, Location::CelestialLocation, 1840, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:56.140692, 2026-01-11 23:28:56.140692, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  385) EquipmentRequest edge cases and data integrity handles equipment_type with special characters
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (701, Test Dome, Crater Dome, null, 1557, Player, 3426, null, Location::CelestialLocation, 1843, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:56.437564, 2026-01-11 23:28:56.437564, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:283:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (701, Test Dome, Crater Dome, null, 1557, Player, 3426, null, Location::CelestialLocation, 1843, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:28:56.437564, 2026-01-11 23:28:56.437564, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  386) Financial::Account Development Corporation (DC) Trade allows DC-to-DC trade on the virtual ledger via operational_data flags
       Failure/Error:
         expect { 
           builder_acc.transfer_funds(5000, supplier_acc, "Modular Habitation Units") 
         }.not_to raise_error

         expected no Exception, got #<RuntimeError: Insufficient funds> with backtrace:
           # ./app/models/financial/account.rb:31:in 'Financial::Account#transfer_funds'
           # ./spec/models/financial/account_spec.rb:170:in 'block (4 levels) in <main>'
           # ./spec/models/financial/account_spec.rb:169:in 'block (3 levels) in <main>'
       # ./spec/models/financial/account_spec.rb:169:in 'block (3 levels) in <main>'

  387) Financial::Transaction currency precision supports high precision for GCC (8 decimal places)
       Failure/Error: expect(transaction.reload.amount).to eq(gcc_amount)

         expected: 0.12345678
              got: 0.12e0

         (compared using ==)
       # ./spec/models/financial/transaction_spec.rb:89:in 'block (3 levels) in <main>'

  388) Game#assign_task adds a new task to the task list with correct completion time
       Failure/Error:
         @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|
           c.name = 'Galactic Crypto Currency'
           c.is_system_currency = true
           c.precision = 8
         end

       NameError:
         uninitialized constant Currency
       # ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'

  389) Game#advance_time advances game time and completes a task
       Failure/Error:
         @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|
           c.name = 'Galactic Crypto Currency'
           c.is_system_currency = true
           c.precision = 8
         end

       NameError:
         uninitialized constant Currency
       # ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'

  390) Game#advance_time with no tasks prints a message when there are no tasks
       Failure/Error:
         @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|
           c.name = 'Galactic Crypto Currency'
           c.is_system_currency = true
           c.precision = 8
         end

       NameError:
         uninitialized constant Currency
       # ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'

  391) CelestialBodies::GasGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
       Failure/Error:
         GasGiant.create!(
           name: "Jupiter",
           size: 11.2,
           gravity: 24.79,
           density: 1.33,
           orbital_period: 4331,
           mass: 1.898e27, # Example mass in kg
           radius: 6.99e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 8580000, "Helium" => 1520000 },
           temperature: 165.0 # Example temperature

       NameError:
         uninitialized constant GasGiant
       # ./spec/models/gas_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/gas_giant_spec.rb:20:in 'block (3 levels) in <main>'

  392) CelestialBodies::GasGiant#calculate_gravity calculates gravity based on mass and radius
       Failure/Error:
         GasGiant.create!(
           name: "Jupiter",
           size: 11.2,
           gravity: 24.79,
           density: 1.33,
           orbital_period: 4331,
           mass: 1.898e27, # Example mass in kg
           radius: 6.99e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 8580000, "Helium" => 1520000 },
           temperature: 165.0 # Example temperature

       NameError:
         uninitialized constant GasGiant
       # ./spec/models/gas_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/gas_giant_spec.rb:27:in 'block (3 levels) in <main>'

  393) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :liquid_volume looks like a number
       Failure/Error: it { should validate_numericality_of(:liquid_volume) }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :liquid_volume on the
         CelestialBodies::Spheres::Hydrosphere to "abcd", but that attribute does
         not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'
       # ./spec/models/hydrosphere_spec.rb:13:in 'block (3 levels) in <main>'

  394) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :lakes looks like a number
       Failure/Error: it { should validate_numericality_of(:lakes) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :lakes
         looks like a number, but this could not be proved.
           After setting :lakes to ‹"abcd"›, the matcher expected the
           CelestialBodies::Spheres::Hydrosphere to be invalid, but it was valid
           instead.
       # ./spec/models/hydrosphere_spec.rb:14:in 'block (3 levels) in <main>'

  395) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :rivers looks like a number
       Failure/Error: it { should validate_numericality_of(:rivers) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :rivers
         looks like a number, but this could not be proved.
           After setting :rivers to ‹"abcd"›, the matcher expected the
           CelestialBodies::Spheres::Hydrosphere to be invalid, but it was valid
           instead.
       # ./spec/models/hydrosphere_spec.rb:15:in 'block (3 levels) in <main>'

  396) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :oceans looks like a number
       Failure/Error: it { should validate_numericality_of(:oceans) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :oceans
         looks like a number, but this could not be proved.
           After setting :oceans to ‹"abcd"›, the matcher expected the
           CelestialBodies::Spheres::Hydrosphere to be invalid, but it was valid
           instead.
       # ./spec/models/hydrosphere_spec.rb:16:in 'block (3 levels) in <main>'

  397) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :ice looks like a number
       Failure/Error: it { should validate_numericality_of(:ice) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :ice
         looks like a number, but this could not be proved.
           After setting :ice to ‹"abcd"› -- which was read back as ‹0.0› -- the
           matcher expected the CelestialBodies::Spheres::Hydrosphere to be
           invalid, but it was valid instead.

           As indicated in the message above, :ice seems to be changing certain
           values as they are set, and this could have something to do with why
           this test is failing. If you've overridden the writer method for this
           attribute, then you may need to change it to make this test pass, or
           do something else entirely.
       # ./spec/models/hydrosphere_spec.rb:17:in 'block (3 levels) in <main>'

  398) CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calls update_liquid_materials_from_celestial_body
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:22:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  399) CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calculates the liquid volume after setup
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:22:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  400) CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds liquid materials to the hydrosphere
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  401) CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds ice to the hydrosphere
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  402) CelestialBodies::Spheres::Hydrosphere#add_liquid distributes liquid between oceans, lakes, and rivers
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:58:in 'block (4 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:58:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  403) CelestialBodies::Spheres::Hydrosphere#calculate_liquid_volume calculates the total liquid volume correctly
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:66:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  404) CelestialBodies::Spheres::Hydrosphere#update_water_cycle melts ice when temperature is above freezing
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:79:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  405) CelestialBodies::Spheres::Hydrosphere#update_water_cycle does not melt ice when temperature is below freezing
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:79:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  406) CelestialBodies::Spheres::Hydrosphere#evaporate_liquids evaporates liquids when conditions are met
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:99:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  407) CelestialBodies::IceGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
       Failure/Error:
         IceGiant.create!(
           name: "Uranus",
           size: 4.0,
           gravity: 8.69,
           density: 1.27,
           orbital_period: 30660,
           mass: 8.681e25, # Example mass in kg
           radius: 2.54e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 830000, "Helium" => 140000 },
           temperature: 76.0 # Example temperature

       NameError:
         uninitialized constant IceGiant
       # ./spec/models/ice_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/ice_giant_spec.rb:20:in 'block (3 levels) in <main>'

  408) CelestialBodies::IceGiant#calculate_gravity calculates gravity based on mass and radius
       Failure/Error:
         IceGiant.create!(
           name: "Uranus",
           size: 4.0,
           gravity: 8.69,
           density: 1.27,
           orbital_period: 30660,
           mass: 8.681e25, # Example mass in kg
           radius: 2.54e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 830000, "Helium" => 140000 },
           temperature: 76.0 # Example temperature

       NameError:
         uninitialized constant IceGiant
       # ./spec/models/ice_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/ice_giant_spec.rb:27:in 'block (3 levels) in <main>'

  409) Item lookup service integration loads properties from item lookup service with category
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:11:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:129:in 'block (3 levels) in <main>'

  410) Item lookup service integration loads material properties for raw materials
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:26:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:154:in 'block (3 levels) in <main>'

  411) Item#container operations identifies containers correctly
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:18:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:173:in 'block (3 levels) in <main>'

  412) Item#container operations adds items to containers
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:18:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:180:in 'block (4 levels) in <main>'
       # ./spec/models/item_spec.rb:178:in 'block (3 levels) in <main>'

  413) Item#container operations removes items from containers
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:18:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:184:in 'block (3 levels) in <main>'

  414) Item#container operations enforces weight capacity limits
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:201:in 'block (3 levels) in <main>'

  415) Item#total_weight calculates base weight from properties
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:11:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:218:in 'block (3 levels) in <main>'

  416) Item#total_weight includes contained items in total weight
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:18:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:233:in 'block (3 levels) in <main>'

  417) Item#tradeable? returns true for normal items with positive amount
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:11:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:255:in 'block (3 levels) in <main>'

  418) Item#tradeable? returns false for items with zero amount
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:11:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:259:in 'block (3 levels) in <main>'

  419) Item#tradeable? returns false for containers with items
       Failure/Error: expect { container.add_item(small_item) }.to_not raise_error

         expected no Exception, got #<NoMethodError: undefined method 'location=' for an instance of Craft::BaseCraft> with backtrace:
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
           # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
           # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
           # ./spec/models/item_spec.rb:18:in 'block (2 levels) in <main>'
           # ./spec/models/item_spec.rb:265:in 'block (4 levels) in <main>'
           # ./spec/models/item_spec.rb:265:in 'block (3 levels) in <main>'
       # ./spec/models/item_spec.rb:265:in 'block (3 levels) in <main>'

  420) Item#tradeable? returns true for empty containers
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:18:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:273:in 'block (3 levels) in <main>'

  421) Item regolith handling gets composition from celestial body geosphere
       Failure/Error: expect(luna.identifier).to eq('LUNA-01')

         expected: "LUNA-01"
              got: "LUNA-38"

         (compared using ==)
       # ./spec/models/item_spec.rb:300:in 'block (3 levels) in <main>'

  422) Item regolith handling includes source body in properties
       Failure/Error: let(:base_craft) { create(:base_craft) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/item_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/item_spec.rb:289:in 'block (3 levels) in <main>'
       # ./spec/models/item_spec.rb:316:in 'block (3 levels) in <main>'

  423) CelestialBodies::Materials::Liquid associations 
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:9:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  424) CelestialBodies::Materials::Liquid validations is valid with valid attributes
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:14:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  425) CelestialBodies::Materials::Liquid validations is not valid without a name
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:18:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  426) CelestialBodies::Materials::Liquid validations is not valid without an amount
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  427) CelestialBodies::Materials::Liquid validations is not valid with a negative amount
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:30:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  428) Location::CelestialLocation validations is expected to validate that :name cannot be empty/falsy
       Failure/Error: it { is_expected.to validate_presence_of(:name) }

         Expected Location::CelestialLocation to validate that :name cannot be
         empty/falsy, but this could not be proved.
           After setting :name to ‹""›, the matcher expected the
           Location::CelestialLocation to be invalid, but it was valid instead.
       # ./spec/models/location/celestial_location_spec.rb:15:in 'block (3 levels) in <main>'

  429) Location::CelestialLocation orbital mechanics #orbital_period returns nil for surface locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Surface Location',
           coordinates: '40.71°N 74.01°W',
           altitude: 0
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:316:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:327:in 'block (4 levels) in <main>'

  430) Location::CelestialLocation orbital mechanics #orbital_period calculates period for orbital locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Orbital Location',
           coordinates: '0.00°N 0.00°E',
           altitude: 408_000
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:306:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:332:in 'block (4 levels) in <main>'

  431) Location::CelestialLocation orbital mechanics #orbital_velocity returns nil for surface locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Surface Location',
           coordinates: '40.71°N 74.01°W',
           altitude: 0
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:316:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:350:in 'block (4 levels) in <main>'

  432) Location::CelestialLocation orbital mechanics #orbital_velocity calculates velocity for orbital locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Orbital Location',
           coordinates: '0.00°N 0.00°E',
           altitude: 408_000
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:306:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:355:in 'block (4 levels) in <main>'

  433) Location::CelestialLocation orbital mechanics #gravity returns surface gravity for surface locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Surface Location',
           coordinates: '40.71°N 74.01°W',
           altitude: 0
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:316:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:373:in 'block (4 levels) in <main>'

  434) Location::CelestialLocation orbital mechanics #gravity calculates reduced gravity at altitude
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Orbital Location',
           coordinates: '0.00°N 0.00°E',
           altitude: 408_000
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:306:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:377:in 'block (4 levels) in <main>'

  435) Location::CelestialLocation#description describes surface locations
       Failure/Error:
         location = Location::CelestialLocation.new(
           name: 'Surface Location',
           celestial_body: body,
           coordinates: '28.50°N 80.60°W',
           altitude: 0
         )

       ActiveRecord::AssociationTypeMismatch:
         CelestialBodies::CelestialBody(#8880) expected, got #<Double "Body"> which is an instance of RSpec::Mocks::Double(#114712)
       # ./spec/models/location/celestial_location_spec.rb:401:in 'block (3 levels) in <main>'

  436) Location::CelestialLocation#description describes orbital locations
       Failure/Error:
         location = Location::CelestialLocation.new(
           name: 'Orbital Location',
           celestial_body: body,
           coordinates: '0.00°N 0.00°E',
           altitude: 400_000
         )

       ActiveRecord::AssociationTypeMismatch:
         CelestialBodies::CelestialBody(#8880) expected, got #<Double "Body"> which is an instance of RSpec::Mocks::Double(#114712)
       # ./spec/models/location/celestial_location_spec.rb:415:in 'block (3 levels) in <main>'

  437) Location::SpatialLocation#update_location updates coordinates
       Failure/Error: expect(spatial_location.update_location(new_coords)).to be true

       NoMethodError:
         undefined method 'update_location' for an instance of Location::SpatialLocation
       # ./spec/models/location/spatial_location_spec.rb:76:in 'block (3 levels) in <main>'

  438) Market::Condition#current_price returns the latest price from price_histories
       Failure/Error: let(:marketplace) { create(:marketplace) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/condition_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/market/condition_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/market/condition_spec.rb:16:in 'block (3 levels) in <main>'

  439) Market::Condition#current_price returns default price if no price_histories exist
       Failure/Error: let(:marketplace) { create(:marketplace) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/condition_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/market/condition_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/market/condition_spec.rb:22:in 'block (3 levels) in <main>'

  440) Market::Marketplace associations is expected to belong to settlement class_name => Settlement::BaseSettlement required: true
       Failure/Error: it { should belong_to(:settlement).class_name('Settlement::BaseSettlement') }
         Expected Market::Marketplace to have a belongs_to association called settlement (Market::Marketplace does not have a settlement_id foreign key.)
       # ./spec/models/market/marketplace_spec.rb:16:in 'block (3 levels) in <main>'

  441) Market::Marketplace#current_market_condition returns the market condition for a given resource
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:28:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:32:in 'block (3 levels) in <main>'

  442) Market::Marketplace#current_market_condition returns nil for a resource that does not exist
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:28:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:32:in 'block (3 levels) in <main>'

  443) Market::Marketplace#find_matching_orders when order is a Sell order calls the settlement NPC methods
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:51:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:83:in 'block (4 levels) in <main>'

  444) Market::Marketplace#find_matching_orders when order is not a Sell order returns an empty array
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:51:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:101:in 'block (4 levels) in <main>'

  445) Market::Marketplace#place_order creates an order
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  446) Market::Marketplace#place_order converts volume parameter to quantity
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  447) Market::Marketplace#place_order sets the base_settlement_id
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  448) Market::Marketplace#place_order removes unused parameters
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  449) Market::Marketplace#place_order when order is fully filled returns nil
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  450) Market::Marketplace#place_order when order is fully filled sets order quantity to zero
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  451) Market::Marketplace#place_order when order is partially filled returns the order
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  452) Market::Marketplace#place_order when no matching orders exist returns the unfilled order
       Failure/Error: let(:marketplace) { described_class.create!(settlement: settlement) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # ./spec/models/market/marketplace_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:113:in 'block (3 levels) in <main>'

  453) Market::Marketplace#execute_trades delegates the entire trade execution to Market::TradeExecutionService
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       Zeitwerk::NameError:
         expected file /home/galaxy_game/app/models/organizations/corporation.rb to define constant Organizations::Corporation, but didn't
       # /usr/local/bundle/gems/zeitwerk-2.7.1/lib/zeitwerk/loader/callbacks.rb:33:in 'Zeitwerk::Loader::Callbacks#on_file_autoloaded'
       # /usr/local/bundle/gems/zeitwerk-2.7.1/lib/zeitwerk/core_ext/kernel.rb:27:in 'Kernel#require'
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  454) Market::Marketplace#execute_trades updates the order quantity to zero when fully filled
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  455) Market::Marketplace#execute_trades wraps the execution in a transaction
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  456) Market::Marketplace#execute_trades when partially filled updates the order quantity to remaining amount
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  457) Market::Order is valid with valid attributes
       Failure/Error: let(:market_condition) { create(:market_condition) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:23:in 'block (2 levels) in <main>'

  458) Market::Order requires a market_condition
       Failure/Error: let(:settlement) { create(:base_settlement, :independent, name: "Test Settlement", settlement_type: :base, current_population: 1, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:34:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  459) Market::Order requires an orderable
       Failure/Error: let(:market_condition) { create(:market_condition) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:40:in 'block (2 levels) in <main>'

  460) Market::Order belongs to market_condition
       Failure/Error: let(:market_condition) { create(:market_condition) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:47:in 'block (2 levels) in <main>'

  461) Market::Order supports polymorphic orderable association
       Failure/Error: let(:market_condition) { create(:market_condition) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:59:in 'block (2 levels) in <main>'

  462) Market::Order is invalid without quantity
       Failure/Error: let(:market_condition) { create(:market_condition) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:71:in 'block (2 levels) in <main>'

  463) Market::Order is invalid without order_type
       Failure/Error: let(:market_condition) { create(:market_condition) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:83:in 'block (2 levels) in <main>'

  464) Market::Order can be associated with a base_settlement_id
       Failure/Error: let(:market_condition) { create(:market_condition) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/order_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/market/order_spec.rb:95:in 'block (2 levels) in <main>'

  465) Market::PriceHistory validations is valid with valid attributes
       Failure/Error: let(:marketplace) { create(:marketplace) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/price_history_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/market/price_history_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/market/price_history_spec.rb:14:in 'block (3 levels) in <main>'

  466) Market::PriceHistory validations is not valid without a price
       Failure/Error: let(:marketplace) { create(:marketplace) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/price_history_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/market/price_history_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/market/price_history_spec.rb:22:in 'block (3 levels) in <main>'

  467) Market::SupplyChain is valid with valid attributes
       Failure/Error: let(:marketplace) { create(:marketplace) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/supply_chain_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:11:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:24:in 'block (2 levels) in <main>'

  468) Market::SupplyChain requires a market_order
       Failure/Error: supply_chain = Market::SupplyChain.new(resource_name: 'LOX', volume: 100.0, status: 'pending')

       ActiveModel::UnknownAttributeError:
         unknown attribute 'resource_name' for Market::SupplyChain.
       # ./spec/models/market/supply_chain_spec.rb:33:in 'block (2 levels) in <main>'

  469) Market::SupplyChain can track status changes
       Failure/Error: let(:marketplace) { create(:marketplace) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/supply_chain_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:11:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:40:in 'block (2 levels) in <main>'

  470) Market::SupplyChain scopes active supply chains
       Failure/Error: let(:marketplace) { create(:marketplace) }

       ActiveModel::MissingAttributeError:
         can't write unknown attribute `settlement_id`
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/supply_chain_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:11:in 'block (2 levels) in <main>'
       # ./spec/models/market/supply_chain_spec.rb:57:in 'block (2 levels) in <main>'

  471) Market::TransactionFee validations is expected to validate that :fee_type cannot be empty/falsy
       Failure/Error: it { should validate_presence_of(:fee_type) }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :fee_type on the Market::TransactionFee to
         nil, but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#run_allow_or_disallow_matcher'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:103:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#disallows_value_of'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:258:in 'Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#disallows_original_or_typecast_value?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:180:in 'block in Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:179:in 'Array#all?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:5:in 'block (3 levels) in <main>'

  472) Market::TransactionFee validations is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"›
       Failure/Error: it { should validate_inclusion_of(:fee_type).in_array(%w[percentage fixed]) }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :fee_type on the Market::TransactionFee to
         "percentage", but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:42:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_failing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:395:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#run_allow_or_disallow_matcher'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:98:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#allows_value_of'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:468:in 'block in Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#allows_all_values_in_array?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:467:in 'Array#all?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:467:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#allows_all_values_in_array?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:417:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#matches_for_array?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:376:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:6:in 'block (3 levels) in <main>'

  473) Market::TransactionFee validations is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil
       Failure/Error: it { should validate_numericality_of(:percentage).is_greater_than_or_equal_to(0).allow_nil }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :percentage on the Market::TransactionFee
         to "-1", but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:36:in 'block in Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Array#reject'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:13:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/comparison_matcher.rb:79:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::ComparisonMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:7:in 'block (3 levels) in <main>'

  474) Market::TransactionFee validations is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil
       Failure/Error: it { should validate_numericality_of(:fixed_amount).is_greater_than_or_equal_to(0).allow_nil }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :fixed_amount on the Market::TransactionFee
         to "-1", but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:36:in 'block in Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Array#reject'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:13:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/comparison_matcher.rb:79:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::ComparisonMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:8:in 'block (3 levels) in <main>'

  475) Market::TransactionFee#calculate calculates percentage fee
       Failure/Error: fee = build(:transaction_fee, fee_type: 'percentage', percentage: 5, fixed_amount: nil)

       NoMethodError:
         undefined method 'fee_type=' for an instance of Market::TransactionFee
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/transaction_fee_spec.rb:13:in 'block (3 levels) in <main>'

  476) Market::TransactionFee#calculate calculates fixed fee
       Failure/Error: fee = build(:transaction_fee, fee_type: 'fixed', percentage: nil, fixed_amount: 10)

       NoMethodError:
         undefined method 'fee_type=' for an instance of Market::TransactionFee
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/transaction_fee_spec.rb:18:in 'block (3 levels) in <main>'

  477) Market::TransactionFee#calculate returns 0 for unknown fee_type
       Failure/Error: fee = build(:transaction_fee, fee_type: 'other', percentage: nil, fixed_amount: nil)

       NoMethodError:
         undefined method 'fee_type=' for an instance of Market::TransactionFee
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/transaction_fee_spec.rb:23:in 'block (3 levels) in <main>'

  478) MaterialRequest validations is valid with required attributes
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (792, Test Dome, Crater Dome, null, 1724, Player, 3785, null, Location::CelestialLocation, 2029, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:43.01073, 2026-01-11 23:29:43.01073, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:15:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (792, Test Dome, Crater Dome, null, 1724, Player, 3785, null, Location::CelestialLocation, 2029, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:43.01073, 2026-01-11 23:29:43.01073, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  479) MaterialRequest validations requires a material_name
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (794, Test Dome, Crater Dome, null, 1726, Player, 3790, null, Location::CelestialLocation, 2032, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:43.521545, 2026-01-11 23:29:43.521545, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (794, Test Dome, Crater Dome, null, 1726, Player, 3790, null, Location::CelestialLocation, 2032, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:43.521545, 2026-01-11 23:29:43.521545, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  480) MaterialRequest validations requires quantity_requested to be present
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (796, Test Dome, Crater Dome, null, 1728, Player, 3795, null, Location::CelestialLocation, 2035, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:43.978148, 2026-01-11 23:29:43.978148, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:33:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (796, Test Dome, Crater Dome, null, 1728, Player, 3795, null, Location::CelestialLocation, 2035, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:43.978148, 2026-01-11 23:29:43.978148, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  481) MaterialRequest validations requires quantity_requested to be greater than 0
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (798, Test Dome, Crater Dome, null, 1730, Player, 3800, null, Location::CelestialLocation, 2038, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:44.333795, 2026-01-11 23:29:44.333795, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (798, Test Dome, Crater Dome, null, 1730, Player, 3800, null, Location::CelestialLocation, 2038, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:44.333795, 2026-01-11 23:29:44.333795, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  482) MaterialRequest validations requires quantity_requested to be a number
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (800, Test Dome, Crater Dome, null, 1732, Player, 3803, null, Location::CelestialLocation, 2040, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:44.64504, 2026-01-11 23:29:44.64504, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:52:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (800, Test Dome, Crater Dome, null, 1732, Player, 3803, null, Location::CelestialLocation, 2040, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:44.64504, 2026-01-11 23:29:44.64504, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  483) MaterialRequest associations belongs to a requestable (polymorphic)
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (802, Test Dome, Crater Dome, null, 1734, Player, 3808, null, Location::CelestialLocation, 2043, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:44.968336, 2026-01-11 23:29:44.968336, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:62:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:65:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (802, Test Dome, Crater Dome, null, 1734, Player, 3808, null, Location::CelestialLocation, 2043, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:44.968336, 2026-01-11 23:29:44.968336, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  484) MaterialRequest associations can be associated with different requestable types
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (803, Test Dome, Crater Dome, null, 1735, Player, 3812, null, Location::CelestialLocation, 2046, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:45.278755, 2026-01-11 23:29:45.278755, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:70:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (803, Test Dome, Crater Dome, null, 1735, Player, 3812, null, Location::CelestialLocation, 2046, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:45.278755, 2026-01-11 23:29:45.278755, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  485) MaterialRequest enums status enum defaults to pending status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (805, Test Dome, Crater Dome, null, 1737, Player, 3816, null, Location::CelestialLocation, 2048, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:45.594578, 2026-01-11 23:29:45.594578, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:92:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (805, Test Dome, Crater Dome, null, 1737, Player, 3816, null, Location::CelestialLocation, 2048, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:45.594578, 2026-01-11 23:29:45.594578, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  486) MaterialRequest enums status enum can be set to different statuses
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (807, Test Dome, Crater Dome, null, 1739, Player, 3820, null, Location::CelestialLocation, 2051, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:45.883819, 2026-01-11 23:29:45.883819, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:96:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (807, Test Dome, Crater Dome, null, 1739, Player, 3820, null, Location::CelestialLocation, 2051, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:45.883819, 2026-01-11 23:29:45.883819, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  487) MaterialRequest enums status enum accepts string values for status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (808, Test Dome, Crater Dome, null, 1740, Player, 3824, null, Location::CelestialLocation, 2054, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:46.243994, 2026-01-11 23:29:46.243994, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:102:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (808, Test Dome, Crater Dome, null, 1740, Player, 3824, null, Location::CelestialLocation, 2054, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:46.243994, 2026-01-11 23:29:46.243994, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  488) MaterialRequest enums priority enum defaults to normal priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (810, Test Dome, Crater Dome, null, 1742, Player, 3829, null, Location::CelestialLocation, 2057, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:46.57889, 2026-01-11 23:29:46.57889, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:118:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (810, Test Dome, Crater Dome, null, 1742, Player, 3829, null, Location::CelestialLocation, 2057, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:46.57889, 2026-01-11 23:29:46.57889, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  489) MaterialRequest enums priority enum can be set to different priorities
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (811, Test Dome, Crater Dome, null, 1744, Player, 3832, null, Location::CelestialLocation, 2060, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:46.907732, 2026-01-11 23:29:46.907732, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:122:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (811, Test Dome, Crater Dome, null, 1744, Player, 3832, null, Location::CelestialLocation, 2060, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:46.907732, 2026-01-11 23:29:46.907732, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  490) MaterialRequest enums priority enum accepts string values for priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (812, Test Dome, Crater Dome, null, 1745, Player, 3836, null, Location::CelestialLocation, 2064, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:47.216208, 2026-01-11 23:29:47.216208, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:128:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (812, Test Dome, Crater Dome, null, 1745, Player, 3836, null, Location::CelestialLocation, 2064, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:47.216208, 2026-01-11 23:29:47.216208, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  491) MaterialRequest scopes .pending_requests returns pending and partially fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (813, Test Dome, Crater Dome, null, 1746, Player, 3841, null, Location::CelestialLocation, 2070, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:47.536053, 2026-01-11 23:29:47.536053, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:135:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (813, Test Dome, Crater Dome, null, 1746, Player, 3841, null, Location::CelestialLocation, 2070, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:47.536053, 2026-01-11 23:29:47.536053, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  492) MaterialRequest scopes .fulfilled returns only fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (814, Test Dome, Crater Dome, null, 1747, Player, 3846, null, Location::CelestialLocation, 2074, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:47.837942, 2026-01-11 23:29:47.837942, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:135:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (814, Test Dome, Crater Dome, null, 1747, Player, 3846, null, Location::CelestialLocation, 2074, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:47.837942, 2026-01-11 23:29:47.837942, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  493) MaterialRequest scopes .for_material returns requests for a specific material
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (815, Test Dome, Crater Dome, null, 1748, Player, 3850, null, Location::CelestialLocation, 2078, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:48.113077, 2026-01-11 23:29:48.113077, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:135:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (815, Test Dome, Crater Dome, null, 1748, Player, 3850, null, Location::CelestialLocation, 2078, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:48.113077, 2026-01-11 23:29:48.113077, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  494) MaterialRequest delegations delegates settlement to requestable
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (816, Test Dome, Crater Dome, null, 1749, Player, 3855, null, Location::CelestialLocation, 2083, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:48.404604, 2026-01-11 23:29:48.404604, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:168:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:171:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (816, Test Dome, Crater Dome, null, 1749, Player, 3855, null, Location::CelestialLocation, 2083, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:48.404604, 2026-01-11 23:29:48.404604, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  495) MaterialRequest delegations handles nil settlement gracefully
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (817, Test Dome, Crater Dome, null, 1750, Player, 3859, null, Location::CelestialLocation, 2087, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:48.683987, 2026-01-11 23:29:48.683987, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:176:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (817, Test Dome, Crater Dome, null, 1750, Player, 3859, null, Location::CelestialLocation, 2087, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:48.683987, 2026-01-11 23:29:48.683987, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  496) MaterialRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (818, Test Dome, Crater Dome, null, 1751, Player, 3864, null, Location::CelestialLocation, 2092, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:49.047554, 2026-01-11 23:29:49.047554, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:185:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (818, Test Dome, Crater Dome, null, 1751, Player, 3864, null, Location::CelestialLocation, 2092, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:49.047554, 2026-01-11 23:29:49.047554, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  497) MaterialRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (819, Test Dome, Crater Dome, null, 1752, Player, 3874, null, Location::CelestialLocation, 2095, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:49.383879, 2026-01-11 23:29:49.383879, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:194:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (819, Test Dome, Crater Dome, null, 1752, Player, 3874, null, Location::CelestialLocation, 2095, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:49.383879, 2026-01-11 23:29:49.383879, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  498) MaterialRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (820, Test Dome, Crater Dome, null, 1753, Player, 3877, null, Location::CelestialLocation, 2097, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:49.706571, 2026-01-11 23:29:49.706571, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:203:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (820, Test Dome, Crater Dome, null, 1753, Player, 3877, null, Location::CelestialLocation, 2097, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:49.706571, 2026-01-11 23:29:49.706571, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  499) MaterialRequest instance methods #gas_request? returns true when material is a gas
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (821, Test Dome, Crater Dome, null, 1754, Player, 3879, null, Location::CelestialLocation, 2099, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:50.04738, 2026-01-11 23:29:50.04738, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:222:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (821, Test Dome, Crater Dome, null, 1754, Player, 3879, null, Location::CelestialLocation, 2099, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:50.04738, 2026-01-11 23:29:50.04738, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  500) MaterialRequest instance methods #gas_request? returns false when material is not a gas
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (822, Test Dome, Crater Dome, null, 1755, Player, 3881, null, Location::CelestialLocation, 2101, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:50.42422, 2026-01-11 23:29:50.42422, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:229:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (822, Test Dome, Crater Dome, null, 1755, Player, 3881, null, Location::CelestialLocation, 2101, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:50.42422, 2026-01-11 23:29:50.42422, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  501) MaterialRequest instance methods #gas_request? returns false when material data is not found
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (823, Test Dome, Crater Dome, null, 1756, Player, 3883, null, Location::CelestialLocation, 2103, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:50.753425, 2026-01-11 23:29:50.753425, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:235:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (823, Test Dome, Crater Dome, null, 1756, Player, 3883, null, Location::CelestialLocation, 2103, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:50.753425, 2026-01-11 23:29:50.753425, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  502) MaterialRequest instance methods #gas_request? returns false when material data has no category
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (824, Test Dome, Crater Dome, null, 1757, Player, 3885, null, Location::CelestialLocation, 2105, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:51.061504, 2026-01-11 23:29:51.061504, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:242:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (824, Test Dome, Crater Dome, null, 1757, Player, 3885, null, Location::CelestialLocation, 2105, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:51.061504, 2026-01-11 23:29:51.061504, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  503) MaterialRequest factory creates a valid material request with factory
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (825, Test Dome, Crater Dome, null, 1758, Player, 3887, null, Location::CelestialLocation, 2107, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:51.338739, 2026-01-11 23:29:51.338739, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:251:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (825, Test Dome, Crater Dome, null, 1758, Player, 3887, null, Location::CelestialLocation, 2107, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-11 23:29:51.338739, 2026-01-11 23:29:51.338739, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  504) CelestialBodies::Material validations is not valid without a state
       Failure/Error: expect(material).to_not be_valid
         expected #<CelestialBodies::Material id: 1402, name: "Material 15", amount: 100.0, boiling_point: nil, melting_point: nil, state_at_room_temp: nil, state: nil, location: "surface", is_volatile: false, materializable_type: nil, materializable_id: nil, celestial_body_id: 6378, created_at: "2026-01-11 23:29:51.975842000 +0000", updated_at: "2026-01-11 23:29:51.975842000 +0000", layer: nil> not to be valid
       # ./spec/models/material_spec.rb:29:in 'block (3 levels) in <main>'

  505) CelestialBodies::Material validations is not valid with an invalid state
       Failure/Error: material.state = 'unknown_state'

       ArgumentError:
         'unknown_state' is not a valid state
       # ./spec/models/material_spec.rb:40:in 'block (3 levels) in <main>'

  506) CelestialBodies::Material validations is not valid with non-numeric melting and boiling points
       Failure/Error: expect(material).to_not be_valid
         expected #<CelestialBodies::Material id: 1406, name: "Material 19", amount: 100.0, boiling_point: 0.0, melting_point: 0.0, state_at_room_temp: nil, state: "solid", location: "surface", is_volatile: false, materializable_type: nil, materializable_id: nil, celestial_body_id: 6382, created_at: "2026-01-11 23:29:52.486434000 +0000", updated_at: "2026-01-11 23:29:52.486434000 +0000", layer: nil> not to be valid
       # ./spec/models/material_spec.rb:53:in 'block (3 levels) in <main>'

  507) CelestialBodies::Material#state_at returns "solid" when temperature is below the adjusted melting point
       Failure/Error: expect(material.state_at(250, 1.0)).to eq('solid')

       NoMethodError:
         undefined method 'state_at' for an instance of CelestialBodies::Material
       # ./spec/models/material_spec.rb:65:in 'block (3 levels) in <main>'

  508) CelestialBodies::Material#state_at returns "liquid" when temperature is between the adjusted melting and boiling points
       Failure/Error: expect(material.state_at(400, 1.0)).to eq('liquid')

       NoMethodError:
         undefined method 'state_at' for an instance of CelestialBodies::Material
       # ./spec/models/material_spec.rb:69:in 'block (3 levels) in <main>'

  509) CelestialBodies::Material#state_at returns "gas" when temperature is above the adjusted boiling point
       Failure/Error: expect(material.state_at(600, 1.0)).to eq('gas')

       NoMethodError:
         undefined method 'state_at' for an instance of CelestialBodies::Material
       # ./spec/models/material_spec.rb:73:in 'block (3 levels) in <main>'

  510) Modules::BaseModule associations accepts craft as polymorphic attachable
       Failure/Error: craft = create(:base_craft, owner: player)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/modules/base_module_spec.rb:15:in 'block (2 levels) in <main>'
       # ./spec/models/modules/base_module_spec.rb:30:in 'block (3 levels) in <main>'

  511) Modules::BaseModule callbacks after_create :apply_module_to_attachable applies module to craft when created with craft attachable
       Failure/Error: craft = create(:base_craft, owner: player)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/modules/base_module_spec.rb:15:in 'block (2 levels) in <main>'
       # ./spec/models/modules/base_module_spec.rb:114:in 'block (4 levels) in <main>'

  512) Modules::BaseModule callbacks before_destroy :remove_module_from_attachable removes module from craft when destroyed
       Failure/Error: craft = create(:base_craft, owner: player)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/modules/base_module_spec.rb:15:in 'block (2 levels) in <main>'
       # ./spec/models/modules/base_module_spec.rb:133:in 'block (4 levels) in <main>'

  513) OrbitalConstructionProject#materials_complete? when all required materials are delivered returns true
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:21:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:25:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  514) OrbitalConstructionProject#materials_complete? when some materials are missing returns false
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:21:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:38:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  515) OrbitalConstructionProject#materials_complete? when materials exceed requirements returns true
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:21:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:51:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  516) OrbitalConstructionProject#completion_percentage when no materials are delivered returns 0
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:64:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:68:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  517) OrbitalConstructionProject#completion_percentage when half materials are delivered returns 50
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:64:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:81:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  518) OrbitalConstructionProject#completion_percentage when all materials are delivered returns 100
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:64:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:94:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  519) OrbitalConstructionProject JSONB storage stores required_materials as JSONB
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:107:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:111:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  520) OrbitalConstructionProject JSONB storage stores delivered_materials as JSONB
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:107:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:118:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  521) OrbitalConstructionProject JSONB storage stores project_metadata as JSONB
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_construction_project_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:107:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_construction_project_spec.rb:125:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  522) OrbitalRelationship associations belongs to primary_body polymorphically
       Failure/Error: relationship = OrbitalRelationship.new(primary_body: star)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:12:in 'block (3 levels) in <main>'

  523) OrbitalRelationship associations belongs to secondary_body polymorphically
       Failure/Error: relationship = OrbitalRelationship.new(secondary_body: planet)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'secondary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:17:in 'block (3 levels) in <main>'

  524) OrbitalRelationship validations is valid with valid attributes
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:34:in 'block (3 levels) in <main>'

  525) OrbitalRelationship validations relationship_type validation requires relationship_type to be present
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.except(:relationship_type))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:40:in 'block (4 levels) in <main>'

  526) OrbitalRelationship validations relationship_type validation validates relationship_type inclusion
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(relationship_type: type))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:49:in 'block (5 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:48:in 'Array#each'
       # ./spec/models/orbital_relationship_spec.rb:48:in 'block (4 levels) in <main>'

  527) OrbitalRelationship validations numerical validations validates distance is positive
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(distance: -1))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:60:in 'block (4 levels) in <main>'

  528) OrbitalRelationship validations numerical validations validates semi_major_axis is positive
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(semi_major_axis: -1))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:66:in 'block (4 levels) in <main>'

  529) OrbitalRelationship validations numerical validations validates eccentricity is between 0 and 1
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(eccentricity: 0.5))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:72:in 'block (4 levels) in <main>'

  530) OrbitalRelationship validations numerical validations validates orbital_period is positive
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(orbital_period: -1))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:81:in 'block (4 levels) in <main>'

  531) OrbitalRelationship validations uniqueness validation prevents duplicate relationships between same bodies
       Failure/Error: OrbitalRelationship.create!(valid_attributes)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:88:in 'block (4 levels) in <main>'

  532) OrbitalRelationship backward compatibility methods #sun returns primary_body when it's a Star
       Failure/Error:
         create(:orbital_relationship, 
           primary_body: star, 
           secondary_body: planet, 
           relationship_type: 'star_planet'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:99:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:108:in 'block (4 levels) in <main>'

  533) OrbitalRelationship backward compatibility methods #sun returns nil when primary_body is not a Star
       Failure/Error:
         planet_moon_relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:112:in 'block (4 levels) in <main>'

  534) OrbitalRelationship backward compatibility methods #sun= sets primary_body and relationship_type
       Failure/Error: relationship = OrbitalRelationship.new(secondary_body: planet)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'secondary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:123:in 'block (4 levels) in <main>'

  535) OrbitalRelationship backward compatibility methods #celestial_body returns secondary_body when it's a CelestialBody
       Failure/Error:
         create(:orbital_relationship, 
           primary_body: star, 
           secondary_body: planet, 
           relationship_type: 'star_planet'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:99:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:133:in 'block (4 levels) in <main>'

  536) OrbitalRelationship backward compatibility methods #celestial_body= sets secondary_body
       Failure/Error: relationship.celestial_body = planet

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/orbital_relationship_spec.rb:140:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant OrbitalRelationship::CelestialBody
       #   ./spec/models/orbital_relationship_spec.rb:140:in 'block (4 levels) in <main>'

  537) OrbitalRelationship relationship type helpers identifies star_planet relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:149:in 'block (3 levels) in <main>'

  538) OrbitalRelationship relationship type helpers identifies planet_moon relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:159:in 'block (3 levels) in <main>'

  539) OrbitalRelationship relationship type helpers identifies binary_star relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: binary_star,
           relationship_type: 'binary_star'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:169:in 'block (3 levels) in <main>'

  540) OrbitalRelationship energy calculations #stellar_energy_input calculates stellar energy based on luminosity and distance
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11  # 1 AU
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:182:in 'block (4 levels) in <main>'

  541) OrbitalRelationship energy calculations #stellar_energy_input returns 0 when primary_body doesn't have luminosity
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon',
           distance: 3.844e8
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:194:in 'block (4 levels) in <main>'

  542) OrbitalRelationship energy calculations #tidal_heating calculates tidal heating for planet-moon relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon',
           distance: 3.844e8,  # Earth-Moon distance
           eccentricity: 0.0549  # Moon's eccentricity
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:207:in 'block (4 levels) in <main>'

  543) OrbitalRelationship energy calculations #tidal_heating includes eccentricity factor in calculation
       Failure/Error:
         low_ecc = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon',
           distance: 3.844e8,
           eccentricity: 0.01
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:220:in 'block (4 levels) in <main>'

  544) OrbitalRelationship energy calculations #energy_input returns stellar energy for star_planet relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:242:in 'block (4 levels) in <main>'

  545) OrbitalRelationship energy calculations #energy_input returns combined tidal and reflected energy for planet_moon relationships
       Failure/Error:
         star_planet = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:254:in 'block (4 levels) in <main>'

  546) OrbitalRelationship terraforming reflected_energy and energy_input returns extra energy for star_planet with orbital mirrors and albedo adjustment
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:278:in 'block (3 levels) in <main>'

  547) OrbitalRelationship orbital mechanics #orbital_distance returns semi_major_axis when available
       Failure/Error:
         relationship = create(:orbital_relationship,
           distance: 1.0e11,
           semi_major_axis: 1.5e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:301:in 'block (4 levels) in <main>'

  548) OrbitalRelationship orbital mechanics #orbital_distance falls back to distance when semi_major_axis is nil
       Failure/Error:
         relationship = create(:orbital_relationship,
           distance: 1.0e11,
           semi_major_axis: nil
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:309:in 'block (4 levels) in <main>'

  549) OrbitalRelationship orbital mechanics #orbital_distance returns 0 when both are nil
       Failure/Error:
         relationship = create(:orbital_relationship,
           distance: nil,
           semi_major_axis: nil
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:317:in 'block (4 levels) in <main>'

  550) OrbitalRelationship orbital mechanics #calculated_orbital_period calculates orbital period using Kepler's Third Law
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           semi_major_axis: 1.496e11  # 1 AU
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:327:in 'block (4 levels) in <main>'

  551) OrbitalRelationship orbital mechanics #calculated_orbital_period returns nil when primary_body has no mass
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star_with_mass,
           secondary_body: planet,
           semi_major_axis: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:340:in 'block (4 levels) in <main>'

  552) OrbitalRelationship orbital mechanics #current_orbital_position calculates orbital position based on time
       Failure/Error:
         relationship = create(:orbital_relationship,
           orbital_period: 30.0,  # 30 day period
           epoch_time: epoch,
           mean_anomaly_at_epoch: 0
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:354:in 'block (4 levels) in <main>'

  553) OrbitalRelationship orbital mechanics #current_orbital_position returns nil when orbital_period or epoch_time is missing
       Failure/Error:
         relationship = create(:orbital_relationship,
           orbital_period: nil,
           epoch_time: nil
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:366:in 'block (4 levels) in <main>'

  554) OrbitalRelationship private methods #masses_present? returns true when both bodies have mass
       Failure/Error: let(:relationship) { create(:orbital_relationship, primary_body: star, secondary_body: planet) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:378:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:381:in 'block (4 levels) in <main>'

  555) OrbitalRelationship private methods #masses_present? returns false when primary_body has no mass
       Failure/Error: let(:relationship) { create(:orbital_relationship, primary_body: star, secondary_body: planet) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:378:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:386:in 'block (4 levels) in <main>'

  556) OrbitalRelationship private methods #extract_mass extracts mass from Star objects
       Failure/Error: let(:relationship) { create(:orbital_relationship) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:391:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:394:in 'block (4 levels) in <main>'

  557) OrbitalRelationship private methods #extract_mass extracts and converts mass from CelestialBody objects
       Failure/Error: let(:relationship) { create(:orbital_relationship) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:391:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:399:in 'block (4 levels) in <main>'

  558) OrbitalRelationship private methods #extract_mass returns nil for unsupported object types
       Failure/Error: let(:relationship) { create(:orbital_relationship) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:391:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:404:in 'block (4 levels) in <main>'

  559) Organizations::BaseOrganization distributes profits to members based on ownership
       Failure/Error: allow(consortium).to receive(:calculate_revenue).and_return(1_000_000)
         #<Organizations::BaseOrganization id: 256, name: "Test Organization 61", identifier: "ORG66", organization_type: "consortium", operational_data: {}, description: nil, owner_type: nil, owner_id: nil, created_at: "2026-01-11 23:30:05.609039000 +0000", updated_at: "2026-01-11 23:30:05.609039000 +0000"> does not implement: calculate_revenue
       # ./spec/models/organizations/base_organization_profit_spec.rb:9:in 'block (2 levels) in <main>'

  560) Organizations::TaxAuthority.instance always returns the same single instance
       Failure/Error: expect(Organizations::TaxAuthority.count).to eq(1)

         expected: 1
              got: 2

         (compared using ==)
       # ./spec/models/organizations/tax_authority_spec.rb:24:in 'block (3 levels) in <main>'

  561) PlanetBiome 
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:15:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  562) PlanetBiome 
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  563) PlanetBiome is valid with valid attributes
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:20:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  564) PlanetBiome is not valid without a biome
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:24:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  565) PlanetBiome is not valid without a celestial_body
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:29:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  566) PlantEnvironment validations is valid with valid attributes
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:14:in 'block (3 levels) in <main>'

  567) PlantEnvironment validations is not valid without a plant
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:18:in 'block (3 levels) in <main>'

  568) PlantEnvironment validations is not valid without an environment
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:23:in 'block (3 levels) in <main>'

  569) PlantEnvironment validations is not valid with duplicate plant and environment pair
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:28:in 'block (3 levels) in <main>'

  570) Plant validations is valid with valid attributes
       Failure/Error: expect(plant).to be_valid
         expected #<Plant id: nil, name: "Cactus", growth_temperature_range: "20..30", growth_humidity_range: "10..30", description: "A hardy plant adapted to dry environments", created_at: nil, updated_at: nil> to be valid, but got errors: Environment must exist
       # ./spec/models/plant_spec.rb:10:in 'block (3 levels) in <main>'

  571) Plant methods can grow in a given environment if conditions are met
       Failure/Error: environment = Environment.create(biome: biome, planet: Planet.first, temperature: 25.0, pressure: 1.0, humidity: 20.0)

       NameError:
         uninitialized constant Planet
       # ./spec/models/plant_spec.rb:37:in 'block (3 levels) in <main>'

  572) Plant methods cannot grow in a given environment if conditions are not met
       Failure/Error: environment = Environment.create(biome: biome, planet: Planet.first, temperature: 35.0, pressure: 1.0, humidity: 80.0)

       NameError:
         uninitialized constant Planet
       # ./spec/models/plant_spec.rb:43:in 'block (3 levels) in <main>'

  573) Player validations is valid with valid attributes
       Failure/Error: let!(:location_on_surface) { CelestialLocation.create(name: "Test Location #{SecureRandom.hex(4)}", coordinates: "#{SecureRandom.hex(4)}°N #{SecureRandom.hex(4)}°E", celestial_body: celestial_body) }

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/models/player_spec.rb:8:in 'block (2 levels) in <main>'

  574) Player validations is not valid without a name
       Failure/Error: let!(:location_on_surface) { CelestialLocation.create(name: "Test Location #{SecureRandom.hex(4)}", coordinates: "#{SecureRandom.hex(4)}°N #{SecureRandom.hex(4)}°E", celestial_body: celestial_body) }

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/models/player_spec.rb:8:in 'block (2 levels) in <main>'

  575) Player validations is not valid without an active_location
       Failure/Error: let!(:location_on_surface) { CelestialLocation.create(name: "Test Location #{SecureRandom.hex(4)}", coordinates: "#{SecureRandom.hex(4)}°N #{SecureRandom.hex(4)}°E", celestial_body: celestial_body) }

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/models/player_spec.rb:8:in 'block (2 levels) in <main>'

  576) Player account balance has a balance of 1000
       Failure/Error: let!(:location_on_surface) { CelestialLocation.create(name: "Test Location #{SecureRandom.hex(4)}", coordinates: "#{SecureRandom.hex(4)}°N #{SecureRandom.hex(4)}°E", celestial_body: celestial_body) }

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/models/player_spec.rb:8:in 'block (2 levels) in <main>'

  577) Player inventory at active location raises an error if active location is not set
       Failure/Error: let!(:location_on_surface) { CelestialLocation.create(name: "Test Location #{SecureRandom.hex(4)}", coordinates: "#{SecureRandom.hex(4)}°N #{SecureRandom.hex(4)}°E", celestial_body: celestial_body) }

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/models/player_spec.rb:8:in 'block (2 levels) in <main>'

  578) Player inventory at active location returns the inventory at the active location
       Failure/Error: let!(:location_on_surface) { CelestialLocation.create(name: "Test Location #{SecureRandom.hex(4)}", coordinates: "#{SecureRandom.hex(4)}°N #{SecureRandom.hex(4)}°E", celestial_body: celestial_body) }

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/models/player_spec.rb:8:in 'block (2 levels) in <main>'

  579) Rigs::BaseRig#apply_rig_to_attachable applies rig effect to the attachable unit
       Failure/Error: expect(base_unit).to receive(:update_consumables).at_least(:once)
         #<Units::BaseUnit id: 333, identifier: "UNIT45", name: "Test Unit 45", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 263, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-11 23:30:08.594035000 +0000", updated_at: "2026-01-11 23:30:08.594035000 +0000"> does not implement: update_consumables
       # ./spec/models/rigs/base_rig_spec.rb:24:in 'block (3 levels) in <main>'

  580) Rigs::BaseRig#remove_from removes rig effect from the attachable unit
       Failure/Error: expect(base_unit).to receive(:update_consumables).at_least(:once)
         #<Units::BaseUnit id: 334, identifier: "UNIT46", name: "Test Unit 46", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 264, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-11 23:30:08.633229000 +0000", updated_at: "2026-01-11 23:30:08.633229000 +0000"> does not implement: update_consumables
       # ./spec/models/rigs/base_rig_spec.rb:31:in 'block (3 levels) in <main>'

  581) Rigs::BaseRig polymorphic association can belong to an attachable BaseUnit
       Failure/Error: expect(base_unit.persisted_rigs).to include(rig)

       NoMethodError:
         undefined method 'persisted_rigs' for an instance of Units::BaseUnit
       # ./spec/models/rigs/base_rig_spec.rb:39:in 'block (3 levels) in <main>'

  582) Rigs::BaseRig#apply_output_effects and #revert_output_effects applies and reverts output effects if attachable responds to update_outputs
       Failure/Error: allow(base_unit).to receive(:update_outputs)
         #<Units::BaseUnit id: 340, identifier: "UNIT52", name: "Test Unit 52", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 270, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-11 23:30:09.012002000 +0000", updated_at: "2026-01-11 23:30:09.012002000 +0000"> does not implement: update_outputs
       # ./spec/models/rigs/base_rig_spec.rb:108:in 'block (3 levels) in <main>'

  583) Rigs::BaseRig#apply_damage_effects and #revert_damage_effects applies and reverts damage effects if attachable responds to update_damage_risks
       Failure/Error: allow(base_unit).to receive(:update_damage_risks)
         #<Units::BaseUnit id: 341, identifier: "UNIT53", name: "Test Unit 53", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 271, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-11 23:30:09.061736000 +0000", updated_at: "2026-01-11 23:30:09.061736000 +0000"> does not implement: update_damage_risks
       # ./spec/models/rigs/base_rig_spec.rb:130:in 'block (3 levels) in <main>'

  584) RouteProposal calculates vote outcome based on threshold
       Failure/Error: votes_in_favor = votes.where(vote: 'approve').sum(:voting_power)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column route_proposal_votes.route_proposal_id does not exist
         LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
                                                                      ^
       # ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'
       # ./spec/models/route_proposal_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column route_proposal_votes.route_proposal_id does not exist
       #   LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
       #                                                                ^
       #   ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'

  585) RouteProposal fails if votes do not meet threshold
       Failure/Error: votes_in_favor = votes.where(vote: 'approve').sum(:voting_power)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column route_proposal_votes.route_proposal_id does not exist
         LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
                                                                      ^
       # ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'
       # ./spec/models/route_proposal_spec.rb:19:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column route_proposal_votes.route_proposal_id does not exist
       #   LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
       #                                                                ^
       #   ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'

  586) RouteProposalVote is valid with valid attributes
       Failure/Error: let(:proposal) { create(:route_proposal) }

       KeyError:
         Factory not registered: "route_proposal"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/route_proposal_vote_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/route_proposal_vote_spec.rb:8:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "route_proposal"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  587) RouteProposalVote is invalid with an invalid vote value
       Failure/Error: let(:proposal) { create(:route_proposal) }

       KeyError:
         Factory not registered: "route_proposal"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/route_proposal_vote_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/route_proposal_vote_spec.rb:13:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "route_proposal"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  588) Settlement::BaseSettlement validations is valid with valid attributes
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  589) Settlement::BaseSettlement validations is not valid without a name
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  590) Settlement::BaseSettlement validations is not valid with a negative current population
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  591) Settlement::BaseSettlement validations is not valid with a non-integer current population
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  592) Settlement::BaseSettlement associations can belong to a player
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  593) Settlement::BaseSettlement associations has many docked crafts
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  594) Settlement::BaseSettlement associations has many base units
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  595) Settlement::BaseSettlement associations has a marketplace association using the correct foreign key
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  596) Settlement::BaseSettlement associations has a financial account
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  597) Settlement::BaseSettlement associations destroys the marketplace when destroyed
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  598) Settlement::BaseSettlement storage capacity calculates storage capacity by type
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:112:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  599) Settlement::BaseSettlement storage capacity maintains backward compatibility with total storage capacity (liquid and gas only)
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:112:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  600) Settlement::BaseSettlement storage capacity calculates total storage capacity (sum of all storage types)
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:112:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  601) Settlement::BaseSettlement Market Integration #npc_market_bid calls the NpcPriceCalculator with the correct arguments
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  602) Settlement::BaseSettlement Market Integration #npc_market_bid returns the calculated price
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  603) Settlement::BaseSettlement Market Integration #npc_buy_capacity when storage is the limiting factor (50 units) limits capacity by available storage (50)
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  604) Settlement::BaseSettlement Market Integration #npc_buy_capacity when finances are the limiting factor (20 units) limits capacity by financial ability (20)
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  605) Settlement::BaseSettlement Market Integration #npc_buy_capacity when bid price is zero returns 0 capacity
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  606) Settlement::BaseSettlement Market Integration #npc_buy_capacity when account or inventory is missing returns 0 capacity if account is missing
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  607) Settlement::BaseSettlement Market Integration #npc_buy_capacity when account or inventory is missing returns 0 capacity if inventory is missing
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  608) Settlement::BaseSettlement after_create hooks creates a financial account and inventory
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  609) Settlement::BaseSettlement celestial body delegation delegates celestial_body to location
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  610) Settlement::BaseSettlement#process_materials processes materials using base units
       Failure/Error:
         create(:base_settlement, :independent,
                name: "Test Base",
                settlement_type: :base,
                current_population: 1,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  611) Settlement::BaseSettlement operational_data can store and retrieve operational data
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:263:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  612) Settlement::BaseSettlement operational_data provides default empty hash if operational_data is empty
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:263:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  613) Settlement::BaseSettlement operational_data works with energy management methods
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:263:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  614) Settlement::BaseSettlement construction cost management #construction_cost_percentage returns default percentage when not set
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  615) Settlement::BaseSettlement construction cost management #construction_cost_percentage returns custom percentage when set in operational_data
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  616) Settlement::BaseSettlement construction cost management #construction_cost_percentage handles empty operational_data gracefully
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  617) Settlement::BaseSettlement construction cost management #construction_cost_percentage handles missing manufacturing section gracefully
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  618) Settlement::BaseSettlement construction cost management #construction_cost_percentage handles empty operational_data gracefully
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  619) Settlement::BaseSettlement construction cost management #construction_cost_percentage= sets the construction cost percentage in operational_data
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  620) Settlement::BaseSettlement construction cost management #construction_cost_percentage= initializes operational_data manufacturing section if empty
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  621) Settlement::BaseSettlement construction cost management #construction_cost_percentage= preserves existing operational_data when setting percentage
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  622) Settlement::BaseSettlement construction cost management #calculate_construction_cost calculates construction cost as percentage of purchase cost
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  623) Settlement::BaseSettlement construction cost management #calculate_construction_cost rounds to 2 decimal places
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  624) Settlement::BaseSettlement construction cost management #calculate_construction_cost handles zero purchase cost
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  625) Settlement::BaseSettlement construction cost management #calculate_construction_cost handles string input by converting to float
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  626) Settlement::BaseSettlement construction cost management #calculate_construction_cost handles nil input gracefully
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  627) Settlement::BaseSettlement construction cost management manufacturing settings supports manufacturing efficiency setting
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  628) Settlement::BaseSettlement construction cost management manufacturing settings defaults manufacturing efficiency to 1.0
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  629) Settlement::BaseSettlement construction cost management manufacturing settings supports equipment check setting
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  630) Settlement::BaseSettlement construction cost management manufacturing settings defaults equipment check to true
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:315:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  631) Settlement::BaseSettlement construction cost integration integrates construction cost calculations with settlement manufacturing data
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:450:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  632) Settlement::BaseSettlement construction cost integration preserves other operational_data when updating construction settings
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:450:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  633) Settlement::BaseSettlement construction cost integration works correctly when operational_data starts empty
       Failure/Error: let(:base_settlement) { create(:base_settlement, :independent, owner: player, location: location) }

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/base_settlement_spec.rb:450:in 'block (3 levels) in <main>'
       # ./spec/models/settlement/base_settlement_spec.rb:28:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  634) Settlement::City validations is valid with valid attributes
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:21:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  635) Settlement::City validations is not valid without a location
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:25:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  636) Settlement::City validations is not valid without a name
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:30:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  637) Settlement::City validations is not valid with a negative current population
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:35:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  638) Settlement::City validations is not valid with food_per_person less than or equal to zero
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:40:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  639) Settlement::City validations is not valid with water_per_person less than or equal to zero
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:45:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  640) Settlement::City validations is not valid with energy_per_person less than or equal to zero
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:50:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  641) Settlement::City#resource_requirements calculates resource requirements correctly
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:57:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  642) Settlement::NPCColony can build a unit
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  643) Settlement::NPCColony can establish trade routes
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  644) Settlement::NPCColony can perform autonomous tasks
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  645) Settlement::NPCColony calculates total population across settlements
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  646) Settlement::OrbitalDepot#add_gas handles multiple gas types
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./app/models/settlement/orbital_depot.rb:32:in 'Settlement::OrbitalDepot#add_gas'
       # ./spec/models/settlement/orbital_depot_spec.rb:83:in 'block (3 levels) in <main>'

  647) Settlement::OrbitalDepot#total_gas_mass sums all gas types
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./app/models/settlement/orbital_depot.rb:32:in 'Settlement::OrbitalDepot#add_gas'
       # ./spec/models/settlement/orbital_depot_spec.rb:184:in 'block (3 levels) in <main>'

  648) Settlement::OrbitalDepot#gas_inventory_summary groups by gas name
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./app/models/settlement/orbital_depot.rb:32:in 'Settlement::OrbitalDepot#add_gas'
       # ./spec/models/settlement/orbital_depot_spec.rb:207:in 'block (3 levels) in <main>'

  649) Settlement::OrbitalDepot#depot_status returns comprehensive status hash
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./app/models/settlement/orbital_depot.rb:32:in 'Settlement::OrbitalDepot#add_gas'
       # ./spec/models/settlement/orbital_depot_spec.rb:218:in 'block (3 levels) in <main>'

  650) Settlement::Outpost validations is valid with valid attributes
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  651) Settlement::Outpost validations is not valid without a name
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  652) Settlement::Outpost population capacity calculates total capacity from habitat units
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  653) Settlement::Outpost population capacity calculates available capacity correctly
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  654) Settlement::Outpost population capacity checks if it has capacity for additional population
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  655) Settlement::Settlement validations is valid with valid attributes
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  656) Settlement::Settlement validations is not valid without a name
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  657) Settlement::Settlement population capacity calculates total capacity from habitat units
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  658) Settlement::Settlement population capacity calculates available capacity correctly
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  659) Settlement::Settlement population capacity checks if it has capacity for additional population
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  660) Settlement::SpaceStation model structure inherits from BaseSettlement
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  661) Settlement::SpaceStation model structure includes LifeSupport
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  662) Settlement::SpaceStation model structure includes Docking
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  663) Settlement::SpaceStation model structure includes Shell concern
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  664) Settlement::SpaceStation model structure inherits Enclosable through Shell
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  665) Settlement::SpaceStation validations validates settlement_type is station or outpost
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  666) Settlement::SpaceStation associations 
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  667) Settlement::SpaceStation associations 
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  668) Settlement::SpaceStation associations 
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  669) Settlement::SpaceStation dimensional interface (from Enclosable) #set_dimensions stores dimensions in operational_data
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  670) Settlement::SpaceStation dimensional interface (from Enclosable) #set_dimensions can set diameter for cylindrical stations
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  671) Settlement::SpaceStation dimensional interface (from Enclosable) #area_m2 calculates area for rectangular station
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  672) Settlement::SpaceStation dimensional interface (from Enclosable) #area_m2 calculates area for cylindrical station
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  673) Settlement::SpaceStation dimensional interface (from Enclosable) #calculate_volume calculates volume for rectangular station
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  674) Settlement::SpaceStation dimensional interface (from Enclosable) #calculate_volume calculates volume for cylindrical station
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  675) Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! returns success result with materials and time estimate
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  676) Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! updates status to framework_construction
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  677) Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! accepts custom panel type
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  678) Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! updates shell composition
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  679) Settlement::SpaceStation shell construction workflow (from Shell concern) construction phases advances through construction phases
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  680) Settlement::SpaceStation shell construction workflow (from Shell concern) construction phases creates atmosphere when sealed
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  681) Settlement::SpaceStation shell construction workflow (from Shell concern) construction phases does not initialize default modules when operational
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  682) Settlement::SpaceStation shell construction workflow (from Shell concern) status helpers responds to Shell concern status methods
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  683) Settlement::SpaceStation shell construction workflow (from Shell concern) status helpers checks sealed status correctly
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  684) Settlement::SpaceStation shell construction workflow (from Shell concern) status helpers checks pressurized status correctly
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  685) Settlement::SpaceStation power generation (from Enclosable) calculates power generation from solar panels
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  686) Settlement::SpaceStation power generation (from Enclosable) accounts for panel degradation
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  687) Settlement::SpaceStation power generation (from Enclosable) accounts for failed panels
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  688) Settlement::SpaceStation panel degradation and maintenance (from Enclosable) simulates panel degradation over time
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  689) Settlement::SpaceStation panel degradation and maintenance (from Enclosable) can repair failed panels
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  690) Settlement::SpaceStation panel degradation and maintenance (from Enclosable) can replace degraded panels
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  691) Settlement::SpaceStation panel degradation and maintenance (from Enclosable) provides shell status report
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  692) Settlement::SpaceStation storage capacity management #calculate_storage_capacity returns 0 when no storage units exist
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  693) Settlement::SpaceStation storage capacity management #calculate_storage_capacity sums capacity from all storage units
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  694) Settlement::SpaceStation storage capacity management #calculate_storage_capacity ignores units without storage capacity
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  695) Settlement::SpaceStation storage capacity management #available_capacity returns total capacity when empty
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  696) Settlement::SpaceStation storage capacity management #available_capacity subtracts current inventory mass
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  697) Settlement::SpaceStation storage capacity management #can_store? returns true when sufficient capacity available
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  698) Settlement::SpaceStation storage capacity management #can_store? returns false when insufficient capacity
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  699) Settlement::SpaceStation module management #add_module adds a new module to the station
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  700) Settlement::SpaceStation module management #add_module requires station to be operational
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  701) Settlement::SpaceStation module management module type queries filters modules by type
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  702) Settlement::SpaceStation module management #habitat_capacity sums capacity from all habitat modules
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  703) Settlement::SpaceStation module management #research_efficiency sums efficiency from all lab modules
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  704) Settlement::SpaceStation operational status #fully_operational? requires shell to be operational
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  705) Settlement::SpaceStation operational status #fully_operational? requires habitat modules
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  706) Settlement::SpaceStation operational status #station_status returns comprehensive status
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  707) Settlement::SpaceStation damage and repair can damage modules
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  708) Settlement::SpaceStation damage and repair repairs damaged modules and shell
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  709) Settlement::SpaceStation integration scenarios orbital depot inheriting from space station inherits all Shell/Enclosable functionality
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  710) Settlement::SpaceStation integration scenarios orbital depot inheriting from space station adds depot-specific gas storage
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  711) Settlement::SpaceStation integration scenarios complete station lifecycle goes from planned to fully operational
       Failure/Error:
         described_class.create!(
           name: 'Deimos Station',
           settlement_type: 'station',
           location: orbital_location,
           current_population: 0
         )

       ArgumentError:
         'station' is not a valid settlement_type
       # ./spec/models/settlement/space_station_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/space_station_spec.rb:57:in 'block (2 levels) in <main>'

  712) ShellPrintingJob scopes returns active jobs
       Failure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  713) ShellPrintingJob scopes returns completed jobs
       Failure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  714) ShellPrintingJob scopes returns in_progress jobs
       Failure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  715) ShellPrintingJob#start! changes status to in_progress and sets started_at
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:51:in 'block (4 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:51:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  716) ShellPrintingJob#complete! changes status to completed and sets completed_at
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:57:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  717) ShellPrintingJob#progress_percentage calculates progress percentage
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:67:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  718) ShellPrintingJob#time_remaining_hours calculates remaining time
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:75:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  719) ShellPrintingJob#process_tick when job is not complete increases progress_hours
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:83:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  720) ShellPrintingJob#process_tick when job completes during tick completes the job
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:83:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  721) SolarSystem associations has one spatial_location association
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  722) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  723) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  724) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  725) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  726) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  727) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  728) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  729) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  730) SolarSystem validations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  731) SolarSystem validations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  732) SolarSystem callbacks generates a unique name before create if name is not present
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  733) SolarSystem callbacks sets an initial star after create if no stars exist
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  734) SolarSystem#load_star loads or creates a star with the given parameters
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  735) SolarSystem#load_star updates an existing star if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  736) SolarSystem#load_terrestrial_planet loads or creates a terrestrial planet
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  737) SolarSystem#load_terrestrial_planet updates an existing terrestrial planet if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  738) SolarSystem#load_gas_giant loads or creates a gas giant
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  739) SolarSystem#load_gas_giant updates an existing gas giant if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  740) SolarSystem#load_ice_giant loads or creates an ice giant
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  741) SolarSystem#load_ice_giant updates an existing ice giant if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  742) SolarSystem#load_moon loads or creates a moon
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  743) SolarSystem#load_moon updates an existing moon if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  744) SolarSystem#load_dwarf_planet loads or creates a dwarf planet
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  745) SolarSystem#load_dwarf_planet updates an existing dwarf planet if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  746) SolarSystem#habitable_zone? when a planet is in the habitable zone of at least one star returns true
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  747) SolarSystem#habitable_zone? when a planet is outside the habitable zone of all stars returns false
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  748) SolarSystem#habitable_zone? when there are no stars returns false
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  749) SolarSystem#habitable_zone? when the planet does not have an orbital period returns false
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  750) SolarSystem#total_mass calculates total mass of all planets and dwarf planets
       Failure/Error: let!(:jupiter) { create(:gas_giant, name: "Jupiter", solar_system: solar_system) }

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:256:in 'block (3 levels) in <main>'

  751) SolarSystem star relationships can have multiple stars
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  752) SolarSystem star relationships identifies the primary star by mass
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  753) SolarSystem star relationships supports binary star systems
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  754) Storage::BaseStorage#add_item adds item successfully
       Failure/Error:
           def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}
             Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata
         
             return false unless can_store?(name, amount)
             owner ||= determine_default_owner
         
             if specialized_storage_required?(name)
               store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata
             elsif capacity_exceeded?(amount + total_stored)
               handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata

       ArgumentError:
         wrong number of arguments (given 1, expected 2..4)
       # ./app/models/inventory.rb:18:in 'add_item'
       # ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'
       # ./spec/models/storage/base_storage_spec.rb:10:in 'block (3 levels) in <main>'

  755) Storage::BaseStorage#remove_item removes item successfully
       Failure/Error:
           def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}
             Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata
         
             return false unless can_store?(name, amount)
             owner ||= determine_default_owner
         
             if specialized_storage_required?(name)
               store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata
             elsif capacity_exceeded?(amount + total_stored)
               handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata

       ArgumentError:
         wrong number of arguments (given 1, expected 2..4)
       # ./app/models/inventory.rb:18:in 'add_item'
       # ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'
       # ./spec/models/storage/base_storage_spec.rb:24:in 'block (3 levels) in <main>'

  756) Storage::BaseStorage#remove_item fails to remove item if not enough available
       Failure/Error:
           def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}
             Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata
         
             return false unless can_store?(name, amount)
             owner ||= determine_default_owner
         
             if specialized_storage_required?(name)
               store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata
             elsif capacity_exceeded?(amount + total_stored)
               handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata

       ArgumentError:
         wrong number of arguments (given 1, expected 2..4)
       # ./app/models/inventory.rb:18:in 'add_item'
       # ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'
       # ./spec/models/storage/base_storage_spec.rb:31:in 'block (3 levels) in <main>'

  757) Storage::GasStorage initializes with the correct type
       Failure/Error:
         def initialize(capacity, gas_type, pressure = 1.0) # Default pressure at 1.0 atm
           super(capacity, 'Gas')                        # Specify type as 'Gas'
           @gas_type = gas_type                          # Store the type of gas
           @pressure = pressure                          # Store the pressure

       ArgumentError:
         wrong number of arguments (given 1, expected 2..3)
       # ./app/models/storage/gas_storage.rb:6:in 'initialize'
       # ./spec/models/storage/gas_storage_spec.rb:5:in 'Class#new'
       # ./spec/models/storage/gas_storage_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/storage/gas_storage_spec.rb:8:in 'block (2 levels) in <main>'

  758) Storage::SolidStorage initializes with the correct type
       Failure/Error:
         def initialize(capacity, solid_type)
           super(capacity, 'Solid')                      # Specify type as 'Solid'
           @solid_type = solid_type                      # Store the type of solid
         end

       ArgumentError:
         wrong number of arguments (given 1, expected 2)
       # ./app/models/storage/solid_storage.rb:6:in 'initialize'
       # ./spec/models/storage/solid_storage_spec.rb:5:in 'Class#new'
       # ./spec/models/storage/solid_storage_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/storage/solid_storage_spec.rb:8:in 'block (2 levels) in <main>'

  759) CelestialBodies::TerrestrialPlanet runs TerraSim on planet creation
       Failure/Error: expect_any_instance_of(TerraSim).to receive(:calc_current)
         TerraSim does not implement #calc_current
       # ./spec/models/terrestrial_planets_spec.rb:34:in 'block (2 levels) in <main>'

  760) CelestialBodies::TerrestrialPlanet#update_biomes updates biomes specific to terrestrial planets
       Failure/Error: planet.temperature = -60 # Example temperature for Mars

       NoMethodError:
         undefined method 'temperature=' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet
       # ./spec/models/terrestrial_planets_spec.rb:10:in 'block (3 levels) in <main>'

  761) CelestialBodies::TerrestrialPlanet#add_gas adds gas and updates the mass
       Failure/Error: planet.add_gas('Oxygen', 1000)

       NoMethodError:
         undefined method 'add_gas' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet
       # ./spec/models/terrestrial_planets_spec.rb:20:in 'block (3 levels) in <main>'

  762) CelestialBodies::TerrestrialPlanet#calculate_surface_conditions calculates surface conditions specific to terrestrial planets
       Failure/Error: planet.calculate_surface_conditions

       NoMethodError:
         undefined method 'calculate_surface_conditions' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet
       # ./spec/models/terrestrial_planets_spec.rb:28:in 'block (3 levels) in <main>'

  763) Transaction associations belongs to an account
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:23:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  764) Transaction associations belongs to a recipient
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:28:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  765) Transaction validations requires a transaction_type
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:35:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  766) Transaction validations requires a valid transaction_type
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:41:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  767) Transaction validations requires an amount
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:47:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  768) Transaction validations requires amount to be numeric
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:53:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  769) Transaction transaction types allows deposit transactions
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:61:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  770) Transaction transaction types allows withdraw transactions
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:66:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  771) Transaction transaction types allows transfer transactions
       Failure/Error: let(:account) { create(:account, accountable: player) }

       ActiveRecord::InvalidForeignKey:
         PG::ForeignKeyViolation: ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
         DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/transaction_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:13:in 'block (2 levels) in <main>'
       # ./spec/models/transaction_spec.rb:71:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::ForeignKeyViolation:
       #   ERROR:  insert or update on table "accounts" violates foreign key constraint "fk_rails_dd73f000d2"
       #   DETAIL:  Key (currency_id)=(1) is not present in table "currencies".
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  772) UnitAssemblyJob#materials_gathered? returns false when not all materials are fulfilled
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:41:in 'block (3 levels) in <main>'

  773) UnitAssemblyJob#materials_gathered? returns true when all materials are fulfilled
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:41:in 'block (3 levels) in <main>'

  774) UnitAssemblyJob#materials_gathered? returns true when no material requests exist
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:41:in 'block (3 levels) in <main>'

  775) UnitAssemblyJob#start_assembly starts assembly when materials are gathered
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:86:in 'block (3 levels) in <main>'

  776) UnitAssemblyJob#start_assembly consumes materials from inventory
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:86:in 'block (3 levels) in <main>'

  777) UnitAssemblyJob#start_assembly returns false when not materials_pending status
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:86:in 'block (3 levels) in <main>'

  778) Units::BaseUnit storage operations #store_item stores items in both inventory and operational data
       Failure/Error: expect(storage_unit.store_item('steel_bar', 10)).to be true

         expected true
              got false
       # ./spec/models/units/base_unit_spec.rb:124:in 'block (4 levels) in <main>'

  779) Units::BaseUnit storage operations #store_item updates existing items
       Failure/Error: expect(storage_unit.store_item('steel_bar', 15)).to be true

         expected true
              got false
       # ./spec/models/units/base_unit_spec.rb:141:in 'block (4 levels) in <main>'

  780) Units::Battery interaction with BatteryManagement concern prefers specialized methods over concern methods
       Failure/Error: expect(battery).to receive(:charge_battery).with(20.0)

         (#<Units::Battery id: nil, identifier: "BATTERY_001", name: "Test Battery", unit_type: "satellite_battery", operational_data: {"battery" => {"capacity" => 500.0, "current_charge" => 420.0, "max_charge_rate_kw" => 50.0, "max_discharge_rate_kw" => 75.0, "efficiency" => 0.95}}, location_type: nil, location_id: nil, owner_type: nil, owner_id: nil, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: nil, updated_at: nil>).charge_battery(20.0)
             expected: 1 time with arguments: (20.0)
             received: 0 times
       # ./spec/models/units/battery_spec.rb:107:in 'block (3 levels) in <main>'

  781) Units::WasteTreatmentUnit#operate operates successfully and produces recycled and neutralized output
       Failure/Error:
         Units::WasteTreatmentUnit.new(
           name: 'Basic Waste Treatment Unit',
           material_list: { 'waste' => 30, 'recycled_output' => 15, 'neutralized_output' => 5 },
           energy_cost: 10
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'energy_cost' for Units::WasteTreatmentUnit.
       # ./spec/models/waste_treatment_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/waste_treatment_unit_spec.rb:20:in 'block (3 levels) in <main>'

  782) Units::WasteTreatmentUnit#operate returns false if insufficient waste is available
       Failure/Error:
         Units::WasteTreatmentUnit.new(
           name: 'Basic Waste Treatment Unit',
           material_list: { 'waste' => 30, 'recycled_output' => 15, 'neutralized_output' => 5 },
           energy_cost: 10
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'energy_cost' for Units::WasteTreatmentUnit.
       # ./spec/models/waste_treatment_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/waste_treatment_unit_spec.rb:29:in 'block (3 levels) in <main>'

  783) Units::WasteTreatmentUnit#operate returns false if insufficient power is available
       Failure/Error:
         Units::WasteTreatmentUnit.new(
           name: 'Basic Waste Treatment Unit',
           material_list: { 'waste' => 30, 'recycled_output' => 15, 'neutralized_output' => 5 },
           energy_cost: 10
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'energy_cost' for Units::WasteTreatmentUnit.
       # ./spec/models/waste_treatment_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/waste_treatment_unit_spec.rb:34:in 'block (3 levels) in <main>'

  784) Wormhole associations is expected to have many endpoints class_name => SpatialLocation dependent => destroy
       Failure/Error: it { is_expected.to have_many(:endpoints).class_name('SpatialLocation').dependent(:destroy) }
         Expected Wormhole to have a has_many association called endpoints (endpoints should resolve to SpatialLocation for class_name)
       # ./spec/models/wormhole_spec.rb:44:in 'block (3 levels) in <main>'

  785) Wormhole#stabilization_satellites returns deployed stabilization satellites within range of either endpoint
       Failure/Error: craft = create(:base_craft, :wormhole_stabilizer, owner: player)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/wormhole_spec.rb:88:in 'block (3 levels) in <main>'

  786) Wormhole#operational_stabilizers returns a unique list of operational direct stabilizers and stabilization satellites
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:137:in 'block (3 levels) in <main>'

  787) Wormhole#safe_for_travel? with insufficient operational stabilizers is not safe
       Failure/Error: let!(:stabilizer) { create(:base_craft, stabilizing_wormhole: wormhole) } # Not operational

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/wormhole_spec.rb:228:in 'block (4 levels) in <main>'

  788) Wormhole#safe_for_travel? with enough operational stabilizers is safe
       Failure/Error: let!(:stabilizer1) { create(:base_craft, :operational, stabilizing_wormhole: wormhole) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/wormhole_spec.rb:237:in 'block (4 levels) in <main>'

  789) Wormhole#can_traverse? with sufficient mass limit returns true
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:249:in 'block (3 levels) in <main>'

  790) Wormhole#can_traverse? with insufficient mass limit returns false
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:249:in 'block (3 levels) in <main>'

  791) Wormhole#can_traverse? when one-way and already traversed returns false
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:249:in 'block (3 levels) in <main>'

  792) Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint A when not stabilized and mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  793) Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint B when not stabilized and mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  794) Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint A when mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  795) Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint B when mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  796) Wormhole#stabilization_satellites (integration) returns deployed stabilization satellites within range of either endpoint
       Failure/Error: craft = create(:base_craft, :wormhole_stabilizer, owner: player)

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/wormhole_spec.rb:398:in 'block (3 levels) in <main>'

  797) AIManager::DecisionTree#make_decisions when oxygen is critical calls handle_oxygen_refill and returns
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:17:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  798) AIManager::DecisionTree#make_decisions when account is negative calls handle_debt_repayment and returns
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:31:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  799) AIManager::DecisionTree#make_decisions when no priorities proceeds with normal decision making
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:42:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  800) AIManager::DecisionTree#handle_oxygen_refill calls prioritize_oxygen_refill on resource_planner
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:59:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  801) AIManager::DecisionTree#handle_debt_repayment sets si_ask_ceiling in settlement operational_data
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:72:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  802) AIManager::DecisionTree#handle_mars_oxygen_maintenance calls prioritize_energy_for_o2_generation on resource_planner
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:84:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  803) AIManager::DecisionTree#handle_mars_nitrogen_import finds closest resource source and creates interplanetary contract
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:92:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  804) AIManager::DecisionTree Mars planet-aware crisis handling when O2 crisis on Mars handles O2 crisis through local maintenance, not trade
       Failure/Error: let(:mars_settlement) { create(:base_settlement, :station, location: mars_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:109:in 'block (3 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:117:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  805) AIManager::DecisionTree Mars planet-aware crisis handling when N2 crisis on Mars triggers interplanetary contract based on closest source
       Failure/Error: let(:mars_settlement) { create(:base_settlement, :station, location: mars_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/decision_tree_spec.rb:108:in 'block (3 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:109:in 'block (3 levels) in <main>'
       # ./spec/services/ai_manager/decision_tree_spec.rb:131:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  806) AIManager::OperationalManager#make_decision when stable and expansion is feasible considers expansion
       Failure/Error:
         allow(operational_manager).to receive(:consider_expansion).and_return({
           action: :expansion, pattern: :venus_pattern, reason: :pattern_match
         })

         #<AIManager::OperationalManager:0x00007f7c89999528 @settlement=#<Double "Settlement">, @patterns={callisto_settlement_patterns: {callisto_foothold_settlement: {description: "Callisto foothold - radiation protection, surface mining operations, subsurface resource access", target_world: "callisto", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 390, phases: [{id: "radiation_survey", name: "Radiation Environment Assessment & Site Selection", duration: 120, crew_required: 4, equipment_focus: "radiation_monitoring"}, {id: "surface_mining", name: "Surface Regolith Mining & Processing", duration: 120, crew_required: 6, equipment_focus: "mining_operations"}, {id: "subsurface_exploration", name: "Deep Subsurface Resource Assessment", duration: 90, crew_required: 8, equipment_focus: "deep_drilling"}, {id: "protected_habitation", name: "Radiation-Shielded Habitat & Operations Center", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "mining_rig (2)", "deep_drill (2)", "radiation_shield_generator (2)"], units: ["shielded_habitat (2)", "regolith_processor (2)", "drilling_platform (1)", "radiation_monitor (3)"]}, inventory: {deployable_units: ["mining_drill (2)", "radiation_sensor (4)", "surface_rover (2)", "orbital_radiation_mapper (1)"], supplies: ["enriched_uranium_fuel (3500 kilogram)", "shielding_materials (1200 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["surface_regolith", "subsurface_ice", "silicate_materials", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "heavy_shielding", "mining_equipment"], construction_materials: ["radiation_shielding", "reinforced_structures", "cryogenic_storage"], estimated_import_timeline: 390}, isru_capabilities: {oxygen_production_rate: 20, hydrogen_production_rate: 15, water_production_rate: 30, power_generation: 400}}, economic_model: {estimated_cost: 4800000, import_ratio: 0.55, revenue_streams: ["rare_materials", "radiation_research", "mining_exports"], break_even_timeline: 780}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 22, expansion_triggers: ["radiation_shielding_verified", "mining_operations_stable"], population_sources: ["earth_mining_engineers", "ganymede_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 8000, challenges: ["extreme_radiation", "surface_instability", "resource_scarcity", "thermal_extremes"]}}}, ceres_settlement_patterns: {ceres_foothold_settlement: {description: "Ceres foothold - water ice mining, nickel-iron ore extraction, asteroid belt coordination hub", target_world: "ceres", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 200, phases: [{id: "resource_survey", name: "Asteroid Resource Survey & Mining Site Selection", duration: 40, crew_required: 4, equipment_focus: "geological_survey"}, {id: "water_ice_extraction", name: "Water Ice Mining & Cryogenic Storage", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ore_processing", name: "Nickel-Iron Ore Extraction & Processing", duration: 50, crew_required: 5, equipment_focus: "ore_processing"}, {id: "belt_coordination", name: "Asteroid Belt Operations Center & Trade Hub", duration: 50, crew_required: 8, equipment_focus: "coordination_hub"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "water_extractor (4)", "ore_processor (3)", "cryogenic_storage (2)"], units: ["modular_habitat_unit (2)", "ice_drilling_rig (2)", "ore_mining_rig (2)", "belt_communications_array (1)"]}, inventory: {deployable_units: ["geological_scanner (3)", "mining_drone (4)", "orbital_scanner_satellite (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "hydrogen_stores (300 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, economic_model: {estimated_gcc_cost: 850000, local_production_ratio: 0.75, revenue_streams: [{resource: "water_ice", volume: "high", market_value: "medium", trade_partners: ["mars_development_corporation", "vesta_development_corporation"]}, {resource: "nickel_iron_ore", volume: "high", market_value: "high", trade_partners: ["mars_development_corporation", "earth_development_corporation"]}], operational_costs: {power: "nuclear", maintenance: "medium", crew_rotation: "quarterly"}}, environmental_considerations: {gravity: "microgravity", atmosphere: "none", temperature: "cryogenic", radiation: "high", dust: "significant", challenges: ["microgravity_operations", "thermal_management", "dust_contamination"], advantages: ["abundant_water_ice", "rich_mineral_deposits", "strategic_belt_position"]}, expansion_potential: {follow_on_settlements: ["ceres_main_base", "belt_mining_outposts"], regional_influence: "asteroid_belt_coordination", strategic_value: "resource_extraction_hub"}}}, europa_settlement_patterns: {europa_foothold_settlement: {description: "Europa foothold - subsurface ocean access, ice drilling operations, astrobiology research", target_world: "europa", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 360, phases: [{id: "surface_analysis", name: "Surface Geology Analysis & Landing Site Selection", duration: 90, crew_required: 4, equipment_focus: "geological_survey"}, {id: "ice_penetration", name: "Ice Sheet Drilling & Subsurface Access", duration: 120, crew_required: 6, equipment_focus: "ice_drilling"}, {id: "ocean_sampling", name: "Subsurface Ocean Exploration & Sampling", duration: 90, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "research_station", name: "Permanent Research Station & Long-Term Monitoring", duration: 60, crew_required: 12, equipment_focus: "research_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "ice_drilling_rig (2)", "ocean_probe (3)", "radiation_shielded_habitat (2)"], units: ["cryogenic_habitat (2)", "drilling_platform (1)", "ocean_sampler (2)", "seismic_monitor (1)"]}, inventory: {deployable_units: ["ice_penetrator (2)", "ocean_rover (1)", "seismic_sensor (3)", "radiation_monitor (2)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "thermal_drilling_bits (50)"], consumables: ["oxygen (5000 kilogram)", "water (20000 kilogram)", "food (5000 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "geological_heat", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "thermal_drilling_equipment", "radiation_shielding"], construction_materials: ["radiation_shielding", "cryogenic_materials", "pressure_vessels"], estimated_import_timeline: 360}, isru_capabilities: {oxygen_production_rate: 25, hydrogen_production_rate: 20, water_production_rate: 40, power_generation: 350}}, economic_model: {estimated_cost: 5500000, import_ratio: 0.65, revenue_streams: ["scientific_discoveries", "ocean_data", "water_exports"], break_even_timeline: 720}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["ocean_access_established", "radiation_protection_verified"], population_sources: ["earth_astrobiologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 10000, challenges: ["extreme_radiation", "cryogenic_surface", "ocean_pressure", "ice_instability"]}}}, ganymede_settlement_patterns: {ganymede_foothold_settlement: {description: "Ganymede foothold - magnetic field protection, subsurface ocean exploration, ice resource utilization", target_world: "ganymede", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 330, phases: [{id: "magnetic_analysis", name: "Magnetic Field Analysis & Radiation Assessment", duration: 75, crew_required: 4, equipment_focus: "magnetic_survey"}, {id: "ice_resource_development", name: "Surface Ice Mining & Resource Processing", duration: 90, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ocean_penetration", name: "Subsurface Ocean Access & Exploration", duration: 105, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "permanent_base", name: "Magnetic-Shielded Base & Scientific Operations", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "ice_mining_rig (2)", "ocean_drilling_system (2)", "magnetic_shield_generator (1)"], units: ["radiation_shielded_habitat (2)", "ice_processor (2)", "ocean_probe (2)", "magnetic_monitor (1)"]}, inventory: {deployable_units: ["ice_drill (2)", "ocean_sampler (2)", "magnetic_sensor (3)", "radiation_detector (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "shielding_materials (800 kilogram)"], consumables: ["oxygen (4500 kilogram)", "water (18000 kilogram)", "food (4500 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "magnetic_field", "silicate_materials"], import_requirements: {critical_imports: ["hydrogen", "magnetic_shielding", "deep_drilling_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels", "cryogenic_materials"], estimated_import_timeline: 330}, isru_capabilities: {oxygen_production_rate: 30, hydrogen_production_rate: 25, water_production_rate: 35, power_generation: 300}}, economic_model: {estimated_cost: 5000000, import_ratio: 0.6, revenue_streams: ["magnetic_research", "ocean_discoveries", "ice_resources"], break_even_timeline: 660}, population_model: {initial_population: 12, growth_rate: "moderate", support_capacity: 25, expansion_triggers: ["magnetic_shielding_verified", "ocean_access_established"], population_sources: ["earth_magnetic_specialists", "europa_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4000, challenges: ["radiation_environment", "cryogenic_conditions", "ocean_depth", "magnetic_interference"]}}}, io_settlement_patterns: {io_foothold_settlement: {description: "Io foothold - geothermal energy utilization, sulfur processing, volcanic activity monitoring", target_world: "io", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 420, phases: [{id: "volcanic_assessment", name: "Volcanic Activity Analysis & Safe Zone Identification", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "geothermal_harvesting", name: "Geothermal Energy Extraction & Power Generation", duration: 120, crew_required: 6, equipment_focus: "energy_systems"}, {id: "sulfur_processing", name: "Sulfur Compound Mining & Processing", duration: 90, crew_required: 8, equipment_focus: "chemical_processing"}, {id: "thermal_habitation", name: "Heat-Shielded Habitat & Research Operations", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["geothermal_power_plant (3)", "heat_shield_generator (2)", "sulfur_processor (2)", "volcanic_monitor (3)"], units: ["thermal_habitat (2)", "geothermal_drill (2)", "chemical_reactor (2)", "seismic_sensor (2)"]}, inventory: {deployable_units: ["volcanic_probe (3)", "heat_shield (4)", "sulfur_extractor (2)", "thermal_rover (1)"], supplies: ["thermal_insulation (1500 kilogram)", "corrosion_resistant_materials (800 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (14000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["geothermal_energy", "sulfur_compounds", "volcanic_gases", "surface_materials"], import_requirements: {critical_imports: ["hydrogen", "extreme_heat_shielding", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "heat_resistant_alloys", "radiation_shielding"], estimated_import_timeline: 420}, isru_capabilities: {oxygen_production_rate: 15, sulfur_production_rate: 40, hydrogen_production_rate: 10, power_generation: 500}}, economic_model: {estimated_cost: 6500000, import_ratio: 0.75, revenue_streams: ["geothermal_energy", "sulfur_exports", "volcanic_research"], break_even_timeline: 840}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 18, expansion_triggers: ["thermal_protection_verified", "geothermal_stability_confirmed"], population_sources: ["earth_volcanologists", "venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 6000, challenges: ["extreme_temperatures", "volcanic_activity", "radiation", "corrosive_environment"]}}}, luna_settlement_patterns: {luna_foothold_settlement: {description: "Minimal lunar foothold - survey, ISRU oxygen/water, basic habitat", target_world: "luna", priority: "foothold", phase_structure: {total_phases: 3, estimated_total_duration: 180, phases: [{id: "survey_deployment", name: "Orbital Survey & Landing Site Selection", duration: 30, crew_required: 2, equipment_focus: "remote_sensing"}, {id: "isru_establishment", name: "ISRU Oxygen & Water Production Setup", duration: 60, crew_required: 4, equipment_focus: "resource_extraction"}, {id: "minimal_habitation", name: "Basic Crew Habitat & Life Support", duration: 90, crew_required: 6, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "oxygen_generator (3)", "water_extractor (2)"], units: ["modular_habitat_unit (2)", "regolith_processor (1)", "helium3_mining_rig (1)"]}, inventory: {deployable_units: ["orbital_survey_satellite (1)", "surface_rover (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, resource_dependencies: {local_resources_required: ["regolith", "water_ice", "helium3"], import_requirements: {critical_imports: ["oxygen", "water", "food"], construction_materials: ["structural_materials"], estimated_import_timeline: 180}, isru_capabilities: {oxygen_production_rate: 25, water_production_rate: 15, power_generation: 200}}, economic_model: {estimated_cost: 2500000, import_ratio: 0.4, revenue_streams: ["helium3_sales", "research_data"], break_even_timeline: 360}, population_model: {initial_population: 6, growth_rate: "slow", support_capacity: 12, expansion_triggers: ["isru_self_sufficiency", "helium3_exports"], population_sources: ["earth_transfers", "trained_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 720}}}, mars_settlement_patterns: {mars_foothold_settlement: {description: "Mars foothold - atmospheric CO2 utilization, regolith processing, subsurface water access", target_world: "mars", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 240, phases: [{id: "atmospheric_analysis", name: "Atmospheric Composition Analysis & Site Selection", duration: 45, crew_required: 3, equipment_focus: "atmospheric_science"}, {id: "co2_isru_setup", name: "CO2 Sabatier Process & Oxygen Production", duration: 75, crew_required: 5, equipment_focus: "chemical_processing"}, {id: "water_ice_mining", name: "Subsurface Water Ice Mining & Purification", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "surface_habitation", name: "Pressurized Habitat & Radiation Protection", duration: 60, crew_required: 8, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "sabatier_reactor (2)", "atmospheric_processor (2)", "water_extractor (3)"], units: ["modular_habitat_unit (3)", "radiation_shielded_habitat (1)", "ice_drilling_rig (1)", "regolith_processor (2)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "surface_rover (2)", "orbital_weather_satellite (1)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "hydrogen_stores (500 kilogram)"], consumables: ["oxygen (3000 kilogram)", "water (12000 kilogram)", "food (3000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "water_ice", "regolith", "solar_energy"], import_requirements: {critical_imports: ["hydrogen", "specialized_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels"], estimated_import_timeline: 240}, isru_capabilities: {oxygen_production_rate: 40, water_production_rate: 25, methane_production_rate: 15, power_generation: 300}}, economic_model: {estimated_cost: 4000000, import_ratio: 0.5, revenue_streams: ["methane_fuel_sales", "scientific_data", "water_exports"], break_even_timeline: 480}, population_model: {initial_population: 8, growth_rate: "moderate", support_capacity: 20, expansion_triggers: ["atmospheric_self_sufficiency", "water_independence"], population_sources: ["earth_transfers", "luna_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 2400, challenges: ["thin_atmosphere", "radiation", "dust_storms"]}}}, titan_settlement_patterns: {titan_foothold_settlement: {description: "Titan foothold - hydrocarbon lake utilization, cryogenic processing, methane atmosphere operations", target_world: "titan", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 270, phases: [{id: "atmospheric_descent", name: "Atmospheric Descent & Surface Site Selection", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "hydrocarbon_processing", name: "Methane/Ethane Extraction & Processing", duration: 90, crew_required: 6, equipment_focus: "cryogenic_processing"}, {id: "lake_exploration", name: "Hydrocarbon Lake Survey & Resource Assessment", duration: 75, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_habitation", name: "Cryogenic Habitat & Long-Term Operations", duration: 45, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "methane_processor (3)", "cryogenic_extractor (2)", "atmospheric_heater (2)"], units: ["cryogenic_habitat (2)", "lake_sampling_rig (1)", "methane_refinery (2)", "surface_rover (3)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "cryogenic_drill (1)", "methane_sensor (3)", "orbital_imager (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "thermal_insulation (500 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (10000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["methane_atmosphere", "ethane_lakes", "nitrogen_atmosphere", "cryogenic_ice"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 270}, isru_capabilities: {methane_production_rate: 35, oxygen_production_rate: 20, hydrogen_production_rate: 15, power_generation: 250}}, economic_model: {estimated_cost: 4500000, import_ratio: 0.6, revenue_streams: ["hydrocarbon_exports", "cryogenic_research", "methane_fuel"], break_even_timeline: 540}, population_model: {initial_population: 10, growth_rate: "moderate", support_capacity: 30, expansion_triggers: ["hydrocarbon_self_sufficiency", "cryogenic_habitation_stability"], population_sources: ["earth_scientists", "mars_venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 3000, challenges: ["cryogenic_temperatures", "toxic_atmosphere", "low_gravity", "dust_storms"]}}}, triton_settlement_patterns: {triton_foothold_settlement: {description: "Triton foothold - cryovolcanic activity, nitrogen atmosphere utilization, geyser monitoring", target_world: "triton", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 450, phases: [{id: "cryovolcanic_survey", name: "Cryovolcanic Activity Analysis & Landing Assessment", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "nitrogen_processing", name: "Atmospheric Nitrogen Capture & Processing", duration: 120, crew_required: 6, equipment_focus: "atmospheric_processing"}, {id: "surface_exploration", name: "Geyser Field Survey & Resource Mapping", duration: 120, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_operations", name: "Cryogenic Habitat & Long-Term Research", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "nitrogen_processor (2)", "cryogenic_extractor (2)", "geyser_monitor (2)"], units: ["cryogenic_habitat (2)", "atmospheric_collector (2)", "surface_rover (2)", "thermal_sensor (3)"]}, inventory: {deployable_units: ["cryovolcanic_probe (2)", "nitrogen_harvester (2)", "geyser_sampler (1)", "orbital_mapper (1)"], supplies: ["thermal_insulation (1000 kilogram)", "cryogenic_fluids (500 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["nitrogen_atmosphere", "water_ice", "cryovolcanic_materials", "geyser_vapors"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "cryogenic_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 450}, isru_capabilities: {oxygen_production_rate: 20, nitrogen_production_rate: 35, hydrogen_production_rate: 15, power_generation: 280}}, economic_model: {estimated_cost: 5200000, import_ratio: 0.65, revenue_streams: ["cryovolcanic_research", "nitrogen_exports", "geyser_data"], break_even_timeline: 900}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["cryogenic_systems_stable", "nitrogen_self_sufficiency"], population_sources: ["earth_cryovolcanologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4500, challenges: ["extreme_cold", "thin_atmosphere", "cryovolcanic_activity", "orbital_instability"]}}}, venus_settlement_patterns: {venus_foothold_settlement: {description: "Venus foothold - high-altitude floating habitats, CO2 processing, extreme temperature operations", target_world: "venus", priority: "foothold", phase_structure: {total_phases: 5, estimated_total_duration: 300, phases: [{id: "atmospheric_entry", name: "Atmospheric Entry & High-Altitude Station Establishment", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "floating_platform_deployment", name: "Aerostat Platform Deployment & Stabilization", duration: 90, crew_required: 6, equipment_focus: "aerostat_technology"}, {id: "co2_utilization", name: "CO2 Separation & Resource Extraction", duration: 75, crew_required: 8, equipment_focus: "chemical_separation"}, {id: "energy_harvesting", name: "Solar Energy Collection & Power Distribution", duration: 45, crew_required: 7, equipment_focus: "energy_systems"}, {id: "expanded_operations", name: "Multi-Platform Network & Research Operations", duration: 30, crew_required: 10, equipment_focus: "network_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "co2_separator (3)", "aerostat_platform (4)", "atmospheric_processor (2)"], units: ["floating_habitat (2)", "energy_collection_array (3)", "chemical_reactor (2)", "communication_relay (1)"]}, inventory: {deployable_units: ["atmospheric_probe (3)", "aerostat_balloon (4)", "solar_collector (6)", "weather_satellite (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "specialized_alloys (1000 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (15000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "sulfuric_acid_vapors", "solar_energy", "atmospheric_pressure"], import_requirements: {critical_imports: ["hydrogen", "heat_shielding", "corrosion_resistant_materials"], construction_materials: ["titanium_alloys", "ceramic_composites", "radiation_shielding"], estimated_import_timeline: 300}, isru_capabilities: {oxygen_production_rate: 30, sulfur_production_rate: 20, carbon_production_rate: 25, power_generation: 400}}, economic_model: {estimated_cost: 6000000, import_ratio: 0.7, revenue_streams: ["rare_materials", "atmospheric_data", "energy_exports"], break_even_timeline: 600}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 25, expansion_triggers: ["atmospheric_self_sufficiency", "platform_network_stability"], population_sources: ["earth_specialists", "mars_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 5000, challenges: ["extreme_temperatures", "corrosive_atmosphere", "high_pressure", "acid_clouds"]}}}}, @priorities=#<AIManager::AiPrioritySystem:0x00007f7c8d6e08c8 @last_check=Sun, 11 Jan 2026 23:32:02.073871003 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f7c8d6e03f0 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f7c89cd98a0 @settlement_id=1, @decision_history=[{timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:26:59 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:26:59 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:27:00 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:27:00 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion
       # ./spec/services/ai_manager/operational_manager_spec.rb:54:in 'block (4 levels) in <main>'

  807) AIManager::OperationalManager#make_decision when stable with no expansion opportunities maintains current operations
       Failure/Error:
         allow(operational_manager).to receive(:consider_expansion).and_return({
           action: :maintain, reason: :no_suitable_expansion
         })

         #<AIManager::OperationalManager:0x00007f7c8a140240 @settlement=#<Double "Settlement">, @patterns={callisto_settlement_patterns: {callisto_foothold_settlement: {description: "Callisto foothold - radiation protection, surface mining operations, subsurface resource access", target_world: "callisto", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 390, phases: [{id: "radiation_survey", name: "Radiation Environment Assessment & Site Selection", duration: 120, crew_required: 4, equipment_focus: "radiation_monitoring"}, {id: "surface_mining", name: "Surface Regolith Mining & Processing", duration: 120, crew_required: 6, equipment_focus: "mining_operations"}, {id: "subsurface_exploration", name: "Deep Subsurface Resource Assessment", duration: 90, crew_required: 8, equipment_focus: "deep_drilling"}, {id: "protected_habitation", name: "Radiation-Shielded Habitat & Operations Center", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "mining_rig (2)", "deep_drill (2)", "radiation_shield_generator (2)"], units: ["shielded_habitat (2)", "regolith_processor (2)", "drilling_platform (1)", "radiation_monitor (3)"]}, inventory: {deployable_units: ["mining_drill (2)", "radiation_sensor (4)", "surface_rover (2)", "orbital_radiation_mapper (1)"], supplies: ["enriched_uranium_fuel (3500 kilogram)", "shielding_materials (1200 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["surface_regolith", "subsurface_ice", "silicate_materials", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "heavy_shielding", "mining_equipment"], construction_materials: ["radiation_shielding", "reinforced_structures", "cryogenic_storage"], estimated_import_timeline: 390}, isru_capabilities: {oxygen_production_rate: 20, hydrogen_production_rate: 15, water_production_rate: 30, power_generation: 400}}, economic_model: {estimated_cost: 4800000, import_ratio: 0.55, revenue_streams: ["rare_materials", "radiation_research", "mining_exports"], break_even_timeline: 780}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 22, expansion_triggers: ["radiation_shielding_verified", "mining_operations_stable"], population_sources: ["earth_mining_engineers", "ganymede_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 8000, challenges: ["extreme_radiation", "surface_instability", "resource_scarcity", "thermal_extremes"]}}}, ceres_settlement_patterns: {ceres_foothold_settlement: {description: "Ceres foothold - water ice mining, nickel-iron ore extraction, asteroid belt coordination hub", target_world: "ceres", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 200, phases: [{id: "resource_survey", name: "Asteroid Resource Survey & Mining Site Selection", duration: 40, crew_required: 4, equipment_focus: "geological_survey"}, {id: "water_ice_extraction", name: "Water Ice Mining & Cryogenic Storage", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ore_processing", name: "Nickel-Iron Ore Extraction & Processing", duration: 50, crew_required: 5, equipment_focus: "ore_processing"}, {id: "belt_coordination", name: "Asteroid Belt Operations Center & Trade Hub", duration: 50, crew_required: 8, equipment_focus: "coordination_hub"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "water_extractor (4)", "ore_processor (3)", "cryogenic_storage (2)"], units: ["modular_habitat_unit (2)", "ice_drilling_rig (2)", "ore_mining_rig (2)", "belt_communications_array (1)"]}, inventory: {deployable_units: ["geological_scanner (3)", "mining_drone (4)", "orbital_scanner_satellite (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "hydrogen_stores (300 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, economic_model: {estimated_gcc_cost: 850000, local_production_ratio: 0.75, revenue_streams: [{resource: "water_ice", volume: "high", market_value: "medium", trade_partners: ["mars_development_corporation", "vesta_development_corporation"]}, {resource: "nickel_iron_ore", volume: "high", market_value: "high", trade_partners: ["mars_development_corporation", "earth_development_corporation"]}], operational_costs: {power: "nuclear", maintenance: "medium", crew_rotation: "quarterly"}}, environmental_considerations: {gravity: "microgravity", atmosphere: "none", temperature: "cryogenic", radiation: "high", dust: "significant", challenges: ["microgravity_operations", "thermal_management", "dust_contamination"], advantages: ["abundant_water_ice", "rich_mineral_deposits", "strategic_belt_position"]}, expansion_potential: {follow_on_settlements: ["ceres_main_base", "belt_mining_outposts"], regional_influence: "asteroid_belt_coordination", strategic_value: "resource_extraction_hub"}}}, europa_settlement_patterns: {europa_foothold_settlement: {description: "Europa foothold - subsurface ocean access, ice drilling operations, astrobiology research", target_world: "europa", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 360, phases: [{id: "surface_analysis", name: "Surface Geology Analysis & Landing Site Selection", duration: 90, crew_required: 4, equipment_focus: "geological_survey"}, {id: "ice_penetration", name: "Ice Sheet Drilling & Subsurface Access", duration: 120, crew_required: 6, equipment_focus: "ice_drilling"}, {id: "ocean_sampling", name: "Subsurface Ocean Exploration & Sampling", duration: 90, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "research_station", name: "Permanent Research Station & Long-Term Monitoring", duration: 60, crew_required: 12, equipment_focus: "research_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "ice_drilling_rig (2)", "ocean_probe (3)", "radiation_shielded_habitat (2)"], units: ["cryogenic_habitat (2)", "drilling_platform (1)", "ocean_sampler (2)", "seismic_monitor (1)"]}, inventory: {deployable_units: ["ice_penetrator (2)", "ocean_rover (1)", "seismic_sensor (3)", "radiation_monitor (2)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "thermal_drilling_bits (50)"], consumables: ["oxygen (5000 kilogram)", "water (20000 kilogram)", "food (5000 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "geological_heat", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "thermal_drilling_equipment", "radiation_shielding"], construction_materials: ["radiation_shielding", "cryogenic_materials", "pressure_vessels"], estimated_import_timeline: 360}, isru_capabilities: {oxygen_production_rate: 25, hydrogen_production_rate: 20, water_production_rate: 40, power_generation: 350}}, economic_model: {estimated_cost: 5500000, import_ratio: 0.65, revenue_streams: ["scientific_discoveries", "ocean_data", "water_exports"], break_even_timeline: 720}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["ocean_access_established", "radiation_protection_verified"], population_sources: ["earth_astrobiologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 10000, challenges: ["extreme_radiation", "cryogenic_surface", "ocean_pressure", "ice_instability"]}}}, ganymede_settlement_patterns: {ganymede_foothold_settlement: {description: "Ganymede foothold - magnetic field protection, subsurface ocean exploration, ice resource utilization", target_world: "ganymede", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 330, phases: [{id: "magnetic_analysis", name: "Magnetic Field Analysis & Radiation Assessment", duration: 75, crew_required: 4, equipment_focus: "magnetic_survey"}, {id: "ice_resource_development", name: "Surface Ice Mining & Resource Processing", duration: 90, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ocean_penetration", name: "Subsurface Ocean Access & Exploration", duration: 105, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "permanent_base", name: "Magnetic-Shielded Base & Scientific Operations", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "ice_mining_rig (2)", "ocean_drilling_system (2)", "magnetic_shield_generator (1)"], units: ["radiation_shielded_habitat (2)", "ice_processor (2)", "ocean_probe (2)", "magnetic_monitor (1)"]}, inventory: {deployable_units: ["ice_drill (2)", "ocean_sampler (2)", "magnetic_sensor (3)", "radiation_detector (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "shielding_materials (800 kilogram)"], consumables: ["oxygen (4500 kilogram)", "water (18000 kilogram)", "food (4500 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "magnetic_field", "silicate_materials"], import_requirements: {critical_imports: ["hydrogen", "magnetic_shielding", "deep_drilling_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels", "cryogenic_materials"], estimated_import_timeline: 330}, isru_capabilities: {oxygen_production_rate: 30, hydrogen_production_rate: 25, water_production_rate: 35, power_generation: 300}}, economic_model: {estimated_cost: 5000000, import_ratio: 0.6, revenue_streams: ["magnetic_research", "ocean_discoveries", "ice_resources"], break_even_timeline: 660}, population_model: {initial_population: 12, growth_rate: "moderate", support_capacity: 25, expansion_triggers: ["magnetic_shielding_verified", "ocean_access_established"], population_sources: ["earth_magnetic_specialists", "europa_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4000, challenges: ["radiation_environment", "cryogenic_conditions", "ocean_depth", "magnetic_interference"]}}}, io_settlement_patterns: {io_foothold_settlement: {description: "Io foothold - geothermal energy utilization, sulfur processing, volcanic activity monitoring", target_world: "io", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 420, phases: [{id: "volcanic_assessment", name: "Volcanic Activity Analysis & Safe Zone Identification", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "geothermal_harvesting", name: "Geothermal Energy Extraction & Power Generation", duration: 120, crew_required: 6, equipment_focus: "energy_systems"}, {id: "sulfur_processing", name: "Sulfur Compound Mining & Processing", duration: 90, crew_required: 8, equipment_focus: "chemical_processing"}, {id: "thermal_habitation", name: "Heat-Shielded Habitat & Research Operations", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["geothermal_power_plant (3)", "heat_shield_generator (2)", "sulfur_processor (2)", "volcanic_monitor (3)"], units: ["thermal_habitat (2)", "geothermal_drill (2)", "chemical_reactor (2)", "seismic_sensor (2)"]}, inventory: {deployable_units: ["volcanic_probe (3)", "heat_shield (4)", "sulfur_extractor (2)", "thermal_rover (1)"], supplies: ["thermal_insulation (1500 kilogram)", "corrosion_resistant_materials (800 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (14000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["geothermal_energy", "sulfur_compounds", "volcanic_gases", "surface_materials"], import_requirements: {critical_imports: ["hydrogen", "extreme_heat_shielding", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "heat_resistant_alloys", "radiation_shielding"], estimated_import_timeline: 420}, isru_capabilities: {oxygen_production_rate: 15, sulfur_production_rate: 40, hydrogen_production_rate: 10, power_generation: 500}}, economic_model: {estimated_cost: 6500000, import_ratio: 0.75, revenue_streams: ["geothermal_energy", "sulfur_exports", "volcanic_research"], break_even_timeline: 840}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 18, expansion_triggers: ["thermal_protection_verified", "geothermal_stability_confirmed"], population_sources: ["earth_volcanologists", "venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 6000, challenges: ["extreme_temperatures", "volcanic_activity", "radiation", "corrosive_environment"]}}}, luna_settlement_patterns: {luna_foothold_settlement: {description: "Minimal lunar foothold - survey, ISRU oxygen/water, basic habitat", target_world: "luna", priority: "foothold", phase_structure: {total_phases: 3, estimated_total_duration: 180, phases: [{id: "survey_deployment", name: "Orbital Survey & Landing Site Selection", duration: 30, crew_required: 2, equipment_focus: "remote_sensing"}, {id: "isru_establishment", name: "ISRU Oxygen & Water Production Setup", duration: 60, crew_required: 4, equipment_focus: "resource_extraction"}, {id: "minimal_habitation", name: "Basic Crew Habitat & Life Support", duration: 90, crew_required: 6, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "oxygen_generator (3)", "water_extractor (2)"], units: ["modular_habitat_unit (2)", "regolith_processor (1)", "helium3_mining_rig (1)"]}, inventory: {deployable_units: ["orbital_survey_satellite (1)", "surface_rover (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, resource_dependencies: {local_resources_required: ["regolith", "water_ice", "helium3"], import_requirements: {critical_imports: ["oxygen", "water", "food"], construction_materials: ["structural_materials"], estimated_import_timeline: 180}, isru_capabilities: {oxygen_production_rate: 25, water_production_rate: 15, power_generation: 200}}, economic_model: {estimated_cost: 2500000, import_ratio: 0.4, revenue_streams: ["helium3_sales", "research_data"], break_even_timeline: 360}, population_model: {initial_population: 6, growth_rate: "slow", support_capacity: 12, expansion_triggers: ["isru_self_sufficiency", "helium3_exports"], population_sources: ["earth_transfers", "trained_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 720}}}, mars_settlement_patterns: {mars_foothold_settlement: {description: "Mars foothold - atmospheric CO2 utilization, regolith processing, subsurface water access", target_world: "mars", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 240, phases: [{id: "atmospheric_analysis", name: "Atmospheric Composition Analysis & Site Selection", duration: 45, crew_required: 3, equipment_focus: "atmospheric_science"}, {id: "co2_isru_setup", name: "CO2 Sabatier Process & Oxygen Production", duration: 75, crew_required: 5, equipment_focus: "chemical_processing"}, {id: "water_ice_mining", name: "Subsurface Water Ice Mining & Purification", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "surface_habitation", name: "Pressurized Habitat & Radiation Protection", duration: 60, crew_required: 8, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "sabatier_reactor (2)", "atmospheric_processor (2)", "water_extractor (3)"], units: ["modular_habitat_unit (3)", "radiation_shielded_habitat (1)", "ice_drilling_rig (1)", "regolith_processor (2)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "surface_rover (2)", "orbital_weather_satellite (1)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "hydrogen_stores (500 kilogram)"], consumables: ["oxygen (3000 kilogram)", "water (12000 kilogram)", "food (3000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "water_ice", "regolith", "solar_energy"], import_requirements: {critical_imports: ["hydrogen", "specialized_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels"], estimated_import_timeline: 240}, isru_capabilities: {oxygen_production_rate: 40, water_production_rate: 25, methane_production_rate: 15, power_generation: 300}}, economic_model: {estimated_cost: 4000000, import_ratio: 0.5, revenue_streams: ["methane_fuel_sales", "scientific_data", "water_exports"], break_even_timeline: 480}, population_model: {initial_population: 8, growth_rate: "moderate", support_capacity: 20, expansion_triggers: ["atmospheric_self_sufficiency", "water_independence"], population_sources: ["earth_transfers", "luna_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 2400, challenges: ["thin_atmosphere", "radiation", "dust_storms"]}}}, titan_settlement_patterns: {titan_foothold_settlement: {description: "Titan foothold - hydrocarbon lake utilization, cryogenic processing, methane atmosphere operations", target_world: "titan", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 270, phases: [{id: "atmospheric_descent", name: "Atmospheric Descent & Surface Site Selection", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "hydrocarbon_processing", name: "Methane/Ethane Extraction & Processing", duration: 90, crew_required: 6, equipment_focus: "cryogenic_processing"}, {id: "lake_exploration", name: "Hydrocarbon Lake Survey & Resource Assessment", duration: 75, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_habitation", name: "Cryogenic Habitat & Long-Term Operations", duration: 45, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "methane_processor (3)", "cryogenic_extractor (2)", "atmospheric_heater (2)"], units: ["cryogenic_habitat (2)", "lake_sampling_rig (1)", "methane_refinery (2)", "surface_rover (3)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "cryogenic_drill (1)", "methane_sensor (3)", "orbital_imager (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "thermal_insulation (500 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (10000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["methane_atmosphere", "ethane_lakes", "nitrogen_atmosphere", "cryogenic_ice"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 270}, isru_capabilities: {methane_production_rate: 35, oxygen_production_rate: 20, hydrogen_production_rate: 15, power_generation: 250}}, economic_model: {estimated_cost: 4500000, import_ratio: 0.6, revenue_streams: ["hydrocarbon_exports", "cryogenic_research", "methane_fuel"], break_even_timeline: 540}, population_model: {initial_population: 10, growth_rate: "moderate", support_capacity: 30, expansion_triggers: ["hydrocarbon_self_sufficiency", "cryogenic_habitation_stability"], population_sources: ["earth_scientists", "mars_venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 3000, challenges: ["cryogenic_temperatures", "toxic_atmosphere", "low_gravity", "dust_storms"]}}}, triton_settlement_patterns: {triton_foothold_settlement: {description: "Triton foothold - cryovolcanic activity, nitrogen atmosphere utilization, geyser monitoring", target_world: "triton", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 450, phases: [{id: "cryovolcanic_survey", name: "Cryovolcanic Activity Analysis & Landing Assessment", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "nitrogen_processing", name: "Atmospheric Nitrogen Capture & Processing", duration: 120, crew_required: 6, equipment_focus: "atmospheric_processing"}, {id: "surface_exploration", name: "Geyser Field Survey & Resource Mapping", duration: 120, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_operations", name: "Cryogenic Habitat & Long-Term Research", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "nitrogen_processor (2)", "cryogenic_extractor (2)", "geyser_monitor (2)"], units: ["cryogenic_habitat (2)", "atmospheric_collector (2)", "surface_rover (2)", "thermal_sensor (3)"]}, inventory: {deployable_units: ["cryovolcanic_probe (2)", "nitrogen_harvester (2)", "geyser_sampler (1)", "orbital_mapper (1)"], supplies: ["thermal_insulation (1000 kilogram)", "cryogenic_fluids (500 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["nitrogen_atmosphere", "water_ice", "cryovolcanic_materials", "geyser_vapors"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "cryogenic_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 450}, isru_capabilities: {oxygen_production_rate: 20, nitrogen_production_rate: 35, hydrogen_production_rate: 15, power_generation: 280}}, economic_model: {estimated_cost: 5200000, import_ratio: 0.65, revenue_streams: ["cryovolcanic_research", "nitrogen_exports", "geyser_data"], break_even_timeline: 900}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["cryogenic_systems_stable", "nitrogen_self_sufficiency"], population_sources: ["earth_cryovolcanologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4500, challenges: ["extreme_cold", "thin_atmosphere", "cryovolcanic_activity", "orbital_instability"]}}}, venus_settlement_patterns: {venus_foothold_settlement: {description: "Venus foothold - high-altitude floating habitats, CO2 processing, extreme temperature operations", target_world: "venus", priority: "foothold", phase_structure: {total_phases: 5, estimated_total_duration: 300, phases: [{id: "atmospheric_entry", name: "Atmospheric Entry & High-Altitude Station Establishment", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "floating_platform_deployment", name: "Aerostat Platform Deployment & Stabilization", duration: 90, crew_required: 6, equipment_focus: "aerostat_technology"}, {id: "co2_utilization", name: "CO2 Separation & Resource Extraction", duration: 75, crew_required: 8, equipment_focus: "chemical_separation"}, {id: "energy_harvesting", name: "Solar Energy Collection & Power Distribution", duration: 45, crew_required: 7, equipment_focus: "energy_systems"}, {id: "expanded_operations", name: "Multi-Platform Network & Research Operations", duration: 30, crew_required: 10, equipment_focus: "network_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "co2_separator (3)", "aerostat_platform (4)", "atmospheric_processor (2)"], units: ["floating_habitat (2)", "energy_collection_array (3)", "chemical_reactor (2)", "communication_relay (1)"]}, inventory: {deployable_units: ["atmospheric_probe (3)", "aerostat_balloon (4)", "solar_collector (6)", "weather_satellite (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "specialized_alloys (1000 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (15000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "sulfuric_acid_vapors", "solar_energy", "atmospheric_pressure"], import_requirements: {critical_imports: ["hydrogen", "heat_shielding", "corrosion_resistant_materials"], construction_materials: ["titanium_alloys", "ceramic_composites", "radiation_shielding"], estimated_import_timeline: 300}, isru_capabilities: {oxygen_production_rate: 30, sulfur_production_rate: 20, carbon_production_rate: 25, power_generation: 400}}, economic_model: {estimated_cost: 6000000, import_ratio: 0.7, revenue_streams: ["rare_materials", "atmospheric_data", "energy_exports"], break_even_timeline: 600}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 25, expansion_triggers: ["atmospheric_self_sufficiency", "platform_network_stability"], population_sources: ["earth_specialists", "mars_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 5000, challenges: ["extreme_temperatures", "corrosive_atmosphere", "high_pressure", "acid_clouds"]}}}}, @priorities=#<AIManager::AiPrioritySystem:0x00007f7c8d8016f8 @last_check=Sun, 11 Jan 2026 23:32:02.099842690 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f7c8d800dc0 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f7c8a178028 @settlement_id=1, @decision_history=[{timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:26:59 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:26:59 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:27:00 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:27:00 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion
       # ./spec/services/ai_manager/operational_manager_spec.rb:71:in 'block (4 levels) in <main>'

  808) AIManager::OperationalManager decision logging logs decisions with timestamps and categories
       Failure/Error: allow(operational_manager).to receive(:consider_expansion).and_return({ action: :maintain, reason: :stable })
         #<AIManager::OperationalManager:0x00007f7c8d7a7a90 @settlement=#<Double "Settlement">, @patterns={callisto_settlement_patterns: {callisto_foothold_settlement: {description: "Callisto foothold - radiation protection, surface mining operations, subsurface resource access", target_world: "callisto", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 390, phases: [{id: "radiation_survey", name: "Radiation Environment Assessment & Site Selection", duration: 120, crew_required: 4, equipment_focus: "radiation_monitoring"}, {id: "surface_mining", name: "Surface Regolith Mining & Processing", duration: 120, crew_required: 6, equipment_focus: "mining_operations"}, {id: "subsurface_exploration", name: "Deep Subsurface Resource Assessment", duration: 90, crew_required: 8, equipment_focus: "deep_drilling"}, {id: "protected_habitation", name: "Radiation-Shielded Habitat & Operations Center", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "mining_rig (2)", "deep_drill (2)", "radiation_shield_generator (2)"], units: ["shielded_habitat (2)", "regolith_processor (2)", "drilling_platform (1)", "radiation_monitor (3)"]}, inventory: {deployable_units: ["mining_drill (2)", "radiation_sensor (4)", "surface_rover (2)", "orbital_radiation_mapper (1)"], supplies: ["enriched_uranium_fuel (3500 kilogram)", "shielding_materials (1200 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["surface_regolith", "subsurface_ice", "silicate_materials", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "heavy_shielding", "mining_equipment"], construction_materials: ["radiation_shielding", "reinforced_structures", "cryogenic_storage"], estimated_import_timeline: 390}, isru_capabilities: {oxygen_production_rate: 20, hydrogen_production_rate: 15, water_production_rate: 30, power_generation: 400}}, economic_model: {estimated_cost: 4800000, import_ratio: 0.55, revenue_streams: ["rare_materials", "radiation_research", "mining_exports"], break_even_timeline: 780}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 22, expansion_triggers: ["radiation_shielding_verified", "mining_operations_stable"], population_sources: ["earth_mining_engineers", "ganymede_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 8000, challenges: ["extreme_radiation", "surface_instability", "resource_scarcity", "thermal_extremes"]}}}, ceres_settlement_patterns: {ceres_foothold_settlement: {description: "Ceres foothold - water ice mining, nickel-iron ore extraction, asteroid belt coordination hub", target_world: "ceres", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 200, phases: [{id: "resource_survey", name: "Asteroid Resource Survey & Mining Site Selection", duration: 40, crew_required: 4, equipment_focus: "geological_survey"}, {id: "water_ice_extraction", name: "Water Ice Mining & Cryogenic Storage", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ore_processing", name: "Nickel-Iron Ore Extraction & Processing", duration: 50, crew_required: 5, equipment_focus: "ore_processing"}, {id: "belt_coordination", name: "Asteroid Belt Operations Center & Trade Hub", duration: 50, crew_required: 8, equipment_focus: "coordination_hub"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "water_extractor (4)", "ore_processor (3)", "cryogenic_storage (2)"], units: ["modular_habitat_unit (2)", "ice_drilling_rig (2)", "ore_mining_rig (2)", "belt_communications_array (1)"]}, inventory: {deployable_units: ["geological_scanner (3)", "mining_drone (4)", "orbital_scanner_satellite (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "hydrogen_stores (300 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, economic_model: {estimated_gcc_cost: 850000, local_production_ratio: 0.75, revenue_streams: [{resource: "water_ice", volume: "high", market_value: "medium", trade_partners: ["mars_development_corporation", "vesta_development_corporation"]}, {resource: "nickel_iron_ore", volume: "high", market_value: "high", trade_partners: ["mars_development_corporation", "earth_development_corporation"]}], operational_costs: {power: "nuclear", maintenance: "medium", crew_rotation: "quarterly"}}, environmental_considerations: {gravity: "microgravity", atmosphere: "none", temperature: "cryogenic", radiation: "high", dust: "significant", challenges: ["microgravity_operations", "thermal_management", "dust_contamination"], advantages: ["abundant_water_ice", "rich_mineral_deposits", "strategic_belt_position"]}, expansion_potential: {follow_on_settlements: ["ceres_main_base", "belt_mining_outposts"], regional_influence: "asteroid_belt_coordination", strategic_value: "resource_extraction_hub"}}}, europa_settlement_patterns: {europa_foothold_settlement: {description: "Europa foothold - subsurface ocean access, ice drilling operations, astrobiology research", target_world: "europa", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 360, phases: [{id: "surface_analysis", name: "Surface Geology Analysis & Landing Site Selection", duration: 90, crew_required: 4, equipment_focus: "geological_survey"}, {id: "ice_penetration", name: "Ice Sheet Drilling & Subsurface Access", duration: 120, crew_required: 6, equipment_focus: "ice_drilling"}, {id: "ocean_sampling", name: "Subsurface Ocean Exploration & Sampling", duration: 90, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "research_station", name: "Permanent Research Station & Long-Term Monitoring", duration: 60, crew_required: 12, equipment_focus: "research_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "ice_drilling_rig (2)", "ocean_probe (3)", "radiation_shielded_habitat (2)"], units: ["cryogenic_habitat (2)", "drilling_platform (1)", "ocean_sampler (2)", "seismic_monitor (1)"]}, inventory: {deployable_units: ["ice_penetrator (2)", "ocean_rover (1)", "seismic_sensor (3)", "radiation_monitor (2)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "thermal_drilling_bits (50)"], consumables: ["oxygen (5000 kilogram)", "water (20000 kilogram)", "food (5000 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "geological_heat", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "thermal_drilling_equipment", "radiation_shielding"], construction_materials: ["radiation_shielding", "cryogenic_materials", "pressure_vessels"], estimated_import_timeline: 360}, isru_capabilities: {oxygen_production_rate: 25, hydrogen_production_rate: 20, water_production_rate: 40, power_generation: 350}}, economic_model: {estimated_cost: 5500000, import_ratio: 0.65, revenue_streams: ["scientific_discoveries", "ocean_data", "water_exports"], break_even_timeline: 720}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["ocean_access_established", "radiation_protection_verified"], population_sources: ["earth_astrobiologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 10000, challenges: ["extreme_radiation", "cryogenic_surface", "ocean_pressure", "ice_instability"]}}}, ganymede_settlement_patterns: {ganymede_foothold_settlement: {description: "Ganymede foothold - magnetic field protection, subsurface ocean exploration, ice resource utilization", target_world: "ganymede", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 330, phases: [{id: "magnetic_analysis", name: "Magnetic Field Analysis & Radiation Assessment", duration: 75, crew_required: 4, equipment_focus: "magnetic_survey"}, {id: "ice_resource_development", name: "Surface Ice Mining & Resource Processing", duration: 90, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ocean_penetration", name: "Subsurface Ocean Access & Exploration", duration: 105, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "permanent_base", name: "Magnetic-Shielded Base & Scientific Operations", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "ice_mining_rig (2)", "ocean_drilling_system (2)", "magnetic_shield_generator (1)"], units: ["radiation_shielded_habitat (2)", "ice_processor (2)", "ocean_probe (2)", "magnetic_monitor (1)"]}, inventory: {deployable_units: ["ice_drill (2)", "ocean_sampler (2)", "magnetic_sensor (3)", "radiation_detector (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "shielding_materials (800 kilogram)"], consumables: ["oxygen (4500 kilogram)", "water (18000 kilogram)", "food (4500 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "magnetic_field", "silicate_materials"], import_requirements: {critical_imports: ["hydrogen", "magnetic_shielding", "deep_drilling_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels", "cryogenic_materials"], estimated_import_timeline: 330}, isru_capabilities: {oxygen_production_rate: 30, hydrogen_production_rate: 25, water_production_rate: 35, power_generation: 300}}, economic_model: {estimated_cost: 5000000, import_ratio: 0.6, revenue_streams: ["magnetic_research", "ocean_discoveries", "ice_resources"], break_even_timeline: 660}, population_model: {initial_population: 12, growth_rate: "moderate", support_capacity: 25, expansion_triggers: ["magnetic_shielding_verified", "ocean_access_established"], population_sources: ["earth_magnetic_specialists", "europa_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4000, challenges: ["radiation_environment", "cryogenic_conditions", "ocean_depth", "magnetic_interference"]}}}, io_settlement_patterns: {io_foothold_settlement: {description: "Io foothold - geothermal energy utilization, sulfur processing, volcanic activity monitoring", target_world: "io", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 420, phases: [{id: "volcanic_assessment", name: "Volcanic Activity Analysis & Safe Zone Identification", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "geothermal_harvesting", name: "Geothermal Energy Extraction & Power Generation", duration: 120, crew_required: 6, equipment_focus: "energy_systems"}, {id: "sulfur_processing", name: "Sulfur Compound Mining & Processing", duration: 90, crew_required: 8, equipment_focus: "chemical_processing"}, {id: "thermal_habitation", name: "Heat-Shielded Habitat & Research Operations", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["geothermal_power_plant (3)", "heat_shield_generator (2)", "sulfur_processor (2)", "volcanic_monitor (3)"], units: ["thermal_habitat (2)", "geothermal_drill (2)", "chemical_reactor (2)", "seismic_sensor (2)"]}, inventory: {deployable_units: ["volcanic_probe (3)", "heat_shield (4)", "sulfur_extractor (2)", "thermal_rover (1)"], supplies: ["thermal_insulation (1500 kilogram)", "corrosion_resistant_materials (800 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (14000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["geothermal_energy", "sulfur_compounds", "volcanic_gases", "surface_materials"], import_requirements: {critical_imports: ["hydrogen", "extreme_heat_shielding", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "heat_resistant_alloys", "radiation_shielding"], estimated_import_timeline: 420}, isru_capabilities: {oxygen_production_rate: 15, sulfur_production_rate: 40, hydrogen_production_rate: 10, power_generation: 500}}, economic_model: {estimated_cost: 6500000, import_ratio: 0.75, revenue_streams: ["geothermal_energy", "sulfur_exports", "volcanic_research"], break_even_timeline: 840}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 18, expansion_triggers: ["thermal_protection_verified", "geothermal_stability_confirmed"], population_sources: ["earth_volcanologists", "venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 6000, challenges: ["extreme_temperatures", "volcanic_activity", "radiation", "corrosive_environment"]}}}, luna_settlement_patterns: {luna_foothold_settlement: {description: "Minimal lunar foothold - survey, ISRU oxygen/water, basic habitat", target_world: "luna", priority: "foothold", phase_structure: {total_phases: 3, estimated_total_duration: 180, phases: [{id: "survey_deployment", name: "Orbital Survey & Landing Site Selection", duration: 30, crew_required: 2, equipment_focus: "remote_sensing"}, {id: "isru_establishment", name: "ISRU Oxygen & Water Production Setup", duration: 60, crew_required: 4, equipment_focus: "resource_extraction"}, {id: "minimal_habitation", name: "Basic Crew Habitat & Life Support", duration: 90, crew_required: 6, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "oxygen_generator (3)", "water_extractor (2)"], units: ["modular_habitat_unit (2)", "regolith_processor (1)", "helium3_mining_rig (1)"]}, inventory: {deployable_units: ["orbital_survey_satellite (1)", "surface_rover (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, resource_dependencies: {local_resources_required: ["regolith", "water_ice", "helium3"], import_requirements: {critical_imports: ["oxygen", "water", "food"], construction_materials: ["structural_materials"], estimated_import_timeline: 180}, isru_capabilities: {oxygen_production_rate: 25, water_production_rate: 15, power_generation: 200}}, economic_model: {estimated_cost: 2500000, import_ratio: 0.4, revenue_streams: ["helium3_sales", "research_data"], break_even_timeline: 360}, population_model: {initial_population: 6, growth_rate: "slow", support_capacity: 12, expansion_triggers: ["isru_self_sufficiency", "helium3_exports"], population_sources: ["earth_transfers", "trained_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 720}}}, mars_settlement_patterns: {mars_foothold_settlement: {description: "Mars foothold - atmospheric CO2 utilization, regolith processing, subsurface water access", target_world: "mars", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 240, phases: [{id: "atmospheric_analysis", name: "Atmospheric Composition Analysis & Site Selection", duration: 45, crew_required: 3, equipment_focus: "atmospheric_science"}, {id: "co2_isru_setup", name: "CO2 Sabatier Process & Oxygen Production", duration: 75, crew_required: 5, equipment_focus: "chemical_processing"}, {id: "water_ice_mining", name: "Subsurface Water Ice Mining & Purification", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "surface_habitation", name: "Pressurized Habitat & Radiation Protection", duration: 60, crew_required: 8, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "sabatier_reactor (2)", "atmospheric_processor (2)", "water_extractor (3)"], units: ["modular_habitat_unit (3)", "radiation_shielded_habitat (1)", "ice_drilling_rig (1)", "regolith_processor (2)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "surface_rover (2)", "orbital_weather_satellite (1)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "hydrogen_stores (500 kilogram)"], consumables: ["oxygen (3000 kilogram)", "water (12000 kilogram)", "food (3000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "water_ice", "regolith", "solar_energy"], import_requirements: {critical_imports: ["hydrogen", "specialized_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels"], estimated_import_timeline: 240}, isru_capabilities: {oxygen_production_rate: 40, water_production_rate: 25, methane_production_rate: 15, power_generation: 300}}, economic_model: {estimated_cost: 4000000, import_ratio: 0.5, revenue_streams: ["methane_fuel_sales", "scientific_data", "water_exports"], break_even_timeline: 480}, population_model: {initial_population: 8, growth_rate: "moderate", support_capacity: 20, expansion_triggers: ["atmospheric_self_sufficiency", "water_independence"], population_sources: ["earth_transfers", "luna_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 2400, challenges: ["thin_atmosphere", "radiation", "dust_storms"]}}}, titan_settlement_patterns: {titan_foothold_settlement: {description: "Titan foothold - hydrocarbon lake utilization, cryogenic processing, methane atmosphere operations", target_world: "titan", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 270, phases: [{id: "atmospheric_descent", name: "Atmospheric Descent & Surface Site Selection", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "hydrocarbon_processing", name: "Methane/Ethane Extraction & Processing", duration: 90, crew_required: 6, equipment_focus: "cryogenic_processing"}, {id: "lake_exploration", name: "Hydrocarbon Lake Survey & Resource Assessment", duration: 75, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_habitation", name: "Cryogenic Habitat & Long-Term Operations", duration: 45, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "methane_processor (3)", "cryogenic_extractor (2)", "atmospheric_heater (2)"], units: ["cryogenic_habitat (2)", "lake_sampling_rig (1)", "methane_refinery (2)", "surface_rover (3)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "cryogenic_drill (1)", "methane_sensor (3)", "orbital_imager (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "thermal_insulation (500 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (10000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["methane_atmosphere", "ethane_lakes", "nitrogen_atmosphere", "cryogenic_ice"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 270}, isru_capabilities: {methane_production_rate: 35, oxygen_production_rate: 20, hydrogen_production_rate: 15, power_generation: 250}}, economic_model: {estimated_cost: 4500000, import_ratio: 0.6, revenue_streams: ["hydrocarbon_exports", "cryogenic_research", "methane_fuel"], break_even_timeline: 540}, population_model: {initial_population: 10, growth_rate: "moderate", support_capacity: 30, expansion_triggers: ["hydrocarbon_self_sufficiency", "cryogenic_habitation_stability"], population_sources: ["earth_scientists", "mars_venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 3000, challenges: ["cryogenic_temperatures", "toxic_atmosphere", "low_gravity", "dust_storms"]}}}, triton_settlement_patterns: {triton_foothold_settlement: {description: "Triton foothold - cryovolcanic activity, nitrogen atmosphere utilization, geyser monitoring", target_world: "triton", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 450, phases: [{id: "cryovolcanic_survey", name: "Cryovolcanic Activity Analysis & Landing Assessment", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "nitrogen_processing", name: "Atmospheric Nitrogen Capture & Processing", duration: 120, crew_required: 6, equipment_focus: "atmospheric_processing"}, {id: "surface_exploration", name: "Geyser Field Survey & Resource Mapping", duration: 120, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_operations", name: "Cryogenic Habitat & Long-Term Research", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "nitrogen_processor (2)", "cryogenic_extractor (2)", "geyser_monitor (2)"], units: ["cryogenic_habitat (2)", "atmospheric_collector (2)", "surface_rover (2)", "thermal_sensor (3)"]}, inventory: {deployable_units: ["cryovolcanic_probe (2)", "nitrogen_harvester (2)", "geyser_sampler (1)", "orbital_mapper (1)"], supplies: ["thermal_insulation (1000 kilogram)", "cryogenic_fluids (500 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["nitrogen_atmosphere", "water_ice", "cryovolcanic_materials", "geyser_vapors"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "cryogenic_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 450}, isru_capabilities: {oxygen_production_rate: 20, nitrogen_production_rate: 35, hydrogen_production_rate: 15, power_generation: 280}}, economic_model: {estimated_cost: 5200000, import_ratio: 0.65, revenue_streams: ["cryovolcanic_research", "nitrogen_exports", "geyser_data"], break_even_timeline: 900}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["cryogenic_systems_stable", "nitrogen_self_sufficiency"], population_sources: ["earth_cryovolcanologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4500, challenges: ["extreme_cold", "thin_atmosphere", "cryovolcanic_activity", "orbital_instability"]}}}, venus_settlement_patterns: {venus_foothold_settlement: {description: "Venus foothold - high-altitude floating habitats, CO2 processing, extreme temperature operations", target_world: "venus", priority: "foothold", phase_structure: {total_phases: 5, estimated_total_duration: 300, phases: [{id: "atmospheric_entry", name: "Atmospheric Entry & High-Altitude Station Establishment", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "floating_platform_deployment", name: "Aerostat Platform Deployment & Stabilization", duration: 90, crew_required: 6, equipment_focus: "aerostat_technology"}, {id: "co2_utilization", name: "CO2 Separation & Resource Extraction", duration: 75, crew_required: 8, equipment_focus: "chemical_separation"}, {id: "energy_harvesting", name: "Solar Energy Collection & Power Distribution", duration: 45, crew_required: 7, equipment_focus: "energy_systems"}, {id: "expanded_operations", name: "Multi-Platform Network & Research Operations", duration: 30, crew_required: 10, equipment_focus: "network_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "co2_separator (3)", "aerostat_platform (4)", "atmospheric_processor (2)"], units: ["floating_habitat (2)", "energy_collection_array (3)", "chemical_reactor (2)", "communication_relay (1)"]}, inventory: {deployable_units: ["atmospheric_probe (3)", "aerostat_balloon (4)", "solar_collector (6)", "weather_satellite (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "specialized_alloys (1000 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (15000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "sulfuric_acid_vapors", "solar_energy", "atmospheric_pressure"], import_requirements: {critical_imports: ["hydrogen", "heat_shielding", "corrosion_resistant_materials"], construction_materials: ["titanium_alloys", "ceramic_composites", "radiation_shielding"], estimated_import_timeline: 300}, isru_capabilities: {oxygen_production_rate: 30, sulfur_production_rate: 20, carbon_production_rate: 25, power_generation: 400}}, economic_model: {estimated_cost: 6000000, import_ratio: 0.7, revenue_streams: ["rare_materials", "atmospheric_data", "energy_exports"], break_even_timeline: 600}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 25, expansion_triggers: ["atmospheric_self_sufficiency", "platform_network_stability"], population_sources: ["earth_specialists", "mars_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 5000, challenges: ["extreme_temperatures", "corrosive_atmosphere", "high_pressure", "acid_clouds"]}}}}, @priorities=#<AIManager::AiPrioritySystem:0x00007f7c8fba76e8 @last_check=Sun, 11 Jan 2026 23:32:02.300105163 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f7c8fba5c80 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f7c9420fec8 @settlement_id=1, @decision_history=[{timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:26:59 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:26:59 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:27:00 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:27:00 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion
       # ./spec/services/ai_manager/operational_manager_spec.rb:185:in 'block (3 levels) in <main>'

  809) AIManager::PriorityHeuristic#oxygen_critical? when O2 mass is above 15% of target returns false
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:13:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  810) AIManager::PriorityHeuristic#oxygen_critical? when O2 mass is below 15% of target returns true
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:26:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  811) AIManager::PriorityHeuristic#account_negative? when account balance is positive returns false
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:40:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  812) AIManager::PriorityHeuristic#account_negative? when account balance is negative returns true
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:50:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  813) AIManager::PriorityHeuristic#get_priorities when neither condition is met returns empty array
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:62:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  814) AIManager::PriorityHeuristic#get_priorities when oxygen is critical returns refill_oxygen priority
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:75:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  815) AIManager::PriorityHeuristic#get_priorities when account is negative returns debt_repayment priority
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:88:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  816) AIManager::PriorityHeuristic#get_priorities when both conditions are met returns both priorities
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:101:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  817) AIManager::PriorityHeuristic#get_priorities on Mars when oxygen is critical on Mars returns local_oxygen_generation priority instead of refill_oxygen
       Failure/Error: let(:mars_settlement) { create(:base_settlement, :station, location: mars_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:119:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:123:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  818) AIManager::PriorityHeuristic#get_priorities on Mars when nitrogen is critical on Mars returns local_argon_extraction priority
       Failure/Error: let(:mars_settlement) { create(:base_settlement, :station, location: mars_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:145:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:149:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  819) AIManager::PriorityHeuristic#calculate_si_ask_price returns 95% of the calculated ask price
       Failure/Error: let(:settlement) { create(:base_settlement, :station) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:168:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  820) AIManager::PriorityHeuristic Environmental System Integration with procedurally generated planet having 95% CO2 and 0.0 Tesla magnetic field correctly chooses local O2 production
       Failure/Error: let(:high_co2_settlement) { create(:base_settlement, :station, location: high_co2_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:180:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:184:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  821) AIManager::PriorityHeuristic Environmental System Integration with planet having low CO2 and weak magnetic field chooses oxygen refill instead of local generation
       Failure/Error: let(:low_co2_settlement) { create(:base_settlement, :station, location: low_co2_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:204:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:208:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  822) AIManager::PriorityHeuristic Environmental System Integration with settlement having excess CO and H2 prioritizes methane synthesis
       Failure/Error: let(:excess_gas_settlement) { create(:base_settlement, :station, location: excess_gas_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:228:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:232:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  823) AIManager::PriorityHeuristic Environmental System Integration with settlement having critical storage capacity prioritizes storage module construction
       Failure/Error: let(:full_tanks_settlement) { create(:base_settlement, :station, location: full_tanks_location) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:252:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/priority_heuristic_spec.rb:256:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  824) AIManager::SystemArchitect#deploy_subsurface_foothold creates subsurface location
       Failure/Error: expect { architect.send(:deploy_subsurface_foothold) }.to change(CelestialLocation, :count).by(1)

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/services/ai_manager/system_architect_spec.rb:100:in 'block (3 levels) in <main>'

  825) AIManager::SystemArchitect#deploy_subsurface_foothold creates settlement
       Failure/Error:
         Structures::BaseStructure.create!(
           name: "Primary Habitat Module - #{settlement.name} - #{Time.now.to_i}-#{rand(1000)}",
           structure_name: 'habitat',
           settlement: settlement,
           owner: settlement.owner,
           operational_data: { 
             pressurized: true, 
             radiation_shielded: true, 
             structure_type: 'habitat',
             status: 'operational'

       ActiveRecord::RecordInvalid:
         Validation failed: Structure type can't be blank
       # ./app/services/ai_manager/system_architect.rb:471:in 'AIManager::SystemArchitect#create_habitat_structures'
       # ./app/services/ai_manager/system_architect.rb:385:in 'AIManager::SystemArchitect#deploy_initial_habitats'
       # ./app/services/ai_manager/system_architect.rb:152:in 'AIManager::SystemArchitect#deploy_subsurface_foothold'
       # ./spec/services/ai_manager/system_architect_spec.rb:104:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/system_architect_spec.rb:104:in 'block (3 levels) in <main>'

  826) AIManager::SystemArchitect#find_nearby_asteroid with suitable asteroid finds the asteroid
       Failure/Error: let!(:asteroid) { create(:asteroid, solar_system: solar_system) }

       KeyError:
         Factory not registered: "asteroid"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_architect_spec.rb:118:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "asteroid"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  827) AIManager::SystemIntelligenceService#system_status with operational structures returns correct operational ratio and status
       Failure/Error: let!(:operational_structure) { create(:base_structure, :operational) }

       KeyError:
         Trait not registered: "operational"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:181:in 'FactoryBot::Definition#aggregate_from_traits_and_self'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:37:in 'FactoryBot::Definition#to_create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition_hierarchy.rb:6:in 'FactoryBot::DefinitionHierarchy.build_from_definition'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:128:in 'FactoryBot::Factory#build_hierarchy'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:91:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_intelligence_service_spec.rb:12:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "operational"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  828) AIManager::SystemIntelligenceService#system_status with all operational structures returns healthy status
       Failure/Error: let!(:structure1) { create(:base_structure, :operational) }

       KeyError:
         Trait not registered: "operational"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:181:in 'FactoryBot::Definition#aggregate_from_traits_and_self'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:37:in 'FactoryBot::Definition#to_create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition_hierarchy.rb:6:in 'FactoryBot::DefinitionHierarchy.build_from_definition'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:128:in 'FactoryBot::Factory#build_hierarchy'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:91:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_intelligence_service_spec.rb:35:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "operational"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  829) AIManager::SystemIntelligenceService#system_status with mostly non-operational structures returns critical status
       Failure/Error: let!(:structure1) { create(:base_structure, :non_operational, location: create(:celestial_location, celestial_body: celestial_body)) }

       KeyError:
         Trait not registered: "non_operational"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:181:in 'FactoryBot::Definition#aggregate_from_traits_and_self'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:37:in 'FactoryBot::Definition#to_create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition_hierarchy.rb:6:in 'FactoryBot::DefinitionHierarchy.build_from_definition'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:128:in 'FactoryBot::Factory#build_hierarchy'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:91:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_intelligence_service_spec.rb:56:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "non_operational"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  830) AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure creates a crater dome structure
       Failure/Error:
         crater_dome = Structures::CraterDome.create!(
           name: structure_name,
           structure_name: structure_name,
           owner: @settlement,
           location: dome_location,
           settlement: @settlement,
           operational_data: {
             'structure_type' => 'crater_dome',
             'dimensions' => {
               'diameter' => task['diameter'] || 100.0,

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (903, Test Dome (2041), Test Dome (2041), null, 2041, Settlement::BaseSettlement, 2041, null, Location::CelestialLocation, 2558, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-11 23:32:14.268013, 2026-01-11 23:32:14.268013, null, null, 0, 0).
       # ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:519:in 'block (5 levels) in <main>'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:518:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (903, Test Dome (2041), Test Dome (2041), null, 2041, Settlement::BaseSettlement, 2041, null, Location::CelestialLocation, 2558, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-11 23:32:14.268013, 2026-01-11 23:32:14.268013, null, null, 0, 0).
       #   ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'

  831) AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure uses ConstructionJobService
       Failure/Error:
         crater_dome = Structures::CraterDome.create!(
           name: structure_name,
           structure_name: structure_name,
           owner: @settlement,
           location: dome_location,
           settlement: @settlement,
           operational_data: {
             'structure_type' => 'crater_dome',
             'dimensions' => {
               'diameter' => task['diameter'] || 100.0,

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (904, Test Dome (2042), Test Dome (2042), null, 2042, Settlement::BaseSettlement, 2042, null, Location::CelestialLocation, 2559, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-11 23:32:14.354792, 2026-01-11 23:32:14.354792, null, null, 0, 0).
       # ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:529:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (904, Test Dome (2042), Test Dome (2042), null, 2042, Settlement::BaseSettlement, 2042, null, Location::CelestialLocation, 2559, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-11 23:32:14.354792, 2026-01-11 23:32:14.354792, null, null, 0, 0).
       #   ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'

  832) AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply schedules a material ferry mission
       Failure/Error: @l1_station = create(:base_settlement, name: 'L1 Depot', owner: player, settlement_type: :station)

       ArgumentError:
         'station' is not a valid settlement_type
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:630:in 'block (3 levels) in <main>'

  833) AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply updates craft status
       Failure/Error: @l1_station = create(:base_settlement, name: 'L1 Depot', owner: player, settlement_type: :station)

       ArgumentError:
         'station' is not a valid settlement_type
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:630:in 'block (3 levels) in <main>'

  834) AIManager::TaskExecutionEngine.orbital_resupply_cycle when no active projects does not schedule missions
       Failure/Error: @l1_station = create(:base_settlement, name: 'L1 Depot', owner: player, settlement_type: :station)

       ArgumentError:
         'station' is not a valid settlement_type
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:630:in 'block (3 levels) in <main>'

  835) AIManager::TerraformingManager#calculate_gas_needs with magnetosphere protection returns gas needs for warming phase
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./app/services/ai_manager/terraforming_manager.rb:46:in 'AIManager::TerraformingManager#calculate_gas_needs'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:21:in 'block (4 levels) in <main>'

  836) AIManager::TerraformingManager#calculate_gas_needs without magnetosphere protection returns empty hash
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./app/services/ai_manager/terraforming_manager.rb:46:in 'AIManager::TerraformingManager#calculate_gas_needs'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:28:in 'block (4 levels) in <main>'

  837) AIManager::TerraformingManager#calculate_gas_needs with preservation mode and exceeded limit returns empty hash
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./app/services/ai_manager/terraforming_manager.rb:46:in 'AIManager::TerraformingManager#calculate_gas_needs'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:38:in 'block (4 levels) in <main>'

  838) AIManager::TerraformingManager#has_magnetosphere_protection? with natural magnetosphere returns true
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:49:in 'block (4 levels) in <main>'

  839) AIManager::TerraformingManager#has_magnetosphere_protection? without natural magnetosphere returns false
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:55:in 'block (4 levels) in <main>'

  840) AutonomousMissionService.find_or_create_worldhouse_feature when a lava tube exists returns the existing lava tube
       Failure/Error: let!(:lava_tube) { create(:lava_tube_feature, celestial_body: celestial_body, status: 'natural') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:10:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  841) AutonomousMissionService.find_or_create_worldhouse_feature priority order prioritizes lava tube over valley and canyon
       Failure/Error: let!(:lava_tube) { create(:lava_tube_feature, celestial_body: celestial_body, status: 'natural') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:52:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  842) AutonomousMissionService.execute_base_building_sequence calls the feature finding method
       Failure/Error: allow(described_class).to receive(:find_or_create_worldhouse_feature).and_return(create(:lava_tube_feature))

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:78:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  843) AutonomousMissionService.execute_base_building_sequence logs mission progress
       Failure/Error: allow(described_class).to receive(:find_or_create_worldhouse_feature).and_return(create(:lava_tube_feature))

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:78:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  844) Construction::OrbitalShipyardService.create_shipyard_project with valid parameters creates a new orbital construction project
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:13:in 'block (5 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:12:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  845) Construction::OrbitalShipyardService.create_shipyard_project with valid parameters associates the project with the station
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:18:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  846) Construction::OrbitalShipyardService.create_shipyard_project with valid parameters sets the correct blueprint_id
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:23:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  847) Construction::OrbitalShipyardService.create_shipyard_project with valid parameters sets initial status to materials_pending
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:28:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  848) Construction::OrbitalShipyardService.create_shipyard_project with valid parameters initializes progress_percentage to 0
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:33:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  849) Construction::OrbitalShipyardService.create_shipyard_project with valid parameters loads required materials from blueprint
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:38:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  850) Construction::OrbitalShipyardService.create_shipyard_project with valid parameters initializes delivered_materials with zero values
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:44:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  851) Construction::OrbitalShipyardService.create_shipyard_project with invalid blueprint_id raises an error
       Failure/Error:
         expect {
           described_class.create_shipyard_project(station, 'invalid_blueprint')
         }.to raise_error(RuntimeError, /Blueprint not found/)

         expected RuntimeError with message matching /Blueprint not found/, got #<KeyError: Trait not registered: "station"> with backtrace:
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
           # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
           # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
           # ./spec/services/construction/orbital_shipyard_service_spec.rb:55:in 'block (5 levels) in <main>'
           # ./spec/services/construction/orbital_shipyard_service_spec.rb:54:in 'block (4 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:54:in 'block (4 levels) in <main>'

  852) Construction::OrbitalShipyardService.deliver_materials when material is needed consumes the material for the project
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  853) Construction::OrbitalShipyardService.deliver_materials when material is needed returns the unconsumed quantity
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  854) Construction::OrbitalShipyardService.deliver_materials when material is needed does not consume more than needed
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  855) Construction::OrbitalShipyardService.deliver_materials when material is not needed returns the full quantity
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  856) Construction::OrbitalShipyardService.deliver_materials when material is not needed does not update any project materials
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  857) Construction::OrbitalShipyardService.deliver_materials when project becomes ready changes status to in_progress when all materials are delivered
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  858) Construction::OrbitalShipyardService.deliver_materials with multiple projects distributes materials across projects
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  859) Construction::OrbitalShipyardService.update_construction_progress increases progress percentage
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:147:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  860) Construction::OrbitalShipyardService.update_construction_progress does not exceed 100%
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:147:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  861) Construction::OrbitalShipyardService.update_construction_progress when progress reaches 100% completes the project
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:147:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  862) Construction::OrbitalShipyardService.complete_project marks the project as completed
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:175:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  863) Construction::OrbitalShipyardService.complete_project spawns the completed craft
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:175:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  864) Construction::OrbitalShipyardService.spawn_completed_craft creates a new craft
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  865) Construction::OrbitalShipyardService.spawn_completed_craft associates the craft with the station
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  866) Construction::OrbitalShipyardService.spawn_completed_craft sets the craft status to docked
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  867) Construction::OrbitalShipyardService.spawn_completed_craft loads operational data from blueprint
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  868) CraterDomeConstructionService#construct creates a construction job successfully
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  869) CraterDomeConstructionService#construct when entity is different from service provider processes a payment
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  870) CraterDomeConstructionService#start_construction starts the construction process
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  871) CraterDomeConstructionService#complete_construction completes the construction process
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  872) End-to-End Economic Simulation simulates the full pipeline to determine the initial market listing price
       Failure/Error: expect(eap_price).to be_within(0.01).of(expected_eap_prices[material_data['key']])
         expected 0.0 to be within 0.01 of 137.5
       # ./spec/services/e2e_economic_simulation_spec.rb:87:in 'block (3 levels) in <main>'
       # ./spec/services/e2e_economic_simulation_spec.rb:75:in 'Array#each'
       # ./spec/services/e2e_economic_simulation_spec.rb:75:in 'block (2 levels) in <main>'

  873) Financial::TaxCollectionService.collect_sales_tax when tax is applicable calculates the correct tax amount
       Failure/Error: expect(tax_result[:tax_paid]).to eq(expected_tax_amount)

       NoMethodError:
         undefined method '[]' for an instance of Float
       # ./spec/services/financial/tax_collection_service_spec.rb:27:in 'block (4 levels) in <main>'

  874) Financial::TaxCollectionService.collect_sales_tax when tax rate is zero (e.g., for Tax Authority) returns 0.0 and does not call the TransactionManager
       Failure/Error: expect(tax_result[:tax_paid]).to eq(0.0)

       NoMethodError:
         undefined method '[]' for an instance of Float
       # ./spec/services/financial/tax_collection_service_spec.rb:54:in 'block (4 levels) in <main>'

  875) Financial::TaxCollectionService.collect_sales_tax when organization is missing a tax rate returns 0.0 and does not call the TransactionManager
       Failure/Error: expect(tax_result[:tax_paid]).to eq(0.0)

       NoMethodError:
         undefined method '[]' for an instance of Float
       # ./spec/services/financial/tax_collection_service_spec.rb:66:in 'block (4 levels) in <main>'

  876) FittingService fits all components from inventory
       Failure/Error: let(:craft) { create(:base_craft, owner: settlement) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/fitting_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/fitting_service_spec.rb:31:in 'block (2 levels) in <main>'

  877) FittingService returns errors if inventory is missing items
       Failure/Error: let(:craft) { create(:base_craft, owner: settlement) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/fitting_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/fitting_service_spec.rb:41:in 'block (2 levels) in <main>'

  878) FittingService fits components without inventory if inventory is nil
       Failure/Error: let(:craft) { create(:base_craft, owner: settlement) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/fitting_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/fitting_service_spec.rb:48:in 'block (2 levels) in <main>'

  879) FittingService does not persist changes if dry_run is true
       Failure/Error: let(:craft) { create(:base_craft, owner: settlement) }

       NoMethodError:
         undefined method 'location=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/fitting_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/fitting_service_spec.rb:54:in 'block (2 levels) in <main>'

  880) Game#advance_by_days advances the simulation by the given number of days
       Failure/Error:
         create(:base_settlement, :independent, :with_storage,
                name: "Mars Base One",
                current_population: 5,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/game_spec.rb:23:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  881) Game#advance_by_days does not advance time if days is zero or negative
       Failure/Error:
         create(:base_settlement, :independent, :with_storage,
                name: "Mars Base One",
                current_population: 5,
                owner: player,
                location: location)

       KeyError:
         Trait not registered: "independent"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/game_spec.rb:23:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "independent"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  882) Generators::LavaTubeGenerator#generate with random generation creates a lava tube with random features
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:11:in 'block (4 levels) in <main>'

  883) Generators::LavaTubeGenerator#generate with random generation generates random dimensions
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:23:in 'block (4 levels) in <main>'

  884) Generators::LavaTubeGenerator#generate with random generation generates random attributes
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:32:in 'block (4 levels) in <main>'

  885) Generators::LavaTubeGenerator#generate with random generation creates random skylights and access points
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:41:in 'block (4 levels) in <main>'

  886) Generators::LavaTubeGenerator#generate with predefined parameters creates a lava tube with specified parameters
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./spec/services/generators/lava_tube_generator_spec.rb:95:in 'block (4 levels) in <main>'

  887) Generators::LavaTubeGenerator#generate with predefined parameters creates predefined skylights and access points
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./spec/services/generators/lava_tube_generator_spec.rb:116:in 'block (4 levels) in <main>'

  888) Generators::LavaTubeGenerator#generate with minimal parameters creates a lava tube with defaults
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./spec/services/generators/lava_tube_generator_spec.rb:135:in 'block (4 levels) in <main>'

  889) Generators::ValleyGenerator#generate with random generation creates a valley with random features
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./spec/services/generators/valley_generator_spec.rb:17:in 'block (4 levels) in <main>'

  890) Generators::ValleyGenerator#generate with random generation generates random dimensions
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/valley.rb:10:in 'CelestialBodies::Features::Valley#length_m'
       # ./app/services/generators/valley_generator.rb:163:in 'block in Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:151:in 'Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:21:in 'Generators::ValleyGenerator#generate'
       # ./spec/services/generators/valley_generator_spec.rb:22:in 'block (4 levels) in <main>'

  891) Generators::ValleyGenerator#generate with random generation generates segments
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/valley.rb:10:in 'CelestialBodies::Features::Valley#length_m'
       # ./app/services/generators/valley_generator.rb:163:in 'block in Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:151:in 'Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:21:in 'Generators::ValleyGenerator#generate'
       # ./spec/services/generators/valley_generator_spec.rb:31:in 'block (4 levels) in <main>'

  892) Generators::ValleyGenerator#generate with predefined parameters creates a valley with specified parameters
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/valley.rb:10:in 'CelestialBodies::Features::Valley#length_m'
       # ./spec/services/generators/valley_generator_spec.rb:88:in 'block (4 levels) in <main>'

  893) Generators::ValleyGenerator#generate with predefined parameters creates predefined access points
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./spec/services/generators/valley_generator_spec.rb:102:in 'block (4 levels) in <main>'

  894) Logistics::ContractService.create_internal_transfer with valid settlements creates a logistics contract for internal transfer
       Failure/Error: expect(contract).to be_persisted
         expected nil to respond to `persisted?`
       # ./spec/services/logistics/contract_service_spec.rb:23:in 'block (4 levels) in <main>'

  895) Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects intercepts materials for orbital construction
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/logistics/inventory_manager_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/logistics/inventory_manager_spec.rb:14:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  896) Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects does not add materials to station inventory if all consumed by projects
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/logistics/inventory_manager_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/logistics/inventory_manager_spec.rb:14:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  897) Logistics::InventoryManager.transfer_item when transferring orbital construction materials to non-orbital settlement transfers materials normally without interception
       Failure/Error: to_inventory.inventoryable.orbital? &&

       NoMethodError:
         undefined method 'orbital?' for an instance of Settlement::BaseSettlement
       # ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'
       # ./spec/services/logistics/inventory_manager_spec.rb:65:in 'block (4 levels) in <main>'

  898) Logistics::InventoryManager.transfer_item when transferring non-orbital materials to orbital station transfers materials normally without interception
       Failure/Error: let(:station) { create(:base_settlement, :station, owner: player) }

       KeyError:
         Trait not registered: "station"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/logistics/inventory_manager_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/logistics/inventory_manager_spec.rb:78:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "station"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  899) Lookup::CraftLookupService#find_craft loads JSON files with correct format
       Failure/Error: expect(data).to have_key('id')
         expected `{"ai_decision_logic" => {"crew_availability_check" => "required", "fuel_availability_check" => "requi...euvers", "operational_kw" => 2500, "peak_surge_kw" => 8000}, "template" => "craft_operational_data"}.has_key?("id")` to be truthy, got false
       # ./spec/services/lookup/craft_lookup_service_spec.rb:27:in 'block (4 levels) in <main>'
       # ./spec/services/lookup/craft_lookup_service_spec.rb:24:in 'Array#each'
       # ./spec/services/lookup/craft_lookup_service_spec.rb:24:in 'block (3 levels) in <main>'

  900) Lookup::ItemLookupService#find_item loads items from the correct file structure
       Failure/Error: items_path = described_class.base_items_path.to_s

       NoMethodError:
         undefined method 'base_items_path' for class Lookup::ItemLookupService
       # ./spec/services/lookup/item_lookup_service_spec.rb:9:in 'block (3 levels) in <main>'

  901) Lookup::ItemLookupService#find_item handles scrap items dynamically
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:63:in 'block (3 levels) in <main>'

  902) Lookup::ItemLookupService dynamic item creation creates scrap items on the fly
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:126:in 'block (3 levels) in <main>'

  903) Lookup::ItemLookupService dynamic item creation creates processed items on the fly
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:134:in 'block (3 levels) in <main>'

  904) Lookup::ItemLookupService dynamic item creation creates used items on the fly
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:142:in 'block (3 levels) in <main>'

  905) Lookup::MaterialLookupService#find_material finds atmospheric gases by chemical formula
       Failure/Error: expect(oxygen).not_to be_nil

         expected: not nil
              got: nil
       # ./spec/services/lookup/material_lookup_service_spec.rb:45:in 'block (3 levels) in <main>'

  906) Lookup::MaterialLookupService#find_material finds materials case-insensitively
       Failure/Error: expect(@service.get_material_property(o2_material, 'chemical_formula')).to eq("O2")

         expected: "O2"
              got: nil

         (compared using ==)
       # ./spec/services/lookup/material_lookup_service_spec.rb:53:in 'block (3 levels) in <main>'

  907) Lookup::MaterialLookupService material property access has all expected material properties
       Failure/Error: expect(@service.get_material_property(ilmenite, 'molar_mass')).to be_a(Numeric)
         expected nil to be a kind of Numeric
       # ./spec/services/lookup/material_lookup_service_spec.rb:96:in 'block (3 levels) in <main>'

  908) Lookup::MaterialLookupService.locate_gases_path uses GalaxyGame::Paths consistently
       Failure/Error: expect(path).to eq(expected_path)

         expected: "/home/galaxy_game/app/data/resources/materials/gases"
              got: "/home/galaxy_game/home/galaxy_game/app/data/resources/materials/gases"

         (compared using ==)
       # ./spec/services/lookup/material_lookup_service_spec.rb:210:in 'block (3 levels) in <main>'

  909) Lookup::MaterialLookupService error handling with corrupted JSON files handles JSON parsing errors gracefully
       Failure/Error: Rails.logger.error "Error parsing #{file}: #{e.message}"

         #<ActiveSupport::Logger:0x00007f7cac5f99e0 @level=0, @progname=nil, @default_formatter=#<Logger::Formatter:0x00007f7cac5e6098 @datetime_format=nil>, @formatter=#<ActiveSupport::Logger::SimpleFormatter:0x00007f7cac5e4068 @datetime_format=nil, @thread_key="activesupport_tagged_logging_tags:8632">, @logdev=#<Logger::LogDevice:0x00007f7cac5daf18 @shift_period_suffix="%Y%m%d", @shift_size=1048576, @shift_age=0, @filename="/home/galaxy_game/log/development.log", @dev=#<File:/home/galaxy_game/log/development.log>, @binmode=false, @reraise_write_errors=[], @mon_data=#<Monitor:0x00007f7cac5e5fa8>, @mon_data_owner_object_id=2824>, @level_override={}> received :error with unexpected arguments
           expected: (/Invalid JSON in file:/)
                got: ("Error parsing /tmp/d20260111-5548-56hoat/corrupted.json: expected object key, got 'invalid json }")
         Diff:
         @@ -1 +1 @@
         -[/Invalid JSON in file:/]
         +["Error parsing /tmp/d20260111-5548-56hoat/corrupted.json: expected object key, got 'invalid json }"]
       # ./app/services/lookup/material_lookup_service.rb:196:in 'block in Lookup::MaterialLookupService#load_json_files'
       # ./app/services/lookup/material_lookup_service.rb:190:in 'Array#map'
       # ./app/services/lookup/material_lookup_service.rb:190:in 'Lookup::MaterialLookupService#load_json_files'
       # ./spec/services/lookup/material_lookup_service_spec.rb:256:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # JSON::ParserError:
       #   expected object key, got 'invalid json }
       #   /usr/local/bundle/gems/json-2.10.2/lib/json/common.rb:248:in 'JSON::Ext::Parser.parse'

  910) Lookup::ModuleLookupService service configuration has the correct base path
       Failure/Error: expect(actual_path).to eq(expected_path)

         expected: "/home/galaxy_game/data/json-data/operational_data/modules"
              got: "/home/galaxy_game/app/data/operational_data/modules"

         (compared using ==)
       # ./spec/services/lookup/module_lookup_service_spec.rb:52:in 'block (3 levels) in <main>'

  911) Lookup::PlanetaryGeologicalFeatureLookupService#initialize initializes with a celestial body
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:21:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  912) Lookup::PlanetaryGeologicalFeatureLookupService#initialize loads features during initialization
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:27:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  913) Lookup::PlanetaryGeologicalFeatureLookupService#all_features returns all loaded features
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:55:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  914) Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles multiple JSON files
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:64:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  915) Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles single feature JSON files
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:81:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  916) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by exact name match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  917) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by case-insensitive name match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  918) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by lowercase name match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  919) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns nil when feature is not found
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  920) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name handles symbol input
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  921) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns the first match when multiple features have the same name
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  922) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features of a specific type
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  923) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features by case-insensitive type match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  924) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns empty array when no features of that type exist
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  925) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type handles symbol input
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  926) Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary groups features by type
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:226:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  927) Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary handles features with nil type
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:226:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  928) Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary returns empty hash when no features exist
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:226:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  929) Lookup::PlanetaryGeologicalFeatureLookupService path construction constructs correct path for planet
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:260:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  930) Lookup::PlanetaryGeologicalFeatureLookupService error handling handles JSON parse errors gracefully
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:282:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  931) Lookup::PlanetaryGeologicalFeatureLookupService error handling logs debug information about found files
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:297:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  932) Lookup::UnitLookupService#find_unit finds units case-insensitively by ID
       Failure/Error: expect(unit_upper).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:109:in 'block (3 levels) in <main>'

  933) Lookup::UnitLookupService#find_unit with propulsion units finds propulsion units by their exact ID
       Failure/Error:
         expect(found_unit).to be_present,
           "Unit #{unit_id} not found. Check if '#{File.basename(propulsion_files.first)}' exists"

         Unit basic_engine not found. Check if 'basic_engine_data.json' exists
       # ./spec/services/lookup/unit_lookup_service_spec.rb:58:in 'block (4 levels) in <main>'

  934) Lookup::UnitLookupService#find_unit with propulsion units has expected propulsion unit properties
       Failure/Error: expect(propulsion_unit).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:67:in 'block (4 levels) in <main>'

  935) Lookup::UnitLookupService#find_unit with robot units finds robot units by their ID
       Failure/Error:
         expect(robot_unit).to be_present,
           "Robot unit #{unit_id} not found. Check its JSON file in #{GalaxyGame::Paths::ROBOTS_DEPLOYMENT_UNITS_PATH}"

         Robot unit car_300_deployment_robot_mk1 not found. Check its JSON file in /home/galaxy_game/app/data/operational_data/units/robots/deployment
       # ./spec/services/lookup/unit_lookup_service_spec.rb:97:in 'block (4 levels) in <main>'

  936) Lookup::UnitLookupService service configuration has all expected unit categories
       Failure/Error: expect(actual_categories).to match_array(expected_categories)

         expected collection contained:  ["communication", "computer", "construction", "control", "droid", "em_processing", "energy", "gravita...gistics", "robots_maintenance", "robots_resource", "sensors", "specialized", "storage", "structure"]
         actual collection contained:    ["computer", "droid", "energy", "habitats", "life_support", "processing", "production", "propulsion",... "robots_logistics", "robots_maintenance", "robots_resource", "specialized", "storage", "structure"]
         the missing elements were:      ["communication", "construction", "control", "em_processing", "gravitational_control", "infrastructure", "power", "resource", "sensors"]
       # ./spec/services/lookup/unit_lookup_service_spec.rb:132:in 'block (3 levels) in <main>'

  937) Lookup::UnitLookupService matching behavior matches by exact ID
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:219:in 'block (3 levels) in <main>'

  938) Lookup::UnitLookupService matching behavior matches by exact name
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:224:in 'block (3 levels) in <main>'

  939) Lookup::UnitLookupService matching behavior matches by partial ID with sufficient length
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:231:in 'block (3 levels) in <main>'

  940) Lookup::UnitLookupService matching behavior is case insensitive
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:235:in 'block (3 levels) in <main>'

  941) ManufacturingService.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  942) ManufacturingService.manufacture with real blueprints works with different blueprint categories
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  943) ManufacturingService.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  944) ManufacturingService.manufacture with different construction cost percentages uses settlement's custom construction percentage
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  945) ManufacturingService.manufacture with real blueprint data creates material requests based on actual blueprint requirements
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  946) ManufacturingService.manufacture with real blueprint data automatically fulfills material requirements when materials are available
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  947) ManufacturingService.manufacture with real blueprint data stores actual blueprint data in specifications
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  948) ManufacturingService.manufacture with invalid blueprint returns failure when blueprint not found
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  949) Manufacturing::AssemblyService.start_assembly with all materials available charges the tenant fee
       Failure/Error: expect(player.account.reload.balance).to eq(initial_player_balance)

         expected: 0.1e4
              got: 0.964e3

         (compared using ==)
       # ./spec/services/manufacturing/assembly_service_spec.rb:70:in 'block (4 levels) in <main>'

  950) Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) creates a production job using real blueprint
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/manufacturing/component_production_integration_spec.rb:58:in 'block (4 levels) in <main>'

  951) Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) consumes depleted_regolith from inventory
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/manufacturing/component_production_integration_spec.rb:58:in 'block (4 levels) in <main>'

  952) Manufacturing::Construction::CoveringService#initialize initializes with coverable, panel type, and settlement
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:11:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  953) Manufacturing::Construction::CoveringService#initialize uses default panel type if not provided
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:19:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  954) Manufacturing::Construction::CoveringService#initialize finds settlement from coverable if not provided
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  955) Manufacturing::Construction::CoveringService#calculate_materials calculates base materials using CoveringCalculator
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:34:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  956) Manufacturing::Construction::CoveringService#calculate_materials merges panel-specific materials
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:52:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  957) Manufacturing::Construction::CoveringService#calculate_materials sums quantities for duplicate materials
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:65:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  958) Manufacturing::Construction::CoveringService#schedule_construction returns error if no settlement
       Failure/Error: coverable_without_settlement = create(:crater_dome, name: 'Unique Test Dome', settlement: nil)

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (939, Unique Test Dome, Crater Dome, null, null, Player, 4630, null, Location::CelestialLocation, 2838, 0, {"status": "planned", "dimensions": {"depth": 30.0, "diameter": ..., 2026-01-11 23:34:04.6433, 2026-01-11 23:34:04.6433, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:86:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (939, Unique Test Dome, Crater Dome, null, null, Player, 4630, null, Location::CelestialLocation, 2838, 0, {"status": "planned", "dimensions": {"depth": 30.0, "diameter": ..., 2026-01-11 23:34:04.6433, 2026-01-11 23:34:04.6433, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  959) Manufacturing::Construction::CoveringService#schedule_construction returns error if no blueprint found
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:95:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  960) Manufacturing::Construction::CoveringService#schedule_construction creates a construction job
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:105:in 'block (4 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:104:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  961) Manufacturing::Construction::CoveringService#schedule_construction creates material requests
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:111:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  962) Manufacturing::Construction::CoveringService#schedule_construction creates equipment requests
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:116:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  963) Manufacturing::Construction::CoveringService#schedule_construction updates coverable status to materials_requested
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:120:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  964) Manufacturing::Construction::CoveringService#schedule_construction returns success with construction job
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:125:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  965) Manufacturing::Construction::CoveringService#start_construction returns false if materials not gathered
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:143:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  966) Manufacturing::Construction::CoveringService#start_construction returns false if equipment not gathered
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:148:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  967) Manufacturing::Construction::CoveringService#start_construction updates job status to in_progress
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:155:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  968) Manufacturing::Construction::CoveringService#start_construction assigns builders through ConstructionManager
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:164:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  969) Manufacturing::Construction::CoveringService#start_construction updates coverable status to under_construction
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:172:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  970) Manufacturing::Construction::CoveringService#track_progress returns false if job not in progress
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:185:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:192:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  971) Manufacturing::Construction::CoveringService#track_progress returns false if construction not complete
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:182:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:198:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  972) Manufacturing::Construction::CoveringService#track_progress completes construction when work is done
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:185:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:205:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  973) Manufacturing::Construction::CoveringService#track_progress updates coverable status
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:213:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  974) Manufacturing::Construction::CoveringService#track_progress releases equipment
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:185:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:220:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  975) Manufacturing::Construction::CoveringService#track_progress returns true when complete
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:182:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:228:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  976) Manufacturing::Construction::DomeService#initialize initializes with default panel type
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  977) Manufacturing::Construction::DomeService#initialize initializes with custom panel type
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  978) Manufacturing::Construction::DomeService#initialize defaults service provider to entity
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  979) Manufacturing::Construction::DomeService#schedule_construction creates a construction job successfully
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  980) Manufacturing::Construction::DomeService#schedule_construction fails when no settlement found
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  981) Manufacturing::Construction::DomeService#schedule_construction creates material and equipment requests for player construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  982) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider processes payment for contracted construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  983) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider does not create material requests for contracted construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  984) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider marks materials and equipment as provided by contractor
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  985) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider handles payment failure gracefully
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  986) Manufacturing::Construction::DomeService#start_construction starts construction when materials and equipment are ready
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  987) Manufacturing::Construction::DomeService#start_construction fails when materials not ready for player construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  988) Manufacturing::Construction::DomeService#start_construction bypasses checks for contracted construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  989) Manufacturing::Construction::DomeService#track_progress completes construction when work is finished
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  990) Manufacturing::Construction::DomeService#track_progress returns false when construction not complete
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  991) Manufacturing::Construction::DomeService#track_progress sets correct status for different layer types
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  992) Manufacturing::Construction::DomeService#track_progress releases equipment when construction completes
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  993) Manufacturing::Construction::DomeService#complete_construction completes the construction process
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  994) Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for primary layer
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  995) Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for secondary layer
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  996) Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for both layers
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  997) Manufacturing::Construction::DomeService private methods #determine_completion_status returns operational for unknown layer types
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  998) Manufacturing::Construction::DomeService private methods #is_player_construction? returns true when entity and provider are the same
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  999) Manufacturing::Construction::DomeService private methods #is_player_construction? returns false when entity and provider are different
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1000) Manufacturing::Construction::HangarService#initialize initializes with default hangar type
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1001) Manufacturing::Construction::HangarService#initialize initializes with custom hangar type
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1002) Manufacturing::Construction::HangarService#initialize raises error for non-large access points
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1003) Manufacturing::Construction::HangarService#schedule_construction creates a hangar structure successfully
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1004) Manufacturing::Construction::HangarService#schedule_construction creates a construction job
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1005) Manufacturing::Construction::HangarService#schedule_construction connects the access point to the hangar
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1006) Manufacturing::Construction::HangarService#schedule_construction fails when no settlement found
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1007) Manufacturing::Construction::HangarService#schedule_construction fails when no blueprint found
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1008) Manufacturing::Construction::HangarService#schedule_construction creates material and equipment requests
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1009) Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for standard rover hangar
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1010) Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for large craft hangar
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1011) Manufacturing::Construction::HangarService#start_construction starts construction when materials and equipment are ready
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1012) Manufacturing::Construction::HangarService#start_construction fails when materials not ready
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1013) Manufacturing::Construction::HangarService#start_construction fails when equipment not ready
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1014) Manufacturing::Construction::HangarService#track_progress completes construction when work is finished
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1015) Manufacturing::Construction::HangarService#track_progress returns false when construction not complete
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1016) Manufacturing::Construction::HangarService#track_progress releases equipment when construction completes
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1017) Manufacturing::Construction::HangarService#calculate_materials calculates materials for standard rover hangar
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1018) Manufacturing::Construction::HangarService#calculate_materials calculates materials for large craft hangar
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1019) Manufacturing::Construction::HangarService#calculate_materials merges blueprint materials with specific materials
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1020) Manufacturing::Construction::HangarService#calculate_construction_time calculates base time for standard hangar
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1021) Manufacturing::Construction::HangarService#calculate_construction_time calculates longer time for large craft hangar
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1022) Manufacturing::Construction::HangarService#calculate_equipment_requirements calculates equipment requirements
        Failure/Error:
          create(:settlement, 
            :independent,
            name: "Olympus Base", 
            location: location,
            owner: player
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1023) Manufacturing::Construction::SegmentCoveringService#initialize uses modular_structural_panel as default
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:19:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1024) Manufacturing::Construction::SegmentCoveringService#initialize finds settlement from worldhouse
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:24:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1025) Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials calculates worldhouse-scale materials
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:30:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:33:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1026) Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials includes cable calculations for massive segments
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:30:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:41:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1027) Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials scales materials by panel count
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:52:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1028) Manufacturing::Construction::SegmentCoveringService#complexity_factor returns 1.5 base factor for worldhouse
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:62:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1029) Manufacturing::Construction::SegmentCoveringService#complexity_factor increases factor for very large segments
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:67:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1030) Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires minimum 10 printers for worldhouse
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:75:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:78:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1031) Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires heavy equipment
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:75:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:85:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1032) Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements scales equipment for massive segments
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:75:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:92:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1033) Manufacturing::Construction::SegmentCoveringService#schedule_construction creates construction phases for large segments
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:105:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1034) Manufacturing::Construction::SegmentCoveringService#schedule_construction includes phase names and durations
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:105:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1035) Manufacturing::Construction::SkylightService#initialize uses skylight-specific default panel type
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:19:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1036) Manufacturing::Construction::SkylightService#initialize finds settlement from lava tube
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:24:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1037) Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates transparent panel materials
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:30:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:33:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1038) Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates solar panel materials
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:30:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:41:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1039) Manufacturing::Construction::SkylightService#calculate_panel_specific_materials scales materials by panel count
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:30:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:51:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1040) Manufacturing::Construction::SkylightService#complexity_factor returns 1.0 for basic transparent panels
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:60:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1041) Manufacturing::Construction::SkylightService#complexity_factor returns 1.5 for solar panels
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:65:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1042) Manufacturing::Construction::SkylightService#complexity_factor returns 1.3 for thermal insulation
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:70:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1043) Manufacturing::Construction::SkylightService#determine_completion_status returns primary_cover for basic transparent
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:76:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:79:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1044) Manufacturing::Construction::SkylightService#determine_completion_status returns solar_cover for solar panels
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:76:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:84:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1045) Manufacturing::Construction::SkylightService#determine_completion_status returns full_cover for structural on primary cover
        Failure/Error: let(:settlement) { create(:settlement) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/construction/skylight_service_spec.rb:89:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1046) Manufacturing::CostCalculator Earth-Imported COGS (EAP-COGS) calculates the EAP-COGS (Earth Import Cost) for the unit
        Failure/Error: base_efficiency = @blueprint.dig('production_data', 'base_material_efficiency') || @blueprint['waste_factor'] ? (1.0 - @blueprint['waste_factor']) : 1.0

        TypeError:
          nil can't be coerced into Float
        # ./app/services/manufacturing/cost_calculator.rb:83:in 'Float#-'
        # ./app/services/manufacturing/cost_calculator.rb:83:in 'Manufacturing::CostCalculator#print_breakdown'
        # ./spec/services/manufacturing/cost_calculator_spec.rb:68:in 'block (3 levels) in <main>'

  1047) Manufacturing::CostCalculator Local Production COGS (LAP-COGS) calculates the LAP-COGS (Local Production Cost) for the unit
        Failure/Error: base_efficiency = @blueprint.dig('production_data', 'base_material_efficiency') || @blueprint['waste_factor'] ? (1.0 - @blueprint['waste_factor']) : 1.0

        TypeError:
          nil can't be coerced into Float
        # ./app/services/manufacturing/cost_calculator.rb:83:in 'Float#-'
        # ./app/services/manufacturing/cost_calculator.rb:83:in 'Manufacturing::CostCalculator#print_breakdown'
        # ./spec/services/manufacturing/cost_calculator_spec.rb:89:in 'block (3 levels) in <main>'

  1048) Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs creates a material processing job record
        Failure/Error:
          Item.create!(
            inventory: @settlement.inventory,
            name: "inert_regolith_waste",
            amount: inert_waste_produced,
            owner: @settlement.owner,
            storage_method: 'bulk_storage',
            metadata: inert_metadata
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/services/manufacturing/material_processing_service.rb:158:in 'block in Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
        # ./app/services/manufacturing/material_processing_service.rb:142:in 'Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
        # ./app/services/manufacturing/material_processing_service.rb:101:in 'Manufacturing::MaterialProcessingService#complete_job'
        # ./app/models/material_processing_job.rb:53:in 'MaterialProcessingJob#complete!'
        # ./app/models/material_processing_job.rb:44:in 'MaterialProcessingJob#process_tick'
        # ./spec/services/manufacturing/material_processing_service_spec.rb:105:in 'block (4 levels) in <main>'
        # ./spec/services/manufacturing/material_processing_service_spec.rb:9:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/material_processing_service_spec.rb:8:in 'block (2 levels) in <main>'

  1049) Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs produces gases with correct composition after job completion
        Failure/Error:
          Item.create!(
            inventory: @settlement.inventory,
            name: "inert_regolith_waste",
            amount: inert_waste_produced,
            owner: @settlement.owner,
            storage_method: 'bulk_storage',
            metadata: inert_metadata
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/services/manufacturing/material_processing_service.rb:158:in 'block in Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
        # ./app/services/manufacturing/material_processing_service.rb:142:in 'Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
        # ./app/services/manufacturing/material_processing_service.rb:101:in 'Manufacturing::MaterialProcessingService#complete_job'
        # ./app/models/material_processing_job.rb:53:in 'MaterialProcessingJob#complete!'
        # ./app/models/material_processing_job.rb:44:in 'MaterialProcessingJob#process_tick'
        # ./spec/services/manufacturing/material_processing_service_spec.rb:113:in 'block (4 levels) in <main>'
        # ./spec/services/manufacturing/material_processing_service_spec.rb:9:in 'block (3 levels) in <main>'
        # ./spec/services/manufacturing/material_processing_service_spec.rb:8:in 'block (2 levels) in <main>'

  1050) Manufacturing::MaterialRequest.create_material_requests creates requests for all required materials
        Failure/Error: let(:construction_job) { create(:construction_job, blueprint: blueprint) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/manufacturing/material_request_system_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/material_request_system_spec.rb:9:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1051) Manufacturing::Processing#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
        Failure/Error: celestial_location = CelestialLocation.find_by(name: @owner.active_location)

        NameError:
          uninitialized constant Manufacturing::Processing::CelestialLocation
        # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'
        # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'
        # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'
        # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'
        # ./spec/services/manufacturing/processing_spec.rb:102:in 'block (4 levels) in <main>'

  1052) Manufacturing::Processing#process when owner does not have enough resources returns an error when resources are insufficient
        Failure/Error:
          expect {
            service.process
          }.to raise_error(RuntimeError, /Insufficient resources: Steel/)

          expected RuntimeError with message matching /Insufficient resources: Steel/, got #<NameError: uninitialized constant Manufacturing::Processing::CelestialLocation> with backtrace:
            # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'
            # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'
            # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'
            # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'
            # ./spec/services/manufacturing/processing_spec.rb:116:in 'block (5 levels) in <main>'
            # ./spec/services/manufacturing/processing_spec.rb:115:in 'block (4 levels) in <main>'
        # ./spec/services/manufacturing/processing_spec.rb:115:in 'block (4 levels) in <main>'

  1053) Manufacturing::Processing#process when owner does not have enough GCC raises an error when GCC is insufficient
        Failure/Error:
          expect {
            service.process
          }.to raise_error(RuntimeError, "Insufficient GCC")

          expected RuntimeError with "Insufficient GCC", got #<NameError: uninitialized constant Manufacturing::Processing::CelestialLocation> with backtrace:
            # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'
            # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'
            # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'
            # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'
            # ./spec/services/manufacturing/processing_spec.rb:128:in 'block (5 levels) in <main>'
            # ./spec/services/manufacturing/processing_spec.rb:127:in 'block (4 levels) in <main>'
        # ./spec/services/manufacturing/processing_spec.rb:127:in 'block (4 levels) in <main>'

  1054) Manufacturing::Service.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1055) Manufacturing::Service.manufacture with real blueprints works with different blueprint categories
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1056) Manufacturing::Service.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1057) Manufacturing::Service.manufacture with different construction cost percentages uses settlement's custom construction percentage
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1058) Manufacturing::Service.manufacture with real blueprint data creates material requests based on actual blueprint requirements
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1059) Manufacturing::Service.manufacture with real blueprint data automatically fulfills material requirements when materials are available
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1060) Manufacturing::Service.manufacture with real blueprint data stores actual blueprint data in specifications
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1061) Manufacturing::Service.manufacture with invalid blueprint returns failure when blueprint not found
        Failure/Error:
          settlement.inventory.items.create!(
            name: 'precision_components',
            amount: 200,
            owner: player,
            material_type: 'component'
          )

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  1062) Market::ConditionUpdaterService.call updates supply for all tracked resources
        Failure/Error: let!(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/condition_updater_service_spec.rb:37:in 'block (2 levels) in <main>'

  1063) Market::ConditionUpdaterService.call updates demand for all tracked resources, respecting smoothing and growth
        Failure/Error: let!(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/condition_updater_service_spec.rb:37:in 'block (2 levels) in <main>'

  1064) Market::ConditionUpdaterService.call creates a market condition if one does not exist
        Failure/Error: let!(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/condition_updater_service_spec.rb:37:in 'block (2 levels) in <main>'

  1065) Market::ConditionUpdaterService.call initializes a marketplace if the settlement does not have one
        Failure/Error: let!(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/condition_updater_service_spec.rb:37:in 'block (2 levels) in <main>'

  1066) Market::ConditionUpdaterService.calculate_new_supply returns zero if net change is a large negative and smooths current supply
        Failure/Error: let!(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/condition_updater_service_spec.rb:37:in 'block (2 levels) in <main>'

  1067) Market::NpcPriceCalculator.calculate_ask with market-based pricing (sufficient history) uses market average with markup
        Failure/Error: let(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/npc_price_calculator_spec.rb:28:in 'block (2 levels) in <main>'
        # ./spec/services/market/npc_price_calculator_spec.rb:93:in 'block (4 levels) in <main>'

  1068) Market::NpcPriceCalculator.calculate_ask with market-based pricing (sufficient history) never goes below cost floor
        Failure/Error: let(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/npc_price_calculator_spec.rb:28:in 'block (2 levels) in <main>'
        # ./spec/services/market/npc_price_calculator_spec.rb:93:in 'block (4 levels) in <main>'

  1069) Market::NpcPriceCalculator error handling handles settlements without location
        Failure/Error: expect(ask_price).to be_present
          expected `nil.present?` to be truthy, got false
        # ./spec/services/market/npc_price_calculator_spec.rb:347:in 'block (3 levels) in <main>'

  1070) Market::NpcPriceCalculator error handling handles nil settlement
        Failure/Error: expect(ask_price).to be_present
          expected `nil.present?` to be truthy, got false
        # ./spec/services/market/npc_price_calculator_spec.rb:355:in 'block (3 levels) in <main>'

  1071) Market::NpcPriceCalculator integration with Market::PriceHistory queries price history for market-based pricing
        Failure/Error: let(:marketplace) { create(:marketplace, settlement: settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/market/npc_price_calculator_spec.rb:28:in 'block (2 levels) in <main>'
        # ./spec/services/market/npc_price_calculator_spec.rb:404:in 'block (3 levels) in <main>'

  1072) Market::TradeExecutionService returns true on successful execution
        Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  1073) Market::TradeExecutionService calls the TaxCollectionService with gross revenue and seller
        Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  1074) Market::TradeExecutionService calls TransactionManager.create_transfer with the NET amount
        Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  1075) Market::TradeExecutionService removes inventory from seller
        Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  1076) Market::TradeExecutionService creates a trade record
        Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  1077) Market::TradeExecutionService creates a price history record
        Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  1078) Market::TradeExecutionService creates a supply chain record
        Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  1079) MaterialLookupService#find_material returns the correct material
        Failure/Error: item = items.find { |i| i['chemical_formula'].casecmp?(name) }

        NoMethodError:
          undefined method 'casecmp?' for nil
        # ./app/services/material_lookup_service.rb:14:in 'block (2 levels) in MaterialLookupService#find_material'
        # ./app/services/material_lookup_service.rb:14:in 'Array#each'
        # ./app/services/material_lookup_service.rb:14:in 'Enumerable#find'
        # ./app/services/material_lookup_service.rb:14:in 'block in MaterialLookupService#find_material'
        # ./app/services/material_lookup_service.rb:8:in 'Hash#each'
        # ./app/services/material_lookup_service.rb:8:in 'MaterialLookupService#find_material'
        # ./spec/services/material_lookup_service_spec.rb:17:in 'block (3 levels) in <main>'

  1080) MaterialLookupService#find_material returns nil for a nonexistent material
        Failure/Error: item = items.find { |i| i['chemical_formula'].casecmp?(name) }

        NoMethodError:
          undefined method 'casecmp?' for nil
        # ./app/services/material_lookup_service.rb:14:in 'block (2 levels) in MaterialLookupService#find_material'
        # ./app/services/material_lookup_service.rb:14:in 'Array#each'
        # ./app/services/material_lookup_service.rb:14:in 'Enumerable#find'
        # ./app/services/material_lookup_service.rb:14:in 'block in MaterialLookupService#find_material'
        # ./app/services/material_lookup_service.rb:8:in 'Hash#each'
        # ./app/services/material_lookup_service.rb:8:in 'MaterialLookupService#find_material'
        # ./spec/services/material_lookup_service_spec.rb:22:in 'block (3 levels) in <main>'

  1081) MaterialRequestService.create_material_requests creates requests for all required materials
        Failure/Error: let(:construction_job) { create(:construction_job, blueprint: blueprint) }

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/material_request_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/material_request_service_spec.rb:9:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1082) Naming::PlanetNameService#add_suffix_to_name adds a suffix to the base name
        Failure/Error: expect(result).to eq("Aurelion I")

          expected: "Aurelion I"
               got: "Aurelion II"

          (compared using ==)
        # ./spec/services/naming/planet_name_service_spec.rb:92:in 'block (3 levels) in <main>'

  1083) Pressurization::HabitatPressurizationService#calculate_habitat_volume calculates correct volume for crater dome
        Failure/Error: dome = build(:crater_dome)

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:5:in 'FactoryBot::Strategy::Build#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/habitat_pressurization_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/habitat_pressurization_service_spec.rb:20:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1084) Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available sources gases from depot tanks
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:10:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1085) Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available uses depot tank gases for pressurization
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:10:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1086) Pressurization::StructurePressurizationService.pressurize_structure when no depot tanks are available falls back to standard pressurization logic
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:39:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1087) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks aggregates gases from all depot tanks
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:48:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1088) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks returns empty hash when no gases are stored
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:48:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1089) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has no depot tanks returns empty hash
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:77:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1090) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when depot tanks have no gas_storage data returns empty hash
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:83:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1091) Pressurization::StructurePressurizationService mining byproduct integration when mining Si produces O2 byproduct increases available gases from depot tanks for pressurization
        Failure/Error: let(:settlement) { create(:base_settlement, :station, owner: player) }

        KeyError:
          Trait not registered: "station"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:5:in 'block (2 levels) in <main>'
        # ./spec/services/pressurization/structure_pressurization_service_spec.rb:100:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "station"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1092) PressurizationService#check_sealing_status with traditional sealed environment returns ready for sealed environment
        Failure/Error: result = service.check_sealing_status

        NoMethodError:
          undefined method 'check_sealing_status' for an instance of PressurizationService
        # ./spec/services/pressurization_service_spec.rb:26:in 'block (4 levels) in <main>'

  1093) PressurizationService#check_sealing_status with traditional sealed environment returns not ready for unsealed environment
        Failure/Error: result = service.check_sealing_status

        NoMethodError:
          undefined method 'check_sealing_status' for an instance of PressurizationService
        # ./spec/services/pressurization_service_spec.rb:32:in 'block (4 levels) in <main>'

  1094) PressurizationService#check_sealing_status with pressurization target (lava tube) returns not ready when requirements not met
        Failure/Error:
          create(:lava_tube,
            operational_data: {
              'pressurization_requirements' => { 'plugs' => 2, 'domes' => 1 },
              'pressurization_progress' => {
                'seals' => { 'plugs' => 1, 'domes' => 0 }
              }
            }
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization_service_spec.rb:40:in 'block (4 levels) in <main>'
        # ./spec/services/pressurization_service_spec.rb:63:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1095) PressurizationService#check_sealing_status with pressurization target (lava tube) returns ready when requirements met
        Failure/Error:
          create(:lava_tube,
            operational_data: {
              'pressurization_requirements' => { 'plugs' => 2, 'domes' => 1 },
              'pressurization_progress' => {
                'seals' => { 'plugs' => 2, 'domes' => 1 },
                'ready_for_pressurization' => true
              }
            }
          )

        KeyError:
          Factory not registered: "settlement"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/pressurization_service_spec.rb:51:in 'block (4 levels) in <main>'
        # ./spec/services/pressurization_service_spec.rb:70:in 'block (4 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "settlement"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1096) PressurizationService#check_sealing_status with pressurization target (canyon) returns not ready when requirements not met
        Failure/Error: @atmosphere = environment.atmospheric_data

        NoMethodError:
          undefined method 'atmospheric_data' for an instance of CelestialBodies::Features::Canyon
        # ./app/models/pressurization_service.rb:5:in 'PressurizationService#initialize'
        # ./spec/services/pressurization_service_spec.rb:89:in 'Class#new'
        # ./spec/services/pressurization_service_spec.rb:89:in 'block (4 levels) in <main>'

  1097) ProcessingService#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
        Failure/Error: celestial_location = CelestialLocation.find_by(name: @owner.active_location)

        NameError:
          uninitialized constant ProcessingService::CelestialLocation
        # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'
        # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'
        # ./spec/services/processing_service_spec.rb:97:in 'Class#new'
        # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'
        # ./spec/services/processing_service_spec.rb:102:in 'block (4 levels) in <main>'

  1098) ProcessingService#process when owner does not have enough resources returns an error when resources are insufficient
        Failure/Error:
          expect {
            service.process
          }.to raise_error(RuntimeError, /Insufficient resources: Steel/)

          expected RuntimeError with message matching /Insufficient resources: Steel/, got #<NameError: uninitialized constant ProcessingService::CelestialLocation> with backtrace:
            # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'
            # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'
            # ./spec/services/processing_service_spec.rb:97:in 'Class#new'
            # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'
            # ./spec/services/processing_service_spec.rb:116:in 'block (5 levels) in <main>'
            # ./spec/services/processing_service_spec.rb:115:in 'block (4 levels) in <main>'
        # ./spec/services/processing_service_spec.rb:115:in 'block (4 levels) in <main>'

  1099) ProcessingService#process when owner does not have enough GCC raises an error when GCC is insufficient
        Failure/Error:
          expect {
            service.process
          }.to raise_error(RuntimeError, "Insufficient GCC")

          expected RuntimeError with "Insufficient GCC", got #<NameError: uninitialized constant ProcessingService::CelestialLocation> with backtrace:
            # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'
            # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'
            # ./spec/services/processing_service_spec.rb:97:in 'Class#new'
            # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'
            # ./spec/services/processing_service_spec.rb:128:in 'block (5 levels) in <main>'
            # ./spec/services/processing_service_spec.rb:127:in 'block (4 levels) in <main>'
        # ./spec/services/processing_service_spec.rb:127:in 'block (4 levels) in <main>'

  1100) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests terraformed names for template-based planets
        Failure/Error:
          count.times do |i|
            @planet_counter += 1
            moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
            moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
            
            # Moons are smaller, with random sizes
            mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
            radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
            
            volume = (4.0/3.0) * Math::PI * (radius ** 3)

        NoMethodError:
          undefined method 'times' for an instance of Float
        # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
        # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./spec/services/star_sim/procedural_generator_spec.rb:166:in 'block (4 levels) in <main>'

  1101) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests neutral names for procedural planets
        Failure/Error:
          count.times do |i|
            @planet_counter += 1
            moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
            moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
            
            # Moons are smaller, with random sizes
            mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
            radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
            
            volume = (4.0/3.0) * Math::PI * (radius ** 3)

        NoMethodError:
          undefined method 'times' for an instance of Float
        # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
        # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./spec/services/star_sim/procedural_generator_spec.rb:178:in 'block (4 levels) in <main>'

  1102) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates applies orbital optimization for template-based planets
        Failure/Error:
          count.times do |i|
            @planet_counter += 1
            moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
            moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
            
            # Moons are smaller, with random sizes
            mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
            radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
            
            volume = (4.0/3.0) * Math::PI * (radius ** 3)

        NoMethodError:
          undefined method 'times' for an instance of Float
        # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
        # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./spec/services/star_sim/procedural_generator_spec.rb:196:in 'block (4 levels) in <main>'

  1103) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates generates procedural planets when not using templates
        Failure/Error:
          count.times do |i|
            @planet_counter += 1
            moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
            moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
            
            # Moons are smaller, with random sizes
            mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
            radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
            
            volume = (4.0/3.0) * Math::PI * (radius ** 3)

        NoMethodError:
          undefined method 'times' for an instance of Float
        # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
        # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
        # ./spec/services/star_sim/procedural_generator_spec.rb:204:in 'block (4 levels) in <main>'

  1104) StarSim::ProceduralGenerator#generate_biosphere_data provides enhanced biosphere for template-based planets
        Failure/Error: expect(result[:biodiversity_index]).to be > 0

          expected: > 0
               got:   nil
        # ./spec/services/star_sim/procedural_generator_spec.rb:324:in 'block (3 levels) in <main>'

  1105) StarSim::ProceduralGenerator#generate_biosphere_data provides basic biosphere for planets with good conditions
        Failure/Error: expect(result[:biodiversity_index]).to be >= 0

          expected: >= 0
               got:    nil
        # ./spec/services/star_sim/procedural_generator_spec.rb:338:in 'block (3 levels) in <main>'

  1106) StarSim::ProceduralGenerator#generate_biosphere_data returns empty biosphere for unsuitable planets
        Failure/Error: expect(result[:biodiversity_index]).to eq(0.0)

          expected: 0.0
               got: nil

          (compared using ==)
        # ./spec/services/star_sim/procedural_generator_spec.rb:350:in 'block (3 levels) in <main>'

  1107) StarSim::ProceduralGenerator integration test generates a complete, valid system
        Failure/Error: expect(planet).to have_key(:atmosphere)
          expected `{"albedo" => 0.3380879334258706, "atmosphere" => {"composition" => {"CO2" => {"percentage" => 80.0}, ...tion_difficulty" => "moderate", "total_CO2_available" => 3.0e+20, "total_H2O_available" => 8.0e+20}}.has_key?(:atmosphere)` to be truthy, got false
        # ./spec/services/star_sim/procedural_generator_spec.rb:467:in 'block (4 levels) in <main>'
        # ./spec/services/star_sim/procedural_generator_spec.rb:455:in 'Array#each'
        # ./spec/services/star_sim/procedural_generator_spec.rb:455:in 'block (3 levels) in <main>'

  1108) TerraSim::AtmosphereSimulationService#initialize initializes with a celestial body
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:24:in 'block (3 levels) in <main>'

  1109) TerraSim::AtmosphereSimulationService#initialize sets up the Stefan-Boltzmann constant
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:28:in 'block (3 levels) in <main>'

  1110) TerraSim::AtmosphereSimulationService#simulate updates the pressure
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  1111) TerraSim::AtmosphereSimulationService#simulate calculates the greenhouse effect
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  1112) TerraSim::AtmosphereSimulationService#simulate updates temperature data in the atmosphere
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  1113) TerraSim::AtmosphereSimulationService#simulate simulates atmospheric loss
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  1114) TerraSim::AtmosphereSimulationService#simulate decreases dust
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  1115) TerraSim::AtmosphereSimulationService temperature calculation methods calculates stefan_boltzmann_temp correctly
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:91:in 'block (3 levels) in <main>'

  1116) TerraSim::AtmosphereSimulationService temperature calculation methods calculates greenhouse_adjusted_temp correctly
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:91:in 'block (3 levels) in <main>'

  1117) TerraSim::AtmosphereSimulationService temperature calculation methods calculates water_vapor_pressure correctly
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:91:in 'block (3 levels) in <main>'

  1118) TerraSim::AtmosphereSimulationService#update_temperatures updates all temperature types in atmosphere
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CO2', percentage: 0.04, mass: 2.1e15)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:13:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
        # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:124:in 'block (3 levels) in <main>'

  1119) TerraSim::BiosphereSimulationService#initialize initializes with a celestial body and sets the biosphere
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1120) TerraSim::BiosphereSimulationService#simulate runs the biosphere simulation steps
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1121) TerraSim::BiosphereSimulationService#simulate prevents concurrent simulations
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1122) TerraSim::BiosphereSimulationService#simulate does nothing if biosphere is nil
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1123) TerraSim::BiosphereSimulationService#calculate_biosphere_conditions calculates and updates habitable ratio and ice latitude
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1124) TerraSim::BiosphereSimulationService#calculate_biosphere_conditions calls update_biodiversity and influence_atmosphere
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1125) TerraSim::BiosphereSimulationService#simulate_ecosystem_interactions simulates plant growth and updates vegetation cover
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1126) TerraSim::BiosphereSimulationService#simulate_ecosystem_interactions simulates basic animal activity (logging for now)
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1127) TerraSim::BiosphereSimulationService#track_species_population updates species populations based on birth and death rates
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1128) TerraSim::BiosphereSimulationService#manage_food_web simulates herbivore consumption and updates vegetation
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1129) TerraSim::BiosphereSimulationService#manage_food_web simulates carnivore predation and updates prey population
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1130) TerraSim::BiosphereSimulationService#balance_biomes attempts to adjust global temperatures towards biome optima
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1131) TerraSim::BiosphereSimulationService#balance_biomes adjusts biome moisture levels based on climate type
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1132) TerraSim::BiosphereSimulationService#balance_biomes attempts to adjust biome area percentages
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1133) TerraSim::BiosphereSimulationService#update_biodiversity calculates and updates the biodiversity index
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1134) TerraSim::BiosphereSimulationService#calculate_biodiversity calculates the biodiversity index based on the number of biomes
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1135) TerraSim::BiosphereSimulationService#influence_atmosphere simulates gas exchange with the atmosphere
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1136) TerraSim::BiosphereSimulationService private #calculate_light_availability calculates light availability based on star luminosity and atmospheric dust
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1137) TerraSim::BiosphereSimulationService private #calculate_temperature_suitability calculates temperature suitability for a given range when within range
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1138) TerraSim::BiosphereSimulationService private #calculate_temperature_suitability calculates temperature suitability for a given range when outside range
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1139) TerraSim::BiosphereSimulationService terraforming integration #calculate_life_form_atmospheric_effects with no life forms returns zero effects
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1140) TerraSim::BiosphereSimulationService terraforming integration #calculate_life_form_atmospheric_effects with multiple life forms aggregates effects from all species
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1141) TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms uses life form effects when available
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1142) TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms scales effects by time
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1143) TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms falls back to hardcoded values when no life forms
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1144) TerraSim::BiosphereSimulationService terraforming integration #simulate with time parameter stores time_skipped for use in other methods
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1145) TerraSim::BiosphereSimulationService terraforming integration #simulate with time parameter passes time to influence_atmosphere
        Failure/Error: let(:planet_biome1) { create(:celestial_bodies_planet_biome, biosphere: biosphere, biome: biome1, moisture_level: 0.7) }

        KeyError:
          Factory not registered: "celestial_bodies_planet_biome"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <module:TerraSim>'
        # ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:41:in 'block (2 levels) in <module:TerraSim>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "celestial_bodies_planet_biome"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1146) TerraSim::ExoticWorldSimulationService#initialize sets planet-specific options
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1147) TerraSim::ExoticWorldSimulationService#initialize accepts custom options
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1148) TerraSim::ExoticWorldSimulationService#planet_type determines planet type from temperature and elements
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1149) TerraSim::ExoticWorldSimulationService#planet_type uses planet_type from celestial body if available
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1150) TerraSim::ExoticWorldSimulationService#planet_type defaults to terrestrial for unknown combinations
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1151) TerraSim::ExoticWorldSimulationService#simulate_planet_specific_processes with an ice giant calls ice-specific simulation methods
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1152) TerraSim::ExoticWorldSimulationService#simulate_planet_specific_processes with a carbon planet calls carbon planet-specific methods
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1153) TerraSim::ExoticWorldSimulationService#simulate_diamond_formation converts carbon to diamond
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1154) TerraSim::ExoticWorldSimulationService#simulate_cryovolcanism adds frozen materials to the planet
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1155) TerraSim::ExoticWorldSimulationService#simulate_extreme_pressure converts hydrogen to metallic hydrogen at extreme pressure
        Failure/Error:
          celestial_body.geosphere.geological_materials.create!(
            name: 'Carbon',
            state: 'solid',
            layer: 'mantle',
            percentage: 10,
            mass: 1000
          )

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:18:in 'block (2 levels) in <main>'

  1156) TerraSim::GeosphereInitializer initializing terrestrial planet geosphere creates a geosphere with terrestrial properties
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:58:in 'block (3 levels) in <main>'

  1157) TerraSim::GeosphereInitializer ice giant initialization creates appropriate ice materials
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:95:in 'block (3 levels) in <main>'

  1158) TerraSim::GeosphereInitializer ice giant initialization creates appropriate mantle materials
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:109:in 'block (3 levels) in <main>'

  1159) TerraSim::GeosphereInitializer exotic materials initialization creates hydrogen in metallic state under extreme conditions
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:138:in 'block (3 levels) in <main>'

  1160) TerraSim::GeosphereInitializer material state determination creates hydrogen as gas in the crust
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:158:in 'block (3 levels) in <main>'

  1161) TerraSim::GeosphereInitializer material state determination creates water ice as solid
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:175:in 'block (3 levels) in <main>'

  1162) TerraSim::GeosphereInitializer initializing terrestrial planet geosphere creates a geosphere with terrestrial properties
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initializer_spec.rb:62:in 'block (3 levels) in <main>'

  1163) TerraSim::GeosphereInitializer ice giant initialization creates appropriate ice materials
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initializer_spec.rb:99:in 'block (3 levels) in <main>'

  1164) TerraSim::GeosphereInitializer exotic materials initialization creates hydrogen in metallic state under extreme conditions
        Failure/Error: @geosphere.save!

        ArgumentError:
          wrong number of arguments (given 0, expected 1..2)
        # ./app/services/terra_sim/geosphere_initializer.rb:20:in 'TerraSim::GeosphereInitializer#initialize_geosphere'
        # ./spec/services/terra_sim/geosphere_initializer_spec.rb:128:in 'block (3 levels) in <main>'

  1165) TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for planets with atmospheres
        Failure/Error: allow_any_instance_of(TerraSim::GeosphereInitializer).to receive(:determine_regolith_depth).and_return(3.0)
          TerraSim::GeosphereInitializer does not implement #determine_regolith_depth
        # ./spec/services/terra_sim/geosphere_initializer_spec.rb:143:in 'block (3 levels) in <main>'

  1166) TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for airless bodies
        Failure/Error: allow_any_instance_of(TerraSim::GeosphereInitializer).to receive(:determine_regolith_depth).and_return(3.0)
          TerraSim::GeosphereInitializer does not implement #determine_regolith_depth
        # ./spec/services/terra_sim/geosphere_initializer_spec.rb:143:in 'block (3 levels) in <main>'

  1167) TerraSim::GeosphereSimulationService#eruption adds volcanic gases to the atmosphere
        Failure/Error: raise InvalidGasError, "Unknown chemical formula or name: #{chemical_formula}. Check materials database."

        AtmosphereConcern::InvalidGasError:
          Unknown chemical formula or name: Water. Check materials database.
        # ./app/models/concerns/atmosphere_concern.rb:101:in 'AtmosphereConcern#add_gas'
        # ./app/services/terra_sim/geosphere_simulation_service.rb:175:in 'TerraSim::GeosphereSimulationService#add_gas_safely'
        # ./app/services/terra_sim/geosphere_simulation_service.rb:214:in 'block in TerraSim::GeosphereSimulationService#eruption'
        # ./app/services/terra_sim/geosphere_simulation_service.rb:209:in 'Hash#each'
        # ./app/services/terra_sim/geosphere_simulation_service.rb:209:in 'TerraSim::GeosphereSimulationService#eruption'
        # ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:124:in 'block (4 levels) in <main>'
        # ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:123:in 'block (3 levels) in <main>'

  1168) TerraSim::HydrosphereSimulationService#simulate calls all simulation methods in order
        Failure/Error: expect(subject).to receive(:handle_ice_melting).once.ordered
          #<TerraSim::HydrosphereSimulationService:0x00007f7c852be518 @celestial_body=#<CelestialBodies::CelestialBody id: 7856, identifier: "CBODY-1093", name: "CelestialBody994", type: nil, size: 0.1e1, gravity: 0.9807e1, density: 0.5514e1, orbital_period: 0.36525e3, mass: 0.5972e25, radius: 0.6371e7, axial_tilt: nil, escape_velocity: 0.111857264923715e5, semi_major_axis: nil, surface_area: nil, volume: nil, status: "active", known_pressure: 0.1e1, parent_celestial_body_id: nil, properties: {}, created_at: "2026-01-11 23:35:44.847213000 +0000", updated_at: "2026-01-11 23:35:44.847213000 +0000", rotational_period: nil, surface_temperature: 250.0, geological_activity: false, solar_system_id: nil, albedo: 0.306, insolation: 1361.0, crust: "{}", mantle: "{}", core: "{}", base_values: {}, current_values: {}, origin_body_id: nil, composition_type: nil>, @hydrosphere=#<CelestialBodies::Spheres::Hydrosphere id: 4325, celestial_body_id: 7856, temperature: 300.0, pressure: 1.0, water_bodies: {"ice_caps" => {"volume" => 100000000000000.0}, "oceans" => {"volume" => 1.0e+15}, "lakes" => {"volume" => 10000000000000.0}, "rivers" => {"volume" => 1000000000000.0}}, composition: {"H2O" => 100.0}, state_distribution: {"solid" => 50.0, "liquid" => 40.0, "gas" => 10.0}, total_water_mass: 1.0e+18, pollution: 0, environment_type: "planetary", sealed_status: false, water_changes: {}, dynamic_pressure: nil, base_values: {"base_liquid_bodies" => {}, "base_composition" => {}, "base_state_distribution" => {"liquid" => 0.0, "solid" => 0.0, "vapor" => 0.0}, "base_temperature" => 0.0, "base_pressure" => 0.0, "base_total_liquid_mass" => 0.0}, created_at: "2026-01-11 23:35:44.907629000 +0000", updated_at: "2026-01-11 23:35:44.907629000 +0000", ocean_temp: nil, lake_temp: nil, river_temp: nil, ice_temp: nil>, @atmosphere=#<CelestialBodies::Spheres::Atmosphere id: 8293, celestial_body_id: 7856, temperature: 250.0, pressure: 1.0, composition: {}, total_atmospheric_mass: 5.0e+18, dust: {}, pollution: 0, environment_type: "planetary", sealing_status: false, gas_changes: {}, dynamic_pressure: nil, base_values: {}, temperature_data: {}, created_at: "2026-01-11 23:35:44.899132000 +0000", updated_at: "2026-01-11 23:35:44.899132000 +0000", craft_id: nil, structure_id: nil, structure_type: nil>, @material_lookup=#<MaterialLookupService:0x00007f7c8d201690 @materials={"materials" => [{"name" => "Water", "chemical_formula" => "H2O", "aliases" => ["Steam", "Water Vapor"], "description" => "Essential for all known forms of life, found in solid, liquid, and gas states.", "boiling_point" => 100.0, "freezing_point" => 0.0, "vapor_point" => 100.0, "melting_point" => 0.0, "molar_mass" => 18.01528}, {"name" => "Carbon Dioxide", "chemical_formula" => "CO2", "description" => "A gas found in planetary atmospheres, critical for photosynthesis and greenhouse effects.", "boiling_point" => -78.5, "freezing_point" => -56.6, "vapor_point" => -78.5, "melting_point" => -56.6, "molar_mass" => 44.01}, {"name" => "Nitrogen", "chemical_formula" => "N2", "description" => "A major component of Earth's atmosphere, inert in most reactions.", "boiling_point" => -195.8, "freezing_point" => -210.0, "vapor_point" => -195.8, "melting_point" => -210.0, "molar_mass" => 28.0134}, {"name" => "Oxygen", "chemical_formula" => "O2", "description" => "Essential for aerobic life, highly reactive and found in Earth's atmosphere.", "boiling_point" => -183.0, "freezing_point" => -218.8, "vapor_point" => -183.0, "melting_point" => -218.8, "molar_mass" => 32.0}, {"name" => "Methane", "chemical_formula" => "CH4", "description" => "A greenhouse gas, often found in atmospheres of planets and moons, also used as a fuel.", "boiling_point" => -161.5, "freezing_point" => -182.5, "vapor_point" => -161.5, "melting_point" => -182.5, "molar_mass" => 16.04}, {"name" => "Hydrogen", "chemical_formula" => "H2", "description" => "The most abundant element in the universe, found in gas giants and used for fusion energy.", "boiling_point" => -252.9, "freezing_point" => -259.2, "vapor_point" => -252.9, "melting_point" => -259.2, "molar_mass" => 2.016}, {"name" => "Helium", "chemical_formula" => "He", "description" => "A noble gas, second most abundant element, found in gas giants and stars.", "boiling_point" => -268.9, "freezing_point" => -272.2, "vapor_point" => -268.9, "melting_point" => -272.2, "molar_mass" => 4.002602}, {"name" => "Sulfur Dioxide", "chemical_formula" => "SO2", "description" => "A toxic gas often associated with volcanic activity.", "boiling_point" => -10.0, "freezing_point" => -72.7, "vapor_point" => -10.0, "melting_point" => -72.7, "molar_mass" => 64.066}, {"name" => "Ammonia", "chemical_formula" => "NH3", "description" => "A compound of nitrogen and hydrogen, common in the atmospheres of gas giants.", "boiling_point" => -33.3, "freezing_point" => -77.7, "vapor_point" => -33.3, "melting_point" => -77.7, "molar_mass" => 17.031}, {"name" => "Argon", "chemical_formula" => "Ar", "description" => "A noble gas present in Earth's atmosphere in small quantities, chemically inert.", "boiling_point" => -185.8, "freezing_point" => -189.3, "vapor_point" => -185.8, "melting_point" => -189.3, "molar_mass" => 39.948}, {"name" => "Neon", "chemical_formula" => "Ne", "description" => "A noble gas found in small quantities in planetary atmospheres, used in neon lighting.", "boiling_point" => -246.0, "freezing_point" => -248.6, "vapor_point" => -246.0, "melting_point" => -248.6, "molar_mass" => 20.1797}, {"name" => "Carbon Monoxide", "chemical_formula" => "CO", "description" => "A toxic gas formed by incomplete combustion of carbon-containing materials.", "boiling_point" => -191.5, "freezing_point" => -205.0, "vapor_point" => -191.5, "melting_point" => -205.0, "molar_mass" => 28.01}, {"name" => "Hydrogen Sulfide", "chemical_formula" => "H2S", "description" => "A toxic gas often associated with volcanic activity, has a characteristic 'rotten egg' smell.", "boiling_point" => -60.3, "freezing_point" => -85.5, "vapor_point" => -60.3, "melting_point" => -85.5, "molar_mass" => 34.08}, {"name" => "Sulfuric Acid", "chemical_formula" => "H2SO4", "description" => "A highly corrosive acid, found in Venus' atmosphere in aerosol form.", "boiling_point" => 337.0, "freezing_point" => 10.0, "vapor_point" => 337.0, "melting_point" => 10.0, "molar_mass" => 98.079}, {"name" => "Sulfur Hexafluoride", "chemical_formula" => "SF6", "description" => "A potent greenhouse gas, used in electrical insulation.", "boiling_point" => -64.0, "freezing_point" => -50.8, "vapor_point" => -64.0, "melting_point" => -50.8, "molar_mass" => 146.06}, {"name" => "Nitrous Oxide", "chemical_formula" => "N2O", "description" => "A greenhouse gas, also used in medical applications as an anesthetic.", "boiling_point" => -88.5, "freezing_point" => -90.8, "vapor_point" => -88.5, "melting_point" => -90.8, "molar_mass" => 44.013}, {"name" => "Ozone", "chemical_formula" => "O3", "description" => "A gas that protects the Earth from ultraviolet radiation.", "boiling_point" => -112.0, "freezing_point" => -192.2, "vapor_point" => -112.0, "melting_point" => -192.2, "molar_mass" => 48.0}, {"name" => "Acetylene", "chemical_formula" => "C2H2", "description" => "A flammable gas used in welding and cutting.", "boiling_point" => -84.0, "freezing_point" => -80.8, "vapor_point" => -84.0, "melting_point" => -80.8, "molar_mass" => 26.04}, {"name" => "Ethanol", "chemical_formula" => "C2H5OH", "description" => "A volatile and flammable liquid, used as a solvent and in beverages.", "boiling_point" => 78.37, "freezing_point" => -114.1, "vapor_point" => 78.37, "melting_point" => -114.1, "molar_mass" => 46.07}, {"name" => "Mercury", "chemical_formula" => "Hg", "description" => "A liquid metal used in thermometers and barometers.", "boiling_point" => 356.73, "freezing_point" => -38.83, "vapor_point" => 356.73, "melting_point" => -38.83, "molar_mass" => 200.59}, {"name" => "Glycerol", "chemical_formula" => "C3H8O3", "description" => "A viscous liquid used in pharmaceuticals and cosmetics.", "boiling_point" => 290.0, "freezing_point" => 18.2, "vapor_point" => 290.0, "melting_point" => 18.2, "molar_mass" => 92.09}, {"name" => "Sodium Bicarbonate", "chemical_formula" => "NaHCO3", "description" => "Commonly known as baking soda, used in cooking and as a buffer.", "boiling_point" => 1000.0, "freezing_point" => 50.0, "vapor_point" => 1000.0, "melting_point" => 50.0, "molar_mass" => 84.01}, {"name" => "Calcium Sulfate", "chemical_formula" => "CaSO4", "description" => "Used in plaster and as a drying agent.", "boiling_point" => 1460.0, "freezing_point" => 1450.0, "vapor_point" => 1460.0, "melting_point" => 1450.0, "molar_mass" => 136.14}, {"name" => "Graphite", "chemical_formula" => "C", "description" => "A form of carbon used in batteries and lubricants.", "boiling_point" => 4200.0, "freezing_point" => 3652.0, "vapor_point" => 4200.0, "melting_point" => 3652.0, "molar_mass" => 12.01}, {"name" => "Diamond", "chemical_formula" => "C", "description" => "Another form of carbon, known for its hardness and use in jewelry.", "boiling_point" => "N/A", "freezing_point" => 3550.0, "vapor_point" => "N/A", "melting_point" => 3550.0, "molar_mass" => 12.01}, {"name" => "Silicon", "chemical_formula" => "Si", "description" => "A semiconductor used in electronics.", "boiling_point" => 2900.0, "freezing_point" => 1414.0, "vapor_point" => 2900.0, "melting_point" => 1414.0, "molar_mass" => 28.085}, {"name" => "Sodium Phosphate", "chemical_formula" => "Na3PO4", "description" => "Used in detergents and as a food additive.", "boiling_point" => 1600.0, "freezing_point" => 1583.0, "vapor_point" => 1600.0, "melting_point" => 1583.0, "molar_mass" => 163.94}], "meteorites" => [{"name" => "Ordinary Chondrites", "type" => "Stony Meteorite", "subtype" => "Chondrite", "description" => "The most common type, made of silicate minerals and chondrules.", "smelting_output" => [{"material" => "Iron", "percentage" => 15.0}, {"material" => "Silicon", "percentage" => 30.0}, {"material" => "Magnesium", "percentage" => 10.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 45.0}]}, {"name" => "Carbonaceous Chondrites", "type" => "Stony Meteorite", "subtype" => "Chondrite", "description" => "Rich in carbon and organic compounds.", "smelting_output" => [{"material" => "Carbon", "percentage" => 20.0}, {"material" => "Silicon", "percentage" => 25.0}, {"material" => "Magnesium", "percentage" => 15.0}, {"material" => "Nickel", "percentage" => 5.0}], "waste_material" => [{"type" => "Organic Residue", "percentage" => 35.0}]}, {"name" => "Howardites", "type" => "Stony-A Metallic Meteorite", "subtype" => "Achondrite", "description" => "Lack chondrules and composed of differentiated materials.", "smelting_output" => [{"material" => "Calcium", "percentage" => 20.0}, {"material" => "Aluminum", "percentage" => 10.0}, {"material" => "Magnesium", "percentage" => 10.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 60.0}]}, {"name" => "Eucrites", "type" => "Stony-A Metallic Meteorite", "subtype" => "Achondrite", "description" => "Lack chondrules and composed of differentiated materials.", "smelting_output" => [{"material" => "Calcium", "percentage" => 25.0}, {"material" => "Silicon", "percentage" => 20.0}, {"material" => "Iron", "percentage" => 15.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 40.0}]}, {"name" => "Diogenites", "type" => "Stony-A Metallic Meteorite", "subtype" => "Achondrite", "description" => "Lack chondrules and composed of differentiated materials.", "smelting_output" => [{"material" => "Calcium", "percentage" => 15.0}, {"material" => "Magnesium", "percentage" => 15.0}, {"material" => "Nickel", "percentage" => 5.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 65.0}]}, {"name" => "Octahedrites", "type" => "Iron Meteorite", "description" => "Primarily composed of iron and nickel.", "smelting_output" => [{"material" => "Iron", "percentage" => 85.0}, {"material" => "Nickel", "percentage" => 10.0}], "waste_material" => [{"type" => "Impurities", "percentage" => 5.0}]}, {"name" => "Hexahedrites", "type" => "Iron Meteorite", "description" => "Primarily composed of iron with little to no nickel.", "smelting_output" => [{"material" => "Iron", "percentage" => 90.0}], "waste_material" => [{"type" => "Impurities", "percentage" => 10.0}]}, {"name" => "Ataxites", "type" => "Iron Meteorite", "description" => "High in nickel content and lacking in structure.", "smelting_output" => [{"material" => "Nickel", "percentage" => 60.0}, {"material" => "Iron", "percentage" => 30.0}], "waste_material" => [{"type" => "Impurities", "percentage" => 10.0}]}, {"name" => "Pallasites", "type" => "Stony-Iron Meteorite", "description" => "Contain roughly equal parts of metal and silicate minerals, often with olivine crystals.", "smelting_output" => [{"material" => "Iron", "percentage" => 30.0}, {"material" => "Nickel", "percentage" => 10.0}, {"material" => "Magnesium", "percentage" => 15.0}], "waste_material" => [{"type" => "Olivine Crystal Residue", "percentage" => 45.0}]}, {"name" => "Mesosiderites", "type" => "Stony-Iron Meteorite", "description" => "Contain both silicate rock and metal.", "smelting_output" => [{"material" => "Iron", "percentage" => 35.0}, {"material" => "Silicon", "percentage" => 20.0}, {"material" => "Nickel", "percentage" => 10.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 35.0}]}, {"name" => "Allende", "type" => "Carbonaceous Chondrite", "description" => "Rich in carbon and organic compounds, provides insights into the early solar system.", "smelting_output" => [{"material" => "Carbon", "percentage" => 30.0}, {"material" => "Nickel", "percentage" => 5.0}, {"material" => "Magnesium", "percentage" => 10.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 55.0}]}, {"name" => "Murchison", "type" => "Carbonaceous Chondrite", "description" => "Contains amino acids and complex organic compounds.", "smelting_output" => [{"material" => "Carbon", "percentage" => 25.0}, {"material" => "Magnesium", "percentage" => 15.0}, {"material" => "Silicon", "percentage" => 10.0}], "waste_material" => [{"type" => "Organic Residue", "percentage" => 50.0}]}, {"name" => "NWA 7034", "type" => "Lunar Meteorite", "description" => "A meteorite originating from the Moon, nicknamed 'Black Beauty.'", "smelting_output" => [{"material" => "Calcium", "percentage" => 20.0}, {"material" => "Silicon", "percentage" => 15.0}, {"material" => "Iron", "percentage" => 10.0}], "waste_material" => [{"type" => "Basaltic Residue", "percentage" => 55.0}]}, {"name" => "Khujerab", "type" => "Lunar Meteorite", "description" => "A meteorite from the Moon, containing basaltic materials.", "smelting_output" => [{"material" => "Calcium", "percentage" => 25.0}, {"material" => "Iron", "percentage" => 15.0}, {"material" => "Magnesium", "percentage" => 10.0}], "waste_material" => [{"type" => "Basaltic Residue", "percentage" => 50.0}]}, {"name" => "ALH84001", "type" => "Martian Meteorite", "description" => "A meteorite from Mars, famous for possible signs of past life.", "smelting_output" => [{"material" => "Calcium", "percentage" => 20.0}, {"material" => "Iron", "percentage" => 20.0}, {"material" => "Magnesium", "percentage" => 10.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 50.0}]}, {"name" => "NWA 7533", "type" => "Martian Meteorite", "description" => "A brecciated meteorite from Mars containing ancient crustal material.", "smelting_output" => [{"material" => "Silicon", "percentage" => 25.0}, {"material" => "Iron", "percentage" => 20.0}, {"material" => "Magnesium", "percentage" => 15.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 40.0}]}], "raw_ores" => [{"name" => "Hematite", "type" => "Iron Ore", "description" => "An iron ore with a high iron content, often reddish-brown.", "smelting_output" => [{"material" => "Iron", "percentage" => 70.0}, {"material" => "Aluminum", "percentage" => 5.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 25.0}]}, {"name" => "Magnetite", "type" => "Iron Ore", "description" => "An iron ore containing both ferrous and ferric iron, magnetic in nature.", "smelting_output" => [{"material" => "Iron", "percentage" => 72.0}, {"material" => "Nickel", "percentage" => 2.0}], "waste_material" => [{"type" => "Gangue Minerals", "percentage" => 26.0}]}, {"name" => "Bauxite", "type" => "Aluminum Ore", "description" => "The primary source of aluminum, usually consisting of a mix of aluminum oxides.", "smelting_output" => [{"material" => "Aluminum", "percentage" => 50.0}, {"material" => "Iron", "percentage" => 5.0}], "waste_material" => [{"type" => "Red Mud", "percentage" => 45.0}]}, {"name" => "Chalcopyrite", "type" => "Copper Ore", "description" => "A common copper ore, often found in sulfide deposits.", "smelting_output" => [{"material" => "Copper", "percentage" => 35.0}, {"material" => "Iron", "percentage" => 10.0}], "waste_material" => [{"type" => "Sulfur Dioxide", "percentage" => 55.0}]}, {"name" => "Galena", "type" => "Lead Ore", "description" => "The primary ore for lead, often with silver as a byproduct.", "smelting_output" => [{"material" => "Lead", "percentage" => 85.0}, {"material" => "Silver", "percentage" => 5.0}], "waste_material" => [{"type" => "Sulfur Residue", "percentage" => 10.0}]}, {"name" => "Sphalerite", "type" => "Zinc Ore", "description" => "The primary source of zinc, often found with galena in sulfide deposits.", "smelting_output" => [{"material" => "Zinc", "percentage" => 60.0}, {"material" => "Iron", "percentage" => 10.0}], "waste_material" => [{"type" => "Sulfur Residue", "percentage" => 30.0}]}, {"name" => "Cassiterite", "type" => "Tin Ore", "description" => "The primary ore for tin, often black or brown in color.", "smelting_output" => [{"material" => "Tin", "percentage" => 70.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 30.0}]}, {"name" => "Cinnabar", "type" => "Mercury Ore", "description" => "A mercury ore with a bright red color.", "smelting_output" => [{"material" => "Mercury", "percentage" => 85.0}], "waste_material" => [{"type" => "Sulfur Residue", "percentage" => 15.0}]}, {"name" => "Bornite", "type" => "Copper Ore", "description" => "An important copper ore, also known as peacock ore due to its iridescent colors.", "smelting_output" => [{"material" => "Copper", "percentage" => 63.0}, {"material" => "Iron", "percentage" => 12.0}], "waste_material" => [{"type" => "Sulfur Residue", "percentage" => 25.0}]}, {"name" => "Pentlandite", "type" => "Nickel Ore", "description" => "A major source of nickel, often found with pyrrhotite and chalcopyrite.", "smelting_output" => [{"material" => "Nickel", "percentage" => 45.0}, {"material" => "Iron", "percentage" => 20.0}], "waste_material" => [{"type" => "Sulfur Residue", "percentage" => 35.0}]}, {"name" => "Ilmenite", "type" => "Titanium Ore", "description" => "A primary source of titanium, often used in aerospace and pigments.", "smelting_output" => [{"material" => "Titanium", "percentage" => 50.0}, {"material" => "Iron", "percentage" => 15.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 35.0}]}, {"name" => "Rutile", "type" => "Titanium Ore", "description" => "Another important titanium ore, often found in beach sands.", "smelting_output" => [{"material" => "Titanium", "percentage" => 80.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 20.0}]}, {"name" => "Uraninite", "type" => "Uranium Ore", "description" => "A uranium-rich mineral used as fuel in nuclear reactors.", "smelting_output" => [{"material" => "Uranium", "percentage" => 65.0}], "waste_material" => [{"type" => "Radioactive Waste", "percentage" => 35.0}]}, {"name" => "Monazite", "type" => "Rare Earth Ore", "description" => "A source of rare earth elements like cerium and lanthanum.", "smelting_output" => [{"material" => "Cerium", "percentage" => 20.0}, {"material" => "Lanthanum", "percentage" => 15.0}], "waste_material" => [{"type" => "Silicate Residue", "percentage" => 65.0}]}, {"name" => "Spodumene", "type" => "Lithium Ore", "description" => "An important source of lithium, used in batteries.", "smelting_output" => [{"material" => "Lithium", "percentage" => 40.0}], "waste_material" => [{"type" => "Silicate Dust", "percentage" => 60.0}]}]}>> does not implement: handle_ice_melting
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:101:in 'block (3 levels) in <main>'

  1169) TerraSim::HydrosphereSimulationService#simulate prevents recursive calls with simulation flag
        Failure/Error: calculate_region_temperatures

        SystemStackError:
          stack level too deep
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:108:in 'block (4 levels) in <main>'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:112:in 'block (3 levels) in <main>'

  1170) TerraSim::HydrosphereSimulationService#calculate_region_temperatures calculates temperatures for all water bodies
        Failure/Error: volume_effect = Math.log(volume + 1) # Larger volumes retain more cold temperature

        NoMethodError:
          undefined method '+' for an instance of Hash
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:126:in 'block (3 levels) in <main>'

  1171) TerraSim::HydrosphereSimulationService#calculate_region_temperatures sets water temperatures cooler than surface temperature
        Failure/Error: volume_effect = Math.log(volume + 1) # Larger volumes retain more cold temperature

        NoMethodError:
          undefined method '+' for an instance of Hash
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:135:in 'block (3 levels) in <main>'

  1172) TerraSim::HydrosphereSimulationService#handle_evaporation decreases water body volumes
        Failure/Error: evaporation_rate = (surface_temp - water_temp) * 0.001 # Basic evaporation constant factor

        TypeError:
          nil can't be coerced into Float
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:79:in 'Float#-'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:79:in 'TerraSim::HydrosphereSimulationService#calculate_evaporation'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:47:in 'TerraSim::HydrosphereSimulationService#handle_evaporation'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:149:in 'block (3 levels) in <main>'

  1173) TerraSim::HydrosphereSimulationService#handle_evaporation adds water vapor to the atmosphere
        Failure/Error: evaporation_rate = (surface_temp - water_temp) * 0.001 # Basic evaporation constant factor

        TypeError:
          nil can't be coerced into Float
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:79:in 'Float#-'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:79:in 'TerraSim::HydrosphereSimulationService#calculate_evaporation'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:47:in 'TerraSim::HydrosphereSimulationService#handle_evaporation'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:159:in 'block (3 levels) in <main>'

  1174) TerraSim::HydrosphereSimulationService#handle_evaporation handles numeric volume values (not hashes)
        Failure/Error: expect { subject.send(:handle_evaporation) }.not_to raise_error

          expected no Exception, got #<TypeError: nil can't be coerced into Float> with backtrace:
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:79:in 'Float#-'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:79:in 'TerraSim::HydrosphereSimulationService#calculate_evaporation'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:47:in 'TerraSim::HydrosphereSimulationService#handle_evaporation'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:167:in 'block (4 levels) in <main>'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:167:in 'block (3 levels) in <main>'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:167:in 'block (3 levels) in <main>'

  1175) TerraSim::HydrosphereSimulationService#handle_precipitation increases water body volumes
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'H2O', mass: 1.0e12)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:174:in 'block (3 levels) in <main>'

  1176) TerraSim::HydrosphereSimulationService#handle_precipitation removes water vapor from the atmosphere
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'H2O', mass: 1.0e12)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:174:in 'block (3 levels) in <main>'

  1177) TerraSim::HydrosphereSimulationService#handle_precipitation decreases atmospheric dust concentration
        Failure/Error: create(:gas, atmosphere: atmosphere, name: 'H2O', mass: 1.0e12)

        NameError:
          uninitialized constant Gas
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:174:in 'block (3 levels) in <main>'

  1178) TerraSim::HydrosphereSimulationService#calculate_state_distributions calculates state distribution based on temperature and pressure
        Failure/Error: subject.send(:calculate_state_distributions)

        NoMethodError:
          undefined method 'calculate_state_distributions' for #<TerraSim::HydrosphereSimulationService:0x00007f7c84b413d0>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:211:in 'block (3 levels) in <main>'

  1179) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing melts ice from polar caps
        Failure/Error: subject.send(:handle_ice_melting)

        NoMethodError:
          undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c84dd6230>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:232:in 'block (4 levels) in <main>'

  1180) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to decrease solid percentage
        Failure/Error: subject.send(:handle_ice_melting)

        NoMethodError:
          undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c850db368>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:243:in 'block (4 levels) in <main>'

  1181) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to increase liquid percentage
        Failure/Error: subject.send(:handle_ice_melting)

        NoMethodError:
          undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c8535dca8>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:254:in 'block (4 levels) in <main>'

  1182) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing does not allow solid percentage to go negative
        Failure/Error: subject.send(:handle_ice_melting)

        NoMethodError:
          undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c85437e08>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:267:in 'block (4 levels) in <main>'

  1183) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing adds some melted water as vapor to atmosphere
        Failure/Error: subject.send(:handle_ice_melting)

        NoMethodError:
          undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c854c64f0>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:276:in 'block (4 levels) in <main>'

  1184) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing does not melt more than maximum allowed per cycle
        Failure/Error: subject.send(:handle_ice_melting)

        NoMethodError:
          undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c85589ce8>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:287:in 'block (4 levels) in <main>'

  1185) TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is below freezing does not melt any ice
        Failure/Error: subject.send(:handle_ice_melting)

        NoMethodError:
          undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c8562ba48>
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:305:in 'block (4 levels) in <main>'

  1186) TerraSim::HydrosphereSimulationService#handle_ice_melting when ice caps do not exist returns early without error
        Failure/Error: expect { subject.send(:handle_ice_melting) }.not_to raise_error

          expected no Exception, got #<NoMethodError: undefined method 'handle_ice_melting' for #<TerraSim::HydrosphereSimulationService:0x00007f7c856d79b0>> with backtrace:
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:325:in 'block (5 levels) in <main>'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:325:in 'block (4 levels) in <main>'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:325:in 'block (4 levels) in <main>'

  1187) TerraSim::HydrosphereSimulationService#update_hydrosphere_volume delegates to the hydrosphere model method
        Failure/Error: total_volume = @hydrosphere.oceans + @hydrosphere.lakes + @hydrosphere.rivers + @hydrosphere.ice

        NoMethodError:
          undefined method '+' for an instance of Hash
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:118:in 'TerraSim::HydrosphereSimulationService#update_hydrosphere_volume'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:334:in 'block (3 levels) in <main>'

  1188) TerraSim::HydrosphereSimulationService integration: full simulation cycle runs a complete simulation without errors
        Failure/Error: expect { subject.simulate }.not_to raise_error

          expected no Exception, got #<NoMethodError: undefined method '+' for an instance of Hash> with backtrace:
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:340:in 'block (4 levels) in <main>'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:340:in 'block (3 levels) in <main>'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:340:in 'block (3 levels) in <main>'

  1189) TerraSim::HydrosphereSimulationService integration: full simulation cycle maintains valid state distribution percentages
        Failure/Error: volume_effect = Math.log(volume + 1) # Larger volumes retain more cold temperature

        NoMethodError:
          undefined method '+' for an instance of Hash
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:346:in 'block (3 levels) in <main>'

  1190) TerraSim::HydrosphereSimulationService integration: full simulation cycle never produces negative state distribution values
        Failure/Error: volume_effect = Math.log(volume + 1) # Larger volumes retain more cold temperature

        NoMethodError:
          undefined method '+' for an instance of Hash
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
        # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:363:in 'block (4 levels) in <main>'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:363:in 'block (3 levels) in <main>'

  1191) TerraSim::HydrosphereSimulationService edge cases with extreme cold temperature handles extreme cold without errors
        Failure/Error: expect { subject.simulate }.not_to raise_error

          expected no Exception, got #<NoMethodError: undefined method '+' for an instance of Hash> with backtrace:
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:383:in 'block (5 levels) in <main>'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:383:in 'block (4 levels) in <main>'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:383:in 'block (4 levels) in <main>'

  1192) TerraSim::HydrosphereSimulationService edge cases with extreme hot temperature handles extreme heat without errors
        Failure/Error: expect { subject.simulate }.not_to raise_error

          expected no Exception, got #<NoMethodError: undefined method '+' for an instance of Hash> with backtrace:
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:393:in 'block (5 levels) in <main>'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:393:in 'block (4 levels) in <main>'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:393:in 'block (4 levels) in <main>'

  1193) TerraSim::HydrosphereSimulationService edge cases with zero water bodies handles zero volumes without errors
        Failure/Error: expect { subject.simulate }.not_to raise_error

          expected no Exception, got #<NoMethodError: undefined method '+' for an instance of Hash> with backtrace:
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:38:in 'TerraSim::HydrosphereSimulationService#calculate_water_temp'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:30:in 'TerraSim::HydrosphereSimulationService#calculate_region_temperatures'
            # ./app/services/terra_sim/hydrosphere_simulation_service.rb:14:in 'TerraSim::HydrosphereSimulationService#simulate'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:408:in 'block (5 levels) in <main>'
            # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:408:in 'block (4 levels) in <main>'
        # ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:408:in 'block (4 levels) in <main>'

  1194) Tier1PriceModeler#calculate_eap with titanium alloy calculates the correct EAP
        Failure/Error: expect(eap).to be_within(0.01).of(187.50)
          expected 0.0 to be within 0.01 of 187.5
        # ./spec/services/tier1_price_modeler_spec.rb:76:in 'block (4 levels) in <main>'

  1195) Tier1PriceModeler#calculate_eap with titanium alloy can print breakdown without errors
        Failure/Error: expect { calculator.print_breakdown }.not_to raise_error

          expected no Exception, got #<NameError: uninitialized constant GameConstants::INITIAL_TRANSPORTATION_COST_PER_KG_LUNA> with backtrace:
            # ./app/services/logistics/transport_cost_service.rb:28:in 'Logistics::TransportCostService.calculate_cost_per_kg'
            # ./app/services/tier1_price_modeler.rb:152:in 'Tier1PriceModeler#calculate_transport_cost'
            # ./app/services/tier1_price_modeler.rb:63:in 'Tier1PriceModeler#print_breakdown'
            # ./spec/services/tier1_price_modeler_spec.rb:80:in 'block (5 levels) in <main>'
            # ./spec/services/tier1_price_modeler_spec.rb:80:in 'block (4 levels) in <main>'
        # ./spec/services/tier1_price_modeler_spec.rb:80:in 'block (4 levels) in <main>'

  1196) Tier1PriceModeler#calculate_eap with composite insulation calculates the correct EAP
        Failure/Error: expect(eap).to be_within(0.01).of(156.00)
          expected 0.0 to be within 0.01 of 156.0
        # ./spec/services/tier1_price_modeler_spec.rb:93:in 'block (4 levels) in <main>'

  1197) Tier1PriceModeler#calculate_eap with pressure valves calculates the correct EAP
        Failure/Error: expect(eap).to be_within(0.01).of(166.00)
          expected 0.0 to be within 0.01 of 166.0
        # ./spec/services/tier1_price_modeler_spec.rb:106:in 'block (4 levels) in <main>'

  1198) Tier1PriceModeler#calculate_eap with electronics calculates the correct EAP
        Failure/Error: expect(eap).to be_within(0.01).of(320.00)
          expected 0.0 to be within 0.01 of 320.0
        # ./spec/services/tier1_price_modeler_spec.rb:119:in 'block (4 levels) in <main>'

  1199) Tier1PriceModeler EAP storage for downstream use stores calculated EAPs in a hash
        Failure/Error: expect(new_market_prices.values).to all(be > 0)

          expected [0.0, 0.0, 0.0, 0.0] to all be > 0

             object at index 0 failed to match:
                expected: > 0
                     got:   0.0

             object at index 1 failed to match:
                expected: > 0
                     got:   0.0

             object at index 2 failed to match:
                expected: > 0
                     got:   0.0

             object at index 3 failed to match:
                expected: > 0
                     got:   0.0
        # ./spec/services/tier1_price_modeler_spec.rb:175:in 'block (3 levels) in <main>'

  1200) Tier1PriceModeler integration with EconomicConfig uses earth spot prices from config when available
        Failure/Error: expect(eap).to be > 0

          expected: > 0
               got:   0.0
        # ./spec/services/tier1_price_modeler_spec.rb:208:in 'block (3 levels) in <main>'

  1201) Tier1PriceModeler#print_breakdown outputs detailed breakdown
        Failure/Error: return GameConstants::INITIAL_TRANSPORTATION_COST_PER_KG_LUNA

        NameError:
          uninitialized constant GameConstants::INITIAL_TRANSPORTATION_COST_PER_KG_LUNA
        # ./app/services/logistics/transport_cost_service.rb:28:in 'Logistics::TransportCostService.calculate_cost_per_kg'
        # ./app/services/tier1_price_modeler.rb:152:in 'Tier1PriceModeler#calculate_transport_cost'
        # ./app/services/tier1_price_modeler.rb:63:in 'Tier1PriceModeler#print_breakdown'
        # ./spec/services/tier1_price_modeler_spec.rb:217:in 'block (4 levels) in <main>'
        # ./spec/services/tier1_price_modeler_spec.rb:217:in 'block (3 levels) in <main>'

  1202) Tier1PriceModeler#print_breakdown returns the calculated EAP
        Failure/Error: return GameConstants::INITIAL_TRANSPORTATION_COST_PER_KG_LUNA

        NameError:
          uninitialized constant GameConstants::INITIAL_TRANSPORTATION_COST_PER_KG_LUNA
        # ./app/services/logistics/transport_cost_service.rb:28:in 'Logistics::TransportCostService.calculate_cost_per_kg'
        # ./app/services/tier1_price_modeler.rb:152:in 'Tier1PriceModeler#calculate_transport_cost'
        # ./app/services/tier1_price_modeler.rb:63:in 'Tier1PriceModeler#print_breakdown'
        # ./spec/services/tier1_price_modeler_spec.rb:221:in 'block (3 levels) in <main>'

  1203) TradeService#dynamic_price calculates the dynamic price based on scarcity, transportation, and market conditions
        Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

        ActiveRecord::RecordInvalid:
          Validation failed: Colony must have at least two settlements
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:12:in 'block (3 levels) in <main>'

  1204) TradeService#base_price_for_type returns the correct base price for raw materials
        Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

        ActiveRecord::RecordInvalid:
          Validation failed: Colony must have at least two settlements
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:28:in 'block (3 levels) in <main>'

  1205) TradeService#base_price_for_type returns the correct base price for processed goods
        Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

        ActiveRecord::RecordInvalid:
          Validation failed: Colony must have at least two settlements
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:33:in 'block (3 levels) in <main>'

  1206) TradeService#fuel_cost_per_unit returns the correct fuel cost per unit
        Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

        ActiveRecord::RecordInvalid:
          Validation failed: Colony must have at least two settlements
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:41:in 'block (3 levels) in <main>'

  1207) TradeService#distance_to_buyer calculates the distance between colonies
        Failure/Error: planet_a = create(:planet, distance_from: 10000)

        KeyError:
          Factory not registered: "planet"
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/trade_service_spec.rb:48:in 'block (3 levels) in <main>'
        # ------------------
        # --- Caused by: ---
        # KeyError:
        #   key not found: "planet"
        #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  1208) TradeService#market_conditions returns a random market condition modifier
        Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

        ActiveRecord::RecordInvalid:
          Validation failed: Colony must have at least two settlements
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
        # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
        # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
        # ./spec/services/trade_service_spec.rb:60:in 'block (3 levels) in <main>'

  1209) UnitModuleAssemblyService.build_units_and_modules creates units from the recommended fit
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1210) UnitModuleAssemblyService.build_units_and_modules creates modules from the recommended fit
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1211) UnitModuleAssemblyService.build_units_and_modules creates rigs from the recommended fit
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1212) UnitModuleAssemblyService.build_units_and_modules processes custom port configurations
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1213) UnitModuleAssemblyService.build_units_and_modules handles missing inventory items gracefully
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1214) UnitModuleAssemblyService.build_units_and_modules handles missing recommended fit data gracefully
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1215) UnitModuleAssemblyService.build_units_and_modules assigns correct port names to components
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1216) UnitModuleAssemblyService.disconnect_unit disconnects a unit and returns it to inventory as an item
        Failure/Error: item.save!

        ActiveRecord::RecordInvalid:
          Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
        # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
        # ./app/models/inventory.rb:29:in 'Inventory#add_item'
        # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  1217) WormholeConsortiumFormationService creates memberships for founding members and updates consortium operational_data
        Failure/Error: member = Organizations::Corporation.find_by(identifier: identifier)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./app/services/wormhole_consortium_formation_service.rb:11:in 'block in WormholeConsortiumFormationService.form_consortium'
        # ./app/services/wormhole_consortium_formation_service.rb:10:in 'Hash#each'
        # ./app/services/wormhole_consortium_formation_service.rb:10:in 'WormholeConsortiumFormationService.form_consortium'
        # ./spec/services/wormhole_consortium_formation_service_spec.rb:11:in 'block (3 levels) in <main>'
        # ./spec/services/wormhole_consortium_formation_service_spec.rb:10:in 'block (2 levels) in <main>'

  1218) WormholeConsortiumFormationService updates member operational_data with consortium membership
        Failure/Error: member = Organizations::Corporation.find_by(identifier: identifier)

        NameError:
          uninitialized constant Organizations::Corporation
        # ./app/services/wormhole_consortium_formation_service.rb:11:in 'block in WormholeConsortiumFormationService.form_consortium'
        # ./app/services/wormhole_consortium_formation_service.rb:10:in 'Hash#each'
        # ./app/services/wormhole_consortium_formation_service.rb:10:in 'WormholeConsortiumFormationService.form_consortium'
        # ./spec/services/wormhole_consortium_formation_service_spec.rb:21:in 'block (2 levels) in <main>'

  1219) Guaranteed Market Sale Transaction guaranteed sell order execution executes atomically and creates all required records
        Failure/Error: let!(:marketplace) { Market::Marketplace.create!(settlement: luna_settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # ./spec/transactions/guaranteed_market_sale_spec.rb:12:in 'block (2 levels) in <main>'

  1220) Guaranteed Market Sale Transaction guaranteed sell order execution does not create a SupplyChain record if no matching buy order exists
        Failure/Error: let!(:marketplace) { Market::Marketplace.create!(settlement: luna_settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # ./spec/transactions/guaranteed_market_sale_spec.rb:12:in 'block (2 levels) in <main>'

  1221) Guaranteed Market Sale Transaction guaranteed sell order execution creates a Trade record with correct buyer and seller
        Failure/Error: let!(:marketplace) { Market::Marketplace.create!(settlement: luna_settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # ./spec/transactions/guaranteed_market_sale_spec.rb:12:in 'block (2 levels) in <main>'

  1222) Guaranteed Market Sale Transaction guaranteed sell order execution marks the order as filled by returning nil
        Failure/Error: let!(:marketplace) { Market::Marketplace.create!(settlement: luna_settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # ./spec/transactions/guaranteed_market_sale_spec.rb:12:in 'block (2 levels) in <main>'

  1223) Guaranteed Market Sale Transaction guaranteed sell order execution records a PriceHistory entry after trade execution
        Failure/Error: let!(:marketplace) { Market::Marketplace.create!(settlement: luna_settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # ./spec/transactions/guaranteed_market_sale_spec.rb:12:in 'block (2 levels) in <main>'

  1224) Guaranteed Market Sale Transaction guaranteed sell order execution calls TransactionManager.create_transfer with correct arguments
        Failure/Error: let!(:marketplace) { Market::Marketplace.create!(settlement: luna_settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # ./spec/transactions/guaranteed_market_sale_spec.rb:12:in 'block (2 levels) in <main>'

  1225) Guaranteed Market Sale Transaction guaranteed sell order execution creates a SupplyChain record with correct volume and status
        Failure/Error: let!(:marketplace) { Market::Marketplace.create!(settlement: luna_settlement) }

        ActiveModel::MissingAttributeError:
          can't write unknown attribute `settlement_id`
        # ./spec/transactions/guaranteed_market_sale_spec.rb:12:in 'block (2 levels) in <main>'

Finished in 18 minutes 49 seconds (files took 27.13 seconds to load)
3110 examples, 1225 failures, 20 pending, 1 error occurred outside of examples

Failed examples:

rspec ./spec/controllers/game_controller_spec.rb:68 # GameController GET #index solar system seeding and display calls SystemBuilderService to build the system if no solar system exists
rspec ./spec/controllers/game_controller_spec.rb:82 # GameController GET #index solar system seeding and display correctly calculates @planet_count excluding satellites
rspec ./spec/controllers/game_controller_spec.rb:87 # GameController GET #index solar system seeding and display defines is_moon and body_category singleton methods on celestial bodies
rspec ./spec/controllers/game_controller_spec.rb:102 # GameController GET #index solar system seeding and display generates correct JSON with parent_body_identifier for moons
rspec ./spec/controllers/game_controller_spec.rb:118 # GameController GET #index solar system seeding and display returns JSON with correct celestial bodies data
rspec ./spec/controllers/game_controller_spec.rb:134 # GameController POST #toggle_running toggles the running state from false to true
rspec ./spec/controllers/game_controller_spec.rb:140 # GameController POST #toggle_running toggles the running state from true to false
rspec ./spec/controllers/game_controller_spec.rb:146 # GameController POST #toggle_running returns JSON with the updated state
rspec ./spec/controllers/game_controller_spec.rb:157 # GameController POST #set_speed updates the game speed
rspec ./spec/controllers/game_controller_spec.rb:163 # GameController POST #set_speed clamps the speed value between 1 and 5
rspec ./spec/controllers/game_controller_spec.rb:173 # GameController POST #jump_time adds the specified number of days
rspec ./spec/controllers/game_controller_spec.rb:179 # GameController POST #jump_time handles year rollover
rspec ./spec/controllers/game_controller_spec.rb:186 # GameController POST #jump_time clamps days between 1 and 365
rspec ./spec/controllers/game_controller_spec.rb:195 # GameController GET #state returns the current game state
rspec ./spec/controllers/game_controller_spec.rb:205 # GameController GET #state updates time if running
rspec ./spec/controllers/game_controller_spec.rb:218 # GameController GET #simulation assigns the correct solar system and its primary star
rspec ./spec/controllers/game_controller_spec.rb:226 # GameController GET #simulation redirects to root_path if solar system not found
rspec ./spec/controllers/game_controller_spec.rb:236 # GameController GET #index edge cases handles missing solar system gracefully
rspec ./spec/controllers/game_controller_spec.rb:266 # GameController private get_or_create_game_state creates a new game state if none exists
rspec ./spec/controllers/game_controller_spec.rb:272 # GameController private get_or_create_game_state returns the existing game state if present
rspec ./spec/controllers/transactions_controller_spec.rb:32 # TransactionsController POST #create with valid parameters creates a new financial transaction
rspec ./spec/controllers/transactions_controller_spec.rb:38 # TransactionsController POST #create with valid parameters creates the transaction with correct account information and amount
rspec ./spec/controllers/transactions_controller_spec.rb:50 # TransactionsController POST #create with valid parameters does not attempt to collect tax (enforces separation of concerns)
rspec ./spec/controllers/transactions_controller_spec.rb:57 # TransactionsController POST #create with valid parameters returns a success message
rspec ./spec/controllers/transactions_controller_spec.rb:68 # TransactionsController POST #create with invalid parameters does not create a transaction if amount is missing
rspec ./spec/controllers/transactions_controller_spec.rb:81 # TransactionsController POST #create with invalid parameters returns an error message if amount is missing or invalid
rspec ./spec/data/alien_world_templates_integrity_spec.rb:19 # Alien World Template Integrity template file exists
rspec ./spec/data/alien_world_templates_integrity_spec.rb:24 # Alien World Template Integrity is valid JSON
rspec ./spec/data/alien_world_templates_integrity_spec.rb:28 # Alien World Template Integrity contains terrestrial_planets array
rspec ./spec/data/alien_world_templates_integrity_spec.rb:32 # Alien World Template Integrity contains exactly 25 templates (A01 → A25)
rspec ./spec/data/alien_world_templates_integrity_spec.rb:40 # Alien World Template Integrity has unique identifiers
rspec ./spec/data/alien_world_templates_integrity_spec.rb:46 # Alien World Template Integrity has unique template names
rspec ./spec/data/alien_world_templates_integrity_spec.rb:63 # Alien World Template Integrity required schema fields each template contains all required fields
rspec ./spec/data/alien_world_templates_integrity_spec.rb:74 # Alien World Template Integrity atmosphere rules contains no oxygen by default
rspec ./spec/data/alien_world_templates_integrity_spec.rb:83 # Alien World Template Integrity atmosphere rules has pressure > 0
rspec ./spec/data/alien_world_templates_integrity_spec.rb:93 # Alien World Template Integrity terraforming metadata terraforming_difficulty is between 1 and 10
rspec ./spec/data/alien_world_templates_integrity_spec.rb:101 # Alien World Template Integrity terraforming metadata engineered_atmosphere defaults to false
rspec ./spec/data/alien_world_templates_integrity_spec.rb:110 # Alien World Template Integrity volatile reservoirs has CO2 and H2O reservoirs defined
rspec ./spec/data/alien_world_templates_integrity_spec.rb:120 # Alien World Template Integrity material yield bias contains all yield bias categories
rspec ./spec/data/templates/alien_world_templates_spec.rb:15 # Alien World Templates Integrity exists and is valid JSON
rspec ./spec/data/templates/alien_world_templates_spec.rb:23 # Alien World Templates Integrity metadata exists
rspec ./spec/data/templates/alien_world_templates_spec.rb:27 # Alien World Templates Integrity metadata has required fields
rspec ./spec/data/templates/alien_world_templates_spec.rb:41 # Alien World Templates Integrity metadata is versioned correctly
rspec ./spec/data/templates/alien_world_templates_spec.rb:50 # Alien World Templates Integrity terrestrial planet templates exists and is an array
rspec ./spec/data/templates/alien_world_templates_spec.rb:54 # Alien World Templates Integrity terrestrial planet templates contains exactly 25 templates
rspec ./spec/data/templates/alien_world_templates_spec.rb:58 # Alien World Templates Integrity terrestrial planet templates has unique identifiers
rspec ./spec/data/templates/alien_world_templates_spec.rb:63 # Alien World Templates Integrity terrestrial planet templates covers Template-A01 through Template-A25
rspec ./spec/data/templates/alien_world_templates_spec.rb:69 # Alien World Templates Integrity terrestrial planet templates all templates are terrestrial
rspec ./spec/data/templates/alien_world_templates_spec.rb:88 # Alien World Templates Integrity template schema validation each template contains all required fields
rspec ./spec/data/templates/alien_world_templates_spec.rb:99 # Alien World Templates Integrity atmospheric constraints contains no oxygen by default
rspec ./spec/data/templates/alien_world_templates_spec.rb:109 # Alien World Templates Integrity sanity checks has realistic gravity values
rspec ./spec/data/templates/alien_world_templates_spec.rb:115 # Alien World Templates Integrity sanity checks has positive pressure
rspec ./spec/data/templates/alien_world_templates_spec.rb:121 # Alien World Templates Integrity sanity checks terraforming difficulty is bounded
rspec ./spec/initializers/game_data_paths_spec.rb:4 # GameDataPaths sets the correct path based on environment
rspec ./spec/integration/component_production_game_loop_spec.rb:117 # Component Production Game Loop Integration full production cycle produces components through game loop progression
rspec ./spec/integration/component_production_game_loop_spec.rb:148 # Component Production Game Loop Integration full production cycle handles partial progress over multiple ticks
rspec ./spec/integration/component_production_game_loop_spec.rb:164 # Component Production Game Loop Integration full production cycle processes multiple jobs simultaneously
rspec ./spec/integration/covering_system_integration_spec.rb:43 # Covering System Integration Lava tube worldhouse covering workflow seals skylights when worldhouse construction completes
rspec ./spec/integration/covering_system_integration_spec.rb:155 # Covering System Integration Worldhouse segment covering workflow handles massive scale covering
rspec ./spec/integration/covering_system_integration_spec.rb:176 # Covering System Integration Multi-scale comparison uses same system for different scales
rspec ./spec/integration/manufacturing_pipeline_e2e_spec.rb:277 # Manufacturing Pipeline End-to-End complete ISRU to enclosed tank pipeline processes raw regolith through all stages to produce an enclosed tank
rspec ./spec/integration/manufacturing_pipeline_e2e_spec.rb:589 # Manufacturing Pipeline End-to-End material tracking through pipeline preserves composition metadata through processing chain
rspec ./spec/integration/terraforming_integration_spec.rb:67 # Terraforming Integration end-to-end terraforming simulation creates a barren planet with correct initial conditions
rspec ./spec/integration/terraforming_integration_spec.rb:120 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time increases oxygen levels after 1 day
rspec ./spec/integration/terraforming_integration_spec.rb:130 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time decreases CO2 levels after 1 day
rspec ./spec/integration/terraforming_integration_spec.rb:140 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time shows progressive changes over 100 days
rspec ./spec/integration/terraforming_integration_spec.rb:171 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time scales effects by time parameter
rspec ./spec/integration/terraforming_integration_spec.rb:199 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed life form populations over time maintains or grows populations under favorable conditions
rspec ./spec/integration/terraforming_integration_spec.rb:217 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed combined effects from multiple species aggregates atmospheric effects from all life forms
rspec ./spec/integration/terraforming_integration_spec.rb:244 # Terraforming Integration end-to-end terraforming simulation without life forms uses fallback values when no terraforming organisms exist
rspec ./spec/integration/terraforming_integration_spec.rb:258 # Terraforming Integration realistic terraforming scenario demonstrates full terraforming workflow
rspec ./spec/integration/terraforming_workflow_spec.rb:69 # Terraforming Workflow Integration transforms atmosphere over time with deployed organisms
rspec ./spec/integration/terraforming_workflow_spec.rb:107 # Terraforming Workflow Integration allows monitoring of terraforming progress
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:34 # ConcurrentTaskWorkerJob#perform with manufacturing task during daylight executes the task successfully
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:41 # ConcurrentTaskWorkerJob#perform with manufacturing task during daylight generates manufacturing byproducts
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:54 # ConcurrentTaskWorkerJob#perform with manufacturing task during low light does not generate byproducts
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:70 # ConcurrentTaskWorkerJob#perform with non-manufacturing task does not attempt byproduct generation
rspec ./spec/models/account_spec.rb:23 # Account#deposit with a valid amount increases the account balance
rspec ./spec/models/account_spec.rb:37 # Account#deposit with an invalid amount (negative) raises an error and does not modify the balance
rspec ./spec/models/account_spec.rb:48 # Account#withdraw when funds are sufficient decreases the account balance
rspec ./spec/models/account_spec.rb:62 # Account#withdraw when funds are insufficient raises an error and does not modify the balance
rspec ./spec/models/account_spec.rb:73 # Account#transfer_funds when funds are sufficient transfers the amount from one account to another
rspec ./spec/models/account_spec.rb:95 # Account#transfer_funds when funds are insufficient raises an error and does not modify balances
rspec ./spec/models/account_spec.rb:111 # Account edge cases when balance is exactly zero prevents withdrawals or transfers
rspec ./spec/models/account_spec.rb:119 # Account edge cases when balance is exactly zero allows deposits
rspec ./spec/models/account_spec.rb:127 # Account different accountable types works with a player account
rspec ./spec/models/account_spec.rb:132 # Account different accountable types works with a settlement account
rspec ./spec/models/account_spec.rb:137 # Account different accountable types works with an organization account
rspec ./spec/models/atmosphere_spec.rb:31 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:32 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:33 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:34 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:54 # Atmosphere#volume when celestial_body responds to volume returns the celestial_body's volume
rspec ./spec/models/atmosphere_spec.rb:79 # Atmosphere sealing methods #sealed? returns the sealing status
rspec ./spec/models/atmosphere_spec.rb:87 # Atmosphere sealing methods #seal! sets sealing status to true
rspec ./spec/models/atmosphere_spec.rb:93 # Atmosphere sealing methods #unseal! sets sealing status to false
rspec ./spec/models/atmosphere_spec.rb:103 # Atmosphere#habitable? with good conditions returns true
rspec ./spec/models/atmosphere_spec.rb:109 # Atmosphere#habitable? with low pressure returns false
rspec ./spec/models/atmosphere_spec.rb:116 # Atmosphere#habitable? with low oxygen returns false
rspec ./spec/models/atmosphere_spec.rb:123 # Atmosphere#habitable? with high CO2 returns false
rspec ./spec/models/atmosphere_spec.rb:130 # Atmosphere#habitable? with extreme temperature returns false for too cold
rspec ./spec/models/atmosphere_spec.rb:135 # Atmosphere#habitable? with extreme temperature returns false for too hot
rspec ./spec/models/atmosphere_spec.rb:145 # Atmosphere AtmosphereConcern inclusion includes AtmosphereConcern methods
rspec ./spec/models/atmosphere_spec.rb:155 # Atmosphere JSON fields initializes JSON fields with empty objects
rspec ./spec/models/atmosphere_spec.rb:163 # Atmosphere JSON fields allows storing data in JSON fields
rspec ./spec/models/atmosphere_spec.rb:188 # Atmosphere parent validation rejects multiple parents
rspec ./spec/models/biogas_generator_spec.rb:18 # Units::BiogasGenerator#operate consumes biomass, organic waste, and energy, producing biogas and fertilizer
rspec ./spec/models/biogas_generator_spec.rb:27 # Units::BiogasGenerator#operate returns false if insufficient biomass is available
rspec ./spec/models/biogas_generator_spec.rb:32 # Units::BiogasGenerator#operate returns false if insufficient organic waste is available
rspec ./spec/models/biogas_generator_spec.rb:37 # Units::BiogasGenerator#operate returns false if insufficient energy is available
rspec ./spec/models/biology/biosphere_integration_spec.rb:45 # Biosphere and Life Form Integration ecosystem simulation simulates population dynamics
rspec ./spec/models/biomass_recycler_spec.rb:18 # Units::BiomassRecycler#operate consumes biomass and energy, producing fertilizer and biofuel
rspec ./spec/models/biomass_recycler_spec.rb:26 # Units::BiomassRecycler#operate returns false if insufficient biomass is available
rspec ./spec/models/biomass_recycler_spec.rb:31 # Units::BiomassRecycler#operate returns false if insufficient energy is available
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:38 # CelestialBodies::Features::BaseFeature#static_data fetches data from lookup service
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:43 # CelestialBodies::Features::BaseFeature#static_data caches the data
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:58 # CelestialBodies::Features::BaseFeature#discover! marks feature as discovered
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:65 # CelestialBodies::Features::BaseFeature#discover! sets discovered_at timestamp
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:70 # CelestialBodies::Features::BaseFeature#discover! does not overwrite existing discovery
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:90 # CelestialBodies::Features::BaseFeature status transitions transitions through states correctly
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:107 # CelestialBodies::Features::BaseFeature status transitions cannot skip states
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:114 # CelestialBodies::Features::BaseFeature tier helpers identifies strategic features
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:25 # CelestialBodies::Materials::ExoticMaterial associations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:29 # CelestialBodies::Materials::ExoticMaterial validations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:30 # CelestialBodies::Materials::ExoticMaterial validations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:31 # CelestialBodies::Materials::ExoticMaterial validations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:35 # CelestialBodies::Materials::ExoticMaterial state helper methods identifies metallic hydrogen state
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:42 # CelestialBodies::Materials::ExoticMaterial state helper methods identifies plasma state
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:50 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns metallic_hydrogen for hydrogen at extreme pressure
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:55 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns plasma at extreme temperatures
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:60 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns superfluid for helium at low temperatures
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:65 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at falls back to standard states otherwise
rspec ./spec/models/celestial_bodies/materials/gas_spec.rb:18 # CelestialBodies::Materials::Gas associations can be accessed through atmosphere.gases
rspec ./spec/models/celestial_bodies/materials/geological_material_spec.rb:18 # CelestialBodies::Materials::GeologicalMaterial associations can be accessed through geosphere.geological_materials
rspec ./spec/models/celestial_bodies/materials/geological_material_spec.rb:38 # CelestialBodies::Materials::GeologicalMaterial validations is not valid without a name
rspec ./spec/models/celestial_bodies/materials/geological_material_spec.rb:45 # CelestialBodies::Materials::GeologicalMaterial validations is not valid with an invalid layer
rspec ./spec/models/celestial_bodies/materials/geological_material_spec.rb:52 # CelestialBodies::Materials::GeologicalMaterial validations is not valid with a negative percentage
rspec ./spec/models/celestial_bodies/materials/geological_material_spec.rb:59 # CelestialBodies::Materials::GeologicalMaterial validations is not valid with a percentage over 100
rspec ./spec/models/celestial_bodies/materials/geological_material_spec.rb:66 # CelestialBodies::Materials::GeologicalMaterial validations is not valid with a negative mass
rspec ./spec/models/celestial_bodies/materials/geological_material_spec.rb:73 # CelestialBodies::Materials::GeologicalMaterial validations is not valid with an invalid state
rspec ./spec/models/celestial_bodies/materials/liquid_spec.rb:15 # CelestialBodies::Materials::Liquid associations is expected to belong to hydrosphere required: true
rspec ./spec/models/celestial_bodies/materials/liquid_spec.rb:23 # CelestialBodies::Materials::Liquid associations can be accessed through hydrosphere.liquid_materials
rspec ./spec/models/celestial_bodies/materials/liquid_spec.rb:40 # CelestialBodies::Materials::Liquid validations is valid with valid attributes
rspec ./spec/models/celestial_bodies/materials/liquid_spec.rb:44 # CelestialBodies::Materials::Liquid validations is not valid without a name
rspec ./spec/models/celestial_bodies/materials/liquid_spec.rb:50 # CelestialBodies::Materials::Liquid validations is not valid without an amount
rspec ./spec/models/celestial_bodies/materials/liquid_spec.rb:55 # CelestialBodies::Materials::Liquid validations is not valid with a negative amount
rspec ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:15 # CelestialBodies::MinorBodies::DwarfPlanet validations is valid with valid attributes
rspec ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:21 # CelestialBodies::MinorBodies::DwarfPlanet#is_spherical? returns true for dwarf planets
rspec ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:28 # CelestialBodies::MinorBodies::DwarfPlanet#calculate_geological_activity calculates geological activity based on mass and age
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:133 # CelestialBodies::PlanetBiome has access to celestial_body through biosphere
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:22 # CelestialBodies::PlanetBiome associations 
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:24 # CelestialBodies::PlanetBiome associations 
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:28 # CelestialBodies::PlanetBiome validations is valid with valid attributes
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:32 # CelestialBodies::PlanetBiome validations is not valid without a biome
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:37 # CelestialBodies::PlanetBiome validations is not valid without a biosphere
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:42 # CelestialBodies::PlanetBiome validations 
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:47 # CelestialBodies::PlanetBiome jsonb properties can set and retrieve area_percentage
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:52 # CelestialBodies::PlanetBiome jsonb properties can set and retrieve vegetation_cover
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:58 # CelestialBodies::PlanetBiome jsonb properties can set and retrieve moisture_level
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:63 # CelestialBodies::PlanetBiome jsonb properties can set and retrieve latitude
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:68 # CelestialBodies::PlanetBiome jsonb properties can set and retrieve biodiversity
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:74 # CelestialBodies::PlanetBiome jsonb properties supports deprecated water_level with warning
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:92 # CelestialBodies::PlanetBiome jsonb properties default values for properties defaults area_percentage to 0.0
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:96 # CelestialBodies::PlanetBiome jsonb properties default values for properties defaults vegetation_cover to 0.0
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:101 # CelestialBodies::PlanetBiome jsonb properties default values for properties defaults moisture_level to 0.0
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:105 # CelestialBodies::PlanetBiome jsonb properties default values for properties defaults latitude to 0.0
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:109 # CelestialBodies::PlanetBiome jsonb properties default values for properties defaults biodiversity to 0.0
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:117 # CelestialBodies::PlanetBiome callbacks updates biosphere biodiversity after creation
rspec ./spec/models/celestial_bodies/planet_biome_spec.rb:124 # CelestialBodies::PlanetBiome callbacks updates biosphere biodiversity after destruction
rspec './spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb[1:1:4]' # CelestialBodies::Planets::Gaseous::GasGiant behaves like a gaseous planet calculates cloud bands based on rotation
rspec ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:27 # CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with Jupiter mass estimates a realistic moon count
rspec ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:35 # CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with different masses scales moon count with mass
rspec ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:48 # CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #ring_system_probability returns a high probability for gas giants
rspec './spec/models/celestial_bodies/planets/gaseous/ice_giant_spec.rb[1:1:4]' # CelestialBodies::Planets::Gaseous::IceGiant behaves like a gaseous planet calculates cloud bands based on rotation
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:7 # CelestialBodies::Planets::Ocean::HyceanPlanet validations requires an atmosphere to be present
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:15 # CelestialBodies::Planets::Ocean::HyceanPlanet validations requires at least 10% hydrogen in atmosphere
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:24 # CelestialBodies::Planets::Ocean::HyceanPlanet validations requires significant atmospheric pressure (>1 atm)
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:31 # CelestialBodies::Planets::Ocean::HyceanPlanet validations is valid with proper hydrogen content and pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:36 # CelestialBodies::Planets::Ocean::HyceanPlanet validations inherits ocean planet water coverage validation
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:56 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes base ocean planet factors
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:62 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes hydrogen blanket greenhouse effect
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:68 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors calculates pressure habitability zones
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:75 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors indicates expanded habitable temperature range
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:81 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates optimal pressure range (10-100 atm) as level 3
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:90 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates moderate pressure range (1-10 or 100-1000 atm) as level 2
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:99 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates extreme pressure as level 1
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:110 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes base ocean planet features
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:116 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes hydrogen atmosphere features
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:125 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes extreme storm systems for high pressure atmospheres
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:134 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features does not include storm systems for lower pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:145 # CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies hydrogen saturated oceans for high H2 content
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:152 # CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies methane rich oceans when CH4 is present
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:162 # CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry returns unknown when hydrosphere composition is missing
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:173 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth calculates habitable depth range based on pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:181 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth sets deeper minimum depth for higher pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:191 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth ensures maximum depth is greater than minimum
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:197 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when atmosphere is missing
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:204 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when hydrosphere is missing
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:213 # CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) calculates hydrogen percentage from atmosphere
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:221 # CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) returns 0 when H2 gas is not present
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:232 # CelestialBodies::Planets::Ocean::HyceanPlanet STI type sets the correct STI type
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:240 # CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high surface temperature
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:244 # CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high atmospheric pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:252 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has below-freezing surface temperature
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:256 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has significant ice coverage
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:262 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has higher ammonia content as antifreeze
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:268 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has mixed liquid-solid state distribution
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:277 # CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet inherits water_volume calculation
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:283 # CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet can analyze water chemistry
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:15 # CelestialBodies::Planets::Ocean::OceanPlanet validations requires at least 30% water coverage
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:55 # CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors marks aquatic environment as 'dominant' for coverage above 50%
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:74 # CelestialBodies::Planets::Ocean::OceanPlanet#habitability_factors analyzes water chemistry from hydrosphere composition
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:121 # CelestialBodies::Planets::Ocean::OceanPlanet#surface_features includes ocean_dominated for high water coverage
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:189 # CelestialBodies::Planets::Ocean::OceanPlanet#water_volume increases with higher water coverage
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:212 # CelestialBodies::Planets::Ocean::OceanPlanet#analyze_water_chemistry (protected method) identifies highly saline water
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:224 # CelestialBodies::Planets::Ocean::OceanPlanet#analyze_water_chemistry (protected method) identifies moderately saline water
rspec ./spec/models/celestial_bodies/planets/ocean/ocean_planet_spec.rb:235 # CelestialBodies::Planets::Ocean::OceanPlanet#analyze_water_chemistry (protected method) identifies low salinity water
rspec ./spec/models/celestial_bodies/planets/ocean/water_world_spec.rb:7 # CelestialBodies::Planets::Ocean::WaterWorld validations requires high water coverage
rspec ./spec/models/celestial_bodies/planets/ocean/water_world_spec.rb:50 # CelestialBodies::Planets::Ocean::WaterWorld#surface_features includes pelagic_world for extreme coverage
rspec ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:41 # CelestialBodies::Spheres::Atmosphere#initialize_gases creates gases based on the composition
rspec ./spec/models/celestial_bodies/spheres/atmosphere_spec.rb:54 # CelestialBodies::Spheres::Atmosphere#add_gas adds gas using chemical formula
rspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:79 # CelestialBodies::Spheres::Biosphere defaults accesses default temperature values via delegation methods
rspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:193 # CelestialBodies::Spheres::Biosphere#transfer_material logs errors when transfer fails due to validation errors
rspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:266 # CelestialBodies::Spheres::Biosphere biome management introduces a new biome
rspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:274 # CelestialBodies::Spheres::Biosphere biome management removes a biome
rspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:289 # CelestialBodies::Spheres::Biosphere#calculate_biodiversity_index calculates biodiversity index based on biome diversity
rspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:591 # CelestialBodies::Spheres::Biosphere ecological simulation calculates expanded biodiversity including life forms
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:58 # CelestialBodies::Spheres::Geosphere#add_material adds a material and updates the celestial body and geosphere
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:101 # CelestialBodies::Spheres::Geosphere#add_material adds material to the specified layer
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:130 # CelestialBodies::Spheres::Geosphere#remove_material removes material from the specified layer
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:175 # CelestialBodies::Spheres::Geosphere material management creates materials in correct layer
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:192 # CelestialBodies::Spheres::Geosphere material management updates composition percentages
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:275 # CelestialBodies::Spheres::Geosphere#extract_volatiles extracts volatiles based on temperature increase
rspec ./spec/models/celestial_body_spec.rb:16 # CelestialBodies::CelestialBody when not part of a solar system allows distance_from_star to be nil
rspec ./spec/models/celestial_body_spec.rb:24 # CelestialBodies::CelestialBody#add_material creates a new material if it does not exist
rspec ./spec/models/celestial_body_spec.rb:30 # CelestialBodies::CelestialBody#add_material updates the amount of an existing material
rspec ./spec/models/celestial_body_spec.rb:67 # CelestialBodies::CelestialBody#update_gravity calculates and updates the gravity based on mass and radius
rspec ./spec/models/composting_unit_spec.rb:18 # Units::CompostingUnit#operate consumes organic waste and energy, producing compost
rspec ./spec/models/composting_unit_spec.rb:25 # Units::CompostingUnit#operate returns false if insufficient organic waste is available
rspec ./spec/models/composting_unit_spec.rb:30 # Units::CompostingUnit#operate returns false if insufficient energy is available
rspec ./spec/models/concerns/atmosphere_concern_spec.rb:114 # AtmosphereConcern#add_gas updates existing gas
rspec ./spec/models/concerns/atmosphere_concern_spec.rb:137 # AtmosphereConcern#remove_gas removes gas from the atmosphere
rspec ./spec/models/concerns/atmosphere_concern_spec.rb:462 # AtmosphereConcern#initialize_gases creates gases based on composition
rspec ./spec/models/concerns/energy_management_spec.rb:196 # EnergyManagement solar output factor #current_solar_output_factor queries location solar output factor
rspec ./spec/models/concerns/energy_management_spec.rb:201 # EnergyManagement solar output factor #current_solar_output_factor returns 1.0 when no settlement
rspec ./spec/models/concerns/energy_management_spec.rb:208 # EnergyManagement solar output factor #solar_daylight? returns true when solar factor > 0.1
rspec ./spec/models/concerns/energy_management_spec.rb:213 # EnergyManagement solar output factor #solar_daylight? returns false when solar factor <= 0.1
rspec ./spec/models/concerns/energy_management_spec.rb:243 # EnergyManagement solar output factor power generation with solar scaling scales solar unit output by solar factor
rspec ./spec/models/concerns/energy_management_spec.rb:249 # EnergyManagement solar output factor power generation with solar scaling does not scale non-solar units
rspec ./spec/models/concerns/geosphere_concern_spec.rb:76 # GeosphereConcern#reset returns false if base_values lack required keys
rspec ./spec/models/concerns/geosphere_concern_spec.rb:96 # GeosphereConcern#reset does not modify attributes when base_values are empty
rspec ./spec/models/concerns/geosphere_concern_spec.rb:171 # GeosphereConcern#extract_volatiles extracts volatiles based on temperature increase
rspec ./spec/models/concerns/geosphere_concern_spec.rb:180 # GeosphereConcern#extract_volatiles adds gases to atmosphere using chemical formula
rspec ./spec/models/concerns/geosphere_concern_spec.rb:212 # GeosphereConcern#add_material adds material to the specified layer
rspec ./spec/models/concerns/has_units_spec.rb:92 # HasUnits#installed_units_count returns the total count of all units attached to the craft
rspec ./spec/models/concerns/has_units_spec.rb:114 # HasUnits#install_unit attaches a unit to the craft
rspec ./spec/models/concerns/has_units_spec.rb:147 # HasUnits#install_unit adds errors if installation fails
rspec ./spec/models/concerns/has_units_spec.rb:132 # HasUnits#install_unit prevents installing a unit that is already attached prevents installing a unit that is already attached
rspec ./spec/models/concerns/has_units_spec.rb:173 # HasUnits#remove_unit detaches a unit from the craft
rspec ./spec/models/concerns/has_units_spec.rb:181 # HasUnits#remove_unit returns "Unit not found" if the unit is not attached to this craft
rspec ./spec/models/concerns/has_units_spec.rb:200 # HasUnits unit management scenarios when max units reached does not create a new unit
rspec ./spec/models/concerns/has_units_spec.rb:209 # HasUnits unit management scenarios when max units reached returns "Max units reached"
rspec ./spec/models/concerns/has_units_spec.rb:215 # HasUnits unit management scenarios when unit type is not compatible does not create a new unit
rspec ./spec/models/concerns/has_units_spec.rb:227 # HasUnits unit management scenarios when unit type is not compatible returns "Unit type ... is not compatible with this craft."
rspec ./spec/models/concerns/has_units_spec.rb:236 # HasUnits unit management scenarios when unit type is invalid or data not found does not create a new unit
rspec ./spec/models/concerns/has_units_spec.rb:245 # HasUnits unit management scenarios when unit type is invalid or data not found returns "Invalid unit blueprint ID or data not found."
rspec ./spec/models/concerns/has_units_spec.rb:273 # HasUnits#add_unit when unit type is valid creates a new persisted unit record
rspec ./spec/models/concerns/has_units_spec.rb:282 # HasUnits#add_unit associates the unit with the craft polymorphically
rspec ./spec/models/concerns/has_units_spec.rb:291 # HasUnits#add_unit applies unit effects to the craft
rspec ./spec/models/concerns/has_units_spec.rb:300 # HasUnits#add_unit returns the created unit object
rspec ./spec/models/concerns/has_units_spec.rb:307 # HasUnits#add_unit can add different types of units
rspec ./spec/models/concerns/has_units_spec.rb:321 # HasUnits#add_unit can add a robot unit
rspec ./spec/models/concerns/housing_spec.rb:57 # Housing population management calculates population capacity from habitat units
rspec ./spec/models/concerns/housing_spec.rb:61 # Housing population management uses alias total_capacity for population_capacity
rspec ./spec/models/concerns/housing_spec.rb:65 # Housing population management calculates available capacity
rspec ./spec/models/concerns/housing_spec.rb:70 # Housing population management checks if it has capacity for additional population
rspec ./spec/models/concerns/housing_spec.rb:76 # Housing population management ignores non-habitat units when calculating capacity
rspec ./spec/models/concerns/housing_spec.rb:81 # Housing population management calculates total population from base units
rspec ./spec/models/concerns/hydrosphere_concern_spec.rb:82 # HydrosphereConcern#calculate_evaporation_rate calculates higher evaporation at higher temperatures
rspec ./spec/models/concerns/hydrosphere_concern_spec.rb:161 # HydrosphereConcern#add_liquid adds H2O to the hydrosphere
rspec ./spec/models/concerns/material_properties_concern_spec.rb:204 # MaterialPropertiesConcern exotic state handling identifies exotic states
rspec ./spec/models/concerns/material_properties_concern_spec.rb:218 # MaterialPropertiesConcern exotic state handling calculates phase transitions for exotic conditions
rspec ./spec/models/concerns/mineable_spec.rb:29 # Mineable#mine_gcc mines from satellites and computers
rspec ./spec/models/concerns/mineable_spec.rb:34 # Mineable#mine_gcc does not exceed available power
rspec ./spec/models/concerns/structures/coverable_spec.rb:253 # Structures::Coverable#schedule_covering! creates a construction job
rspec ./spec/models/concerns/structures/coverable_spec.rb:259 # Structures::Coverable#schedule_covering! returns success result
rspec ./spec/models/concerns/structures/coverable_spec.rb:269 # Structures::Coverable#schedule_covering! updates status to materials_requested
rspec ./spec/models/concerns/structures/coverable_spec.rb:275 # Structures::Coverable#schedule_covering! accepts custom panel type
rspec ./spec/models/concerns/structures/coverable_spec.rb:285 # Structures::Coverable#schedule_covering! stores panel_type on coverable
rspec ./spec/models/concerns/structures/coverable_spec.rb:294 # Structures::Coverable#schedule_covering! uses default panel type if not specified
rspec ./spec/models/concerns/structures/coverable_spec.rb:301 # Structures::Coverable#schedule_covering! creates material and equipment requests
rspec ./spec/models/concerns/structures/coverable_spec.rb:308 # Structures::Coverable#schedule_covering! updates shell composition
rspec ./spec/models/concerns/structures/coverable_spec.rb:317 # Structures::Coverable#schedule_covering! fails if already covered
rspec ./spec/models/concerns/structures/coverable_spec.rb:578 # Structures::Coverable integration scenarios lava tube opening handles medium opening
rspec ./spec/models/concerns/structures/coverable_spec.rb:596 # Structures::Coverable complete covering workflow goes through full lifecycle
rspec ./spec/models/consortium_membership_spec.rb:22 # ConsortiumMembership is invalid if member is not a corporation
rspec ./spec/models/construction_job_spec.rb:12 # ConstructionJob validations and attributes is valid with required attributes
rspec ./spec/models/construction_job_spec.rb:22 # ConstructionJob validations and attributes requires a jobable
rspec ./spec/models/construction_job_spec.rb:28 # ConstructionJob validations and attributes accepts a valid job_type
rspec ./spec/models/construction_job_spec.rb:44 # ConstructionJob validations and attributes accepts a valid status
rspec ./spec/models/construction_job_spec.rb:63 # ConstructionJob validations and attributes stores target_values as JSON
rspec ./spec/models/construction_job_spec.rb:96 # ConstructionJob associations has many material_requests
rspec ./spec/models/construction_job_spec.rb:109 # ConstructionJob associations has many equipment_requests
rspec ./spec/models/construction_job_spec.rb:121 # ConstructionJob associations belongs to a jobable
rspec ./spec/models/construction_job_spec.rb:125 # ConstructionJob associations belongs to a settlement
rspec ./spec/models/construction_job_spec.rb:140 # ConstructionJob enum functionality correctly stores and retrieves job_type as an enum
rspec ./spec/models/construction_job_spec.rb:164 # ConstructionJob enum functionality correctly stores and retrieves status as an enum
rspec ./spec/models/construction_job_spec.rb:198 # ConstructionJob convenience methods #materials_gathered? returns true when all material requests are fulfilled
rspec ./spec/models/construction_job_spec.rb:214 # ConstructionJob convenience methods #materials_gathered? returns false when some material requests are pending
rspec ./spec/models/construction_job_spec.rb:234 # ConstructionJob convenience methods #equipment_gathered? returns true when no equipment requests exist
rspec ./spec/models/construction_job_spec.rb:239 # ConstructionJob convenience methods #equipment_gathered? returns true when all equipment requests are fulfilled
rspec ./spec/models/construction_job_spec.rb:250 # ConstructionJob convenience methods #equipment_gathered? returns false when some equipment requests are pending
rspec ./spec/models/construction_job_spec.rb:263 # ConstructionJob convenience methods #infer_settlement returns the jobable's settlement if available
rspec ./spec/models/construction_job_spec.rb:267 # ConstructionJob convenience methods #infer_settlement returns the jobable if it is a Settlement
rspec ./spec/models/construction_job_spec.rb:272 # ConstructionJob convenience methods #infer_settlement finds a settlement by location if available
rspec ./spec/models/craft/base_craft_spec.rb:128 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:129 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:130 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:131 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:135 # Craft::BaseCraft location handling can access location through helper method
rspec ./spec/models/craft/base_craft_spec.rb:139 # Craft::BaseCraft location handling can switch between spatial and celestial locations
rspec ./spec/models/craft/base_craft_spec.rb:189 # Craft::BaseCraft initialization assembles a new craft from inventory and applies the correct variant
rspec ./spec/models/craft/base_craft_spec.rb:209 # Craft::BaseCraft loading craft info loads the correct craft data from the lookup service
rspec ./spec/models/craft/base_craft_spec.rb:244 # Craft::BaseCraft player construction starts with no units
rspec ./spec/models/craft/base_craft_spec.rb:248 # Craft::BaseCraft player construction allows installing units
rspec ./spec/models/craft/base_craft_spec.rb:258 # Craft::BaseCraft player construction allows uninstalling units
rspec ./spec/models/craft/base_craft_spec.rb:313 # Craft::BaseCraft variant configuration loads a variant configuration
rspec ./spec/models/craft/base_craft_spec.rb:320 # Craft::BaseCraft variant configuration changes between variants
rspec ./spec/models/craft/base_craft_spec.rb:330 # Craft::BaseCraft variant configuration provides a list of available variants
rspec ./spec/models/craft/base_craft_spec.rb:335 # Craft::BaseCraft variant configuration handles missing variants gracefully
rspec ./spec/models/craft/base_craft_spec.rb:361 # Craft::BaseCraft atmosphere creation creates an atmosphere after creation
rspec ./spec/models/craft/base_craft_spec.rb:377 # Craft::BaseCraft unit integration integrates with settlement units
rspec ./spec/models/craft/harvester_spec.rb:18 # Craft::Harvester validations is valid with a positive extraction_rate
rspec ./spec/models/craft/harvester_spec.rb:23 # Craft::Harvester validations is invalid with a negative extraction_rate
rspec ./spec/models/craft/harvester_spec.rb:31 # Craft::Harvester#extract_resources when extracting from a valid target increases inventory with extracted resources
rspec ./spec/models/craft/harvester_spec.rb:40 # Craft::Harvester#extract_resources when extracting from an invalid target raises an error
rspec ./spec/models/craft/harvester_spec.rb:51 # Craft::Harvester#extract_resources when storage is full raises an error
rspec ./spec/models/craft/harvester_spec.rb:63 # Craft::Harvester#process_resources converts raw material into refined material
rspec ./spec/models/craft/harvester_spec.rb:73 # Craft::Harvester#process_resources does nothing if no processable materials are present
rspec ./spec/models/craft/variant_manager_spec.rb:66 # Craft::VariantManager#initialize loads base data and variants
rspec ./spec/models/craft/variant_manager_spec.rb:102 # Craft::VariantManager#get_variant merges base data with standard variant data
rspec ./spec/models/craft/variant_manager_spec.rb:113 # Craft::VariantManager#get_variant merges base data with lunar variant data
rspec ./spec/models/craft/variant_manager_spec.rb:124 # Craft::VariantManager#get_variant properly merges nested hashes
rspec ./spec/models/dome_spec.rb:5 # Settlement::Dome calculates used capacity (current occupancy) correctly
rspec ./spec/models/dome_spec.rb:10 # Settlement::Dome calculates remaining capacity correctly
rspec ./spec/models/dome_spec.rb:15 # Settlement::Dome ensures current occupancy does not exceed total capacity
rspec ./spec/models/dwarf_planet_spec.rb:19 # CelestialBodies::DwarfPlanet#calculate_surface_conditions calculates surface conditions specific to dwarf planets
rspec ./spec/models/dwarf_planet_spec.rb:26 # CelestialBodies::DwarfPlanet#update_biomes updates biomes specific to dwarf planets
rspec ./spec/models/environment_spec.rb:11 # Environment validations is valid with valid attributes
rspec ./spec/models/environment_spec.rb:15 # Environment validations is not valid without a biome
rspec ./spec/models/environment_spec.rb:20 # Environment validations is not valid without a planet
rspec ./spec/models/environment_spec.rb:25 # Environment validations is not valid without a temperature
rspec ./spec/models/environment_spec.rb:30 # Environment validations is not valid without a pressure
rspec ./spec/models/environment_spec.rb:35 # Environment validations is not valid without a humidity
rspec ./spec/models/environment_spec.rb:42 # Environment associations belongs to a biome
rspec ./spec/models/environment_spec.rb:46 # Environment associations belongs to a celestial_body
rspec ./spec/models/equipment_request_spec.rb:13 # EquipmentRequest validations is valid with required attributes
rspec ./spec/models/equipment_request_spec.rb:22 # EquipmentRequest validations requires an equipment_type
rspec ./spec/models/equipment_request_spec.rb:31 # EquipmentRequest validations requires quantity_requested to be present
rspec ./spec/models/equipment_request_spec.rb:40 # EquipmentRequest validations requires quantity_requested to be greater than 0
rspec ./spec/models/equipment_request_spec.rb:50 # EquipmentRequest validations requires quantity_requested to be a number
rspec ./spec/models/equipment_request_spec.rb:60 # EquipmentRequest validations allows negative quantity_requested to be invalid
rspec ./spec/models/equipment_request_spec.rb:74 # EquipmentRequest associations belongs to a requestable (polymorphic)
rspec ./spec/models/equipment_request_spec.rb:78 # EquipmentRequest associations can be associated with different requestable types
rspec ./spec/models/equipment_request_spec.rb:101 # EquipmentRequest enums status enum defaults to pending status
rspec ./spec/models/equipment_request_spec.rb:105 # EquipmentRequest enums status enum can be set to different statuses
rspec ./spec/models/equipment_request_spec.rb:111 # EquipmentRequest enums status enum accepts string values for status
rspec ./spec/models/equipment_request_spec.rb:116 # EquipmentRequest enums status enum provides query methods for each status
rspec ./spec/models/equipment_request_spec.rb:136 # EquipmentRequest enums priority enum defaults to normal priority
rspec ./spec/models/equipment_request_spec.rb:140 # EquipmentRequest enums priority enum can be set to different priorities
rspec ./spec/models/equipment_request_spec.rb:146 # EquipmentRequest enums priority enum accepts string values for priority
rspec ./spec/models/equipment_request_spec.rb:151 # EquipmentRequest enums priority enum provides query methods for each priority
rspec ./spec/models/equipment_request_spec.rb:171 # EquipmentRequest scopes .pending_requests returns pending and partially fulfilled requests
rspec ./spec/models/equipment_request_spec.rb:179 # EquipmentRequest scopes .fulfilled returns only fulfilled requests
rspec ./spec/models/equipment_request_spec.rb:187 # EquipmentRequest scopes .for_equipment returns requests for a specific equipment type
rspec ./spec/models/equipment_request_spec.rb:193 # EquipmentRequest scopes .for_equipment returns empty when no equipment of that type is requested
rspec ./spec/models/equipment_request_spec.rb:202 # EquipmentRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
rspec ./spec/models/equipment_request_spec.rb:211 # EquipmentRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
rspec ./spec/models/equipment_request_spec.rb:220 # EquipmentRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
rspec ./spec/models/equipment_request_spec.rb:229 # EquipmentRequest instance methods #quantity_still_needed handles quantity_fulfilled being 0
rspec ./spec/models/equipment_request_spec.rb:241 # EquipmentRequest factory creates a valid equipment request with factory
rspec ./spec/models/equipment_request_spec.rb:247 # EquipmentRequest factory creates equipment request with specific attributes
rspec ./spec/models/equipment_request_spec.rb:261 # EquipmentRequest edge cases and data integrity handles very large quantity requests
rspec ./spec/models/equipment_request_spec.rb:270 # EquipmentRequest edge cases and data integrity maintains data integrity when updating status
rspec ./spec/models/equipment_request_spec.rb:281 # EquipmentRequest edge cases and data integrity handles equipment_type with special characters
rspec ./spec/models/financial/account_spec.rb:164 # Financial::Account Development Corporation (DC) Trade allows DC-to-DC trade on the virtual ledger via operational_data flags
rspec ./spec/models/financial/transaction_spec.rb:85 # Financial::Transaction currency precision supports high precision for GCC (8 decimal places)
rspec ./spec/models/game_spec.rb:61 # Game#assign_task adds a new task to the task list with correct completion time
rspec ./spec/models/game_spec.rb:85 # Game#advance_time advances game time and completes a task
rspec ./spec/models/game_spec.rb:94 # Game#advance_time with no tasks prints a message when there are no tasks
rspec ./spec/models/gas_giant_spec.rb:19 # CelestialBodies::GasGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
rspec ./spec/models/gas_giant_spec.rb:26 # CelestialBodies::GasGiant#calculate_gravity calculates gravity based on mass and radius
rspec ./spec/models/hydrosphere_spec.rb:13 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :liquid_volume looks like a number
rspec ./spec/models/hydrosphere_spec.rb:14 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :lakes looks like a number
rspec ./spec/models/hydrosphere_spec.rb:15 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :rivers looks like a number
rspec ./spec/models/hydrosphere_spec.rb:16 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :oceans looks like a number
rspec ./spec/models/hydrosphere_spec.rb:17 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :ice looks like a number
rspec ./spec/models/hydrosphere_spec.rb:25 # CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calls update_liquid_materials_from_celestial_body
rspec ./spec/models/hydrosphere_spec.rb:30 # CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calculates the liquid volume after setup
rspec ./spec/models/hydrosphere_spec.rb:45 # CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds liquid materials to the hydrosphere
rspec ./spec/models/hydrosphere_spec.rb:49 # CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds ice to the hydrosphere
rspec ./spec/models/hydrosphere_spec.rb:57 # CelestialBodies::Spheres::Hydrosphere#add_liquid distributes liquid between oceans, lakes, and rivers
rspec ./spec/models/hydrosphere_spec.rb:65 # CelestialBodies::Spheres::Hydrosphere#calculate_liquid_volume calculates the total liquid volume correctly
rspec ./spec/models/hydrosphere_spec.rb:84 # CelestialBodies::Spheres::Hydrosphere#update_water_cycle melts ice when temperature is above freezing
rspec ./spec/models/hydrosphere_spec.rb:89 # CelestialBodies::Spheres::Hydrosphere#update_water_cycle does not melt ice when temperature is below freezing
rspec ./spec/models/hydrosphere_spec.rb:105 # CelestialBodies::Spheres::Hydrosphere#evaporate_liquids evaporates liquids when conditions are met
rspec ./spec/models/ice_giant_spec.rb:19 # CelestialBodies::IceGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
rspec ./spec/models/ice_giant_spec.rb:26 # CelestialBodies::IceGiant#calculate_gravity calculates gravity based on mass and radius
rspec ./spec/models/item_spec.rb:128 # Item lookup service integration loads properties from item lookup service with category
rspec ./spec/models/item_spec.rb:153 # Item lookup service integration loads material properties for raw materials
rspec ./spec/models/item_spec.rb:172 # Item#container operations identifies containers correctly
rspec ./spec/models/item_spec.rb:177 # Item#container operations adds items to containers
rspec ./spec/models/item_spec.rb:183 # Item#container operations removes items from containers
rspec ./spec/models/item_spec.rb:194 # Item#container operations enforces weight capacity limits
rspec ./spec/models/item_spec.rb:217 # Item#total_weight calculates base weight from properties
rspec ./spec/models/item_spec.rb:232 # Item#total_weight includes contained items in total weight
rspec ./spec/models/item_spec.rb:254 # Item#tradeable? returns true for normal items with positive amount
rspec ./spec/models/item_spec.rb:258 # Item#tradeable? returns false for items with zero amount
rspec ./spec/models/item_spec.rb:263 # Item#tradeable? returns false for containers with items
rspec ./spec/models/item_spec.rb:272 # Item#tradeable? returns true for empty containers
rspec ./spec/models/item_spec.rb:296 # Item regolith handling gets composition from celestial body geosphere
rspec ./spec/models/item_spec.rb:315 # Item regolith handling includes source body in properties
rspec ./spec/models/liquid_material_spec.rb:9 # CelestialBodies::Materials::Liquid associations 
rspec ./spec/models/liquid_material_spec.rb:13 # CelestialBodies::Materials::Liquid validations is valid with valid attributes
rspec ./spec/models/liquid_material_spec.rb:17 # CelestialBodies::Materials::Liquid validations is not valid without a name
rspec ./spec/models/liquid_material_spec.rb:23 # CelestialBodies::Materials::Liquid validations is not valid without an amount
rspec ./spec/models/liquid_material_spec.rb:29 # CelestialBodies::Materials::Liquid validations is not valid with a negative amount
rspec ./spec/models/location/celestial_location_spec.rb:15 # Location::CelestialLocation validations is expected to validate that :name cannot be empty/falsy
rspec ./spec/models/location/celestial_location_spec.rb:326 # Location::CelestialLocation orbital mechanics #orbital_period returns nil for surface locations
rspec ./spec/models/location/celestial_location_spec.rb:330 # Location::CelestialLocation orbital mechanics #orbital_period calculates period for orbital locations
rspec ./spec/models/location/celestial_location_spec.rb:349 # Location::CelestialLocation orbital mechanics #orbital_velocity returns nil for surface locations
rspec ./spec/models/location/celestial_location_spec.rb:353 # Location::CelestialLocation orbital mechanics #orbital_velocity calculates velocity for orbital locations
rspec ./spec/models/location/celestial_location_spec.rb:372 # Location::CelestialLocation orbital mechanics #gravity returns surface gravity for surface locations
rspec ./spec/models/location/celestial_location_spec.rb:376 # Location::CelestialLocation orbital mechanics #gravity calculates reduced gravity at altitude
rspec ./spec/models/location/celestial_location_spec.rb:400 # Location::CelestialLocation#description describes surface locations
rspec ./spec/models/location/celestial_location_spec.rb:414 # Location::CelestialLocation#description describes orbital locations
rspec ./spec/models/location/spatial_location_spec.rb:69 # Location::SpatialLocation#update_location updates coordinates
rspec ./spec/models/market/condition_spec.rb:15 # Market::Condition#current_price returns the latest price from price_histories
rspec ./spec/models/market/condition_spec.rb:21 # Market::Condition#current_price returns default price if no price_histories exist
rspec ./spec/models/market/marketplace_spec.rb:16 # Market::Marketplace associations is expected to belong to settlement class_name => Settlement::BaseSettlement required: true
rspec ./spec/models/market/marketplace_spec.rb:40 # Market::Marketplace#current_market_condition returns the market condition for a given resource
rspec ./spec/models/market/marketplace_spec.rb:44 # Market::Marketplace#current_market_condition returns nil for a resource that does not exist
rspec ./spec/models/market/marketplace_spec.rb:81 # Market::Marketplace#find_matching_orders when order is a Sell order calls the settlement NPC methods
rspec ./spec/models/market/marketplace_spec.rb:100 # Market::Marketplace#find_matching_orders when order is not a Sell order returns an empty array
rspec ./spec/models/market/marketplace_spec.rb:141 # Market::Marketplace#place_order creates an order
rspec ./spec/models/market/marketplace_spec.rb:152 # Market::Marketplace#place_order converts volume parameter to quantity
rspec ./spec/models/market/marketplace_spec.rb:164 # Market::Marketplace#place_order sets the base_settlement_id
rspec ./spec/models/market/marketplace_spec.rb:176 # Market::Marketplace#place_order removes unused parameters
rspec ./spec/models/market/marketplace_spec.rb:190 # Market::Marketplace#place_order when order is fully filled returns nil
rspec ./spec/models/market/marketplace_spec.rb:214 # Market::Marketplace#place_order when order is fully filled sets order quantity to zero
rspec ./spec/models/market/marketplace_spec.rb:256 # Market::Marketplace#place_order when order is partially filled returns the order
rspec ./spec/models/market/marketplace_spec.rb:274 # Market::Marketplace#place_order when no matching orders exist returns the unfilled order
rspec ./spec/models/market/marketplace_spec.rb:353 # Market::Marketplace#execute_trades delegates the entire trade execution to Market::TradeExecutionService
rspec ./spec/models/market/marketplace_spec.rb:366 # Market::Marketplace#execute_trades updates the order quantity to zero when fully filled
rspec ./spec/models/market/marketplace_spec.rb:398 # Market::Marketplace#execute_trades wraps the execution in a transaction
rspec ./spec/models/market/marketplace_spec.rb:390 # Market::Marketplace#execute_trades when partially filled updates the order quantity to remaining amount
rspec ./spec/models/market/order_spec.rb:21 # Market::Order is valid with valid attributes
rspec ./spec/models/market/order_spec.rb:33 # Market::Order requires a market_condition
rspec ./spec/models/market/order_spec.rb:39 # Market::Order requires an orderable
rspec ./spec/models/market/order_spec.rb:45 # Market::Order belongs to market_condition
rspec ./spec/models/market/order_spec.rb:57 # Market::Order supports polymorphic orderable association
rspec ./spec/models/market/order_spec.rb:69 # Market::Order is invalid without quantity
rspec ./spec/models/market/order_spec.rb:81 # Market::Order is invalid without order_type
rspec ./spec/models/market/order_spec.rb:93 # Market::Order can be associated with a base_settlement_id
rspec ./spec/models/market/price_history_spec.rb:12 # Market::PriceHistory validations is valid with valid attributes
rspec ./spec/models/market/price_history_spec.rb:20 # Market::PriceHistory validations is not valid without a price
rspec ./spec/models/market/supply_chain_spec.rb:22 # Market::SupplyChain is valid with valid attributes
rspec ./spec/models/market/supply_chain_spec.rb:32 # Market::SupplyChain requires a market_order
rspec ./spec/models/market/supply_chain_spec.rb:38 # Market::SupplyChain can track status changes
rspec ./spec/models/market/supply_chain_spec.rb:55 # Market::SupplyChain scopes active supply chains
rspec ./spec/models/market/transaction_fee_spec.rb:5 # Market::TransactionFee validations is expected to validate that :fee_type cannot be empty/falsy
rspec ./spec/models/market/transaction_fee_spec.rb:6 # Market::TransactionFee validations is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"›
rspec ./spec/models/market/transaction_fee_spec.rb:7 # Market::TransactionFee validations is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil
rspec ./spec/models/market/transaction_fee_spec.rb:8 # Market::TransactionFee validations is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil
rspec ./spec/models/market/transaction_fee_spec.rb:12 # Market::TransactionFee#calculate calculates percentage fee
rspec ./spec/models/market/transaction_fee_spec.rb:17 # Market::TransactionFee#calculate calculates fixed fee
rspec ./spec/models/market/transaction_fee_spec.rb:22 # Market::TransactionFee#calculate returns 0 for unknown fee_type
rspec ./spec/models/material_request_spec.rb:13 # MaterialRequest validations is valid with required attributes
rspec ./spec/models/material_request_spec.rb:22 # MaterialRequest validations requires a material_name
rspec ./spec/models/material_request_spec.rb:31 # MaterialRequest validations requires quantity_requested to be present
rspec ./spec/models/material_request_spec.rb:40 # MaterialRequest validations requires quantity_requested to be greater than 0
rspec ./spec/models/material_request_spec.rb:50 # MaterialRequest validations requires quantity_requested to be a number
rspec ./spec/models/material_request_spec.rb:64 # MaterialRequest associations belongs to a requestable (polymorphic)
rspec ./spec/models/material_request_spec.rb:68 # MaterialRequest associations can be associated with different requestable types
rspec ./spec/models/material_request_spec.rb:91 # MaterialRequest enums status enum defaults to pending status
rspec ./spec/models/material_request_spec.rb:95 # MaterialRequest enums status enum can be set to different statuses
rspec ./spec/models/material_request_spec.rb:101 # MaterialRequest enums status enum accepts string values for status
rspec ./spec/models/material_request_spec.rb:117 # MaterialRequest enums priority enum defaults to normal priority
rspec ./spec/models/material_request_spec.rb:121 # MaterialRequest enums priority enum can be set to different priorities
rspec ./spec/models/material_request_spec.rb:127 # MaterialRequest enums priority enum accepts string values for priority
rspec ./spec/models/material_request_spec.rb:143 # MaterialRequest scopes .pending_requests returns pending and partially fulfilled requests
rspec ./spec/models/material_request_spec.rb:151 # MaterialRequest scopes .fulfilled returns only fulfilled requests
rspec ./spec/models/material_request_spec.rb:159 # MaterialRequest scopes .for_material returns requests for a specific material
rspec ./spec/models/material_request_spec.rb:170 # MaterialRequest delegations delegates settlement to requestable
rspec ./spec/models/material_request_spec.rb:174 # MaterialRequest delegations handles nil settlement gracefully
rspec ./spec/models/material_request_spec.rb:183 # MaterialRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
rspec ./spec/models/material_request_spec.rb:192 # MaterialRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
rspec ./spec/models/material_request_spec.rb:201 # MaterialRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
rspec ./spec/models/material_request_spec.rb:220 # MaterialRequest instance methods #gas_request? returns true when material is a gas
rspec ./spec/models/material_request_spec.rb:227 # MaterialRequest instance methods #gas_request? returns false when material is not a gas
rspec ./spec/models/material_request_spec.rb:234 # MaterialRequest instance methods #gas_request? returns false when material data is not found
rspec ./spec/models/material_request_spec.rb:240 # MaterialRequest instance methods #gas_request? returns false when material data has no category
rspec ./spec/models/material_request_spec.rb:250 # MaterialRequest factory creates a valid material request with factory
rspec ./spec/models/material_spec.rb:27 # CelestialBodies::Material validations is not valid without a state
rspec ./spec/models/material_spec.rb:39 # CelestialBodies::Material validations is not valid with an invalid state
rspec ./spec/models/material_spec.rb:50 # CelestialBodies::Material validations is not valid with non-numeric melting and boiling points
rspec ./spec/models/material_spec.rb:64 # CelestialBodies::Material#state_at returns "solid" when temperature is below the adjusted melting point
rspec ./spec/models/material_spec.rb:68 # CelestialBodies::Material#state_at returns "liquid" when temperature is between the adjusted melting and boiling points
rspec ./spec/models/material_spec.rb:72 # CelestialBodies::Material#state_at returns "gas" when temperature is above the adjusted boiling point
rspec ./spec/models/modules/base_module_spec.rb:29 # Modules::BaseModule associations accepts craft as polymorphic attachable
rspec ./spec/models/modules/base_module_spec.rb:112 # Modules::BaseModule callbacks after_create :apply_module_to_attachable applies module to craft when created with craft attachable
rspec ./spec/models/modules/base_module_spec.rb:132 # Modules::BaseModule callbacks before_destroy :remove_module_from_attachable removes module from craft when destroyed
rspec ./spec/models/orbital_construction_project_spec.rb:31 # OrbitalConstructionProject#materials_complete? when all required materials are delivered returns true
rspec ./spec/models/orbital_construction_project_spec.rb:44 # OrbitalConstructionProject#materials_complete? when some materials are missing returns false
rspec ./spec/models/orbital_construction_project_spec.rb:57 # OrbitalConstructionProject#materials_complete? when materials exceed requirements returns true
rspec ./spec/models/orbital_construction_project_spec.rb:74 # OrbitalConstructionProject#completion_percentage when no materials are delivered returns 0
rspec ./spec/models/orbital_construction_project_spec.rb:87 # OrbitalConstructionProject#completion_percentage when half materials are delivered returns 50
rspec ./spec/models/orbital_construction_project_spec.rb:100 # OrbitalConstructionProject#completion_percentage when all materials are delivered returns 100
rspec ./spec/models/orbital_construction_project_spec.rb:109 # OrbitalConstructionProject JSONB storage stores required_materials as JSONB
rspec ./spec/models/orbital_construction_project_spec.rb:116 # OrbitalConstructionProject JSONB storage stores delivered_materials as JSONB
rspec ./spec/models/orbital_construction_project_spec.rb:123 # OrbitalConstructionProject JSONB storage stores project_metadata as JSONB
rspec ./spec/models/orbital_relationship_spec.rb:11 # OrbitalRelationship associations belongs to primary_body polymorphically
rspec ./spec/models/orbital_relationship_spec.rb:16 # OrbitalRelationship associations belongs to secondary_body polymorphically
rspec ./spec/models/orbital_relationship_spec.rb:33 # OrbitalRelationship validations is valid with valid attributes
rspec ./spec/models/orbital_relationship_spec.rb:39 # OrbitalRelationship validations relationship_type validation requires relationship_type to be present
rspec ./spec/models/orbital_relationship_spec.rb:45 # OrbitalRelationship validations relationship_type validation validates relationship_type inclusion
rspec ./spec/models/orbital_relationship_spec.rb:59 # OrbitalRelationship validations numerical validations validates distance is positive
rspec ./spec/models/orbital_relationship_spec.rb:65 # OrbitalRelationship validations numerical validations validates semi_major_axis is positive
rspec ./spec/models/orbital_relationship_spec.rb:70 # OrbitalRelationship validations numerical validations validates eccentricity is between 0 and 1
rspec ./spec/models/orbital_relationship_spec.rb:80 # OrbitalRelationship validations numerical validations validates orbital_period is positive
rspec ./spec/models/orbital_relationship_spec.rb:87 # OrbitalRelationship validations uniqueness validation prevents duplicate relationships between same bodies
rspec ./spec/models/orbital_relationship_spec.rb:107 # OrbitalRelationship backward compatibility methods #sun returns primary_body when it's a Star
rspec ./spec/models/orbital_relationship_spec.rb:111 # OrbitalRelationship backward compatibility methods #sun returns nil when primary_body is not a Star
rspec ./spec/models/orbital_relationship_spec.rb:122 # OrbitalRelationship backward compatibility methods #sun= sets primary_body and relationship_type
rspec ./spec/models/orbital_relationship_spec.rb:132 # OrbitalRelationship backward compatibility methods #celestial_body returns secondary_body when it's a CelestialBody
rspec ./spec/models/orbital_relationship_spec.rb:138 # OrbitalRelationship backward compatibility methods #celestial_body= sets secondary_body
rspec ./spec/models/orbital_relationship_spec.rb:148 # OrbitalRelationship relationship type helpers identifies star_planet relationships
rspec ./spec/models/orbital_relationship_spec.rb:158 # OrbitalRelationship relationship type helpers identifies planet_moon relationships
rspec ./spec/models/orbital_relationship_spec.rb:168 # OrbitalRelationship relationship type helpers identifies binary_star relationships
rspec ./spec/models/orbital_relationship_spec.rb:181 # OrbitalRelationship energy calculations #stellar_energy_input calculates stellar energy based on luminosity and distance
rspec ./spec/models/orbital_relationship_spec.rb:193 # OrbitalRelationship energy calculations #stellar_energy_input returns 0 when primary_body doesn't have luminosity
rspec ./spec/models/orbital_relationship_spec.rb:206 # OrbitalRelationship energy calculations #tidal_heating calculates tidal heating for planet-moon relationships
rspec ./spec/models/orbital_relationship_spec.rb:219 # OrbitalRelationship energy calculations #tidal_heating includes eccentricity factor in calculation
rspec ./spec/models/orbital_relationship_spec.rb:241 # OrbitalRelationship energy calculations #energy_input returns stellar energy for star_planet relationships
rspec ./spec/models/orbital_relationship_spec.rb:252 # OrbitalRelationship energy calculations #energy_input returns combined tidal and reflected energy for planet_moon relationships
rspec ./spec/models/orbital_relationship_spec.rb:277 # OrbitalRelationship terraforming reflected_energy and energy_input returns extra energy for star_planet with orbital mirrors and albedo adjustment
rspec ./spec/models/orbital_relationship_spec.rb:300 # OrbitalRelationship orbital mechanics #orbital_distance returns semi_major_axis when available
rspec ./spec/models/orbital_relationship_spec.rb:308 # OrbitalRelationship orbital mechanics #orbital_distance falls back to distance when semi_major_axis is nil
rspec ./spec/models/orbital_relationship_spec.rb:316 # OrbitalRelationship orbital mechanics #orbital_distance returns 0 when both are nil
rspec ./spec/models/orbital_relationship_spec.rb:326 # OrbitalRelationship orbital mechanics #calculated_orbital_period calculates orbital period using Kepler's Third Law
rspec ./spec/models/orbital_relationship_spec.rb:338 # OrbitalRelationship orbital mechanics #calculated_orbital_period returns nil when primary_body has no mass
rspec ./spec/models/orbital_relationship_spec.rb:352 # OrbitalRelationship orbital mechanics #current_orbital_position calculates orbital position based on time
rspec ./spec/models/orbital_relationship_spec.rb:365 # OrbitalRelationship orbital mechanics #current_orbital_position returns nil when orbital_period or epoch_time is missing
rspec ./spec/models/orbital_relationship_spec.rb:380 # OrbitalRelationship private methods #masses_present? returns true when both bodies have mass
rspec ./spec/models/orbital_relationship_spec.rb:384 # OrbitalRelationship private methods #masses_present? returns false when primary_body has no mass
rspec ./spec/models/orbital_relationship_spec.rb:393 # OrbitalRelationship private methods #extract_mass extracts mass from Star objects
rspec ./spec/models/orbital_relationship_spec.rb:398 # OrbitalRelationship private methods #extract_mass extracts and converts mass from CelestialBody objects
rspec ./spec/models/orbital_relationship_spec.rb:403 # OrbitalRelationship private methods #extract_mass returns nil for unsupported object types
rspec ./spec/models/organizations/base_organization_profit_spec.rb:13 # Organizations::BaseOrganization distributes profits to members based on ownership
rspec ./spec/models/organizations/tax_authority_spec.rb:19 # Organizations::TaxAuthority.instance always returns the same single instance
rspec ./spec/models/planet_biome_spec.rb:15 # PlanetBiome 
rspec ./spec/models/planet_biome_spec.rb:16 # PlanetBiome 
rspec ./spec/models/planet_biome_spec.rb:19 # PlanetBiome is valid with valid attributes
rspec ./spec/models/planet_biome_spec.rb:23 # PlanetBiome is not valid without a biome
rspec ./spec/models/planet_biome_spec.rb:28 # PlanetBiome is not valid without a celestial_body
rspec ./spec/models/plant_environment_spec.rb:13 # PlantEnvironment validations is valid with valid attributes
rspec ./spec/models/plant_environment_spec.rb:17 # PlantEnvironment validations is not valid without a plant
rspec ./spec/models/plant_environment_spec.rb:22 # PlantEnvironment validations is not valid without an environment
rspec ./spec/models/plant_environment_spec.rb:27 # PlantEnvironment validations is not valid with duplicate plant and environment pair
rspec ./spec/models/plant_spec.rb:9 # Plant validations is valid with valid attributes
rspec ./spec/models/plant_spec.rb:35 # Plant methods can grow in a given environment if conditions are met
rspec ./spec/models/plant_spec.rb:41 # Plant methods cannot grow in a given environment if conditions are not met
rspec ./spec/models/player_spec.rb:14 # Player validations is valid with valid attributes
rspec ./spec/models/player_spec.rb:18 # Player validations is not valid without a name
rspec ./spec/models/player_spec.rb:23 # Player validations is not valid without an active_location
rspec ./spec/models/player_spec.rb:30 # Player account balance has a balance of 1000
rspec ./spec/models/player_spec.rb:36 # Player inventory at active location raises an error if active location is not set
rspec ./spec/models/player_spec.rb:41 # Player inventory at active location returns the inventory at the active location
rspec ./spec/models/rigs/base_rig_spec.rb:23 # Rigs::BaseRig#apply_rig_to_attachable applies rig effect to the attachable unit
rspec ./spec/models/rigs/base_rig_spec.rb:30 # Rigs::BaseRig#remove_from removes rig effect from the attachable unit
rspec ./spec/models/rigs/base_rig_spec.rb:37 # Rigs::BaseRig polymorphic association can belong to an attachable BaseUnit
rspec ./spec/models/rigs/base_rig_spec.rb:106 # Rigs::BaseRig#apply_output_effects and #revert_output_effects applies and reverts output effects if attachable responds to update_outputs
rspec ./spec/models/rigs/base_rig_spec.rb:128 # Rigs::BaseRig#apply_damage_effects and #revert_damage_effects applies and reverts damage effects if attachable responds to update_damage_risks
rspec ./spec/models/route_proposal_spec.rb:12 # RouteProposal calculates vote outcome based on threshold
rspec ./spec/models/route_proposal_spec.rb:17 # RouteProposal fails if votes do not meet threshold
rspec ./spec/models/route_proposal_vote_spec.rb:7 # RouteProposalVote is valid with valid attributes
rspec ./spec/models/route_proposal_vote_spec.rb:12 # RouteProposalVote is invalid with an invalid vote value
rspec ./spec/models/settlement/base_settlement_spec.rb:32 # Settlement::BaseSettlement validations is valid with valid attributes
rspec ./spec/models/settlement/base_settlement_spec.rb:36 # Settlement::BaseSettlement validations is not valid without a name
rspec ./spec/models/settlement/base_settlement_spec.rb:41 # Settlement::BaseSettlement validations is not valid with a negative current population
rspec ./spec/models/settlement/base_settlement_spec.rb:46 # Settlement::BaseSettlement validations is not valid with a non-integer current population
rspec ./spec/models/settlement/base_settlement_spec.rb:82 # Settlement::BaseSettlement associations can belong to a player
rspec ./spec/models/settlement/base_settlement_spec.rb:86 # Settlement::BaseSettlement associations has many docked crafts
rspec ./spec/models/settlement/base_settlement_spec.rb:90 # Settlement::BaseSettlement associations has many base units
rspec ./spec/models/settlement/base_settlement_spec.rb:94 # Settlement::BaseSettlement associations has a marketplace association using the correct foreign key
rspec ./spec/models/settlement/base_settlement_spec.rb:98 # Settlement::BaseSettlement associations has a financial account
rspec ./spec/models/settlement/base_settlement_spec.rb:102 # Settlement::BaseSettlement associations destroys the marketplace when destroyed
rspec ./spec/models/settlement/base_settlement_spec.rb:132 # Settlement::BaseSettlement storage capacity calculates storage capacity by type
rspec ./spec/models/settlement/base_settlement_spec.rb:139 # Settlement::BaseSettlement storage capacity maintains backward compatibility with total storage capacity (liquid and gas only)
rspec ./spec/models/settlement/base_settlement_spec.rb:143 # Settlement::BaseSettlement storage capacity calculates total storage capacity (sum of all storage types)
rspec ./spec/models/settlement/base_settlement_spec.rb:172 # Settlement::BaseSettlement Market Integration #npc_market_bid calls the NpcPriceCalculator with the correct arguments
rspec ./spec/models/settlement/base_settlement_spec.rb:177 # Settlement::BaseSettlement Market Integration #npc_market_bid returns the calculated price
rspec ./spec/models/settlement/base_settlement_spec.rb:187 # Settlement::BaseSettlement Market Integration #npc_buy_capacity when storage is the limiting factor (50 units) limits capacity by available storage (50)
rspec ./spec/models/settlement/base_settlement_spec.rb:196 # Settlement::BaseSettlement Market Integration #npc_buy_capacity when finances are the limiting factor (20 units) limits capacity by financial ability (20)
rspec ./spec/models/settlement/base_settlement_spec.rb:204 # Settlement::BaseSettlement Market Integration #npc_buy_capacity when bid price is zero returns 0 capacity
rspec ./spec/models/settlement/base_settlement_spec.rb:210 # Settlement::BaseSettlement Market Integration #npc_buy_capacity when account or inventory is missing returns 0 capacity if account is missing
rspec ./spec/models/settlement/base_settlement_spec.rb:215 # Settlement::BaseSettlement Market Integration #npc_buy_capacity when account or inventory is missing returns 0 capacity if inventory is missing
rspec ./spec/models/settlement/base_settlement_spec.rb:225 # Settlement::BaseSettlement after_create hooks creates a financial account and inventory
rspec ./spec/models/settlement/base_settlement_spec.rb:238 # Settlement::BaseSettlement celestial body delegation delegates celestial_body to location
rspec ./spec/models/settlement/base_settlement_spec.rb:256 # Settlement::BaseSettlement#process_materials processes materials using base units
rspec ./spec/models/settlement/base_settlement_spec.rb:265 # Settlement::BaseSettlement operational_data can store and retrieve operational data
rspec ./spec/models/settlement/base_settlement_spec.rb:282 # Settlement::BaseSettlement operational_data provides default empty hash if operational_data is empty
rspec ./spec/models/settlement/base_settlement_spec.rb:296 # Settlement::BaseSettlement operational_data works with energy management methods
rspec ./spec/models/settlement/base_settlement_spec.rb:318 # Settlement::BaseSettlement construction cost management #construction_cost_percentage returns default percentage when not set
rspec ./spec/models/settlement/base_settlement_spec.rb:322 # Settlement::BaseSettlement construction cost management #construction_cost_percentage returns custom percentage when set in operational_data
rspec ./spec/models/settlement/base_settlement_spec.rb:333 # Settlement::BaseSettlement construction cost management #construction_cost_percentage handles empty operational_data gracefully
rspec ./spec/models/settlement/base_settlement_spec.rb:338 # Settlement::BaseSettlement construction cost management #construction_cost_percentage handles missing manufacturing section gracefully
rspec ./spec/models/settlement/base_settlement_spec.rb:349 # Settlement::BaseSettlement construction cost management #construction_cost_percentage handles empty operational_data gracefully
rspec ./spec/models/settlement/base_settlement_spec.rb:356 # Settlement::BaseSettlement construction cost management #construction_cost_percentage= sets the construction cost percentage in operational_data
rspec ./spec/models/settlement/base_settlement_spec.rb:364 # Settlement::BaseSettlement construction cost management #construction_cost_percentage= initializes operational_data manufacturing section if empty
rspec ./spec/models/settlement/base_settlement_spec.rb:372 # Settlement::BaseSettlement construction cost management #construction_cost_percentage= preserves existing operational_data when setting percentage
rspec ./spec/models/settlement/base_settlement_spec.rb:396 # Settlement::BaseSettlement construction cost management #calculate_construction_cost calculates construction cost as percentage of purchase cost
rspec ./spec/models/settlement/base_settlement_spec.rb:403 # Settlement::BaseSettlement construction cost management #calculate_construction_cost rounds to 2 decimal places
rspec ./spec/models/settlement/base_settlement_spec.rb:410 # Settlement::BaseSettlement construction cost management #calculate_construction_cost handles zero purchase cost
rspec ./spec/models/settlement/base_settlement_spec.rb:414 # Settlement::BaseSettlement construction cost management #calculate_construction_cost handles string input by converting to float
rspec ./spec/models/settlement/base_settlement_spec.rb:421 # Settlement::BaseSettlement construction cost management #calculate_construction_cost handles nil input gracefully
rspec ./spec/models/settlement/base_settlement_spec.rb:427 # Settlement::BaseSettlement construction cost management manufacturing settings supports manufacturing efficiency setting
rspec ./spec/models/settlement/base_settlement_spec.rb:433 # Settlement::BaseSettlement construction cost management manufacturing settings defaults manufacturing efficiency to 1.0
rspec ./spec/models/settlement/base_settlement_spec.rb:437 # Settlement::BaseSettlement construction cost management manufacturing settings supports equipment check setting
rspec ./spec/models/settlement/base_settlement_spec.rb:443 # Settlement::BaseSettlement construction cost management manufacturing settings defaults equipment check to true
rspec ./spec/models/settlement/base_settlement_spec.rb:452 # Settlement::BaseSettlement construction cost integration integrates construction cost calculations with settlement manufacturing data
rspec ./spec/models/settlement/base_settlement_spec.rb:471 # Settlement::BaseSettlement construction cost integration preserves other operational_data when updating construction settings
rspec ./spec/models/settlement/base_settlement_spec.rb:486 # Settlement::BaseSettlement construction cost integration works correctly when operational_data starts empty
rspec ./spec/models/settlement/city_spec.rb:20 # Settlement::City validations is valid with valid attributes
rspec ./spec/models/settlement/city_spec.rb:24 # Settlement::City validations is not valid without a location
rspec ./spec/models/settlement/city_spec.rb:29 # Settlement::City validations is not valid without a name
rspec ./spec/models/settlement/city_spec.rb:34 # Settlement::City validations is not valid with a negative current population
rspec ./spec/models/settlement/city_spec.rb:39 # Settlement::City validations is not valid with food_per_person less than or equal to zero
rspec ./spec/models/settlement/city_spec.rb:44 # Settlement::City validations is not valid with water_per_person less than or equal to zero
rspec ./spec/models/settlement/city_spec.rb:49 # Settlement::City validations is not valid with energy_per_person less than or equal to zero
rspec ./spec/models/settlement/city_spec.rb:56 # Settlement::City#resource_requirements calculates resource requirements correctly
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:13 # Settlement::NPCColony can build a unit
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:19 # Settlement::NPCColony can establish trade routes
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:25 # Settlement::NPCColony can perform autonomous tasks
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:29 # Settlement::NPCColony calculates total population across settlements
rspec ./spec/models/settlement/orbital_depot_spec.rb:81 # Settlement::OrbitalDepot#add_gas handles multiple gas types
rspec ./spec/models/settlement/orbital_depot_spec.rb:182 # Settlement::OrbitalDepot#total_gas_mass sums all gas types
rspec ./spec/models/settlement/orbital_depot_spec.rb:204 # Settlement::OrbitalDepot#gas_inventory_summary groups by gas name
rspec ./spec/models/settlement/orbital_depot_spec.rb:221 # Settlement::OrbitalDepot#depot_status returns comprehensive status hash
rspec ./spec/models/settlement/outpost_spec.rb:15 # Settlement::Outpost validations is valid with valid attributes
rspec ./spec/models/settlement/outpost_spec.rb:19 # Settlement::Outpost validations is not valid without a name
rspec ./spec/models/settlement/outpost_spec.rb:27 # Settlement::Outpost population capacity calculates total capacity from habitat units
rspec ./spec/models/settlement/outpost_spec.rb:34 # Settlement::Outpost population capacity calculates available capacity correctly
rspec ./spec/models/settlement/outpost_spec.rb:40 # Settlement::Outpost population capacity checks if it has capacity for additional population
rspec ./spec/models/settlement/settlement_spec.rb:20 # Settlement::Settlement validations is valid with valid attributes
rspec ./spec/models/settlement/settlement_spec.rb:24 # Settlement::Settlement validations is not valid without a name
rspec ./spec/models/settlement/settlement_spec.rb:32 # Settlement::Settlement population capacity calculates total capacity from habitat units
rspec ./spec/models/settlement/settlement_spec.rb:37 # Settlement::Settlement population capacity calculates available capacity correctly
rspec ./spec/models/settlement/settlement_spec.rb:42 # Settlement::Settlement population capacity checks if it has capacity for additional population
rspec ./spec/models/settlement/space_station_spec.rb:61 # Settlement::SpaceStation model structure inherits from BaseSettlement
rspec ./spec/models/settlement/space_station_spec.rb:65 # Settlement::SpaceStation model structure includes LifeSupport
rspec ./spec/models/settlement/space_station_spec.rb:69 # Settlement::SpaceStation model structure includes Docking
rspec ./spec/models/settlement/space_station_spec.rb:73 # Settlement::SpaceStation model structure includes Shell concern
rspec ./spec/models/settlement/space_station_spec.rb:77 # Settlement::SpaceStation model structure inherits Enclosable through Shell
rspec ./spec/models/settlement/space_station_spec.rb:87 # Settlement::SpaceStation validations validates settlement_type is station or outpost
rspec ./spec/models/settlement/space_station_spec.rb:100 # Settlement::SpaceStation associations 
rspec ./spec/models/settlement/space_station_spec.rb:101 # Settlement::SpaceStation associations 
rspec ./spec/models/settlement/space_station_spec.rb:105 # Settlement::SpaceStation associations 
rspec ./spec/models/settlement/space_station_spec.rb:110 # Settlement::SpaceStation dimensional interface (from Enclosable) #set_dimensions stores dimensions in operational_data
rspec ./spec/models/settlement/space_station_spec.rb:117 # Settlement::SpaceStation dimensional interface (from Enclosable) #set_dimensions can set diameter for cylindrical stations
rspec ./spec/models/settlement/space_station_spec.rb:126 # Settlement::SpaceStation dimensional interface (from Enclosable) #area_m2 calculates area for rectangular station
rspec ./spec/models/settlement/space_station_spec.rb:132 # Settlement::SpaceStation dimensional interface (from Enclosable) #area_m2 calculates area for cylindrical station
rspec ./spec/models/settlement/space_station_spec.rb:141 # Settlement::SpaceStation dimensional interface (from Enclosable) #calculate_volume calculates volume for rectangular station
rspec ./spec/models/settlement/space_station_spec.rb:149 # Settlement::SpaceStation dimensional interface (from Enclosable) #calculate_volume calculates volume for cylindrical station
rspec ./spec/models/settlement/space_station_spec.rb:172 # Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! returns success result with materials and time estimate
rspec ./spec/models/settlement/space_station_spec.rb:181 # Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! updates status to framework_construction
rspec ./spec/models/settlement/space_station_spec.rb:187 # Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! accepts custom panel type
rspec ./spec/models/settlement/space_station_spec.rb:196 # Settlement::SpaceStation shell construction workflow (from Shell concern) #schedule_shell_construction! updates shell composition
rspec ./spec/models/settlement/space_station_spec.rb:217 # Settlement::SpaceStation shell construction workflow (from Shell concern) construction phases advances through construction phases
rspec ./spec/models/settlement/space_station_spec.rb:233 # Settlement::SpaceStation shell construction workflow (from Shell concern) construction phases creates atmosphere when sealed
rspec ./spec/models/settlement/space_station_spec.rb:241 # Settlement::SpaceStation shell construction workflow (from Shell concern) construction phases does not initialize default modules when operational
rspec ./spec/models/settlement/space_station_spec.rb:266 # Settlement::SpaceStation shell construction workflow (from Shell concern) status helpers responds to Shell concern status methods
rspec ./spec/models/settlement/space_station_spec.rb:272 # Settlement::SpaceStation shell construction workflow (from Shell concern) status helpers checks sealed status correctly
rspec ./spec/models/settlement/space_station_spec.rb:280 # Settlement::SpaceStation shell construction workflow (from Shell concern) status helpers checks pressurized status correctly
rspec ./spec/models/settlement/space_station_spec.rb:301 # Settlement::SpaceStation power generation (from Enclosable) calculates power generation from solar panels
rspec ./spec/models/settlement/space_station_spec.rb:309 # Settlement::SpaceStation power generation (from Enclosable) accounts for panel degradation
rspec ./spec/models/settlement/space_station_spec.rb:320 # Settlement::SpaceStation power generation (from Enclosable) accounts for failed panels
rspec ./spec/models/settlement/space_station_spec.rb:341 # Settlement::SpaceStation panel degradation and maintenance (from Enclosable) simulates panel degradation over time
rspec ./spec/models/settlement/space_station_spec.rb:350 # Settlement::SpaceStation panel degradation and maintenance (from Enclosable) can repair failed panels
rspec ./spec/models/settlement/space_station_spec.rb:364 # Settlement::SpaceStation panel degradation and maintenance (from Enclosable) can replace degraded panels
rspec ./spec/models/settlement/space_station_spec.rb:376 # Settlement::SpaceStation panel degradation and maintenance (from Enclosable) provides shell status report
rspec ./spec/models/settlement/space_station_spec.rb:392 # Settlement::SpaceStation storage capacity management #calculate_storage_capacity returns 0 when no storage units exist
rspec ./spec/models/settlement/space_station_spec.rb:396 # Settlement::SpaceStation storage capacity management #calculate_storage_capacity sums capacity from all storage units
rspec ./spec/models/settlement/space_station_spec.rb:422 # Settlement::SpaceStation storage capacity management #calculate_storage_capacity ignores units without storage capacity
rspec ./spec/models/settlement/space_station_spec.rb:463 # Settlement::SpaceStation storage capacity management #available_capacity returns total capacity when empty
rspec ./spec/models/settlement/space_station_spec.rb:467 # Settlement::SpaceStation storage capacity management #available_capacity subtracts current inventory mass
rspec ./spec/models/settlement/space_station_spec.rb:490 # Settlement::SpaceStation storage capacity management #can_store? returns true when sufficient capacity available
rspec ./spec/models/settlement/space_station_spec.rb:494 # Settlement::SpaceStation storage capacity management #can_store? returns false when insufficient capacity
rspec ./spec/models/settlement/space_station_spec.rb:506 # Settlement::SpaceStation module management #add_module adds a new module to the station
rspec ./spec/models/settlement/space_station_spec.rb:523 # Settlement::SpaceStation module management #add_module requires station to be operational
rspec ./spec/models/settlement/space_station_spec.rb:557 # Settlement::SpaceStation module management module type queries filters modules by type
rspec ./spec/models/settlement/space_station_spec.rb:565 # Settlement::SpaceStation module management #habitat_capacity sums capacity from all habitat modules
rspec ./spec/models/settlement/space_station_spec.rb:593 # Settlement::SpaceStation module management #research_efficiency sums efficiency from all lab modules
rspec ./spec/models/settlement/space_station_spec.rb:627 # Settlement::SpaceStation operational status #fully_operational? requires shell to be operational
rspec ./spec/models/settlement/space_station_spec.rb:631 # Settlement::SpaceStation operational status #fully_operational? requires habitat modules
rspec ./spec/models/settlement/space_station_spec.rb:667 # Settlement::SpaceStation operational status #station_status returns comprehensive status
rspec ./spec/models/settlement/space_station_spec.rb:691 # Settlement::SpaceStation damage and repair can damage modules
rspec ./spec/models/settlement/space_station_spec.rb:708 # Settlement::SpaceStation damage and repair repairs damaged modules and shell
rspec ./spec/models/settlement/space_station_spec.rb:732 # Settlement::SpaceStation integration scenarios orbital depot inheriting from space station inherits all Shell/Enclosable functionality
rspec ./spec/models/settlement/space_station_spec.rb:738 # Settlement::SpaceStation integration scenarios orbital depot inheriting from space station adds depot-specific gas storage
rspec ./spec/models/settlement/space_station_spec.rb:757 # Settlement::SpaceStation integration scenarios complete station lifecycle goes from planned to fully operational
rspec ./spec/models/shell_printing_job_spec.rb:36 # ShellPrintingJob scopes returns active jobs
rspec ./spec/models/shell_printing_job_spec.rb:40 # ShellPrintingJob scopes returns completed jobs
rspec ./spec/models/shell_printing_job_spec.rb:44 # ShellPrintingJob scopes returns in_progress jobs
rspec ./spec/models/shell_printing_job_spec.rb:50 # ShellPrintingJob#start! changes status to in_progress and sets started_at
rspec ./spec/models/shell_printing_job_spec.rb:59 # ShellPrintingJob#complete! changes status to completed and sets completed_at
rspec ./spec/models/shell_printing_job_spec.rb:69 # ShellPrintingJob#progress_percentage calculates progress percentage
rspec ./spec/models/shell_printing_job_spec.rb:77 # ShellPrintingJob#time_remaining_hours calculates remaining time
rspec ./spec/models/shell_printing_job_spec.rb:86 # ShellPrintingJob#process_tick when job is not complete increases progress_hours
rspec ./spec/models/shell_printing_job_spec.rb:97 # ShellPrintingJob#process_tick when job completes during tick completes the job
rspec ./spec/models/solar_system_spec.rb:23 # SolarSystem associations has one spatial_location association
rspec ./spec/models/solar_system_spec.rb:30 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:31 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:32 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:33 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:34 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:35 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:36 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:38 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:42 # SolarSystem validations 
rspec ./spec/models/solar_system_spec.rb:43 # SolarSystem validations 
rspec ./spec/models/solar_system_spec.rb:47 # SolarSystem callbacks generates a unique name before create if name is not present
rspec ./spec/models/solar_system_spec.rb:62 # SolarSystem callbacks sets an initial star after create if no stars exist
rspec ./spec/models/solar_system_spec.rb:73 # SolarSystem#load_star loads or creates a star with the given parameters
rspec ./spec/models/solar_system_spec.rb:88 # SolarSystem#load_star updates an existing star if the name matches
rspec ./spec/models/solar_system_spec.rb:102 # SolarSystem#load_terrestrial_planet loads or creates a terrestrial planet
rspec ./spec/models/solar_system_spec.rb:110 # SolarSystem#load_terrestrial_planet updates an existing terrestrial planet if the name matches
rspec ./spec/models/solar_system_spec.rb:125 # SolarSystem#load_gas_giant loads or creates a gas giant
rspec ./spec/models/solar_system_spec.rb:133 # SolarSystem#load_gas_giant updates an existing gas giant if the name matches
rspec ./spec/models/solar_system_spec.rb:147 # SolarSystem#load_ice_giant loads or creates an ice giant
rspec ./spec/models/solar_system_spec.rb:155 # SolarSystem#load_ice_giant updates an existing ice giant if the name matches
rspec ./spec/models/solar_system_spec.rb:169 # SolarSystem#load_moon loads or creates a moon
rspec ./spec/models/solar_system_spec.rb:177 # SolarSystem#load_moon updates an existing moon if the name matches
rspec ./spec/models/solar_system_spec.rb:191 # SolarSystem#load_dwarf_planet loads or creates a dwarf planet
rspec ./spec/models/solar_system_spec.rb:200 # SolarSystem#load_dwarf_planet updates an existing dwarf planet if the name matches
rspec ./spec/models/solar_system_spec.rb:219 # SolarSystem#habitable_zone? when a planet is in the habitable zone of at least one star returns true
rspec ./spec/models/solar_system_spec.rb:227 # SolarSystem#habitable_zone? when a planet is outside the habitable zone of all stars returns false
rspec ./spec/models/solar_system_spec.rb:235 # SolarSystem#habitable_zone? when there are no stars returns false
rspec ./spec/models/solar_system_spec.rb:244 # SolarSystem#habitable_zone? when the planet does not have an orbital period returns false
rspec ./spec/models/solar_system_spec.rb:260 # SolarSystem#total_mass calculates total mass of all planets and dwarf planets
rspec ./spec/models/solar_system_spec.rb:288 # SolarSystem star relationships can have multiple stars
rspec ./spec/models/solar_system_spec.rb:302 # SolarSystem star relationships identifies the primary star by mass
rspec ./spec/models/solar_system_spec.rb:317 # SolarSystem star relationships supports binary star systems
rspec ./spec/models/storage/base_storage_spec.rb:8 # Storage::BaseStorage#add_item adds item successfully
rspec ./spec/models/storage/base_storage_spec.rb:22 # Storage::BaseStorage#remove_item removes item successfully
rspec ./spec/models/storage/base_storage_spec.rb:29 # Storage::BaseStorage#remove_item fails to remove item if not enough available
rspec ./spec/models/storage/gas_storage_spec.rb:7 # Storage::GasStorage initializes with the correct type
rspec ./spec/models/storage/solid_storage_spec.rb:7 # Storage::SolidStorage initializes with the correct type
rspec ./spec/models/terrestrial_planets_spec.rb:33 # CelestialBodies::TerrestrialPlanet runs TerraSim on planet creation
rspec ./spec/models/terrestrial_planets_spec.rb:9 # CelestialBodies::TerrestrialPlanet#update_biomes updates biomes specific to terrestrial planets
rspec ./spec/models/terrestrial_planets_spec.rb:18 # CelestialBodies::TerrestrialPlanet#add_gas adds gas and updates the mass
rspec ./spec/models/terrestrial_planets_spec.rb:27 # CelestialBodies::TerrestrialPlanet#calculate_surface_conditions calculates surface conditions specific to terrestrial planets
rspec ./spec/models/transaction_spec.rb:22 # Transaction associations belongs to an account
rspec ./spec/models/transaction_spec.rb:27 # Transaction associations belongs to a recipient
rspec ./spec/models/transaction_spec.rb:34 # Transaction validations requires a transaction_type
rspec ./spec/models/transaction_spec.rb:40 # Transaction validations requires a valid transaction_type
rspec ./spec/models/transaction_spec.rb:46 # Transaction validations requires an amount
rspec ./spec/models/transaction_spec.rb:52 # Transaction validations requires amount to be numeric
rspec ./spec/models/transaction_spec.rb:60 # Transaction transaction types allows deposit transactions
rspec ./spec/models/transaction_spec.rb:65 # Transaction transaction types allows withdraw transactions
rspec ./spec/models/transaction_spec.rb:70 # Transaction transaction types allows transfer transactions
rspec ./spec/models/unit_assembly_job_spec.rb:53 # UnitAssemblyJob#materials_gathered? returns false when not all materials are fulfilled
rspec ./spec/models/unit_assembly_job_spec.rb:57 # UnitAssemblyJob#materials_gathered? returns true when all materials are fulfilled
rspec ./spec/models/unit_assembly_job_spec.rb:62 # UnitAssemblyJob#materials_gathered? returns true when no material requests exist
rspec ./spec/models/unit_assembly_job_spec.rb:98 # UnitAssemblyJob#start_assembly starts assembly when materials are gathered
rspec ./spec/models/unit_assembly_job_spec.rb:107 # UnitAssemblyJob#start_assembly consumes materials from inventory
rspec ./spec/models/unit_assembly_job_spec.rb:115 # UnitAssemblyJob#start_assembly returns false when not materials_pending status
rspec ./spec/models/units/base_unit_spec.rb:123 # Units::BaseUnit storage operations #store_item stores items in both inventory and operational data
rspec ./spec/models/units/base_unit_spec.rb:139 # Units::BaseUnit storage operations #store_item updates existing items
rspec ./spec/models/units/battery_spec.rb:101 # Units::Battery interaction with BatteryManagement concern prefers specialized methods over concern methods
rspec ./spec/models/waste_treatment_unit_spec.rb:18 # Units::WasteTreatmentUnit#operate operates successfully and produces recycled and neutralized output
rspec ./spec/models/waste_treatment_unit_spec.rb:27 # Units::WasteTreatmentUnit#operate returns false if insufficient waste is available
rspec ./spec/models/waste_treatment_unit_spec.rb:32 # Units::WasteTreatmentUnit#operate returns false if insufficient power is available
rspec ./spec/models/wormhole_spec.rb:44 # Wormhole associations is expected to have many endpoints class_name => SpatialLocation dependent => destroy
rspec ./spec/models/wormhole_spec.rb:129 # Wormhole#stabilization_satellites returns deployed stabilization satellites within range of either endpoint
rspec ./spec/models/wormhole_spec.rb:162 # Wormhole#operational_stabilizers returns a unique list of operational direct stabilizers and stabilization satellites
rspec ./spec/models/wormhole_spec.rb:230 # Wormhole#safe_for_travel? with insufficient operational stabilizers is not safe
rspec ./spec/models/wormhole_spec.rb:240 # Wormhole#safe_for_travel? with enough operational stabilizers is safe
rspec ./spec/models/wormhole_spec.rb:256 # Wormhole#can_traverse? with sufficient mass limit returns true
rspec ./spec/models/wormhole_spec.rb:262 # Wormhole#can_traverse? with insufficient mass limit returns false
rspec ./spec/models/wormhole_spec.rb:301 # Wormhole#can_traverse? when one-way and already traversed returns false
rspec ./spec/models/wormhole_spec.rb:341 # Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint A when not stabilized and mass limit is hit
rspec ./spec/models/wormhole_spec.rb:353 # Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint B when not stabilized and mass limit is hit
rspec ./spec/models/wormhole_spec.rb:365 # Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint A when mass limit is hit
rspec ./spec/models/wormhole_spec.rb:377 # Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint B when mass limit is hit
rspec ./spec/models/wormhole_spec.rb:449 # Wormhole#stabilization_satellites (integration) returns deployed stabilization satellites within range of either endpoint
rspec ./spec/services/ai_manager/decision_tree_spec.rb:16 # AIManager::DecisionTree#make_decisions when oxygen is critical calls handle_oxygen_refill and returns
rspec ./spec/services/ai_manager/decision_tree_spec.rb:30 # AIManager::DecisionTree#make_decisions when account is negative calls handle_debt_repayment and returns
rspec ./spec/services/ai_manager/decision_tree_spec.rb:45 # AIManager::DecisionTree#make_decisions when no priorities proceeds with normal decision making
rspec ./spec/services/ai_manager/decision_tree_spec.rb:56 # AIManager::DecisionTree#handle_oxygen_refill calls prioritize_oxygen_refill on resource_planner
rspec ./spec/services/ai_manager/decision_tree_spec.rb:71 # AIManager::DecisionTree#handle_debt_repayment sets si_ask_ceiling in settlement operational_data
rspec ./spec/services/ai_manager/decision_tree_spec.rb:81 # AIManager::DecisionTree#handle_mars_oxygen_maintenance calls prioritize_energy_for_o2_generation on resource_planner
rspec ./spec/services/ai_manager/decision_tree_spec.rb:97 # AIManager::DecisionTree#handle_mars_nitrogen_import finds closest resource source and creates interplanetary contract
rspec ./spec/services/ai_manager/decision_tree_spec.rb:116 # AIManager::DecisionTree Mars planet-aware crisis handling when O2 crisis on Mars handles O2 crisis through local maintenance, not trade
rspec ./spec/services/ai_manager/decision_tree_spec.rb:135 # AIManager::DecisionTree Mars planet-aware crisis handling when N2 crisis on Mars triggers interplanetary contract based on closest source
rspec ./spec/services/ai_manager/operational_manager_spec.rb:59 # AIManager::OperationalManager#make_decision when stable and expansion is feasible considers expansion
rspec ./spec/services/ai_manager/operational_manager_spec.rb:76 # AIManager::OperationalManager#make_decision when stable with no expansion opportunities maintains current operations
rspec ./spec/services/ai_manager/operational_manager_spec.rb:181 # AIManager::OperationalManager decision logging logs decisions with timestamps and categories
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:18 # AIManager::PriorityHeuristic#oxygen_critical? when O2 mass is above 15% of target returns false
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:31 # AIManager::PriorityHeuristic#oxygen_critical? when O2 mass is below 15% of target returns true
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:43 # AIManager::PriorityHeuristic#account_negative? when account balance is positive returns false
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:53 # AIManager::PriorityHeuristic#account_negative? when account balance is negative returns true
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:68 # AIManager::PriorityHeuristic#get_priorities when neither condition is met returns empty array
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:81 # AIManager::PriorityHeuristic#get_priorities when oxygen is critical returns refill_oxygen priority
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:94 # AIManager::PriorityHeuristic#get_priorities when account is negative returns debt_repayment priority
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:107 # AIManager::PriorityHeuristic#get_priorities when both conditions are met returns both priorities
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:136 # AIManager::PriorityHeuristic#get_priorities on Mars when oxygen is critical on Mars returns local_oxygen_generation priority instead of refill_oxygen
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:160 # AIManager::PriorityHeuristic#get_priorities on Mars when nitrogen is critical on Mars returns local_argon_extraction priority
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:171 # AIManager::PriorityHeuristic#calculate_si_ask_price returns 95% of the calculated ask price
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:195 # AIManager::PriorityHeuristic Environmental System Integration with procedurally generated planet having 95% CO2 and 0.0 Tesla magnetic field correctly chooses local O2 production
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:219 # AIManager::PriorityHeuristic Environmental System Integration with planet having low CO2 and weak magnetic field chooses oxygen refill instead of local generation
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:244 # AIManager::PriorityHeuristic Environmental System Integration with settlement having excess CO and H2 prioritizes methane synthesis
rspec ./spec/services/ai_manager/priority_heuristic_spec.rb:265 # AIManager::PriorityHeuristic Environmental System Integration with settlement having critical storage capacity prioritizes storage module construction
rspec ./spec/services/ai_manager/system_architect_spec.rb:99 # AIManager::SystemArchitect#deploy_subsurface_foothold creates subsurface location
rspec ./spec/services/ai_manager/system_architect_spec.rb:103 # AIManager::SystemArchitect#deploy_subsurface_foothold creates settlement
rspec ./spec/services/ai_manager/system_architect_spec.rb:120 # AIManager::SystemArchitect#find_nearby_asteroid with suitable asteroid finds the asteroid
rspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:24 # AIManager::SystemIntelligenceService#system_status with operational structures returns correct operational ratio and status
rspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:47 # AIManager::SystemIntelligenceService#system_status with all operational structures returns healthy status
rspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:59 # AIManager::SystemIntelligenceService#system_status with mostly non-operational structures returns critical status
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:517 # AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure creates a crater dome structure
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:526 # AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure uses ConstructionJobService
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:645 # AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply schedules a material ferry mission
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:651 # AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply updates craft status
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:663 # AIManager::TaskExecutionEngine.orbital_resupply_cycle when no active projects does not schedule missions
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:17 # AIManager::TerraformingManager#calculate_gas_needs with magnetosphere protection returns gas needs for warming phase
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:27 # AIManager::TerraformingManager#calculate_gas_needs without magnetosphere protection returns empty hash
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:37 # AIManager::TerraformingManager#calculate_gas_needs with preservation mode and exceeded limit returns empty hash
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:48 # AIManager::TerraformingManager#has_magnetosphere_protection? with natural magnetosphere returns true
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:54 # AIManager::TerraformingManager#has_magnetosphere_protection? without natural magnetosphere returns false
rspec ./spec/services/autonomous_mission_service_spec.rb:12 # AutonomousMissionService.find_or_create_worldhouse_feature when a lava tube exists returns the existing lava tube
rspec ./spec/services/autonomous_mission_service_spec.rb:54 # AutonomousMissionService.find_or_create_worldhouse_feature priority order prioritizes lava tube over valley and canyon
rspec ./spec/services/autonomous_mission_service_spec.rb:85 # AutonomousMissionService.execute_base_building_sequence calls the feature finding method
rspec ./spec/services/autonomous_mission_service_spec.rb:91 # AutonomousMissionService.execute_base_building_sequence logs mission progress
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:11 # Construction::OrbitalShipyardService.create_shipyard_project with valid parameters creates a new orbital construction project
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:17 # Construction::OrbitalShipyardService.create_shipyard_project with valid parameters associates the project with the station
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:22 # Construction::OrbitalShipyardService.create_shipyard_project with valid parameters sets the correct blueprint_id
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:27 # Construction::OrbitalShipyardService.create_shipyard_project with valid parameters sets initial status to materials_pending
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:32 # Construction::OrbitalShipyardService.create_shipyard_project with valid parameters initializes progress_percentage to 0
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:37 # Construction::OrbitalShipyardService.create_shipyard_project with valid parameters loads required materials from blueprint
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:43 # Construction::OrbitalShipyardService.create_shipyard_project with valid parameters initializes delivered_materials with zero values
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:53 # Construction::OrbitalShipyardService.create_shipyard_project with invalid blueprint_id raises an error
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:74 # Construction::OrbitalShipyardService.deliver_materials when material is needed consumes the material for the project
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:80 # Construction::OrbitalShipyardService.deliver_materials when material is needed returns the unconsumed quantity
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:85 # Construction::OrbitalShipyardService.deliver_materials when material is needed does not consume more than needed
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:96 # Construction::OrbitalShipyardService.deliver_materials when material is not needed returns the full quantity
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:101 # Construction::OrbitalShipyardService.deliver_materials when material is not needed does not update any project materials
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:113 # Construction::OrbitalShipyardService.deliver_materials when project becomes ready changes status to in_progress when all materials are delivered
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:130 # Construction::OrbitalShipyardService.deliver_materials with multiple projects distributes materials across projects
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:149 # Construction::OrbitalShipyardService.update_construction_progress increases progress percentage
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:155 # Construction::OrbitalShipyardService.update_construction_progress does not exceed 100%
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:167 # Construction::OrbitalShipyardService.update_construction_progress when progress reaches 100% completes the project
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:177 # Construction::OrbitalShipyardService.complete_project marks the project as completed
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:183 # Construction::OrbitalShipyardService.complete_project spawns the completed craft
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:192 # Construction::OrbitalShipyardService.spawn_completed_craft creates a new craft
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:198 # Construction::OrbitalShipyardService.spawn_completed_craft associates the craft with the station
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:203 # Construction::OrbitalShipyardService.spawn_completed_craft sets the craft status to docked
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:208 # Construction::OrbitalShipyardService.spawn_completed_craft loads operational data from blueprint
rspec ./spec/services/crater_dome_construction_service_spec.rb:90 # CraterDomeConstructionService#construct creates a construction job successfully
rspec ./spec/services/crater_dome_construction_service_spec.rb:110 # CraterDomeConstructionService#construct when entity is different from service provider processes a payment
rspec ./spec/services/crater_dome_construction_service_spec.rb:169 # CraterDomeConstructionService#start_construction starts the construction process
rspec ./spec/services/crater_dome_construction_service_spec.rb:214 # CraterDomeConstructionService#complete_construction completes the construction process
rspec ./spec/services/e2e_economic_simulation_spec.rb:67 # End-to-End Economic Simulation simulates the full pipeline to determine the initial market listing price
rspec ./spec/services/financial/tax_collection_service_spec.rb:25 # Financial::TaxCollectionService.collect_sales_tax when tax is applicable calculates the correct tax amount
rspec ./spec/services/financial/tax_collection_service_spec.rb:50 # Financial::TaxCollectionService.collect_sales_tax when tax rate is zero (e.g., for Tax Authority) returns 0.0 and does not call the TransactionManager
rspec ./spec/services/financial/tax_collection_service_spec.rb:63 # Financial::TaxCollectionService.collect_sales_tax when organization is missing a tax rate returns 0.0 and does not call the TransactionManager
rspec ./spec/services/fitting_service_spec.rb:30 # FittingService fits all components from inventory
rspec ./spec/services/fitting_service_spec.rb:39 # FittingService returns errors if inventory is missing items
rspec ./spec/services/fitting_service_spec.rb:47 # FittingService fits components without inventory if inventory is nil
rspec ./spec/services/fitting_service_spec.rb:53 # FittingService does not persist changes if dry_run is true
rspec ./spec/services/game_spec.rb:66 # Game#advance_by_days advances the simulation by the given number of days
rspec ./spec/services/game_spec.rb:72 # Game#advance_by_days does not advance time if days is zero or negative
rspec ./spec/services/generators/lava_tube_generator_spec.rb:9 # Generators::LavaTubeGenerator#generate with random generation creates a lava tube with random features
rspec ./spec/services/generators/lava_tube_generator_spec.rb:21 # Generators::LavaTubeGenerator#generate with random generation generates random dimensions
rspec ./spec/services/generators/lava_tube_generator_spec.rb:30 # Generators::LavaTubeGenerator#generate with random generation generates random attributes
rspec ./spec/services/generators/lava_tube_generator_spec.rb:39 # Generators::LavaTubeGenerator#generate with random generation creates random skylights and access points
rspec ./spec/services/generators/lava_tube_generator_spec.rb:88 # Generators::LavaTubeGenerator#generate with predefined parameters creates a lava tube with specified parameters
rspec ./spec/services/generators/lava_tube_generator_spec.rb:108 # Generators::LavaTubeGenerator#generate with predefined parameters creates predefined skylights and access points
rspec ./spec/services/generators/lava_tube_generator_spec.rb:127 # Generators::LavaTubeGenerator#generate with minimal parameters creates a lava tube with defaults
rspec ./spec/services/generators/valley_generator_spec.rb:8 # Generators::ValleyGenerator#generate with random generation creates a valley with random features
rspec ./spec/services/generators/valley_generator_spec.rb:20 # Generators::ValleyGenerator#generate with random generation generates random dimensions
rspec ./spec/services/generators/valley_generator_spec.rb:29 # Generators::ValleyGenerator#generate with random generation generates segments
rspec ./spec/services/generators/valley_generator_spec.rb:81 # Generators::ValleyGenerator#generate with predefined parameters creates a valley with specified parameters
rspec ./spec/services/generators/valley_generator_spec.rb:95 # Generators::ValleyGenerator#generate with predefined parameters creates predefined access points
rspec ./spec/services/logistics/contract_service_spec.rb:18 # Logistics::ContractService.create_internal_transfer with valid settlements creates a logistics contract for internal transfer
rspec ./spec/services/logistics/inventory_manager_spec.rb:23 # Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects intercepts materials for orbital construction
rspec ./spec/services/logistics/inventory_manager_spec.rb:40 # Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects does not add materials to station inventory if all consumed by projects
rspec ./spec/services/logistics/inventory_manager_spec.rb:62 # Logistics::InventoryManager.transfer_item when transferring orbital construction materials to non-orbital settlement transfers materials normally without interception
rspec ./spec/services/logistics/inventory_manager_spec.rb:81 # Logistics::InventoryManager.transfer_item when transferring non-orbital materials to orbital station transfers materials normally without interception
rspec ./spec/services/lookup/craft_lookup_service_spec.rb:19 # Lookup::CraftLookupService#find_craft loads JSON files with correct format
rspec ./spec/services/lookup/item_lookup_service_spec.rb:8 # Lookup::ItemLookupService#find_item loads items from the correct file structure
rspec ./spec/services/lookup/item_lookup_service_spec.rb:61 # Lookup::ItemLookupService#find_item handles scrap items dynamically
rspec ./spec/services/lookup/item_lookup_service_spec.rb:124 # Lookup::ItemLookupService dynamic item creation creates scrap items on the fly
rspec ./spec/services/lookup/item_lookup_service_spec.rb:132 # Lookup::ItemLookupService dynamic item creation creates processed items on the fly
rspec ./spec/services/lookup/item_lookup_service_spec.rb:140 # Lookup::ItemLookupService dynamic item creation creates used items on the fly
rspec ./spec/services/lookup/material_lookup_service_spec.rb:43 # Lookup::MaterialLookupService#find_material finds atmospheric gases by chemical formula
rspec ./spec/services/lookup/material_lookup_service_spec.rb:51 # Lookup::MaterialLookupService#find_material finds materials case-insensitively
rspec ./spec/services/lookup/material_lookup_service_spec.rb:90 # Lookup::MaterialLookupService material property access has all expected material properties
rspec ./spec/services/lookup/material_lookup_service_spec.rb:207 # Lookup::MaterialLookupService.locate_gases_path uses GalaxyGame::Paths consistently
rspec ./spec/services/lookup/material_lookup_service_spec.rb:254 # Lookup::MaterialLookupService error handling with corrupted JSON files handles JSON parsing errors gracefully
rspec ./spec/services/lookup/module_lookup_service_spec.rb:49 # Lookup::ModuleLookupService service configuration has the correct base path
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:20 # Lookup::PlanetaryGeologicalFeatureLookupService#initialize initializes with a celestial body
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:25 # Lookup::PlanetaryGeologicalFeatureLookupService#initialize loads features during initialization
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:46 # Lookup::PlanetaryGeologicalFeatureLookupService#all_features returns all loaded features
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:63 # Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles multiple JSON files
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:80 # Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles single feature JSON files
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:108 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by exact name match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:117 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by case-insensitive name match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:125 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by lowercase name match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:133 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns nil when feature is not found
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:140 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name handles symbol input
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:150 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns the first match when multiple features have the same name
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:182 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features of a specific type
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:190 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features by case-insensitive type match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:197 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns empty array when no features of that type exist
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:204 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type handles symbol input
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:229 # Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary groups features by type
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:242 # Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary handles features with nil type
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:250 # Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary returns empty hash when no features exist
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:259 # Lookup::PlanetaryGeologicalFeatureLookupService path construction constructs correct path for planet
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:280 # Lookup::PlanetaryGeologicalFeatureLookupService error handling handles JSON parse errors gracefully
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:296 # Lookup::PlanetaryGeologicalFeatureLookupService error handling logs debug information about found files
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:103 # Lookup::UnitLookupService#find_unit finds units case-insensitively by ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:54 # Lookup::UnitLookupService#find_unit with propulsion units finds propulsion units by their exact ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:63 # Lookup::UnitLookupService#find_unit with propulsion units has expected propulsion unit properties
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:93 # Lookup::UnitLookupService#find_unit with robot units finds robot units by their ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:123 # Lookup::UnitLookupService service configuration has all expected unit categories
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:217 # Lookup::UnitLookupService matching behavior matches by exact ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:222 # Lookup::UnitLookupService matching behavior matches by exact name
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:226 # Lookup::UnitLookupService matching behavior matches by partial ID with sufficient length
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:233 # Lookup::UnitLookupService matching behavior is case insensitive
rspec ./spec/services/manfacturing_service_spec.rb:52 # ManufacturingService.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
rspec ./spec/services/manfacturing_service_spec.rb:82 # ManufacturingService.manufacture with real blueprints works with different blueprint categories
rspec ./spec/services/manfacturing_service_spec.rb:112 # ManufacturingService.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
rspec ./spec/services/manfacturing_service_spec.rb:138 # ManufacturingService.manufacture with different construction cost percentages uses settlement's custom construction percentage
rspec ./spec/services/manfacturing_service_spec.rb:161 # ManufacturingService.manufacture with real blueprint data creates material requests based on actual blueprint requirements
rspec ./spec/services/manfacturing_service_spec.rb:208 # ManufacturingService.manufacture with real blueprint data automatically fulfills material requirements when materials are available
rspec ./spec/services/manfacturing_service_spec.rb:266 # ManufacturingService.manufacture with real blueprint data stores actual blueprint data in specifications
rspec ./spec/services/manfacturing_service_spec.rb:291 # ManufacturingService.manufacture with invalid blueprint returns failure when blueprint not found
rspec ./spec/services/manufacturing/assembly_service_spec.rb:56 # Manufacturing::AssemblyService.start_assembly with all materials available charges the tenant fee
rspec ./spec/services/manufacturing/component_production_integration_spec.rb:82 # Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) creates a production job using real blueprint
rspec ./spec/services/manufacturing/component_production_integration_spec.rb:93 # Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) consumes depleted_regolith from inventory
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:10 # Manufacturing::Construction::CoveringService#initialize initializes with coverable, panel type, and settlement
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:18 # Manufacturing::Construction::CoveringService#initialize uses default panel type if not provided
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:23 # Manufacturing::Construction::CoveringService#initialize finds settlement from coverable if not provided
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:32 # Manufacturing::Construction::CoveringService#calculate_materials calculates base materials using CoveringCalculator
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:48 # Manufacturing::Construction::CoveringService#calculate_materials merges panel-specific materials
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:61 # Manufacturing::Construction::CoveringService#calculate_materials sums quantities for duplicate materials
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:84 # Manufacturing::Construction::CoveringService#schedule_construction returns error if no settlement
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:94 # Manufacturing::Construction::CoveringService#schedule_construction returns error if no blueprint found
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:103 # Manufacturing::Construction::CoveringService#schedule_construction creates a construction job
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:109 # Manufacturing::Construction::CoveringService#schedule_construction creates material requests
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:114 # Manufacturing::Construction::CoveringService#schedule_construction creates equipment requests
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:119 # Manufacturing::Construction::CoveringService#schedule_construction updates coverable status to materials_requested
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:124 # Manufacturing::Construction::CoveringService#schedule_construction returns success with construction job
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:142 # Manufacturing::Construction::CoveringService#start_construction returns false if materials not gathered
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:147 # Manufacturing::Construction::CoveringService#start_construction returns false if equipment not gathered
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:154 # Manufacturing::Construction::CoveringService#start_construction updates job status to in_progress
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:163 # Manufacturing::Construction::CoveringService#start_construction assigns builders through ConstructionManager
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:171 # Manufacturing::Construction::CoveringService#start_construction updates coverable status to under_construction
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:191 # Manufacturing::Construction::CoveringService#track_progress returns false if job not in progress
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:196 # Manufacturing::Construction::CoveringService#track_progress returns false if construction not complete
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:201 # Manufacturing::Construction::CoveringService#track_progress completes construction when work is done
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:209 # Manufacturing::Construction::CoveringService#track_progress updates coverable status
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:217 # Manufacturing::Construction::CoveringService#track_progress releases equipment
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:224 # Manufacturing::Construction::CoveringService#track_progress returns true when complete
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:76 # Manufacturing::Construction::DomeService#initialize initializes with default panel type
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:83 # Manufacturing::Construction::DomeService#initialize initializes with custom panel type
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:87 # Manufacturing::Construction::DomeService#initialize defaults service provider to entity
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:93 # Manufacturing::Construction::DomeService#schedule_construction creates a construction job successfully
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:107 # Manufacturing::Construction::DomeService#schedule_construction fails when no settlement found
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:116 # Manufacturing::Construction::DomeService#schedule_construction creates material and equipment requests for player construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:134 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider processes payment for contracted construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:145 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider does not create material requests for contracted construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:153 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider marks materials and equipment as provided by contractor
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:161 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider handles payment failure gracefully
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:198 # Manufacturing::Construction::DomeService#start_construction starts construction when materials and equipment are ready
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:207 # Manufacturing::Construction::DomeService#start_construction fails when materials not ready for player construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:215 # Manufacturing::Construction::DomeService#start_construction bypasses checks for contracted construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:246 # Manufacturing::Construction::DomeService#track_progress completes construction when work is finished
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:257 # Manufacturing::Construction::DomeService#track_progress returns false when construction not complete
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:264 # Manufacturing::Construction::DomeService#track_progress sets correct status for different layer types
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:275 # Manufacturing::Construction::DomeService#track_progress releases equipment when construction completes
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:300 # Manufacturing::Construction::DomeService#complete_construction completes the construction process
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:311 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for primary layer
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:316 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for secondary layer
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:321 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for both layers
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:326 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns operational for unknown layer types
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:333 # Manufacturing::Construction::DomeService private methods #is_player_construction? returns true when entity and provider are the same
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:345 # Manufacturing::Construction::DomeService private methods #is_player_construction? returns false when entity and provider are different
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:67 # Manufacturing::Construction::HangarService#initialize initializes with default hangar type
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:73 # Manufacturing::Construction::HangarService#initialize initializes with custom hangar type
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:77 # Manufacturing::Construction::HangarService#initialize raises error for non-large access points
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:87 # Manufacturing::Construction::HangarService#schedule_construction creates a hangar structure successfully
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:96 # Manufacturing::Construction::HangarService#schedule_construction creates a construction job
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:106 # Manufacturing::Construction::HangarService#schedule_construction connects the access point to the hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:113 # Manufacturing::Construction::HangarService#schedule_construction fails when no settlement found
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:122 # Manufacturing::Construction::HangarService#schedule_construction fails when no blueprint found
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:131 # Manufacturing::Construction::HangarService#schedule_construction creates material and equipment requests
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:138 # Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for standard rover hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:145 # Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for large craft hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:190 # Manufacturing::Construction::HangarService#start_construction starts construction when materials and equipment are ready
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:199 # Manufacturing::Construction::HangarService#start_construction fails when materials not ready
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:207 # Manufacturing::Construction::HangarService#start_construction fails when equipment not ready
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:244 # Manufacturing::Construction::HangarService#track_progress completes construction when work is finished
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:256 # Manufacturing::Construction::HangarService#track_progress returns false when construction not complete
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:263 # Manufacturing::Construction::HangarService#track_progress releases equipment when construction completes
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:272 # Manufacturing::Construction::HangarService#calculate_materials calculates materials for standard rover hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:281 # Manufacturing::Construction::HangarService#calculate_materials calculates materials for large craft hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:290 # Manufacturing::Construction::HangarService#calculate_materials merges blueprint materials with specific materials
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:300 # Manufacturing::Construction::HangarService#calculate_construction_time calculates base time for standard hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:305 # Manufacturing::Construction::HangarService#calculate_construction_time calculates longer time for large craft hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:312 # Manufacturing::Construction::HangarService#calculate_equipment_requirements calculates equipment requirements
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:18 # Manufacturing::Construction::SegmentCoveringService#initialize uses modular_structural_panel as default
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:23 # Manufacturing::Construction::SegmentCoveringService#initialize finds settlement from worldhouse
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:32 # Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials calculates worldhouse-scale materials
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:40 # Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials includes cable calculations for massive segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:48 # Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials scales materials by panel count
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:61 # Manufacturing::Construction::SegmentCoveringService#complexity_factor returns 1.5 base factor for worldhouse
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:66 # Manufacturing::Construction::SegmentCoveringService#complexity_factor increases factor for very large segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:77 # Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires minimum 10 printers for worldhouse
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:84 # Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires heavy equipment
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:91 # Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements scales equipment for massive segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:114 # Manufacturing::Construction::SegmentCoveringService#schedule_construction creates construction phases for large segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:127 # Manufacturing::Construction::SegmentCoveringService#schedule_construction includes phase names and durations
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:18 # Manufacturing::Construction::SkylightService#initialize uses skylight-specific default panel type
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:23 # Manufacturing::Construction::SkylightService#initialize finds settlement from lava tube
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:32 # Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates transparent panel materials
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:40 # Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates solar panel materials
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:47 # Manufacturing::Construction::SkylightService#calculate_panel_specific_materials scales materials by panel count
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:59 # Manufacturing::Construction::SkylightService#complexity_factor returns 1.0 for basic transparent panels
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:64 # Manufacturing::Construction::SkylightService#complexity_factor returns 1.5 for solar panels
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:69 # Manufacturing::Construction::SkylightService#complexity_factor returns 1.3 for thermal insulation
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:78 # Manufacturing::Construction::SkylightService#determine_completion_status returns primary_cover for basic transparent
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:83 # Manufacturing::Construction::SkylightService#determine_completion_status returns solar_cover for solar panels
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:88 # Manufacturing::Construction::SkylightService#determine_completion_status returns full_cover for structural on primary cover
rspec ./spec/services/manufacturing/cost_calculator_spec.rb:65 # Manufacturing::CostCalculator Earth-Imported COGS (EAP-COGS) calculates the EAP-COGS (Earth Import Cost) for the unit
rspec ./spec/services/manufacturing/cost_calculator_spec.rb:86 # Manufacturing::CostCalculator Local Production COGS (LAP-COGS) calculates the LAP-COGS (Local Production Cost) for the unit
rspec ./spec/services/manufacturing/material_processing_service_spec.rb:94 # Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs creates a material processing job record
rspec ./spec/services/manufacturing/material_processing_service_spec.rb:110 # Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs produces gases with correct composition after job completion
rspec ./spec/services/manufacturing/material_request_system_spec.rb:8 # Manufacturing::MaterialRequest.create_material_requests creates requests for all required materials
rspec ./spec/services/manufacturing/processing_spec.rb:101 # Manufacturing::Processing#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
rspec ./spec/services/manufacturing/processing_spec.rb:114 # Manufacturing::Processing#process when owner does not have enough resources returns an error when resources are insufficient
rspec ./spec/services/manufacturing/processing_spec.rb:126 # Manufacturing::Processing#process when owner does not have enough GCC raises an error when GCC is insufficient
rspec ./spec/services/manufacturing/service_spec.rb:52 # Manufacturing::Service.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
rspec ./spec/services/manufacturing/service_spec.rb:80 # Manufacturing::Service.manufacture with real blueprints works with different blueprint categories
rspec ./spec/services/manufacturing/service_spec.rb:110 # Manufacturing::Service.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
rspec ./spec/services/manufacturing/service_spec.rb:136 # Manufacturing::Service.manufacture with different construction cost percentages uses settlement's custom construction percentage
rspec ./spec/services/manufacturing/service_spec.rb:159 # Manufacturing::Service.manufacture with real blueprint data creates material requests based on actual blueprint requirements
rspec ./spec/services/manufacturing/service_spec.rb:206 # Manufacturing::Service.manufacture with real blueprint data automatically fulfills material requirements when materials are available
rspec ./spec/services/manufacturing/service_spec.rb:268 # Manufacturing::Service.manufacture with real blueprint data stores actual blueprint data in specifications
rspec ./spec/services/manufacturing/service_spec.rb:293 # Manufacturing::Service.manufacture with invalid blueprint returns failure when blueprint not found
rspec ./spec/services/market/condition_updater_service_spec.rb:92 # Market::ConditionUpdaterService.call updates supply for all tracked resources
rspec ./spec/services/market/condition_updater_service_spec.rb:110 # Market::ConditionUpdaterService.call updates demand for all tracked resources, respecting smoothing and growth
rspec ./spec/services/market/condition_updater_service_spec.rb:130 # Market::ConditionUpdaterService.call creates a market condition if one does not exist
rspec ./spec/services/market/condition_updater_service_spec.rb:154 # Market::ConditionUpdaterService.call initializes a marketplace if the settlement does not have one
rspec ./spec/services/market/condition_updater_service_spec.rb:170 # Market::ConditionUpdaterService.calculate_new_supply returns zero if net change is a large negative and smooths current supply
rspec ./spec/services/market/npc_price_calculator_spec.rb:106 # Market::NpcPriceCalculator.calculate_ask with market-based pricing (sufficient history) uses market average with markup
rspec ./spec/services/market/npc_price_calculator_spec.rb:111 # Market::NpcPriceCalculator.calculate_ask with market-based pricing (sufficient history) never goes below cost floor
rspec ./spec/services/market/npc_price_calculator_spec.rb:341 # Market::NpcPriceCalculator error handling handles settlements without location
rspec ./spec/services/market/npc_price_calculator_spec.rb:350 # Market::NpcPriceCalculator error handling handles nil settlement
rspec ./spec/services/market/npc_price_calculator_spec.rb:399 # Market::NpcPriceCalculator integration with Market::PriceHistory queries price history for market-based pricing
rspec ./spec/services/market/trade_execution_service_spec.rb:87 # Market::TradeExecutionService returns true on successful execution
rspec ./spec/services/market/trade_execution_service_spec.rb:93 # Market::TradeExecutionService calls the TaxCollectionService with gross revenue and seller
rspec ./spec/services/market/trade_execution_service_spec.rb:103 # Market::TradeExecutionService calls TransactionManager.create_transfer with the NET amount
rspec ./spec/services/market/trade_execution_service_spec.rb:119 # Market::TradeExecutionService removes inventory from seller
rspec ./spec/services/market/trade_execution_service_spec.rb:124 # Market::TradeExecutionService creates a trade record
rspec ./spec/services/market/trade_execution_service_spec.rb:129 # Market::TradeExecutionService creates a price history record
rspec ./spec/services/market/trade_execution_service_spec.rb:134 # Market::TradeExecutionService creates a supply chain record
rspec ./spec/services/material_lookup_service_spec.rb:15 # MaterialLookupService#find_material returns the correct material
rspec ./spec/services/material_lookup_service_spec.rb:21 # MaterialLookupService#find_material returns nil for a nonexistent material
rspec ./spec/services/material_request_service_spec.rb:8 # MaterialRequestService.create_material_requests creates requests for all required materials
rspec ./spec/services/naming/planet_name_service_spec.rb:86 # Naming::PlanetNameService#add_suffix_to_name adds a suffix to the base name
rspec ./spec/services/pressurization/habitat_pressurization_service_spec.rb:19 # Pressurization::HabitatPressurizationService#calculate_habitat_volume calculates correct volume for crater dome
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:21 # Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available sources gases from depot tanks
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:27 # Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available uses depot tank gases for pressurization
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:38 # Pressurization::StructurePressurizationService.pressurize_structure when no depot tanks are available falls back to standard pressurization logic
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:59 # Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks aggregates gases from all depot tanks
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:66 # Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks returns empty hash when no gases are stored
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:76 # Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has no depot tanks returns empty hash
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:92 # Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when depot tanks have no gas_storage data returns empty hash
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:108 # Pressurization::StructurePressurizationService mining byproduct integration when mining Si produces O2 byproduct increases available gases from depot tanks for pressurization
rspec ./spec/services/pressurization_service_spec.rb:24 # PressurizationService#check_sealing_status with traditional sealed environment returns ready for sealed environment
rspec ./spec/services/pressurization_service_spec.rb:30 # PressurizationService#check_sealing_status with traditional sealed environment returns not ready for unsealed environment
rspec ./spec/services/pressurization_service_spec.rb:62 # PressurizationService#check_sealing_status with pressurization target (lava tube) returns not ready when requirements not met
rspec ./spec/services/pressurization_service_spec.rb:69 # PressurizationService#check_sealing_status with pressurization target (lava tube) returns ready when requirements met
rspec ./spec/services/pressurization_service_spec.rb:88 # PressurizationService#check_sealing_status with pressurization target (canyon) returns not ready when requirements not met
rspec ./spec/services/processing_service_spec.rb:101 # ProcessingService#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
rspec ./spec/services/processing_service_spec.rb:114 # ProcessingService#process when owner does not have enough resources returns an error when resources are insufficient
rspec ./spec/services/processing_service_spec.rb:126 # ProcessingService#process when owner does not have enough GCC raises an error when GCC is insufficient
rspec ./spec/services/star_sim/procedural_generator_spec.rb:163 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests terraformed names for template-based planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:175 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests neutral names for procedural planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:187 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates applies orbital optimization for template-based planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:201 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates generates procedural planets when not using templates
rspec ./spec/services/star_sim/procedural_generator_spec.rb:313 # StarSim::ProceduralGenerator#generate_biosphere_data provides enhanced biosphere for template-based planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:328 # StarSim::ProceduralGenerator#generate_biosphere_data provides basic biosphere for planets with good conditions
rspec ./spec/services/star_sim/procedural_generator_spec.rb:341 # StarSim::ProceduralGenerator#generate_biosphere_data returns empty biosphere for unsuitable planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:447 # StarSim::ProceduralGenerator integration test generates a complete, valid system
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:23 # TerraSim::AtmosphereSimulationService#initialize initializes with a celestial body
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:27 # TerraSim::AtmosphereSimulationService#initialize sets up the Stefan-Boltzmann constant
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:52 # TerraSim::AtmosphereSimulationService#simulate updates the pressure
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:57 # TerraSim::AtmosphereSimulationService#simulate calculates the greenhouse effect
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:63 # TerraSim::AtmosphereSimulationService#simulate updates temperature data in the atmosphere
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:76 # TerraSim::AtmosphereSimulationService#simulate simulates atmospheric loss
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:82 # TerraSim::AtmosphereSimulationService#simulate decreases dust
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:105 # TerraSim::AtmosphereSimulationService temperature calculation methods calculates stefan_boltzmann_temp correctly
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:110 # TerraSim::AtmosphereSimulationService temperature calculation methods calculates greenhouse_adjusted_temp correctly
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:115 # TerraSim::AtmosphereSimulationService temperature calculation methods calculates water_vapor_pressure correctly
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:122 # TerraSim::AtmosphereSimulationService#update_temperatures updates all temperature types in atmosphere
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:53 # TerraSim::BiosphereSimulationService#initialize initializes with a celestial body and sets the biosphere
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:63 # TerraSim::BiosphereSimulationService#simulate runs the biosphere simulation steps
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:73 # TerraSim::BiosphereSimulationService#simulate prevents concurrent simulations
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:79 # TerraSim::BiosphereSimulationService#simulate does nothing if biosphere is nil
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:90 # TerraSim::BiosphereSimulationService#calculate_biosphere_conditions calculates and updates habitable ratio and ice latitude
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:96 # TerraSim::BiosphereSimulationService#calculate_biosphere_conditions calls update_biodiversity and influence_atmosphere
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:106 # TerraSim::BiosphereSimulationService#simulate_ecosystem_interactions simulates plant growth and updates vegetation cover
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:126 # TerraSim::BiosphereSimulationService#simulate_ecosystem_interactions simulates basic animal activity (logging for now)
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:133 # TerraSim::BiosphereSimulationService#track_species_population updates species populations based on birth and death rates
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:140 # TerraSim::BiosphereSimulationService#manage_food_web simulates herbivore consumption and updates vegetation
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:143 # TerraSim::BiosphereSimulationService#manage_food_web simulates carnivore predation and updates prey population
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:150 # TerraSim::BiosphereSimulationService#balance_biomes attempts to adjust global temperatures towards biome optima
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:158 # TerraSim::BiosphereSimulationService#balance_biomes adjusts biome moisture levels based on climate type
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:183 # TerraSim::BiosphereSimulationService#balance_biomes attempts to adjust biome area percentages
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:195 # TerraSim::BiosphereSimulationService#update_biodiversity calculates and updates the biodiversity index
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:206 # TerraSim::BiosphereSimulationService#calculate_biodiversity calculates the biodiversity index based on the number of biomes
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:214 # TerraSim::BiosphereSimulationService#influence_atmosphere simulates gas exchange with the atmosphere
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:257 # TerraSim::BiosphereSimulationService private #calculate_light_availability calculates light availability based on star luminosity and atmospheric dust
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:288 # TerraSim::BiosphereSimulationService private #calculate_temperature_suitability calculates temperature suitability for a given range when within range
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:310 # TerraSim::BiosphereSimulationService private #calculate_temperature_suitability calculates temperature suitability for a given range when outside range
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:351 # TerraSim::BiosphereSimulationService terraforming integration #calculate_life_form_atmospheric_effects with no life forms returns zero effects
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:376 # TerraSim::BiosphereSimulationService terraforming integration #calculate_life_form_atmospheric_effects with multiple life forms aggregates effects from all species
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:390 # TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms uses life form effects when available
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:418 # TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms scales effects by time
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:451 # TerraSim::BiosphereSimulationService terraforming integration #influence_atmosphere with life forms falls back to hardcoded values when no life forms
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:470 # TerraSim::BiosphereSimulationService terraforming integration #simulate with time parameter stores time_skipped for use in other methods
rspec ./spec/services/terra_sim/biosphere_simulation_service_spec.rb:476 # TerraSim::BiosphereSimulationService terraforming integration #simulate with time parameter passes time to influence_atmosphere
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:36 # TerraSim::ExoticWorldSimulationService#initialize sets planet-specific options
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:42 # TerraSim::ExoticWorldSimulationService#initialize accepts custom options
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:52 # TerraSim::ExoticWorldSimulationService#planet_type determines planet type from temperature and elements
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:60 # TerraSim::ExoticWorldSimulationService#planet_type uses planet_type from celestial body if available
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:67 # TerraSim::ExoticWorldSimulationService#planet_type defaults to terrestrial for unknown combinations
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:78 # TerraSim::ExoticWorldSimulationService#simulate_planet_specific_processes with an ice giant calls ice-specific simulation methods
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:87 # TerraSim::ExoticWorldSimulationService#simulate_planet_specific_processes with a carbon planet calls carbon planet-specific methods
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:96 # TerraSim::ExoticWorldSimulationService#simulate_diamond_formation converts carbon to diamond
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:112 # TerraSim::ExoticWorldSimulationService#simulate_cryovolcanism adds frozen materials to the planet
rspec ./spec/services/terra_sim/exotic_world_simulation_service_spec.rb:128 # TerraSim::ExoticWorldSimulationService#simulate_extreme_pressure converts hydrogen to metallic hydrogen at extreme pressure
rspec ./spec/services/terra_sim/geosphere_initalizer_spec.rb:53 # TerraSim::GeosphereInitializer initializing terrestrial planet geosphere creates a geosphere with terrestrial properties
rspec ./spec/services/terra_sim/geosphere_initalizer_spec.rb:85 # TerraSim::GeosphereInitializer ice giant initialization creates appropriate ice materials
rspec ./spec/services/terra_sim/geosphere_initalizer_spec.rb:101 # TerraSim::GeosphereInitializer ice giant initialization creates appropriate mantle materials
rspec ./spec/services/terra_sim/geosphere_initalizer_spec.rb:127 # TerraSim::GeosphereInitializer exotic materials initialization creates hydrogen in metallic state under extreme conditions
rspec ./spec/services/terra_sim/geosphere_initalizer_spec.rb:150 # TerraSim::GeosphereInitializer material state determination creates hydrogen as gas in the crust
rspec ./spec/services/terra_sim/geosphere_initalizer_spec.rb:167 # TerraSim::GeosphereInitializer material state determination creates water ice as solid
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:57 # TerraSim::GeosphereInitializer initializing terrestrial planet geosphere creates a geosphere with terrestrial properties
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:89 # TerraSim::GeosphereInitializer ice giant initialization creates appropriate ice materials
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:117 # TerraSim::GeosphereInitializer exotic materials initialization creates hydrogen in metallic state under extreme conditions
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:147 # TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for planets with atmospheres
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:159 # TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for airless bodies
rspec ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:114 # TerraSim::GeosphereSimulationService#eruption adds volcanic gases to the atmosphere
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:95 # TerraSim::HydrosphereSimulationService#simulate calls all simulation methods in order
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:106 # TerraSim::HydrosphereSimulationService#simulate prevents recursive calls with simulation flag
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:125 # TerraSim::HydrosphereSimulationService#calculate_region_temperatures calculates temperatures for all water bodies
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:134 # TerraSim::HydrosphereSimulationService#calculate_region_temperatures sets water temperatures cooler than surface temperature
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:144 # TerraSim::HydrosphereSimulationService#handle_evaporation decreases water body volumes
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:156 # TerraSim::HydrosphereSimulationService#handle_evaporation adds water vapor to the atmosphere
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:162 # TerraSim::HydrosphereSimulationService#handle_evaporation handles numeric volume values (not hashes)
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:177 # TerraSim::HydrosphereSimulationService#handle_precipitation increases water body volumes
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:194 # TerraSim::HydrosphereSimulationService#handle_precipitation removes water vapor from the atmosphere
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:201 # TerraSim::HydrosphereSimulationService#handle_precipitation decreases atmospheric dust concentration
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:210 # TerraSim::HydrosphereSimulationService#calculate_state_distributions calculates state distribution based on temperature and pressure
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:226 # TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing melts ice from polar caps
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:237 # TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to decrease solid percentage
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:248 # TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing updates state distribution to increase liquid percentage
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:259 # TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing does not allow solid percentage to go negative
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:272 # TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing adds some melted water as vapor to atmosphere
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:279 # TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is above freezing does not melt more than maximum allowed per cycle
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:302 # TerraSim::HydrosphereSimulationService#handle_ice_melting when temperature is below freezing does not melt any ice
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:321 # TerraSim::HydrosphereSimulationService#handle_ice_melting when ice caps do not exist returns early without error
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:331 # TerraSim::HydrosphereSimulationService#update_hydrosphere_volume delegates to the hydrosphere model method
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:339 # TerraSim::HydrosphereSimulationService integration: full simulation cycle runs a complete simulation without errors
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:343 # TerraSim::HydrosphereSimulationService integration: full simulation cycle maintains valid state distribution percentages
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:359 # TerraSim::HydrosphereSimulationService integration: full simulation cycle never produces negative state distribution values
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:382 # TerraSim::HydrosphereSimulationService edge cases with extreme cold temperature handles extreme cold without errors
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:392 # TerraSim::HydrosphereSimulationService edge cases with extreme hot temperature handles extreme heat without errors
rspec ./spec/services/terra_sim/hydrosphere_simulation_service_spec.rb:407 # TerraSim::HydrosphereSimulationService edge cases with zero water bodies handles zero volumes without errors
rspec ./spec/services/tier1_price_modeler_spec.rb:70 # Tier1PriceModeler#calculate_eap with titanium alloy calculates the correct EAP
rspec ./spec/services/tier1_price_modeler_spec.rb:79 # Tier1PriceModeler#calculate_eap with titanium alloy can print breakdown without errors
rspec ./spec/services/tier1_price_modeler_spec.rb:87 # Tier1PriceModeler#calculate_eap with composite insulation calculates the correct EAP
rspec ./spec/services/tier1_price_modeler_spec.rb:100 # Tier1PriceModeler#calculate_eap with pressure valves calculates the correct EAP
rspec ./spec/services/tier1_price_modeler_spec.rb:113 # Tier1PriceModeler#calculate_eap with electronics calculates the correct EAP
rspec ./spec/services/tier1_price_modeler_spec.rb:158 # Tier1PriceModeler EAP storage for downstream use stores calculated EAPs in a hash
rspec ./spec/services/tier1_price_modeler_spec.rb:195 # Tier1PriceModeler integration with EconomicConfig uses earth spot prices from config when available
rspec ./spec/services/tier1_price_modeler_spec.rb:216 # Tier1PriceModeler#print_breakdown outputs detailed breakdown
rspec ./spec/services/tier1_price_modeler_spec.rb:220 # Tier1PriceModeler#print_breakdown returns the calculated EAP
rspec ./spec/services/trade_service_spec.rb:11 # TradeService#dynamic_price calculates the dynamic price based on scarcity, transportation, and market conditions
rspec ./spec/services/trade_service_spec.rb:27 # TradeService#base_price_for_type returns the correct base price for raw materials
rspec ./spec/services/trade_service_spec.rb:32 # TradeService#base_price_for_type returns the correct base price for processed goods
rspec ./spec/services/trade_service_spec.rb:40 # TradeService#fuel_cost_per_unit returns the correct fuel cost per unit
rspec ./spec/services/trade_service_spec.rb:47 # TradeService#distance_to_buyer calculates the distance between colonies
rspec ./spec/services/trade_service_spec.rb:59 # TradeService#market_conditions returns a random market condition modifier
rspec ./spec/services/unit_module_assembly_service_spec.rb:49 # UnitModuleAssemblyService.build_units_and_modules creates units from the recommended fit
rspec ./spec/services/unit_module_assembly_service_spec.rb:73 # UnitModuleAssemblyService.build_units_and_modules creates modules from the recommended fit
rspec ./spec/services/unit_module_assembly_service_spec.rb:87 # UnitModuleAssemblyService.build_units_and_modules creates rigs from the recommended fit
rspec ./spec/services/unit_module_assembly_service_spec.rb:101 # UnitModuleAssemblyService.build_units_and_modules processes custom port configurations
rspec ./spec/services/unit_module_assembly_service_spec.rb:117 # UnitModuleAssemblyService.build_units_and_modules handles missing inventory items gracefully
rspec ./spec/services/unit_module_assembly_service_spec.rb:134 # UnitModuleAssemblyService.build_units_and_modules handles missing recommended fit data gracefully
rspec ./spec/services/unit_module_assembly_service_spec.rb:161 # UnitModuleAssemblyService.build_units_and_modules assigns correct port names to components
rspec ./spec/services/unit_module_assembly_service_spec.rb:190 # UnitModuleAssemblyService.disconnect_unit disconnects a unit and returns it to inventory as an item
rspec ./spec/services/wormhole_consortium_formation_service_spec.rb:9 # WormholeConsortiumFormationService creates memberships for founding members and updates consortium operational_data
rspec ./spec/services/wormhole_consortium_formation_service_spec.rb:20 # WormholeConsortiumFormationService updates member operational_data with consortium membership
rspec ./spec/transactions/guaranteed_market_sale_spec.rb:81 # Guaranteed Market Sale Transaction guaranteed sell order execution executes atomically and creates all required records
rspec ./spec/transactions/guaranteed_market_sale_spec.rb:125 # Guaranteed Market Sale Transaction guaranteed sell order execution does not create a SupplyChain record if no matching buy order exists
rspec ./spec/transactions/guaranteed_market_sale_spec.rb:140 # Guaranteed Market Sale Transaction guaranteed sell order execution creates a Trade record with correct buyer and seller
rspec ./spec/transactions/guaranteed_market_sale_spec.rb:159 # Guaranteed Market Sale Transaction guaranteed sell order execution marks the order as filled by returning nil
rspec ./spec/transactions/guaranteed_market_sale_spec.rb:172 # Guaranteed Market Sale Transaction guaranteed sell order execution records a PriceHistory entry after trade execution
rspec ./spec/transactions/guaranteed_market_sale_spec.rb:188 # Guaranteed Market Sale Transaction guaranteed sell order execution calls TransactionManager.create_transfer with correct arguments
rspec ./spec/transactions/guaranteed_market_sale_spec.rb:201 # Guaranteed Market Sale Transaction guaranteed sell order execution creates a SupplyChain record with correct volume and status

