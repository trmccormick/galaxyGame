<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Manager - Testing & Validation</title>
    <%= stylesheet_link_tag 'admin/dashboard', media: 'all' %>
    <%= stylesheet_link_tag 'application', media: 'all' %>
</head>
<body>
    <div class="admin-main-container">
        <header class="admin-header">
            <h1>AI MANAGER - TESTING & VALIDATION</h1>
            <div class="admin-header-info">
                System Status: <span class="text-success">OPERATIONAL</span> |
                Test Environment: <span class="text-accent">ACTIVE</span> |
                <%= link_to '‚Üê AI Manager', admin_ai_manager_path, class: 'admin-dashboard-link' %>
            </div>
        </header>

        <aside class="admin-sidebar">
            <section class="admin-tool-section">
                <h3>üß™ TEST CATEGORIES</h3>
                <%= link_to '‚õèÔ∏è Resource Extraction', '#resource-extraction', class: 'admin-tool-button', onclick: 'showTestSection("resource-extraction"); return false;' %>
                <%= link_to 'üèóÔ∏è Base Construction', '#base-construction', class: 'admin-tool-button', onclick: 'showTestSection("base-construction"); return false;' %>
                <%= link_to 'üè≠ ISRU Pipeline', '#isru-pipeline', class: 'admin-tool-button', onclick: 'showTestSection("isru-pipeline"); return false;' %>
                <%= link_to 'üöÄ GCC Bootstrap', '#gcc-bootstrap', class: 'admin-tool-button', onclick: 'showTestSection("gcc-bootstrap"); return false;' %>
                <%= link_to '‚úÖ Validation Suite', admin_ai_manager_testing_validation_path, class: 'admin-tool-button' %>
            </section>

            <section class="admin-tool-section">
                <h3>üìä TEST RESULTS</h3>
                <div class="admin-stats">
                    <div><span>Tests Run:</span><span class="admin-stat-value"><%= @test_stats[:total_runs] || 0 %></span></div>
                    <div><span>Passed:</span><span class="admin-stat-value completed"><%= @test_stats[:passed] || 0 %></span></div>
                    <div><span>Failed:</span><span class="admin-stat-value failed"><%= @test_stats[:failed] || 0 %></span></div>
                </div>
            </section>
        </aside>

        <main class="admin-content">
            <!-- Resource Extraction Tests -->
            <section class="content-section test-section" id="resource-extraction">
                <h2>‚õèÔ∏è RESOURCE EXTRACTION TESTS</h2>
                <div class="admin-section">
                    <p style="color: #888; margin-bottom: 20px;">
                        Test AI's ability to identify and extract resources from celestial bodies.
                    </p>

                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #00d4ff; font-size: 14px; margin-bottom: 10px;">Select Target Body:</h3>
                        <select id="resource-target" class="test-input" style="width: 100%; margin-bottom: 15px;">
                            <option value="">Choose a celestial body...</option>
                            <% @test_bodies.each do |body| %>
                                <option value="<%= body.id %>"><%= body.name %> (<%= body.type %>)</option>
                            <% end %>
                        </select>

                        <h3 style="color: #00d4ff; font-size: 14px; margin-bottom: 10px;">Resource Type:</h3>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                            <button class="action-btn" onclick="selectResourceType('water')">üíß Water</button>
                            <button class="action-btn" onclick="selectResourceType('metals')">‚öôÔ∏è Metals</button>
                            <button class="action-btn" onclick="selectResourceType('minerals')">üíé Minerals</button>
                            <button class="action-btn" onclick="selectResourceType('gases')">üå´Ô∏è Gases</button>
                        </div>

                        <button class="admin-tool-button" onclick="runResourceExtractionTest()" style="width: 100%;">
                            üöÄ Run Resource Extraction Test
                        </button>
                    </div>

                    <div id="resource-results" class="test-results" style="display: none;">
                        <h3 style="color: #00d4ff; margin-top: 20px;">Test Results:</h3>
                        <div class="admin-section" style="margin-top: 10px;">
                            <pre id="resource-output" style="color: #00d4ff; font-size: 12px; max-height: 300px; overflow-y: auto;"></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Base Construction Tests -->
            <section class="content-section test-section" id="base-construction" style="display: none;">
                <h2>üèóÔ∏è BASE CONSTRUCTION TESTS</h2>
                <div class="admin-section">
                    <p style="color: #888; margin-bottom: 20px;">
                        Test AI's ability to plan and execute base construction missions.
                    </p>

                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #00d4ff; font-size: 14px; margin-bottom: 10px;">Select Target Body:</h3>
                        <select id="construction-target" class="test-input" style="width: 100%; margin-bottom: 15px;">
                            <option value="">Choose a celestial body...</option>
                            <% @test_bodies.each do |body| %>
                                <option value="<%= body.id %>"><%= body.name %> (<%= body.type %>)</option>
                            <% end %>
                        </select>

                        <h3 style="color: #00d4ff; font-size: 14px; margin-bottom: 10px;">Base Type:</h3>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                            <button class="action-btn" onclick="selectBaseType('research')">üî¨ Research</button>
                            <button class="action-btn" onclick="selectBaseType('mining')">‚õèÔ∏è Mining</button>
                            <button class="action-btn" onclick="selectBaseType('habitation')">üè† Habitation</button>
                            <button class="action-btn" onclick="selectBaseType('industrial')">üè≠ Industrial</button>
                        </div>

                        <button class="admin-tool-button" onclick="runBaseConstructionTest()" style="width: 100%;">
                            üöÄ Run Base Construction Test
                        </button>
                    </div>

                    <div id="construction-results" class="test-results" style="display: none;">
                        <h3 style="color: #00d4ff; margin-top: 20px;">Test Results:</h3>
                        <div class="admin-section" style="margin-top: 10px;">
                            <pre id="construction-output" style="color: #00d4ff; font-size: 12px; max-height: 300px; overflow-y: auto;"></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ISRU Pipeline Tests -->
            <section class="content-section test-section" id="isru-pipeline" style="display: none;">
                <h2>üè≠ ISRU PIPELINE TESTS</h2>
                <div class="admin-section">
                    <p style="color: #888; margin-bottom: 20px;">
                        Test In-Situ Resource Utilization pipeline efficiency and AI optimization.
                    </p>

                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #00d4ff; font-size: 14px; margin-bottom: 10px;">Select Target Body:</h3>
                        <select id="isru-target" class="test-input" style="width: 100%; margin-bottom: 15px;">
                            <option value="">Choose a celestial body...</option>
                            <% @test_bodies.each do |body| %>
                                <option value="<%= body.id %>"><%= body.name %> (<%= body.type %>)</option>
                            <% end %>
                        </select>

                        <button class="admin-tool-button" onclick="runISRUTest()" style="width: 100%;">
                            üöÄ Run ISRU Pipeline Test
                        </button>
                    </div>

                    <div id="isru-results" class="test-results" style="display: none;">
                        <h3 style="color: #00d4ff; margin-top: 20px;">Test Results:</h3>
                        <div class="admin-section" style="margin-top: 10px;">
                            <pre id="isru-output" style="color: #00d4ff; font-size: 12px; max-height: 300px; overflow-y: auto;"></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- GCC Bootstrap Tests -->
            <section class="content-section test-section" id="gcc-bootstrap" style="display: none;">
                <h2>üöÄ GCC BOOTSTRAP TESTS</h2>
                <div class="admin-section">
                    <p style="color: #888; margin-bottom: 20px;">
                        Test AI's ability to bootstrap GCC cryptocurrency generation through autonomous satellite deployment.
                    </p>

                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #00d4ff; font-size: 14px; margin-bottom: 10px;">Select Target Body:</h3>
                        <select id="gcc-target" class="test-input" style="width: 100%; margin-bottom: 15px;">
                            <option value="">Choose a celestial body...</option>
                            <% @test_bodies.each do |body| %>
                                <option value="<%= body.id %>"><%= body.name %> (<%= body.type %>)</option>
                            <% end %>
                        </select>

                        <button class="admin-tool-button" onclick="runGCCBootstrapTest()" style="width: 100%;">
                            üöÄ Run GCC Bootstrap Test
                        </button>
                    </div>

                    <div id="gcc-results" class="test-results" style="display: none;">
                        <h3 style="color: #00d4ff; margin-top: 20px;">Test Results:</h3>
                        <div class="admin-section" style="margin-top: 10px;">
                            <pre id="gcc-output" style="color: #00d4ff; font-size: 12px; max-height: 300px; overflow-y: auto;"></pre>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        let selectedResourceType = null;
        let selectedBaseType = null;

        function showTestSection(sectionId) {
            // Hide all test sections
            document.querySelectorAll('.test-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            document.getElementById(sectionId).style.display = 'block';
        }

        function selectResourceType(type) {
            selectedResourceType = type;
            // Visual feedback
            document.querySelectorAll('#resource-extraction .action-btn').forEach(btn => {
                btn.style.background = '#1a1a2e';
            });
            event.target.style.background = '#00d4ff';
            event.target.style.color = '#1a1a2e';
        }

        function selectBaseType(type) {
            selectedBaseType = type;
            // Visual feedback
            document.querySelectorAll('#base-construction .action-btn').forEach(btn => {
                btn.style.background = '#1a1a2e';
            });
            event.target.style.background = '#00d4ff';
            event.target.style.color = '#1a1a2e';
        }

        function runResourceExtractionTest() {
            const target = document.getElementById('resource-target').value;
            if (!target) {
                alert('Please select a target body');
                return;
            }
            if (!selectedResourceType) {
                alert('Please select a resource type');
                return;
            }

            // TODO: Make actual API call to run test
            document.getElementById('resource-results').style.display = 'block';
            document.getElementById('resource-output').textContent = 
                `Running resource extraction test...\n` +
                `Target: Body ${target}\n` +
                `Resource: ${selectedResourceType}\n\n` +
                `[Test implementation pending]`;
        }

        function runBaseConstructionTest() {
            const target = document.getElementById('construction-target').value;
            if (!target) {
                alert('Please select a target body');
                return;
            }
            if (!selectedBaseType) {
                alert('Please select a base type');
                return;
            }

            document.getElementById('construction-results').style.display = 'block';
            document.getElementById('construction-output').textContent = 
                `Running base construction test...\n` +
                `Target: Body ${target}\n` +
                `Base Type: ${selectedBaseType}\n\n` +
                `[Test implementation pending]`;
        }

        function runISRUTest() {
            const target = document.getElementById('isru-target').value;
            if (!target) {
                alert('Please select a target body');
                return;
            }

            document.getElementById('isru-results').style.display = 'block';
            document.getElementById('isru-output').textContent = 
                `Running ISRU pipeline test...\n` +
                `Target: Body ${target}\n\n` +
                `[Test implementation pending]`;
        }

        function runGCCBootstrapTest() {
            const target = document.getElementById('gcc-target').value;
            if (!target) {
                alert('Please select a target body');
                return;
            }

            document.getElementById('gcc-results').style.display = 'block';
            document.getElementById('gcc-output').textContent = 
                `Running GCC bootstrap test...\n` +
                `Target: Body ${target}\n\n` +
                `[Test implementation pending]`;
        }

        // Show first section by default
        showTestSection('resource-extraction');
    </script>
</body>
</html>
