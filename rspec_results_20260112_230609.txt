2026-01-13T04:06:21.860Z pid=3943 tid=18f INFO: Sidekiq 7.3.8 connecting to Redis with options {size: 10, pool_name: "internal", url: "redis://redis:6379/1"}
2026-01-13T04:06:37.116Z pid=3960 tid=1rc INFO: Sidekiq 7.3.8 connecting to Redis with options {size: 10, pool_name: "internal", url: "redis://redis:6379/1"}

GameController
  GET #index
    initializes a game state if none exists
    uses an existing game state if one exists
    updates time if game is running
    doesn't update time if game is not running
    solar system seeding and display
      assigns the Sol solar system and its celestial bodies
      calls SystemBuilderService to build the system if no solar system exists
      correctly calculates @planet_count excluding satellites
      defines is_moon and body_category singleton methods on celestial bodies
      generates correct JSON with parent_body_identifier for moons
      returns JSON with correct celestial bodies data
      logs celestial body attributes for debugging
  POST #toggle_running
    toggles the running state from false to true
    toggles the running state from true to false
    returns JSON with the updated state
  POST #set_speed
    updates the game speed
    clamps the speed value between 1 and 5
  POST #jump_time
    adds the specified number of days
    handles year rollover
    clamps days between 1 and 365
  GET #state
    returns the current game state
    updates time if running
  GET #simulation
    assigns the correct solar system and its primary star
    redirects to root_path if solar system not found
  GET #index edge cases
    handles missing solar system gracefully
    handles celestial bodies with no parent or atmosphere
  private get_or_create_game_state
    creates a new game state if none exists
    returns the existing game state if present

SimulationController
  GET #index
    with existing solar system
      assigns solar system and its celestial bodies
      assigns the primary star
    without solar system
      assigns all celestial bodies
  GET #run
    runs simulation for specific celestial body
    handles errors gracefully
  GET #run_all
    with existing solar system
      runs simulation for all celestial bodies
    without solar system
      handles missing solar system gracefully

StarsController
  GET #index
    returns a success response
  GET #show
    returns a success response
  POST #create
    with valid parameters
      creates a new Star
      renders a JSON response with the new star
    with invalid parameters
      renders a JSON response with errors for the new star
  PATCH/PUT #update
    with valid parameters
#<CelestialBodies::Star id: 1820, identifier: "STAR-7", name: "Betelgeuse", type_of_star: "supergiant", age: 8.0, mass: 2.0e+30, radius: 150000000.0, discovery_state: nil, properties: {"spectral_class" => "G2V", "stellar_class" => "Main Sequence"}, created_at: "2026-01-13 04:07:05.902575000 +0000", updated_at: "2026-01-13 04:07:05.946685000 +0000", solar_system_id: 1679, luminosity: 1.0, temperature: 3500.0, life: 12.0, r_ecosphere: 1.0>
      updates the requested star
      renders a JSON response with the star
    with invalid parameters
      renders a JSON response with errors for the star
  DELETE #destroy
    destroys the requested star

TerrestrialPlanetsController
  GET #index
    returns a success response
  GET #show
    returns a success response
  POST #create
    with valid parameters
      creates a new TerrestrialPlanet with star distance
      renders a JSON response with the new terrestrial_planet
    with invalid parameters
      renders a JSON response with errors for the new terrestrial_planet
  PATCH/PUT #update
    with valid parameters
      updates the requested terrestrial_planet
      renders a JSON response with the terrestrial_planet
    with invalid parameters
      renders a JSON response with errors for the terrestrial_planet
  DELETE #destroy
    destroys the requested terrestrial_planet
    returns a no content response

TransactionsController
  POST #create
    with valid parameters
      creates a new financial transaction
      creates the transaction with correct account information and amount
      does not attempt to collect tax (enforces separation of concerns)
      returns a success message
    with invalid parameters
      does not create a transaction if amount is missing
      returns an error message if amount is missing or invalid

Alien World Template Integrity
  template file exists
  is valid JSON
  contains terrestrial_planets array
  contains exactly 25 templates (A01 → A25)
  has unique identifiers
  has unique template names
  required schema fields
    each template contains all required fields
  atmosphere rules
    contains no oxygen by default
    has pressure > 0
  terraforming metadata
    terraforming_difficulty is between 1 and 10
    engineered_atmosphere defaults to false
  volatile reservoirs
    has CO2 and H2O reservoirs defined
  material yield bias
    contains all yield bias categories

Alien World Templates Integrity
  exists and is valid JSON (FAILED - 1)
  metadata
    exists (FAILED - 2)
    has required fields (FAILED - 3)
    is versioned correctly (FAILED - 4)
  terrestrial planet templates
    exists and is an array (FAILED - 5)
    contains exactly 25 templates (FAILED - 6)
    has unique identifiers (FAILED - 7)
    covers Template-A01 through Template-A25 (FAILED - 8)
    all templates are terrestrial (FAILED - 9)
  template schema validation
    each template contains all required fields (FAILED - 10)
  atmospheric constraints
    contains no oxygen by default (FAILED - 11)
  sanity checks
    has realistic gravity values (FAILED - 12)
    has positive pressure (FAILED - 13)
    terraforming difficulty is bounded (FAILED - 14)

TerrestrialPlanets
  User views a planet detail
  User updates a planet's name only
  User updates a planet with all attributes

GameDataPaths
  sets the correct path based on environment (FAILED - 15)

Component Production Game Loop Integration
  full production cycle
Settlement 1 updated for 1 days.
Time advanced by 1 days. Now at day 1.0
    produces components through game loop progression (FAILED - 16)
Settlement 2 updated for 0.5 days.
Time advanced by 0.5 days. Now at day 0.5
    handles partial progress over multiple ticks (FAILED - 17)
Settlement 3 updated for 1 days.
Time advanced by 1 days. Now at day 1.0
    processes multiple jobs simultaneously (FAILED - 18)

Covering System Integration
  Lava tube worldhouse covering workflow
    seals skylights when worldhouse construction completes (FAILED - 19)
  Worldhouse segment covering workflow
    handles massive scale covering (FAILED - 20)
  Multi-scale comparison
    uses same system for different scales (FAILED - 21)

Manufacturing Pipeline End-to-End
  complete ISRU to enclosed tank pipeline

=== STAGE 0: Initial Setup ===
✓ Staged 2000kg raw regolith

=== STAGE 1: Thermal Extraction Unit (TEU) ===
✓ Created TEU job for 1000kg raw regolith
Settlement 4 updated for 1 days.
Time advanced by 1 days. Now at day 1.0
✓ TEU job completed
✓ Produced 995.0kg processed regolith

=== STAGE 2: Plasma Volatiles Extractor (PVE) ===
✓ Created PVE job for 995.0kg processed regolith
Settlement 4 updated for 1 days.
Time advanced by 1 days. Now at day 2.0
    processes raw regolith through all stages to produce an enclosed tank (FAILED - 22)
  pipeline with multiple batches
Settlement 5 updated for 1 days.
Time advanced by 1 days. Now at day 1.0
    can process multiple batches concurrently
  material tracking through pipeline
Settlement 6 updated for 1 days.
Time advanced by 1 days. Now at day 1.0
    preserves composition metadata through processing chain (FAILED - 23)

Shell Printing Game Loop Integration
  full shell printing cycle
Settlement 7 updated for 0.5 days.
Time advanced by 0.5 days. Now at day 0.5
    encloses inflatable tank through game loop progression
Settlement 8 updated for 0.5 days.
Time advanced by 0.5 days. Now at day 0.5
    tracks material composition in shell metadata

Terraforming Integration
  end-to-end terraforming simulation
    creates a barren planet with correct initial conditions
    with starter ecosystem deployed
      deploys life forms successfully
      life forms have atmospheric contribution
      simulation over time
Tracking species population in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b9a9d90>
Managing food web dynamics in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b9a9d90>
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 295.0 → 295.0
  - Polar: 275.0 → 281.399444444444444444444444444444444445
  - Target: 295.0 (based on biome optima)
Using life form atmospheric effects (2 species)
Life form contributions per day: O2=0.52, CO2 consumed=0.65, CH4=0.0
Atmosphere changes over 1 days:
  O2:  0.13 → 0.65 (+0.52%)
  CO2: 95.32 → 94.67 (-0.65%)
  CH4: 0.0 → 0.0 (+0.0%)
Calculated gas masses: O2=162500000000000.0, CO2=2.36675e+16, CH4=0.0
        increases oxygen levels after 1 day
Tracking species population in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5aad6b88>
Managing food web dynamics in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5aad6b88>
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 295.0 → 295.0
  - Polar: 275.0 → 281.399444444444444444444444444444444445
  - Target: 295.0 (based on biome optima)
Using life form atmospheric effects (2 species)
Life form contributions per day: O2=0.52, CO2 consumed=0.65, CH4=0.0
Atmosphere changes over 1 days:
  O2:  0.13 → 0.65 (+0.52%)
  CO2: 95.32 → 94.67 (-0.65%)
  CH4: 0.0 → 0.0 (+0.0%)
Calculated gas masses: O2=162500000000000.0, CO2=2.36675e+16, CH4=0.0
        decreases CO2 levels after 1 day (FAILED - 24)
Tracking species population in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b514618>
Managing food web dynamics in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b514618>
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 295.0 → 295.0
  - Polar: 275.0 → 281.399444444444444444444444444444444445
  - Target: 295.0 (based on biome optima)
Using life form atmospheric effects (2 species)
Life form contributions per day: O2=0.52, CO2 consumed=0.65, CH4=0.0
Atmosphere changes over 10 days:
  O2:  0.13 → 5.33 (+5.2%)
  CO2: 95.32 → 88.82 (-6.5%)
  CH4: 0.0 → 0.0 (+0.0%)
Calculated gas masses: O2=1.3325e+15, CO2=2.2205000000000004e+16, CH4=0.0
        shows progressive changes over 100 days (FAILED - 25)
Tracking species population in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5ab821e0>
Managing food web dynamics in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5ab821e0>
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 295.0 → 295.0
  - Polar: 275.0 → 281.399444444444444444444444444444444445
  - Target: 295.0 (based on biome optima)
Using life form atmospheric effects (2 species)
Life form contributions per day: O2=0.52, CO2 consumed=0.65, CH4=0.0
Atmosphere changes over 1 days:
  O2:  0.13 → 0.65 (+0.52%)
  CO2: 95.32 → 94.67 (-0.65%)
  CH4: 0.0 → 0.0 (+0.0%)
Calculated gas masses: O2=162500000000000.0, CO2=2.36675e+16, CH4=0.0
        scales effects by time parameter (FAILED - 26)
      life form populations over time
Tracking species population in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5ae9e248>
Managing food web dynamics in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5ae9e248>
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 295.0 → 295.0
  - Polar: 275.0 → 281.399444444444444444444444444444444445
  - Target: 295.0 (based on biome optima)
Using life form atmospheric effects (2 species)
Life form contributions per day: O2=0.52, CO2 consumed=0.65, CH4=0.0
Atmosphere changes over 50 days:
  O2:  0.13 → 26.13 (+26.0%)
  CO2: 95.32 → 62.82 (-32.5%)
  CH4: 0.0 → 0.0 (+0.0%)
Calculated gas masses: O2=6.5325e+15, CO2=1.5705000000000002e+16, CH4=0.0
        maintains or grows populations under favorable conditions
      combined effects from multiple species
Tracking species population in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b0271c8>
Managing food web dynamics in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b0271c8>
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 295.0 → 295.0
  - Polar: 275.0 → 281.399444444444444444444444444444444445
  - Target: 295.0 (based on biome optima)
Using life form atmospheric effects (2 species)
Life form contributions per day: O2=0.52, CO2 consumed=0.65, CH4=0.0
Atmosphere changes over 10 days:
  O2:  0.13 → 5.33 (+5.2%)
  CO2: 95.32 → 88.82 (-6.5%)
  CH4: 0.0 → 0.0 (+0.0%)
Calculated gas masses: O2=1.3325e+15, CO2=2.2205000000000004e+16, CH4=0.0
        aggregates atmospheric effects from all life forms
    without life forms
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 295.0 → 295.0
  - Polar: 275.0 → 281.399444444444444444444444444444444445
  - Target: 295.0 (based on biome optima)
No life forms with terraforming effects, using default values
Atmosphere changes over 1 days:
  O2:  0.13 → 0.13 (+1.0e-05%)
  CO2: 95.32 → 95.32 (-1.0e-05%)
  CH4: 0.0 → 0.0 (+1.0e-06%)
Calculated gas masses: O2=32502500000000.01, CO2=2.38299975e+16, CH4=250000000.0
      uses fallback values when no terraforming organisms exist
  realistic terraforming scenario
Tracking species population in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b341048>
Managing food web dynamics in #<CelestialBodies::Spheres::Biosphere:0x00007f3e5b341048>
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 5.0
  Adjusting global temperatures:
  - Tropical: 290.0 → 290.0
  - Polar: 270.0 → 276.30555555555554
  - Target: 290.0 (based on biome optima)
Using life form atmospheric effects (1 species)
Life form contributions per day: O2=5.0, CO2 consumed=6.0, CH4=0.0
Normalizing atmosphere: total was 500.13%, scaled to 100%
Atmosphere changes over 100 days:
  O2:  0.13 → 100.0 (+500.0%)
  CO2: 95.32 → 0.0 (-600.0%)
  CH4: 0.0 → 0.0 (+0.0%)
Calculated gas masses: O2=2.5e+16, CO2=0.0, CH4=0.0
    demonstrates full terraforming workflow (FAILED - 27)

Terraforming Workflow Integration
Simulating erosion for #<CelestialBodies::Spheres::Geosphere:0x00007f3e5b4a1910>, erosion rate: 0.0 cm/year
Updating geosphere state for #<CelestialBodies::Spheres::Geosphere:0x00007f3e5b4a1910>.
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 0.0
  Adjusting global temperatures:
  - Tropical: 103367612.43597429 → 103367612.43597429
  - Polar: 292040667.35544866 → 232556245.87389216
  - Target: 103367612.43597429 (based on biome optima)
No life forms with terraforming effects, using default values
Atmosphere changes over 1 days:
  O2:  0.0 → 0.0 (+1.0e-05%)
  CO2: 0.0 → 0.0 (-1.0e-05%)
  CH4: 0.0 → 0.0 (+1.0e-06%)
Calculated gas masses: O2=0.0, CO2=0.0, CH4=0.0
  transforms atmosphere over time with deployed organisms (FAILED - 28)
Simulating erosion for #<CelestialBodies::Spheres::Geosphere:0x00007f3e5a2126c8>, erosion rate: 0.0 cm/year
Updating geosphere state for #<CelestialBodies::Spheres::Geosphere:0x00007f3e5a2126c8>.
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 0.0
  Adjusting global temperatures:
  - Tropical: 103367612.43597429 → 103367612.43597429
  - Polar: 292040667.35544866 → 232556245.87389216
  - Target: 103367612.43597429 (based on biome optima)
No life forms with terraforming effects, using default values
Atmosphere changes over 1 days:
  O2:  0.0 → 0.0 (+1.0e-05%)
  CO2: 0.0 → 0.0 (-1.0e-05%)
  CH4: 0.0 → 0.0 (+1.0e-06%)
Calculated gas masses: O2=0.0, CO2=0.0, CH4=0.0
  allows monitoring of terraforming progress (FAILED - 29)

ConcurrentTaskWorkerJob
  #perform
    with manufacturing task during daylight
      executes the task successfully (FAILED - 30)
      generates manufacturing byproducts (FAILED - 31)
    with manufacturing task during low light
      does not generate byproducts (FAILED - 32)
    with non-manufacturing task
      does not attempt byproduct generation (FAILED - 33)
    when task execution fails
      does not mark task as completed

Account
  associations
    is expected to belong to accountable required: true
    is expected to have many transactions dependent => destroy
  validations
    is expected to validate that :balance looks like a number greater than or equal to 0
  #deposit
    with a valid amount
      increases the account balance (FAILED - 34)
    with an invalid amount (negative)
      raises an error and does not modify the balance
  #withdraw
    when funds are sufficient
      decreases the account balance (FAILED - 35)
    when funds are insufficient
      raises an error and does not modify the balance
  #transfer_funds
    when funds are sufficient
      transfers the amount from one account to another (FAILED - 36)
    when funds are insufficient
      raises an error and does not modify balances
  edge cases
    when balance is exactly zero
      prevents withdrawals or transfers
      allows deposits (FAILED - 37)
  different accountable types
    works with a player account
    works with a settlement account
    works with an organization account

Atmosphere
  associations
    is expected to belong to celestial_body optional: true
    is expected to have many gases class_name => CelestialBodies::Materials::Gas dependent => destroy
  validations
    example at ./spec/models/atmosphere_spec.rb:31 (FAILED - 38)
    example at ./spec/models/atmosphere_spec.rb:32 (FAILED - 39)
    example at ./spec/models/atmosphere_spec.rb:33 (FAILED - 40)
    example at ./spec/models/atmosphere_spec.rb:34 (FAILED - 41)
  enums
    defines environment_type enum with string values
  #volume
    when celestial_body responds to volume
      returns the celestial_body's volume (FAILED - 42)
    when celestial_body doesn't respond to volume
      returns 0
  sealing methods
    #sealed?
      returns the sealing status (FAILED - 43)
    #seal!
      sets sealing status to true (FAILED - 44)
    #unseal!
      sets sealing status to false (FAILED - 45)
  #habitable?
    with good conditions
      returns true (FAILED - 46)
    with low pressure
      returns false (FAILED - 47)
    with low oxygen
      returns false (FAILED - 48)
    with high CO2
      returns false (FAILED - 49)
    with extreme temperature
      returns false for too cold (FAILED - 50)
      returns false for too hot (FAILED - 51)
  AtmosphereConcern inclusion
    includes AtmosphereConcern methods (FAILED - 52)
  JSON fields
    initializes JSON fields with empty objects (FAILED - 53)
    allows storing data in JSON fields (FAILED - 54)
  parent validation
    requires exactly one parent
    rejects multiple parents (FAILED - 55)

Units::BiogasGenerator
  #operate
    consumes biomass, organic waste, and energy, producing biogas and fertilizer (FAILED - 56)
    returns false if insufficient biomass is available (FAILED - 57)
    returns false if insufficient organic waste is available (FAILED - 58)
    returns false if insufficient energy is available (FAILED - 59)

Biology::BaseLifeForm
  associations
    is expected to belong to biosphere required: true
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :population looks like a number greater than or equal to 0
  enums
    is expected to define :complexity as an enum backed by an integer with values ‹{microbial: 0, simple: 1, complex: 2, intelligent: 3}›
    is expected to define :domain as an enum backed by an integer with values ‹{aquatic: 0, terrestrial: 1, aerial: 2, subterranean: 3}›
  attributes
    stores additional properties in the properties column
    stores terraforming properties
  #total_biomass
    calculates biomass differently based on complexity
  #atmospheric_contribution
    with terraforming properties set
      calculates atmospheric effects based on population
      scales effects by population size
    with zero population
      returns zero effects
    without terraforming properties
      returns zero effects
  #type_identifier
    raises NotImplementedError when called on base class

Biosphere and Life Form Integration
  ecosystem simulation
    simulates population dynamics (FAILED - 60)
    handles biosphere changes
  food availability calculation
    calculates food availability for herbivores
    calculates food availability for carnivores
    returns nil for photosynthetic life forms
  environmental impact
    calculates the environmental impact of a life form
    considers soil impact for decomposers
  environmental impact
    calculates the environmental impact of a life form
    considers soil impact for decomposers
  interactions
    handles interactions between different life forms

Biology::LifeForm
  inheritance
    inherits from BaseLifeForm
  #type_identifier
    returns 'natural'
  #adapt_to_environment
    with poor adaptation score
      reduces population
    with neutral adaptation score
      keeps population stable
    with good adaptation score
      increases population
  #simulate_growth
    uses _calculate_base_growth_rate to modify population
    is affected by biosphere habitability
  #total_biomass
    with custom mass in properties
      uses custom mass instead of complexity-based calculation
    without custom mass in properties
      falls back to complexity-based calculation
  #atmospheric_contribution
    with no population
      returns zero contribution
    with photosynthetic organism
      calculates oxygen production and CO2 consumption
    with methane-producing organism
      calculates methane production
    with nitrogen-fixing organism
      calculates nitrogen fixation
    with soil-improving organism
      calculates soil improvement
    with multiple effects
      returns all contributions
    with population scaling
      scales contributions by population size

Biology::LifeFormParent
  associations
    is expected to belong to parent class_name => Biology::BaseLifeForm required: true
    is expected to belong to child class_name => Biology::BaseLifeForm required: true
  table name
    uses the correct table name

Biology::LifeForm
  inheritance
    inherits from BaseLifeForm
  #type_identifier
    returns 'natural'
  #adapt_to_environment
    with poor adaptation score
      reduces population
    with neutral adaptation score
      keeps population stable
    with good adaptation score
      increases population
  #simulate_growth
    uses _calculate_base_growth_rate to modify population
    is affected by biosphere habitability
  #total_biomass
    with custom mass in properties
      uses custom mass instead of complexity-based calculation
    without custom mass in properties
      falls back to complexity-based calculation

Units::BiomassRecycler
  #operate
    consumes biomass and energy, producing fertilizer and biofuel (FAILED - 61)
    returns false if insufficient biomass is available (FAILED - 62)
    returns false if insufficient energy is available (FAILED - 63)

Biome
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without a temperature range
    is not valid without a humidity range
    is not valid with a duplicate name
  associations
    has many planet_biomes
    has many celestial_bodies through planet_biomes
  .biomes_for_conditions
    returns biomes matching the temperature and humidity conditions
    returns an empty array when no biomes match the conditions
  suitability
Debug: Testing biome Biome-f5ec72f7-8b4d-45d6-8ee3-e22956798448
Debug: Temperature range: 298..303
Debug: Humidity range: 70..90
Debug: Testing temp: 28 (converted to 301.15)
Debug: Testing humidity: 80
    returns true when the biome is suitable for the given conditions
    returns false when the biome is not suitable for the given conditions
    returns true for suitable conditions in Kelvin

CelestialBodies::Spheres::Biosphere
  is expected to belong to celestial_body required: true
  is valid with valid attributes
  is not valid without a celestial_body

Blueprint
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :current_research_level looks like a number greater than or equal to 0
    is expected to validate that :material_efficiency looks like a number greater than or equal to 0
    is expected to validate that :time_efficiency looks like a number greater than or equal to 0
  #materials
    returns a hash of required materials from JSON
  #calculate_efficiencies
    calculates material and time efficiencies based on research level

CelestialBodies::AlienLifeForm
  associations
    is expected to belong to biosphere class_name => CelestialBodies::Spheres::Biosphere required: true
  enums
    is expected to define :complexity as an enum backed by an integer with values ‹[:microbial, :simple, :complex, :intelligent]›
    is expected to define :domain as an enum backed by an integer with values ‹[:aquatic, :terrestrial, :aerial, :subterranean]›
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :population looks like a number greater than or equal to 0
  store_accessors
    should define store accessors for description, biochemistry, and ecological_role
  #simulate_growth
    should update the population based on growth rate
    should save the updated population

CelestialBodies::BrownDwarf
  validations
    is valid with default attributes
    allows nil orbital_period
    validates orbital_period is greater than or equal to 0 when present
  default attributes
    sets default spectral type
    sets default luminosity
    sets default effective temperature
  #is_star?
    returns false
  #is_orbiting_star?
    returns false for isolated brown dwarfs
    returns true for brown dwarfs in a solar system
  #distance_from_star
    returns nil for isolated brown dwarfs
    when part of a solar system
      delegates to super when orbiting a star
      returns nil when no star distances exist
  physical properties
    has appropriate mass for a brown dwarf
    has appropriate surface temperature for a brown dwarf
  atmospheric and other properties
    can have an atmosphere
  habitable zones
    has a limited habitable zone (PENDING: Habitable zone calculations not yet implemented for brown dwarfs)
  relationships with planets
    can have orbiting planets (PENDING: Brown dwarf planetary systems not yet implemented)

CelestialBodies::CelestialBody
  associations
    is expected to belong to solar_system optional: true
    is expected to have one spatial_location dependent => destroy
    is expected to have many locations dependent => destroy
    is expected to have one atmosphere dependent => destroy
    is expected to have one biosphere dependent => destroy
    is expected to have one geosphere dependent => destroy
    is expected to have one hydrosphere dependent => destroy
  material management
    #add_material
      creates or updates material properly
      updates atmosphere gases if material is a gas
    #remove_material
      reduces material amount and deletes if zero
      updates atmosphere gases accordingly
  calculated properties
    calculates surface_area correctly
    calculates volume correctly
    calculates escape_velocity correctly
  #distance_from_star
    returns nil if no star distance
    returns distance when star_distances present
  #is_moon
    returns false for normal celestial bodies
    returns true if type is moon
  properties JSONB accessors
    can read and write last_simulated_at
  #planet_class?
    returns true for a planet type
    returns false for nil type
    returns false for non-planet type
  #should_simulate?
    returns false if not active
    returns false if radius is too small
    returns true for planet_class? or is_moon
    returns true if force_simulate property is set

CelestialBodies::Features::AccessPoint
  associations
    is expected to belong to parent_feature optional: true
  #set_feature_type
    automatically sets feature_type
  #sealed?
    returns false when natural
    returns true when enclosed
  #area_m2
    calculates area from length and width
    calculates area from diameter if no length/width

CelestialBodies::Features::AdaptedFeature
  validations
    is expected to validate that :feature_id cannot be empty/falsy
    is expected to validate that :feature_type cannot be empty/falsy
    is expected to belong to celestial_body required: true
  attributes
    has a default status of natural
    can set and get adapted_at
    can set and get settlement_id
    can set and get discovered_by
  #static_data
    returns static data hash
  #name
    returns the name from static data
  #coordinates
    returns coordinates from static data
  #feature_specific_data
    returns the full static data hash

CelestialBodies::Features::BaseFeature
  associations
    is expected to belong to celestial_body required: true
    is expected to belong to parent_feature optional: true
    is expected to have many child_features
  validations
    is expected to validate that :feature_id cannot be empty/falsy
    is expected to validate that :feature_type cannot be empty/falsy
    is expected to validate that :status cannot be empty/falsy
  #static_data
    fetches data from lookup service (FAILED - 64)
    caches the data (FAILED - 65)
  #discover!
    marks feature as discovered (FAILED - 66)
    sets discovered_at timestamp (FAILED - 67)
    does not overwrite existing discovery (FAILED - 68)
  status transitions
    transitions through states correctly (FAILED - 69)
    cannot skip states (FAILED - 70)
  tier helpers
    identifies strategic features (FAILED - 71)
    identifies catalog features

CelestialBodies::Features::Canyon
  validations
    is valid with valid attributes
    sets feature_type to canyon before validation
  dimensions
    returns correct length_m
    returns correct width_m
    returns correct depth_m
    returns correct volume_m3
  #formation
    returns the formation type
  #conversion_suitability
    returns the conversion suitability hash
  #segments
    returns the segments array
  #can_pressurize_section?
    returns false if not enclosed or openings not sealed
    returns true if enclosed and all openings sealed

CelestialBodies::Features::Cave
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  #cave_type
    returns cave type
  #conversion_suitability
    returns suitability data
  #can_pressurize?
    returns false when not enclosed or openings not sealed

CelestialBodies::Features::Crater
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  ice detection
    detects ice presence
    returns ice quantities
  #permanently_shadowed?
    returns true for Shackleton
  #solar_exposure_percent
    returns solar exposure data
  #conversion_suitability
    returns dome suitability
    returns advantages and challenges
  #size_category
    categorizes crater size
  #strategic_value
    includes water_ice for Shackleton

CelestialBodies::Features::LavaTube
  associations
    is expected to have many skylights
    is expected to have many access_points
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  #conversion_suitability
    returns suitability data
  #natural_openings
    returns openings from static data
  #create_openings_from_static_data!
    creates child opening features
    creates skylights for skylight openings
  #can_pressurize?
    returns false if openings are not sealed
    returns true when all openings are sealed
  #strategic_value
    returns strategic value array

CelestialBodies::Features::Skylight
  associations
    is expected to belong to parent_feature optional: true
  #set_feature_type
    automatically sets feature_type
  #parent_lava_tube
    returns the parent lava tube
  #area_m2
    calculates area from diameter
  #covered?
    returns false when natural
    returns true when enclosed
    returns true when pressurized

CelestialBodies::Features::Valley
  #set_feature_type
    automatically sets feature_type
  dimension accessors
    reads dimensions from static data
  #formation
    returns formation type
  #conversion_suitability
    returns suitability data
  #calculate_construction_segments
    returns predefined segments from static data

CelestialBodies::Material
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without an amount
    is not valid with a negative amount
    is valid with a valid state (solid, liquid, gas)
  associations
    belongs to a celestial body

CelestialBodies::Materials::Base
  inherits from the original Material class
  uses the materials table

CelestialBodies::Materials::ExoticMaterial
  uses the exotic_materials table
  associations
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:25 (FAILED - 72)
  validations
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:29 (FAILED - 73)
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:30 (FAILED - 74)
    example at ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:31 (FAILED - 75)
  state helper methods
    identifies metallic hydrogen state (FAILED - 76)
    identifies plasma state (FAILED - 77)
  #phase_transition_at
    returns metallic_hydrogen for hydrogen at extreme pressure (FAILED - 78)
    returns plasma at extreme temperatures (FAILED - 79)
    returns superfluid for helium at low temperatures (FAILED - 80)
    falls back to standard states otherwise (FAILED - 81)

CelestialBodies::Materials::Gas
  uses the gases table
  has the same behavior as the original Gas model
  associations
    belongs to atmosphere
    can be accessed through atmosphere.gases
  validations
    is not valid without a name
    is not valid with a negative percentage
    is not valid with a percentage over 100
    is not valid with a negative mass
    is not valid with a negative ppm
  #moles
    calculates moles from mass and molar mass
    returns 0 if mass is nil
    returns 0 if molar_mass is nil
  before_validation callback
    sets molar_mass from material lookup if blank
    does not override existing molar_mass

CelestialBodies::Materials::GeologicalMaterial
  uses the geological_materials table
  associations
    belongs to geosphere
    can be accessed through geosphere.geological_materials
  validations
    is not valid without a name
    is not valid with an invalid layer
    is not valid with a negative percentage
    is not valid with a percentage over 100
    is not valid with a negative mass
    is not valid with an invalid state
  state helper methods
    returns true for solid? when state is 'solid'
    returns true for liquid? when state is 'liquid'
    returns true for gas? when state is 'gas'
  exotic state handling
    correctly reports state for exotic materials
    handles metallic hydrogen specifically
    handles plasma state

CelestialBodies::Materials::Liquid
  uses the liquid_materials table
  associations
    is expected to belong to hydrosphere required: true
    associates with the correct class name
    can be accessed through hydrosphere.liquid_materials
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without an amount
    is not valid with a negative amount

CelestialBodies::MinorBodies::DwarfPlanet
  validations
    is valid with valid attributes (FAILED - 82)
  #is_spherical?
    returns true for dwarf planets (FAILED - 83)
  #calculate_geological_activity
    calculates geological activity based on mass and age (FAILED - 84)

CelestialBodies::PlanetBiome
  has access to celestial_body through biosphere
  associations
    is expected to belong to biome required: true
    is expected to belong to biosphere class_name => CelestialBodies::Spheres::Biosphere required: true
  validations
    is valid with valid attributes
    is not valid without a biome
    is not valid without a biosphere
    is expected to validate that :biome_id is case-sensitively unique within the scope of :biosphere_id
  jsonb properties
    can set and retrieve area_percentage
    can set and retrieve vegetation_cover
    can set and retrieve moisture_level
    can set and retrieve latitude
    can set and retrieve biodiversity
    supports deprecated water_level with warning
    default values for properties
      defaults area_percentage to 0.0
      defaults vegetation_cover to 0.0
      defaults moisture_level to 0.0
      defaults latitude to 0.0
      defaults biodiversity to 0.0
  callbacks
    updates biosphere biodiversity after creation
    updates biosphere biodiversity after destruction

CelestialBodies::Planets::Gaseous::GasGiant
  behaves like a gaseous planet
    is expected to validate that :density looks like a number less than 2.0
    has a low density
    doesn't have a solid surface
    calculates cloud bands based on rotation (FAILED - 85)
  gas giant specific methods
    #estimate_moon_count
      with Jupiter mass
        estimates a realistic moon count (FAILED - 86)
      with different masses
        scales moon count with mass (FAILED - 87)
    #ring_system_probability
      returns a high probability for gas giants (FAILED - 88)

CelestialBodies::Planets::Gaseous::GaseousPlanet
  validations
    is valid with valid attributes
    requires density to be less than 2.0
  #has_solid_surface?
    returns false for gaseous planets
  #calculate_bands
    with fast rotation
      calculates more cloud bands
    with slower rotation
      calculates fewer cloud bands
    with nil rotation period
      returns a default value
  #calculate_blackbody_temperature
    with valid star and semi-major axis
      calculates approximate blackbody temperature
    without valid star data
      returns a default temperature value

CelestialBodies::Planets::Gaseous::IceGiant
  behaves like a gaseous planet
    is expected to validate that :density looks like a number less than 2.0
    has a low density
    doesn't have a solid surface
    calculates cloud bands based on rotation (FAILED - 89)
  #calculate_gravity
    calculates gravity based on mass and radius
  #habitability_score
    returns not habitable for ice giants

CelestialBodies::Planets::Ocean::HyceanPlanet
  validations
    requires an atmosphere to be present (FAILED - 90)
    requires at least 10% hydrogen in atmosphere (FAILED - 91)
    requires significant atmospheric pressure (>1 atm) (FAILED - 92)
    is valid with proper hydrogen content and pressure (FAILED - 93)
    inherits ocean planet water coverage validation (FAILED - 94)
  #habitability_factors
    includes base ocean planet factors (FAILED - 95)
    includes hydrogen blanket greenhouse effect (FAILED - 96)
    calculates pressure habitability zones (FAILED - 97)
    indicates expanded habitable temperature range (FAILED - 98)
    rates optimal pressure range (10-100 atm) as level 3 (FAILED - 99)
    rates moderate pressure range (1-10 or 100-1000 atm) as level 2 (FAILED - 100)
    rates extreme pressure as level 1 (FAILED - 101)
  #surface_features
    includes base ocean planet features (FAILED - 102)
    includes hydrogen atmosphere features (FAILED - 103)
    includes extreme storm systems for high pressure atmospheres (FAILED - 104)
    does not include storm systems for lower pressure (FAILED - 105)
  #ocean_chemistry
    identifies hydrogen saturated oceans for high H2 content (FAILED - 106)
    identifies methane rich oceans when CH4 is present (FAILED - 107)
    returns unknown when hydrosphere composition is missing (FAILED - 108)
  #habitable_layer_depth
    calculates habitable depth range based on pressure (FAILED - 109)
    sets deeper minimum depth for higher pressure (FAILED - 110)
    ensures maximum depth is greater than minimum (FAILED - 111)
    returns nil when atmosphere is missing (FAILED - 112)
    returns nil when hydrosphere is missing (FAILED - 113)
  #hydrogen_percentage (private method)
    calculates hydrogen percentage from atmosphere (FAILED - 114)
    returns 0 when H2 gas is not present (FAILED - 115)
  STI type
    sets the correct STI type (FAILED - 116)
  with :extreme trait
    has very high surface temperature (FAILED - 117)
    has very high atmospheric pressure (FAILED - 118)
  with :cold trait
    has below-freezing surface temperature (FAILED - 119)
    has significant ice coverage (FAILED - 120)
    has higher ammonia content as antifreeze (FAILED - 121)
    has mixed liquid-solid state distribution (FAILED - 122)
  inheritance from OceanPlanet
    inherits water_volume calculation (FAILED - 123)
    can analyze water chemistry (FAILED - 124)

CelestialBodies::Planets::Ocean::OceanPlanet
  validations
    requires a hydrosphere to be present
    requires at least 30% water coverage
    is valid with 30% or more water coverage
  #habitability_factors
    includes aquatic environment factors based on water coverage
    marks aquatic environment as 'significant' for coverage below 50%
    marks aquatic environment as 'dominant' for coverage above 50%
    analyzes water chemistry from hydrosphere composition
    includes temperature state for liquid water range
    identifies frozen surface for low temperatures
    identifies vapor dominated state for high temperatures
  #surface_features
    includes basic water features
    includes ocean_dominated for high water coverage
    includes ice formations for cold temperatures
    includes liquid oceans for moderate temperatures
    includes vapor clouds for high temperatures
  #water_volume
    calculates water volume based on planet size and coverage
    returns 0 when radius is missing
    returns 0 when hydrosphere is missing
    increases with higher water coverage
  #analyze_water_chemistry (protected method)
    identifies highly saline water
    identifies moderately saline water
    identifies low salinity water
  STI type
    sets the correct STI type

CelestialBodies::Planets::Ocean::WaterWorld
  validations
    requires high water coverage
    is valid with appropriate water coverage
  #surface_features
    includes oceanic features
    includes pelagic_world for extreme coverage
  #average_ocean_depth
    calculates depth based on planet size and water coverage
    returns 0 when radius is missing
    returns 0 when hydrosphere is missing

CelestialBodies::Planets::Rocky::TerrestrialPlanet
  #atmosphere_composition
    returns a hash of gas names and percentages
  #habitable_zone?
    returns a boolean indicating if the planet is in the habitable zone
  #habitability_score
    returns a numeric score for habitability
  #classification
    returns a string classification for the planet
  #day_night_cycle
    returns nil or a numeric value for the day-night cycle
  #earth_masses
    returns the mass of the planet in Earth masses
  #earth_radii
    returns the radius of the planet in Earth radii
  #temperature_score
    returns a numeric score for temperature habitability
  #pressure_score
    returns a numeric score for pressure habitability
  #atmosphere_score
    returns a numeric score for atmosphere habitability
  #gravity_score
    returns a numeric score for gravity habitability
  #calculated_atmospheric_pressure
    returns a numeric value for calculated atmospheric pressure

CelestialBodies::Satellites::IceMoon
  is valid with valid attributes
  has ice composition

CelestialBodies::Satellites::LargeMoon
  is valid with valid attributes
  is classified as a large moon

CelestialBodies::Satellites::Moon
  STI configuration
    sets the correct type before validation
  #orbits_planet?
    returns true when parent celestial body is a planet
    returns false when parent celestial body is not set
    works with parent_body alias
  #calculate_tidal_forces
    returns 0 when parent celestial body is not set
    returns 0 when required attributes are missing
    calculates tidal forces based on parent mass and orbital period

CelestialBodies::Satellites::Satellite
  inheritance and concerns
    inherits from CelestialBody
    includes OrbitalMechanics concern
  associations
    belongs to parent_celestial_body
    has parent_body alias
  validations
    validates orbital_period is positive
    validates rotational_period is positive
    allows nil values for orbital and rotational periods
  rotational mechanics
    #tidally_locked?
      returns true when rotational and orbital periods are equal
      returns true when periods are within 5% tolerance
      returns false when periods differ significantly
      returns false when either period is missing
    #day_length_hours
      converts rotational period from days to hours
      returns nil when rotational_period is not set
    #temperature_variation
      returns :extreme for very long rotational periods
      returns :none for tidally locked satellites
      returns :normal for Earth-like rotation
      returns :extreme when rotational_period is nil
  orbital relationship methods
    #orbits_planet?
      returns true when parent is a terrestrial planet
      returns false when parent celestial body is not set
    #calculate_tidal_forces
      returns 0 when parent celestial body is not set
      returns 0 when mass is not set
      calculates tidal forces when all data is present

CelestialBodies::Satellites::SmallMoon
  is valid with valid attributes
  is classified as a small moon

CelestialBodies::Spheres::Atmosphere
  initialization
    creates an atmosphere with default attributes
    updates atmosphere with provided information
  #initialize_gases
    creates gases based on the composition
  #add_gas
    adds gas using chemical formula
  #remove_gas
    removes gas and updates total atmospheric mass
  temperature management
    stores various temperature types in temperature_data
    provides default values for temperature getters
    updates main temperature when greenhouse temperature changes
    persists temperature data across reloads
  gas percentage methods
    #gas_percentage
      returns percentage of existing gas in gases collection
      falls back to composition data when gas not found in gases collection
      returns 0.0 for non-existent gases
    convenience gas percentage methods
      returns O2 percentage via o2_percentage
      returns CO2 percentage via co2_percentage
      returns CH4 percentage via ch4_percentage
      correctly uses the gas_percentage method
  atmospheric density calculations
    #density
      calculates atmospheric density based on pressure, temperature and composition
      returns zero when pressure is zero
      returns zero when temperature is zero
      calculates different density for different gas compositions
    #calculate_gas_constant
      returns a weighted average of gas constants based on composition
      returns Earth default when no gases exist
    #scale_height
      calculates atmospheric scale height based on temperature, gravity and composition
      calculates larger scale height for hotter atmospheres
      calculates smaller scale height for higher gravity
    #calculate_average_molar_mass
      calculates weighted average molar mass from gas composition
      returns Earth default when no gases exist
      calculates different molar mass for different compositions

CelestialBodies::Spheres::Biosphere
  associations
    is expected to belong to celestial_body required: true
    is expected to have many materials dependent => destroy
    is expected to have many planet_biomes dependent => destroy
    is expected to have many biomes through planet_biomes
  life form associations
    is expected to have many life_forms dependent => destroy
    uses the Biology::LifeForm class for the association
    can create life forms
  validations
    can access temperature values via tropical_temperature method
    can access temperature values via polar_temperature method
    is expected to validate that :biodiversity_index looks like a number greater than or equal to 0 and less than or equal to 1 as long as it is not nil
    is expected to validate that :habitable_ratio looks like a number greater than or equal to 0 and less than or equal to 1 as long as it is not nil
  defaults
TEST DEBUG: Atmosphere ID: 3334
TEST DEBUG: CelestialBody atmosphere ID: 3334
TEST DEBUG: Tropical temp from atmosphere: 300.0
TEST DEBUG: Tropical temp via biosphere: 300.0
    accesses default temperature values via delegation methods
  #reset
    coordinates with atmosphere for temperature reset
  #transfer_material
    transfers material to target sphere
    returns false if material not found
    returns false if not enough material available
    logs errors when transfer fails due to validation errors (FAILED - 125)
    logs errors when target material cannot be created
    logs errors when target material cannot be created
  biome management
    introduces a new biome
    removes a biome
  #calculate_biodiversity_index
    calculates biodiversity index based on biome diversity
    returns 0 for a barren biosphere
  #calculate_habitability
    calculates habitability based on atmospheric conditions
    returns 0 with no atmosphere
    returns low habitability with poor conditions
  #discover_life
    discovers nothing with low biodiversity
    has a chance to discover life with moderate biodiversity
  ecological processes
    runs ecological cycle during simulation
  Material transfer edge cases
    correctly assigns celestial_body to target material
    initializes target material with amount 0 if it does not exist
    uses Material class with correct namespace for transaction
    handles nil amount in target material
  soil properties
    has soil_health attribute
    has soil_organic_content attribute
    has soil_microbial_activity attribute
    #update_soil_health updates soil health value
    initializes with default soil health of zero
  vegetation cover
    has vegetation_cover attribute
    defaults to 0.0 vegetation cover
    can update vegetation cover
  temperature delegation
    delegates tropical_temperature to atmosphere when available
    delegates polar_temperature to atmosphere when available
    falls back to default value when atmosphere is not available
  temperature delegation
    delegates tropical_temperature to atmosphere when available
    delegates polar_temperature to atmosphere when available
    falls back to default value when atmosphere is not available
  ecological simulation
    calculates total biomass
    calculates expanded biodiversity including life forms
    simulates life cycle
    can occasionally create new derived life forms

CelestialBodies::Spheres::Geosphere
  validations
    is expected to validate that :total_crust_mass looks like a number as long as it is not nil
    is expected to validate that :total_mantle_mass looks like a number as long as it is not nil
    is expected to validate that :total_core_mass looks like a number as long as it is not nil
    is expected to validate that :geological_activity looks like a number greater than or equal to 0 and less than or equal to 100 as long as it is not nil
  associations
    is expected to belong to celestial_body required: true
  default values
    sets default values for compositions and masses
  #calculate_materials
    calculates and updates materials based on crust, mantle, and core composition (PENDING: calculate_materials method not yet implemented)
  #add_material
    adds a material and updates the celestial body and geosphere (FAILED - 126)
    raises an error if the material is not found in the lookup service
    does not add material if the mass is non-positive
    adds material to the specified layer (FAILED - 127)
    rejects invalid layers
  #remove_material
    removes material from the specified layer (FAILED - 128)
  #set_default_values
    sets default values after initialization
  callbacks
    triggers TerraSim service after adding a material (PENDING: run_terrasim_service method not yet implemented)
  material management
    creates materials in correct layer (FAILED - 129)
    updates composition percentages (FAILED - 130)
    prevents adding gas materials
  material transfers
    transfers material to atmosphere when heated (PENDING: heat_material method not yet implemented)
  #reset
    resets geosphere to base values
  #extract_volatiles
    extracts volatiles based on temperature increase (FAILED - 131)
  #reset
    resets both compositions and material records
  regolith properties
    has regolith_depth attribute
    has regolith_particle_size attribute
    has weathering_rate attribute
    initializes with default regolith depth of zero
    can update regolith properties
    calculates weathering rate based on atmosphere and activity
    updates regolith depth after erosion
    updates plate positions when tectonics are active

CelestialBodies::Spheres::Hydrosphere
  associations
    is expected to belong to celestial_body required: true
    is expected to have many materials dependent => destroy
  validations
    is expected to validate that :total_liquid_mass looks like a number greater than or equal to 0 as long as it is not nil
    is expected to validate that :temperature cannot be empty/falsy
    requires pressure to be present
  store accessors
    accesses water bodies attributes from JSONB store
    writes water bodies attributes to JSONB store
  #reset
    resets to base values
  concern methods
    #calculate_state_distributions
      calculates states based on temperature
    #water_cycle_tick
      calls evaporation and precipitation handlers
  #transfer_material
    transfers material between spheres
    returns false if material not found
    returns false if not enough material available

CelestialBodies::Star
  is valid with all attributes
  is not valid without a name
  is not valid without a type_of_star
  is not valid without an age
  is not valid without a mass
  is not valid without a radius
  is not valid without a temperature
  is not valid without life expectancy
  is not valid without an r_ecosphere
  should have a positive mass
  should have a positive radius
  should have a positive temperature
  responds to attributes
  sets default luminosity based on type_of_star
  sets default luminosity for a sun-like star
  correctly calculates habitable zone

CelestialBodies::CelestialBody
  when part of a solar system
    validates distance_from_star presence
  when not part of a solar system
    allows distance_from_star to be nil (FAILED - 132)
  #add_material
    creates a new material if it does not exist (FAILED - 133)
#<ActiveRecord::Associations::CollectionProxy [#<CelestialBodies::Material id: 753, name: "nitrogen", amount: 100.0, boiling_point: nil, melting_point: nil, state_at_room_temp: nil, state: "solid", location: "atmosphere", is_volatile: false, materializable_type: nil, materializable_id: nil, celestial_body_id: 3188, created_at: "2026-01-13 04:13:17.229546000 +0000", updated_at: "2026-01-13 04:13:17.229546000 +0000", layer: nil>]>
    updates the amount of an existing material (FAILED - 134)
  #update_gravity
    calculates and updates the gravity based on mass and radius (FAILED - 135)

Colony
  validations
    is valid with valid attributes
    requires at least two settlements
  associations
    has multiple settlements
    has an account
    has an inventory
  population calculations
    calculates total population

ComponentProductionJob
  associations
    is expected to belong to settlement required: true
    is expected to belong to printer_unit required: true
  validations
    is expected to validate that :component_blueprint_id cannot be empty/falsy
    is expected to validate that :component_name cannot be empty/falsy
    is expected to validate that :quantity cannot be empty/falsy
    is expected to validate that :quantity looks like an integer greater than 0
    is expected to validate that :status cannot be empty/falsy
    is expected to validate that :production_time_hours cannot be empty/falsy
    is expected to validate that :production_time_hours looks like a number greater than 0
  scopes
    returns active jobs
    returns completed jobs
    returns in_progress jobs
  #start!
    changes status to in_progress and sets started_at
  #complete!
    changes status to completed and sets completed_at
  #fail!
    changes status to failed with reason
  #cancel!
    changes status to cancelled
  #progress_percentage
    calculates progress percentage
  #time_remaining_hours
    calculates remaining time
    returns 0 when complete
  #estimated_completion
    returns nil for pending jobs
    calculates estimated completion time
  #process_tick
    when job is not complete
      increases progress_hours
    when job completes during tick
      completes the job
    when job is not in_progress
      does not process tick
  #active?
    returns true for pending jobs
    returns true for in_progress jobs
    returns false for completed jobs
  #finished?
    returns true for completed jobs
    returns true for failed jobs
    returns false for in_progress jobs

Units::CompostingUnit
  #operate
    consumes organic waste and energy, producing compost (FAILED - 136)
    returns false if insufficient organic waste is available (FAILED - 137)
    returns false if insufficient energy is available (FAILED - 138)

AtmosphereConcern
  #reset
    restores atmosphere to base values
    does nothing when base_values is empty
  #calculate_pressure
    calculates atmospheric pressure
    returns 0 for zero mass
  #add_gas
    adds a new gas to the atmosphere
    updates existing gas
    raises error for invalid gas
  #remove_gas
    removes gas from the atmosphere
    deletes gas when amount becomes zero
    raises error when removing non-existent gas
    raises error when removing more than exists
  #set_default_values
    sets initial values for a new atmosphere
  #gas_percentage
    returns percentage of existing gas in gases collection
    falls back to composition data when gas not found in gases collection
    returns 0.0 for non-existent gases
    returns fresh data after updating gases
  convenience gas percentage methods
    returns O2 percentage via o2_percentage
    returns CO2 percentage via co2_percentage
    returns CH4 percentage via ch4_percentage
  #estimate_molar_mass
    returns default air molar mass for empty composition
    calculates weighted average molar mass from gas composition
    calculates different molar mass for different compositions
    handles unknown gases gracefully
  #calculate_atmospheric_mass_for_volume
    calculates atmospheric mass for given volume and conditions
    returns 0 for invalid inputs
  #get_celestial_atmosphere_data
    with planetary atmosphere (no container)
      returns self data for planetary atmospheres
  #habitable?
    returns true for Earth-like conditions
    returns false for low pressure
    returns false for low oxygen
    returns false for high CO2
    returns false for extreme temperatures
  pressure conversion methods
    converts pressure to atmospheres
    converts pressure to PSI
    converts pressure to mmHg
  temperature conversion methods
    converts temperature to Celsius
    converts temperature to Fahrenheit
  #sealed?
    returns false by default for atmosphere concern
  #initialize_gases
    creates gases based on composition
    returns false when no composition present
  #update_total_atmospheric_mass
    calculates total mass from gas masses
    sets zero when no gases exist
  #recalculate_gas_percentages
    updates gas percentages based on masses
    does nothing when no gases exist
  #increase_dust and #decrease_dust
    increases dust concentration and sets properties
    decreases dust concentration but not below zero
  #increase_pollution
    increases pollution value

AtmosphericProcessing
  when included in a unit (new template format)
    with atmospheric processing capabilities
      #can_process_atmosphere?
        returns true when atmospheric processing is enabled
        returns false when atmospheric processing is disabled
        returns false when processing_capabilities is missing
      #atmospheric_capabilities
        returns capabilities based on processing types
        returns empty hash when can't process atmosphere
      #max_processing_rate
        returns rate for CO₂ input
        returns rate for oxygen output
        returns 0 for unknown substance
      #process_atmosphere!
        returns false for unsupported processing type
        CO2 to oxygen conversion
          processes CO2 to oxygen successfully
          fails when insufficient CO2 available
          fails when no atmosphere available
    without atmospheric processing capabilities
      cannot process atmosphere
      returns empty atmospheric capabilities
      fails to process atmosphere
  when included in a module (existing JSON format)
    CO2 scrubber module
      #can_process_atmosphere?
        returns true when has atmospheric input/output resources
        returns false when no atmospheric resources
      #atmospheric_capabilities
        returns capabilities based on resource flow
      #process_atmosphere!
        CO2 scrubbing
          scrubs CO2 from atmosphere successfully
          fails when cartridge is full
          fails when insufficient CO2 in atmosphere
    air filtration module
      #atmospheric_capabilities
        identifies air filtration capability
      #process_atmosphere!
        air filtration
          filters air successfully
          fails when no contaminants removed
    CO2 venting module
      #atmospheric_capabilities
        identifies CO2 venting capability
      #process_atmosphere!
        CO2 venting
          vents CO2 to space successfully
          vents CO2 to atmosphere with different rate
          fails when operational mode doesn't exist
  error handling
    handles missing operational_data gracefully
    handles malformed operational_data gracefully
    handles missing attachable gracefully
  private helper methods
    #has_processing_capabilities?
      returns true when atmospheric processing enabled
      returns false when atmospheric processing disabled
    #has_atmospheric_operations?
      returns true when has atmospheric resources
      returns false when no atmospheric resources
    #has_resource_flow?
      returns true when both input and output exist
      returns false when input missing
      returns false when output missing

BatteryManagement
  initialization
    sets up default battery data
    uses default capacity of 100.0
    initializes current charge to full capacity
  battery_percentage
    calculates percentage correctly
    handles empty battery
    handles zero capacity
  consume_battery
    reduces battery level by specified amount
    doesn't allow battery to go below zero
    ignores nil or negative values
  recharge_battery
    increases battery level by specified amount
    doesn't allow battery to exceed capacity
    ignores nil or negative values
  charge_battery alias
    works the same as recharge_battery
  battery_drain
    returns the configured drain rate
    has a default value

CryptocurrencyMining
  #mine_gcc
    correctly updates the account balance with mined GCC
    updates internal funds after mining

EnergyManagement
  with test entity
    calculates power usage correctly
    calculates power generation correctly
    determines if power is sufficient
    battery management
      returns battery capacity
      returns current battery level
      calculates battery percentage
      consumes battery charge correctly
      does not allow battery to go below zero
      charges the battery correctly
      does not allow battery charge to exceed capacity
      calculates battery drain correctly with efficiency
  solar output factor
    #current_solar_output_factor
      queries location solar output factor (FAILED - 139)
      returns 1.0 when no settlement (FAILED - 140)
    #solar_daylight?
      returns true when solar factor > 0.1 (FAILED - 141)
      returns false when solar factor <= 0.1 (FAILED - 142)
    power generation with solar scaling
      scales solar unit output by solar factor (FAILED - 143)
      does not scale non-solar units (FAILED - 144)

FinancialManagement
  associations
    has an account
  #can_afford?
    returns true if account balance is sufficient
    returns false if account balance is insufficient
    handles zero balance
  #charge
    withdraws money from account
    creates a transaction record
    raises error when no account exists
  #credit
    deposits money to account
    creates a transaction record
  #balance
    returns account balance
    returns 0 when no account exists
  #manage_expenses (legacy)
Current balance: 50.0.
    charges account when funds are sufficient
Insufficient funds to cover the cost of 150.
    returns false when funds are insufficient
  #update_balance
    credits positive amounts
    charges negative amounts
  account creation
    creates account after creation with appropriate starting balance and currency

GeosphereConcern
  #reset
    resets attributes to base values
    returns false if base_values are not present
    returns false if base_values lack required keys (FAILED - 145)
    does not modify attributes when base_values are empty (FAILED - 146)
    handles missing base values gracefully
  #extract_volatiles
    extracts volatiles based on temperature increase (FAILED - 147)
    adds gases to atmosphere using chemical formula (FAILED - 148)
    returns empty hash when no volatiles are present
  #add_material
    adds material to the specified layer (FAILED - 149)
    validates the material exists in lookup service
  #remove_material
    removes the specified amount of material
    destroys the material record if amount becomes zero
    returns false if material does not exist
    validates the layer parameter
  #calculate_tectonic_activity
    sets tectonic_activity to true when geological_activity > 50
    sets tectonic_activity to false when geological_activity <= 50
  #update_geological_activity
    calculates and updates geological_activity based on factors
    clamps activity to 0-100 range
  #physical_state
    returns solid for temperature below melting point
    returns liquid for temperature between melting and boiling points
    returns gas for temperature above boiling point
    returns solid as default when material data is missing
  callback hooks
    calls update_material_records when composition changes
    calls update_material_states when temperature changes

HasModules
  #add_module_effect
    applies efficiency boost effect
    applies power consumption reduction effect
  #remove_module_effect
    removes efficiency boost effect
    removes power consumption reduction effect

HasUnits
  #installed_units_count
    returns the total count of all units attached to the craft
  #install_unit
    attaches a unit to the craft (FAILED - 150)
    adds errors if installation fails
    prevents installing a unit that is already attached
      prevents installing a unit that is already attached
  #remove_unit
    detaches a unit from the craft
    returns "Unit not found" if the unit is not attached to this craft
  unit management scenarios
    when max units reached does not create a new unit
    when max units reached returns "Max units reached"
    when unit type is not compatible does not create a new unit
    when unit type is not compatible returns "Unit type ... is not compatible with this craft."
    when unit type is invalid or data not found does not create a new unit
    when unit type is invalid or data not found returns "Invalid unit blueprint ID or data not found."
  #add_unit
    when unit type is valid creates a new persisted unit record
    associates the unit with the craft polymorphically
    applies unit effects to the craft
    returns the created unit object
    can add different types of units
    can add a robot unit

Housing
  population management
    calculates population capacity from habitat units (FAILED - 151)
    uses alias total_capacity for population_capacity (FAILED - 152)
    calculates available capacity (FAILED - 153)
    checks if it has capacity for additional population (FAILED - 154)
    ignores non-habitat units when calculating capacity (FAILED - 155)
    calculates total population from base units (FAILED - 156)

HydrosphereConcern
  #calculate_state_distributions
    calculates H2O state distributions based on temperature
    calculates distributions at boiling point
    uses default values when parameters are not provided
  #hydrosphere_cycle_tick
    handles both evaporation and precipitation
    does nothing when celestial body has no atmosphere
  #calculate_evaporation_rate
    calculates higher evaporation at higher temperatures
    returns zero when there is no atmosphere
  #handle_evaporation
    adds H2O vapor to the atmosphere
    does nothing when evaporation rate is zero
  #handle_precipitation
    moves H2O from atmosphere to hydrosphere
    does nothing when no H2O vapor is in atmosphere
  #add_liquid
    adds H2O to the hydrosphere
    validates material exists in lookup service
    validates amount is positive
  #remove_liquid
    removes liquid from the hydrosphere
    validates amount is positive
    validates material exists in hydrosphere

LifeSupport
  validations
    allows nil population
    validates population is not negative
  #calculate_life_support_requirements
    returns empty hash for zero population
    calculates requirements for given population
  #check_resource_availability
    handles starvation when food is below threshold
    handles resource shortages
  #handle_starvation
    reduces population by death rate

MaterialManagementConcern
  #add_material
    with valid inputs
      validates positive amount
      validates material name presence
      looks up material data using real service
      raises error for unknown material
      creates material with standardized ID
      adds to existing material amount
    when material is a gas
      updates atmosphere composition
  #remove_material
    with valid inputs
      validates positive amount
      validates material name presence
      raises error for unknown material
      raises error for insufficient material
      raises error when material not found
      reduces material amount and saves
      sets amount to zero when fully removed
    when material is a gas
      updates atmosphere composition
  #has_gas_properties?
    returns true for gases
    returns false for non-gas materials
    returns falsy when material not found
  integration with CelestialBody
    works with actual celestial body materials association
    handles material validation errors properly
    correctly identifies gas materials from fixtures

MaterialPropertiesConcern
  #properties
    fetches material properties from lookup service
  #molar_mass_from_properties
    returns molar mass from nested properties
    returns molar mass from top level if nested not available
    returns nil if molar mass not found
  #set_molar_mass_from_material
    sets molar_mass from properties if blank
    does not override existing molar_mass
  #state_at
    returns solid state when temperature is below melting point
    returns liquid state when temperature is between melting and boiling points
    returns gas state when temperature is above boiling point
    returns default state when temperature is nil
    uses default values when melting/boiling points are missing
  state helper methods
    #solid?
      returns true when temperature is below melting point
      returns false when temperature is above melting point
      returns true when default state is solid and no temperature given
    #liquid?
      returns true when temperature is between melting and boiling points
      returns false when temperature is below melting point or above boiling point
      returns true when default state is liquid and no temperature given
    #gas?
      returns true when temperature is above boiling point
      returns false when temperature is below boiling point
      returns true when default state is gas and no temperature given
  #default_state
    returns state_at_room_temp from properties if available
    returns solid if state_at_room_temp not available
  exotic state handling
    identifies exotic states (FAILED - 157)
    calculates phase transitions for exotic conditions (FAILED - 158)

MaterialTransferable
  #transfer_material
    transfers material between spheres
    prevents transfer if insufficient amount
    prevents transfer of non-existent material
    updates existing material in target

Mineable
  #mine_gcc
    mines from satellites and computers (FAILED - 159)
    does not exceed available power (FAILED - 160)

OrbitalMechanics
  #orbital_period_around
    calculates orbital period using Kepler's Third Law
    returns nil if spatial_location is missing
  #barycenter_with
    calculates center of mass for two bodies
    returns nil if spatial_location is missing

Structures::Coverable
  concern inclusion
    includes Enclosable
    inherits all Enclosable functionality
  required interface from Enclosable
    requires width_m to be implemented
    requires length_m to be implemented
  associations
    has construction_jobs association
    has material_requests association
    has equipment_requests association
  attributes
    has cover_status attribute
    defaults cover_status to uncovered
    has panel_type attribute
    has construction_date attribute
    has estimated_completion attribute
  status helpers
    #uncovered?
      returns true when uncovered
      returns true when natural
      returns false when covered
    #covered?
      returns false when uncovered
      returns false when materials requested
      returns false when under construction
      returns true when primary cover installed
      returns true when fully covered
    #under_construction?
      returns true when under construction
      returns false otherwise
    #materials_requested?
      returns true when materials requested
      returns false otherwise
  #schedule_covering!
    creates a construction job (FAILED - 161)
    returns success result (FAILED - 162)
    updates status to materials_requested (FAILED - 163)
    accepts custom panel type (FAILED - 164)
    stores panel_type on coverable (FAILED - 165)
    uses default panel type if not specified (FAILED - 166)
    creates material and equipment requests (FAILED - 167)
    updates shell composition (FAILED - 168)
    fails if already covered (FAILED - 169)
    requires settlement
  #complete_covering!
    completes covering when under construction
    sets construction_date
    fails if not under construction
  #active_construction_job
    returns nil when no construction jobs exist
    returns job with materials_pending status
    returns job with in_progress status
    ignores completed jobs
    returns the first active job if multiple exist
  #calculate_covering_materials
    returns materials hash
    accepts custom panel type
    does not create construction job
    scales materials by area
  #estimate_covering_time
    returns time estimate in hours
    scales with area
    accepts custom panel type
    uses blueprint installation time if available
  #calculate_equipment_needs
    returns array of equipment requirements
    includes tools from blueprint
    includes crew requirements
  area calculations from Enclosable
    #area_m2
      with rectangular dimensions
        calculates area as width × length
      with circular dimensions
        calculates area using diameter
      with very large dimensions
        handles worldhouse scale
    #area_km2
      converts square meters to square kilometers
  integration scenarios
    skylight covering
      handles small circular opening
    worldhouse segment covering
      handles massive rectangular span
    lava tube opening
      handles medium opening (FAILED - 170)
  complete covering workflow
    goes through full lifecycle (FAILED - 171)

Structures::Enclosable
  required interface
    requires width_m to be implemented
    requires length_m to be implemented
  #area_m2
    with rectangular dimensions
      calculates area as width × length
    with circular dimensions
      calculates area using diameter
    with very large dimensions
      handles worldhouse scale
  #area_km2
    converts square meters to square kilometers
    handles small areas
  #calculate_enclosure_materials
    calculates materials from blueprint data
    scales materials by area
    includes panel count in materials
    includes ibeam calculations
  #update_shell_composition
    stores panel composition in operational_data
    can track multiple panel types
  #total_power_generation
    calculates power from solar panels
    returns 0 for non-solar panels
    accounts for failed panels
    accounts for degradation
    combines failures and degradation
  #simulate_panel_degradation
    reduces health percentage over time
    uses degradation_rate from blueprint
    can cause random panel failures
    health cannot go below 0
  #repair_panels
    reduces failed_count
    cannot repair more than failed
    returns materials needed for repair
  #replace_degraded_panels
    improves health percentage
    calculates panels to replace based on percentage
    returns materials needed
    health cannot exceed 100%
  #shell_status_report
    returns comprehensive status
    calculates total panels correctly
    calculates total failed correctly
    calculates average health
    flags maintenance needs when health is low
    provides breakdown per panel type
  #light_transmission
    reads from blueprint properties
    returns 0 if not specified
  #thermal_rating
    reads from blueprint properties
    returns 0 if not specified
  panel blueprint loading
    loads blueprint data flexibly
  scale comparison
    handles small enclosures (skylight)
    handles massive enclosures (worldhouse)

Structures::HasProcessing
  #run_processing_cycle
    runs a complete processing cycle
    returns false if structure cannot process
  #can_process?
    returns true when structure is operational and in production mode
    returns false when not in production mode
    returns false when not operational
    returns false when no processing units are available
  #processing_units
    returns units that can process resources
    filters out non-operational units
    filters out units that cannot process
  #check_resource_levels
    returns true when all required resources are available
    returns false when a required resource is insufficient
    returns false when inventory is nil
  #delegate_processing_to_units
    delegates processing to each unit
    provides resources to units
    returns a hash of processed resources
    returns empty hash when no units can process
  #collect_processing_results
    collects output from processing units
    clears unit output buffers
    returns a hash of collected resources
    returns empty hash when no units have output
  #apply_structure_bonuses
    applies quality bonuses from modules
    returns false when no modules are present
    returns false when no quality modules are present

Structures::Shell
  concern inclusion
    includes Enclosable
    inherits all Enclosable functionality
  associations
    has construction_jobs association
    has material_requests association
    has equipment_requests association
  status helpers
    #shell_planned?
      returns true when planned
      returns false when not planned
    #framework_construction?
      returns true when framework under construction
    #panel_installation?
      returns true when panels being installed
    #sealed?
      returns true when sealed
      returns true when pressurized
      returns false when operational
      returns false when under construction
    #pressurized?
      returns true when pressurized
      returns false when operational
      returns false when only sealed
    #pressurize_shell!
      pressurizes when sealed
      creates atmosphere when pressurized
      fails if not sealed
      fails if already pressurized
    #shell_operational?
      returns true when operational
      returns false when not operational
    #shell_under_construction?
      returns true during framework construction
      returns true during panel installation
      returns false when sealed
  #schedule_shell_construction!
    creates a construction job
    returns success result
    updates status to framework_construction
    accepts custom panel type
    stores panel_type on structure
    sets construction_date (FAILED - 172)
    creates material and equipment requests
    updates shell composition
    fails if already sealed
    requires settlement
  #advance_shell_construction!
    advances from planned to framework_construction
    advances from framework_construction to panel_installation
    advances from panel_installation to operational
    advances from panel_installation to sealed when designed for sealing
    advances from sealed to pressurized
    calls on_shell_operational hook when operational
  #active_construction_job
    returns nil when no construction jobs exist
    returns job with materials_pending status
    returns job with in_progress status
    ignores completed jobs
  #calculate_shell_materials
    returns materials hash
    accepts custom panel type
    does not create construction job
    scales materials by area
  #estimate_shell_construction_time
    returns time estimate in hours
    scales with area
    takes longer than covering equivalent area
    accepts custom panel type
  #calculate_equipment_needs
    returns array of equipment requirements
    includes base construction equipment
    includes panel-specific tools from blueprint
    includes crew requirements
  #calculate_volume
    with rectangular dimensions
      calculates volume with assumed height
    with circular dimensions
      calculates spherical volume
  #create_shell_atmosphere
    creates atmosphere when sealed
    starts unpressurized
    accepts custom temperature
    does not create duplicate atmosphere
    returns nil if not sealed
  integration with space station
    provides all methods needed for space station shell
  complete construction workflow
    goes through full lifecycle

Transactable
  ensures player has an associated account

ConsortiumMembership
  is valid with valid attributes
  is invalid if member is not a corporation (FAILED - 173)
  is invalid with zero investment
  is invalid with ownership_percentage > 100
  scopes active memberships

ConstructionJob

=== MaterialRequest columns ===
  id: integer (bigint)
  requestable_type: string (character varying)
  requestable_id: integer (bigint)
  material_name: string (character varying)
  quantity_requested: decimal (numeric(10,2))
  quantity_fulfilled: decimal (numeric(10,2))
  status: string (character varying)
  priority: string (character varying)
  fulfilled_at: datetime (timestamp(6) without time zone)
  created_at: datetime (timestamp(6) without time zone)
  updated_at: datetime (timestamp(6) without time zone)

=== EquipmentRequest columns ===
  id: integer (bigint)
  requestable_type: string (character varying)
  requestable_id: integer (bigint)
  equipment_type: string (character varying)
  quantity_requested: integer (integer)
  quantity_fulfilled: integer (integer)
  status: string (character varying)
  priority: string (character varying)
  fulfilled_at: datetime (timestamp(6) without time zone)
  created_at: datetime (timestamp(6) without time zone)
  updated_at: datetime (timestamp(6) without time zone)

=== Settlement columns ===
  id: integer (bigint)
  name: string (character varying)
  current_population: integer (integer)
  settlement_type: integer (integer)
  colony_id: integer (bigint)
  accounts_id: integer (bigint)
  base_settlements_type: string (character varying)
  base_settlements_id: integer (bigint)
  owner_type: string (character varying)
  owner_id: integer (bigint)
  length: integer (integer)
  diameter: integer (integer)
  usable_area: float (double precision)
  created_at: datetime (timestamp(6) without time zone)
  updated_at: datetime (timestamp(6) without time zone)
  player_id: integer (bigint)
  panel_type: string (character varying)
  operational_data: jsonb (jsonb)
  debug - shows actual database columns
  validations and attributes
    is valid with required attributes (FAILED - 174)
    requires a jobable (FAILED - 175)
    accepts a valid job_type (FAILED - 176)
    accepts a valid status (FAILED - 177)
    stores target_values as JSON (FAILED - 178)
  associations
    has many material_requests (FAILED - 179)
    has many equipment_requests (FAILED - 180)
    belongs to a jobable (FAILED - 181)
    belongs to a settlement (FAILED - 182)
  enum functionality
    correctly stores and retrieves job_type as an enum (FAILED - 183)
    correctly stores and retrieves status as an enum (FAILED - 184)
  convenience methods
    #materials_gathered?
      returns true when all material requests are fulfilled (FAILED - 185)
      returns false when some material requests are pending (FAILED - 186)
    #equipment_gathered?
      returns true when no equipment requests exist (FAILED - 187)
      returns true when all equipment requests are fulfilled (FAILED - 188)
      returns false when some equipment requests are pending (FAILED - 189)
    #infer_settlement
      returns the jobable's settlement if available (FAILED - 190)
      returns the jobable if it is a Settlement (FAILED - 191)
      finds a settlement by location if available (FAILED - 192)

Craft::BaseCraft
  associations
    example at ./spec/models/craft/base_craft_spec.rb:128 (FAILED - 193)
    example at ./spec/models/craft/base_craft_spec.rb:129 (FAILED - 194)
    example at ./spec/models/craft/base_craft_spec.rb:130 (FAILED - 195)
    example at ./spec/models/craft/base_craft_spec.rb:131 (FAILED - 196)
  location handling
    can access location through helper method (FAILED - 197)
    can switch between spatial and celestial locations (FAILED - 198)
  initialization
    assembles a new craft from inventory and applies the correct variant (FAILED - 199)
  loading craft info
    loads the correct craft data from the lookup service (FAILED - 200)
  player construction
    starts with no units (FAILED - 201)
    allows installing units (FAILED - 202)
    allows uninstalling units (FAILED - 203)
  variant configuration
    loads a variant configuration (FAILED - 204)
    changes between variants (FAILED - 205)
    provides a list of available variants (FAILED - 206)
    handles missing variants gracefully (FAILED - 207)
  atmosphere creation
    creates an atmosphere after creation (FAILED - 208)
  unit integration
    integrates with settlement units (FAILED - 209)

Craft::Harvester
  validations
    is valid with a positive extraction_rate (FAILED - 210)
    is invalid with a negative extraction_rate (FAILED - 211)
  #extract_resources
    when extracting from a valid target
      increases inventory with extracted resources (FAILED - 212)
    when extracting from an invalid target
      raises an error (FAILED - 213)
    when storage is full
      raises an error (FAILED - 214)
  #process_resources
    converts raw material into refined material (FAILED - 215)
    does nothing if no processable materials are present (FAILED - 216)

Craft::Satellite::BaseSatellite
  associations and basic attributes
    has the correct current location string
    can access its location helper
    #needs_atmosphere? returns false for satellites
  #valid_deployment_location?
    when operational data defines specific deployment locations
      permits locations defined in its operational data
      rejects locations not defined in its operational data, even if generally space-based
      rejects clearly non-space deployment locations
    when operational data does NOT define specific deployment locations
      permits general space-based locations from BaseSatellite fallback list
      rejects clearly non-space deployment locations
  #deploy
    updates location string and deployment status if valid
    raises if given invalid deployment location string
  unit loading
    installs the correct recommended units
    when recommended units are specified in operational data
      installs the correct recommended units

Craft::Transport::Cycler
  validations
    is expected to validate that :cycler_type cannot be empty/falsy
    is expected to validate that :orbital_period cannot be empty/falsy
  associations
    is expected to have many docked_crafts
    is expected to have many scheduled_arrivals
    is expected to have many scheduled_departures
  #initialize_trajectory
    sets correct orbital period for earth_mars cycler
    sets correct orbital period for earth_venus cycler
    sets correct orbital period for venus_mars cycler
  #validate_cycler_requirements
    adds error if craft_type is not cycler

Craft::VariantManager
  #initialize
    loads base data and variants (FAILED - 217)
    handles non-existent craft types gracefully
  #available_variants
    returns a list of available variant IDs
    returns an empty array when no variants exist
  #get_variant
    returns nil for non-existent variant
    merges base data with standard variant data (FAILED - 218)
    merges base data with lunar variant data (FAILED - 219)
    properly merges nested hashes (FAILED - 220)

Settlement::Dome
  calculates used capacity (current occupancy) correctly (FAILED - 221)
  calculates remaining capacity correctly (FAILED - 222)
  ensures current occupancy does not exceed total capacity (FAILED - 223)

CelestialBodies::DwarfPlanet
  #calculate_surface_conditions
    calculates surface conditions specific to dwarf planets (FAILED - 224)
  #update_biomes
    updates biomes specific to dwarf planets (FAILED - 225)

Environment
  validations
    is valid with valid attributes (FAILED - 226)
    is not valid without a biome (FAILED - 227)
    is not valid without a planet (FAILED - 228)
    is not valid without a temperature (FAILED - 229)
    is not valid without a pressure (FAILED - 230)
    is not valid without a humidity (FAILED - 231)
  associations
    belongs to a biome (FAILED - 232)
    belongs to a celestial_body (FAILED - 233)

EquipmentRequest
  validations
    is valid with required attributes (FAILED - 234)
    requires an equipment_type (FAILED - 235)
    requires quantity_requested to be present (FAILED - 236)
    requires quantity_requested to be greater than 0 (FAILED - 237)
    requires quantity_requested to be a number (FAILED - 238)
    allows negative quantity_requested to be invalid (FAILED - 239)
  associations
    belongs to a requestable (polymorphic) (FAILED - 240)
    can be associated with different requestable types (FAILED - 241)
  enums
    status enum
      has correct status values
      defaults to pending status (FAILED - 242)
      can be set to different statuses (FAILED - 243)
      accepts string values for status (FAILED - 244)
      provides query methods for each status (FAILED - 245)
    priority enum
      has correct priority values
      defaults to normal priority (FAILED - 246)
      can be set to different priorities (FAILED - 247)
      accepts string values for priority (FAILED - 248)
      provides query methods for each priority (FAILED - 249)
  scopes
    .pending_requests
      returns pending and partially fulfilled requests (FAILED - 250)
    .fulfilled
      returns only fulfilled requests (FAILED - 251)
    .for_equipment
      returns requests for a specific equipment type (FAILED - 252)
      returns empty when no equipment of that type is requested (FAILED - 253)
  instance methods
    #quantity_still_needed
      returns the full quantity when quantity_fulfilled is nil (FAILED - 254)
      returns the difference when quantity_fulfilled is set (FAILED - 255)
      returns 0 when fully fulfilled (FAILED - 256)
      handles quantity_fulfilled being 0 (FAILED - 257)
  factory
    creates a valid equipment request with factory (FAILED - 258)
    creates equipment request with specific attributes (FAILED - 259)
  edge cases and data integrity
    handles very large quantity requests (FAILED - 260)
    maintains data integrity when updating status (FAILED - 261)
    handles equipment_type with special characters (FAILED - 262)

Financial::Account
  associations
    is expected to belong to accountable required: true
    is expected to have many transactions dependent => destroy
  validations
    is expected to validate that :balance looks like a number
  Virtual Ledger (Overdraft) Logic
    when owner is a Player
      strictly prevents negative balances
    when owner is a Colony
      allows the balance to drop below zero (Exodus Oligopoly logic)
  #deposit
    with a valid amount
      increases the account balance
    with an invalid amount (negative)
      raises an error and does not modify the balance
  #withdraw
    when funds are sufficient
      decreases the account balance
    when funds are insufficient
      raises an error for players
  #transfer_funds
    when funds are sufficient
      transfers the amount between accounts
    when currencies differ
      raises a currency mismatch error
  edge cases
    prevents withdrawals from zero balance for players
  different accountable types
    works with a player account
    works with a settlement account
    works with an organization account
  Development Corporation (DC) Trade
    allows creation of consortium organization
    allows DC-to-DC trade on the virtual ledger via operational_data flags (FAILED - 263)

Financial::BondRepayment
  associations
    is expected to belong to bond required: true
    is expected to belong to currency required: true

Financial::Bond
  associations
    is expected to belong to issuer required: true
    is expected to belong to holder required: true
    is expected to belong to currency required: true
    is expected to have many repayments class_name => Financial::BondRepayment dependent => destroy
  validations
    is expected to validate that :amount looks like a number greater than 0
    is expected to validate that :issued_at cannot be empty/falsy
    is expected to validate that :status cannot be empty/falsy
  methods
    calculates total repaid
    checks if paid off

Financial::Currency
  associations
    is expected to have many accounts
    is expected to have many transactions
    is expected to belong to issuer optional: true
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :name is case-sensitively unique
    is expected to validate that :symbol cannot be empty/falsy
    is expected to validate that :symbol is case-sensitively unique
    is expected to allow :is_system_currency to be ‹true› or ‹false›
    is expected to allow :precision to be ‹2›

Financial::Transaction
  associations
    belongs to an account
    belongs to a recipient
  validations
    requires a transaction_type
    requires a valid transaction_type
    requires an amount
    requires amount to be numeric
  transaction types
    allows deposit transactions
    allows withdraw transactions
    allows transfer transactions
    allows tax_collection transactions
  currency precision
    supports high precision for GCC (8 decimal places) (FAILED - 264)

Galaxy
  validations
    validates presence of identifier
    validates uniqueness of identifier
  associations
    has many solar systems
    has one spatial location
  callbacks
    generates a unique name before create if name is not present
    generates a random alphanumeric name if none provided
  galaxy type
    accepts different galaxy types
  #name
    returns the name if present
    returns the identifier if name is not present
  #total_mass
    calculates total mass properly (PENDING: Implement this when total_mass method exists)
  galaxy properties
    can store galaxy attributes
    has expected attributes
  spatial context
    can be assigned a spatial location
  .create_with_random_properties
    creates a galaxy with the given identifier
    uses provided options when given
    generates random properties when not specified
    handles a mix of specified and random properties

Game
  #assign_task
    adds a new task to the task list with correct completion time (FAILED - 265)
  #advance_time
    advances game time and completes a task (FAILED - 266)
  #advance_time with no tasks
    prints a message when there are no tasks (FAILED - 267)

GameState
  attributes
    has accessible year, day, running, speed and last_updated_at attributes
  #update_time!
    updates the game time based on elapsed time when running
    doesn't update time when not running
  #toggle_running!
    toggles the running state
    updates last_updated_at when turning on

CelestialBodies::GasGiant
  #calculate_atmospheric_pressure
    calculates atmospheric pressure based on gas quantities (FAILED - 268)
  #calculate_gravity
    calculates gravity based on mass and radius (FAILED - 269)

CelestialBodies::Spheres::Hydrosphere
  associations
    is expected to belong to celestial_body required: true
    is expected to have many liquid_materials dependent => destroy
  validations
    is expected to validate that :liquid_volume looks like a number (FAILED - 270)
    is expected to validate that :lakes looks like a number (FAILED - 271)
    is expected to validate that :rivers looks like a number (FAILED - 272)
    is expected to validate that :oceans looks like a number (FAILED - 273)
    is expected to validate that :ice looks like a number (FAILED - 274)
  #setup_liquid_materials
    calls update_liquid_materials_from_celestial_body (FAILED - 275)
    calculates the liquid volume after setup (FAILED - 276)
  #update_liquid_materials_from_celestial_body
    adds liquid materials to the hydrosphere (FAILED - 277)
    adds ice to the hydrosphere (FAILED - 278)
  #add_liquid
    distributes liquid between oceans, lakes, and rivers (FAILED - 279)
  #calculate_liquid_volume
    calculates the total liquid volume correctly (FAILED - 280)
  #update_water_cycle
    melts ice when temperature is above freezing (FAILED - 281)
    does not melt ice when temperature is below freezing (FAILED - 282)
  #evaporate_liquids
    evaporates liquids when conditions are met (FAILED - 283)

CelestialBodies::IceGiant
  #calculate_atmospheric_pressure
    calculates atmospheric pressure based on gas quantities (FAILED - 284)
  #calculate_gravity
    calculates gravity based on mass and radius (FAILED - 285)

Inventory
  validations
    is valid with valid attributes
    requires an inventoryable
  #available_capacity
    when surface storage is available
      returns infinity
    when using unit storage
      returns remaining capacity from units
      subtracts stored items from capacity
  #add_item
    when capacity is not exceeded
      stores item in inventory
    when capacity is exceeded
      uses surface storage
    when adding a new item with metadata
      creates a new item in the inventory with the specified metadata
    when adding more amount to an existing item with matching metadata
      updates the amount of the specific existing item
    when adding an item that exists but has different metadata
      creates a new item record with different metadata
  #remove_item
    removes items from storage
    when removing an item with specific metadata
      decreases the amount of the specific item matching metadata
      destroys the specific item if amount becomes zero or less
      returns false if not enough amount of the specific item
      returns false if item with matching name but different metadata not found
    when removing an item with matching name but different metadata exists
      only affects the item with the exactly matching metadata

Item
  associations
    is expected to belong to inventory optional: true
    is expected to belong to container class_name => Item optional: true
    is expected to belong to owner required: true
    is expected to belong to storage_unit optional: true
    is expected to have many contained_items class_name => Item dependent => destroy
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :amount looks like a number greater than or equal to 0
    is expected to validate that :storage_method cannot be empty/falsy
  lookup service integration
    loads properties from item lookup service with category
    handles processed materials
    loads material properties for raw materials
  #container operations
    identifies containers correctly
    adds items to containers
    removes items from containers
    enforces weight capacity limits
  #total_weight
    calculates base weight from properties
    includes contained items in total weight
  #tradeable?
    returns true for normal items with positive amount
    returns false for items with zero amount
    returns false for containers with items
    returns true for empty containers
  regolith handling
    gets composition from celestial body geosphere (FAILED - 286)
    includes source body in properties

CelestialBodies::Materials::Liquid
  associations
    example at ./spec/models/liquid_material_spec.rb:9 (FAILED - 287)
  validations
    is valid with valid attributes (FAILED - 288)
    is not valid without a name (FAILED - 289)
    is not valid without an amount (FAILED - 290)
    is not valid with a negative amount (FAILED - 291)

Location::BaseLocation
  is an abstract class
  associations
    is expected to belong to locationable optional: true
  validations
    presence
      is expected to validate that :name cannot be empty/falsy
  #update_location
    with valid attributes
      updates the attributes

Location::CelestialLocation
  associations
    is expected to belong to celestial_body required: true
    is expected to belong to locationable optional: true
  validations
    is expected to validate that :name cannot be empty/falsy (FAILED - 292)
    is expected to validate that :celestial_body cannot be empty/falsy
    is invalid without coordinates
    is invalid with blank coordinates
    coordinate format
      accepts valid coordinates
      rejects invalid coordinates
    uniqueness validation
      validates that coordinates are case-insensitively unique within the same celestial body
      validates that coordinates are unique with the same case within the same celestial body
      allows the same coordinates on a different celestial body
      allows different coordinates on the same celestial body
    altitude validation
      accepts nil altitude (surface location)
      accepts zero altitude (surface location)
      accepts positive altitude (orbital location)
      rejects negative altitude
  scopes
    .surface_locations
      returns locations with nil or zero altitude
    .orbital_locations
      returns locations with positive altitude
    .low_orbit
      returns locations between 0 and 2,000 km
    .medium_orbit
      returns locations between 2,000 and 35,786 km
    .high_orbit
      returns locations above 35,786 km
  #surface?
    returns true for nil altitude
    returns true for zero altitude
    returns false for positive altitude
  #orbital?
    returns false for surface locations
    returns true for orbital locations
  #orbit_type
    returns nil for surface locations
    returns :low for low orbit (< 2,000 km)
    returns :medium for medium orbit (2,000-35,786 km)
    returns :high for high orbit (> 35,786 km)
  #altitude_km
    returns nil for surface locations
    converts meters to kilometers
  #altitude_km=
    sets altitude from kilometers
    sets nil from nil
  #latitude
    parses positive latitude from North coordinates
    parses negative latitude from South coordinates
    handles zero latitude
  #longitude
    parses positive longitude from East coordinates
    parses negative longitude from West coordinates
    handles zero longitude
  orbital mechanics
    #orbital_period
      returns nil for surface locations (FAILED - 293)
      calculates period for orbital locations (FAILED - 294)
      returns nil if celestial body lacks required methods
    #orbital_velocity
      returns nil for surface locations (FAILED - 295)
      calculates velocity for orbital locations (FAILED - 296)
      returns nil if celestial body lacks required methods
    #gravity
      returns surface gravity for surface locations (FAILED - 297)
      calculates reduced gravity at altitude (FAILED - 298)
      returns nil if celestial body lacks required methods
  #description
    describes surface locations (FAILED - 299)
    describes orbital locations (FAILED - 300)
  #full_coordinates
    returns coordinates for surface locations
    includes altitude for orbital locations

Location::SpatialLocation
  associations
    is expected to belong to spatial_context optional: true
    is expected to belong to locationable optional: true
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :x_coordinate cannot be empty/falsy
    is expected to validate that :y_coordinate cannot be empty/falsy
    is expected to validate that :z_coordinate cannot be empty/falsy
    is expected to validate that :x_coordinate looks like a number
    is expected to validate that :y_coordinate looks like a number
    is expected to validate that :z_coordinate looks like a number
    validates uniqueness of 3D position
    validates uniqueness of 3D position within same spatial context
    allows same coordinates in different spatial contexts
  #update_location
    updates coordinates (FAILED - 301)
  #distance_to
    calculates 3D distance between locations

Logistics::Contract
  validations
    is valid with required attributes
    requires material
    requires quantity greater than 0
  enums
    defines status enum
    defines transport_method enum
  scopes
    has active scope
    has completed scope
  instance methods
    #mark_delivered!
      updates status to delivered and sets completed_at
    #mark_failed!
      updates status to failed and records reason

Market::Condition
  associations
    is expected to belong to marketplace class_name => Market::Marketplace required: true
    is expected to have many market_orders class_name => Market::Order dependent => destroy
    is expected to have many price_histories dependent => destroy
    is expected to have many orders dependent => destroy
  #current_price
    returns the latest price from price_histories
    returns default price if no price_histories exist

Market::Marketplace
  associations
    is expected to belong to settlement class_name => Settlement::BaseSettlement required: true
    is expected to have many market_conditions class_name => Market::Condition dependent => destroy
  table configuration
    uses the correct table name
  #current_market_condition
    returns the market condition for a given resource
    returns nil for a resource that does not exist
  #find_matching_orders
    when order is a Sell order
      calls the settlement NPC methods (FAILED - 302)
    when order is not a Sell order
      returns an empty array (FAILED - 303)
  #place_order
    creates an order (FAILED - 304)
    converts volume parameter to quantity (FAILED - 305)
    sets the base_settlement_id (FAILED - 306)
    removes unused parameters (FAILED - 307)
    when order is fully filled
      returns nil (FAILED - 308)
      sets order quantity to zero (FAILED - 309)
    when order is partially filled
      returns the order (FAILED - 310)
    when no matching orders exist
      returns the unfilled order (FAILED - 311)
  #execute_trades
    delegates the entire trade execution to Market::TradeExecutionService (FAILED - 312)
    updates the order quantity to zero when fully filled (FAILED - 313)
    wraps the execution in a transaction (FAILED - 314)
    when partially filled
      updates the order quantity to remaining amount (FAILED - 315)

Market::Order
  is valid with valid attributes
  requires a market_condition
  requires an orderable
  belongs to market_condition
  supports polymorphic orderable association
  is invalid without quantity
  is invalid without order_type
  can be associated with a base_settlement_id

Market::PriceHistory
  associations
    is expected to belong to market_condition class_name => Market::Condition required: true
  validations
    is valid with valid attributes
    is not valid without a price

Market::Settings
  can create a settings record
  defaults transportation_cost_per_kg to nil

Market::SupplyChain
  is valid with valid attributes
  requires a market_order
  can track status changes
  scopes active supply chains

Market::Trade
  associations
    is expected to belong to buyer required: true
    is expected to belong to seller required: true
    is expected to belong to buyer_settlement class_name => Settlement::BaseSettlement required: true
    is expected to belong to seller_settlement class_name => Settlement::BaseSettlement required: true
  validations
    is valid with valid attributes

Market::TransactionFee
  validations
    is expected to validate that :fee_type cannot be empty/falsy (FAILED - 316)
    is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"› (FAILED - 317)
    is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil (FAILED - 318)
    is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil (FAILED - 319)
  #calculate
    calculates percentage fee (FAILED - 320)
    calculates fixed fee (FAILED - 321)
    returns 0 for unknown fee_type (FAILED - 322)

MaterialRequest
  validations
    is valid with required attributes (FAILED - 323)
    requires a material_name (FAILED - 324)
    requires quantity_requested to be present (FAILED - 325)
    requires quantity_requested to be greater than 0 (FAILED - 326)
    requires quantity_requested to be a number (FAILED - 327)
  associations
    belongs to a requestable (polymorphic) (FAILED - 328)
    can be associated with different requestable types (FAILED - 329)
  enums
    status enum
      has correct status values
      defaults to pending status (FAILED - 330)
      can be set to different statuses (FAILED - 331)
      accepts string values for status (FAILED - 332)
    priority enum
      has correct priority values
      defaults to normal priority (FAILED - 333)
      can be set to different priorities (FAILED - 334)
      accepts string values for priority (FAILED - 335)
  scopes
    .pending_requests
      returns pending and partially fulfilled requests (FAILED - 336)
    .fulfilled
      returns only fulfilled requests (FAILED - 337)
    .for_material
      returns requests for a specific material (FAILED - 338)
  delegations
    delegates settlement to requestable (FAILED - 339)
    handles nil settlement gracefully (FAILED - 340)
  instance methods
    #quantity_still_needed
      returns the full quantity when quantity_fulfilled is nil (FAILED - 341)
      returns the difference when quantity_fulfilled is set (FAILED - 342)
      returns 0 when fully fulfilled (FAILED - 343)
    #gas_request?
      returns true when material is a gas (FAILED - 344)
      returns false when material is not a gas (FAILED - 345)
      returns false when material data is not found (FAILED - 346)
      returns false when material data has no category (FAILED - 347)
  factory
    creates a valid material request with factory (FAILED - 348)

CelestialBodies::Material
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without an amount
    is not valid with a negative amount
    is not valid without a state (FAILED - 349)
    is valid with a valid state (solid, liquid, gas)
    is not valid with an invalid state (FAILED - 350)
    is valid with valid melting and boiling points
    is not valid with non-numeric melting and boiling points (FAILED - 351)
  associations
    belongs to a celestial body
  #state_at
    returns "solid" when temperature is below the adjusted melting point (FAILED - 352)
    returns "liquid" when temperature is between the adjusted melting and boiling points (FAILED - 353)
    returns "gas" when temperature is above the adjusted boiling point (FAILED - 354)

Modules::BaseModule
  associations
    is expected to belong to attachable optional: true
    accepts craft as polymorphic attachable
    accepts structure as polymorphic attachable
    can be created without attachable
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :module_type cannot be empty/falsy
    is expected to validate that :identifier cannot be empty/falsy
    creates valid module with all required fields
  callbacks
    before_validation :load_module_data on create
      when module data is found
        loads CO2 scrubber data from lookup service
        does not override existing name if already set
      when module data is not found
        does not crash when module type doesnt exist
    after_create :apply_module_to_attachable
      applies module to craft when created with craft attachable
      applies module to structure when created with structure attachable
      does not crash when created without attachable
    before_destroy :remove_module_from_attachable
      removes module from craft when destroyed
      removes module from structure when destroyed
      does not crash when destroyed without attachable
  instance methods
    #operational_status
      returns operational status from loaded data
      returns inactive when operational_data is missing
    #input_resources
      returns input resources from loaded data
      returns empty array when operational_data is missing
    #output_resources
      returns output resources from loaded data
    #consumables
      returns consumables from loaded data
  AtmosphericProcessing integration
    #can_process_atmosphere?
      returns true for CO2 scrubber module
      returns false for basic life support module
    #atmospheric_capabilities
      identifies CO2 scrubbing capability
    #max_processing_rate
      returns correct rates for CO2 scrubber
  factory integration
    creates valid module using existing factory
    creates CO2 scrubber with trait
  error handling
    handles missing operational_data gracefully
    handles empty operational_data gracefully

OrbitalConstructionProject
  associations
    is expected to belong to station class_name => Settlement::BaseSettlement required: true
  validations
    is expected to validate that :craft_blueprint_id cannot be empty/falsy
    is expected to validate that :progress_percentage looks like a number greater than or equal to 0 and less than or equal to 100
  enums
    is expected to define :status as an enum backed by an integer with values ‹{materials_pending: 0, in_progress: 1, completed: 2, failed: 3, canceled: 4}›
  #materials_complete?
    when all required materials are delivered
      returns true
    when some materials are missing
      returns false
    when materials exceed requirements
      returns true
  #completion_percentage
    when no materials are delivered
      returns 0
    when half materials are delivered
      returns 50
    when all materials are delivered
      returns 100
  JSONB storage
    stores required_materials as JSONB
    stores delivered_materials as JSONB
    stores project_metadata as JSONB

OrbitalRelationship
  associations
    belongs to primary_body polymorphically (FAILED - 355)
    belongs to secondary_body polymorphically (FAILED - 356)
  validations
    is valid with valid attributes (FAILED - 357)
    relationship_type validation
      requires relationship_type to be present (FAILED - 358)
      validates relationship_type inclusion (FAILED - 359)
    numerical validations
      validates distance is positive (FAILED - 360)
      validates semi_major_axis is positive (FAILED - 361)
      validates eccentricity is between 0 and 1 (FAILED - 362)
      validates orbital_period is positive (FAILED - 363)
    uniqueness validation
      prevents duplicate relationships between same bodies (FAILED - 364)
  backward compatibility methods
    #sun
      returns primary_body when it's a Star (FAILED - 365)
      returns nil when primary_body is not a Star (FAILED - 366)
    #sun=
      sets primary_body and relationship_type (FAILED - 367)
    #celestial_body
      returns secondary_body when it's a CelestialBody (FAILED - 368)
    #celestial_body=
      sets secondary_body (FAILED - 369)
  relationship type helpers
    identifies star_planet relationships (FAILED - 370)
    identifies planet_moon relationships (FAILED - 371)
    identifies binary_star relationships (FAILED - 372)
  energy calculations
    #stellar_energy_input
      calculates stellar energy based on luminosity and distance (FAILED - 373)
      returns 0 when primary_body doesn't have luminosity (FAILED - 374)
    #tidal_heating
      calculates tidal heating for planet-moon relationships (FAILED - 375)
      includes eccentricity factor in calculation (FAILED - 376)
    #energy_input
      returns stellar energy for star_planet relationships (FAILED - 377)
      returns combined tidal and reflected energy for planet_moon relationships (FAILED - 378)
  terraforming reflected_energy and energy_input
    returns extra energy for star_planet with orbital mirrors and albedo adjustment (FAILED - 379)
  orbital mechanics
    #orbital_distance
      returns semi_major_axis when available (FAILED - 380)
      falls back to distance when semi_major_axis is nil (FAILED - 381)
      returns 0 when both are nil (FAILED - 382)
    #calculated_orbital_period
      calculates orbital period using Kepler's Third Law (FAILED - 383)
      returns nil when primary_body has no mass (FAILED - 384)
    #current_orbital_position
      calculates orbital position based on time (FAILED - 385)
      returns nil when orbital_period or epoch_time is missing (FAILED - 386)
  private methods
    #masses_present?
      returns true when both bodies have mass (FAILED - 387)
      returns false when primary_body has no mass (FAILED - 388)
    #extract_mass
      extracts mass from Star objects (FAILED - 389)
      extracts and converts mass from CelestialBody objects (FAILED - 390)
      returns nil for unsupported object types (FAILED - 391)

Organizations::BaseOrganization
  renders a text-based dashboard for a member
  renders a text-based dashboard for a non-member

Organizations::BaseOrganization
  distributes profits to members based on ownership (FAILED - 392)

Organizations::TaxAuthority
  .instance
    creates the Tax Authority if it does not exist
    always returns the same single instance (FAILED - 393)
    initializes with the correct identifier and name
  #tax_rate
    always returns 0.0, as the Tax Authority does not pay tax

PlanetBiome
  example at ./spec/models/planet_biome_spec.rb:15 (FAILED - 394)
  example at ./spec/models/planet_biome_spec.rb:16 (FAILED - 395)
  is valid with valid attributes (FAILED - 396)
  is not valid without a biome (FAILED - 397)
  is not valid without a celestial_body (FAILED - 398)

PlantEnvironment
  validations
    is valid with valid attributes (FAILED - 399)
    is not valid without a plant (FAILED - 400)
    is not valid without an environment (FAILED - 401)
    is not valid with duplicate plant and environment pair (FAILED - 402)
  associations
    belongs to a plant
    belongs to an environment

Plant
  validations
    is valid with valid attributes (FAILED - 403)
    is not valid without a name
    is not valid without a growth temperature range
    is not valid without a growth humidity range
    is not valid with a duplicate name
  methods
    can grow in a given environment if conditions are met (FAILED - 404)
    cannot grow in a given environment if conditions are not met (FAILED - 405)

Player
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without an active_location
  account balance
    has a balance of 1000
  inventory at active location
    raises an error if active location is not set
    returns the inventory at the active location

Rigs::BaseRig
  detach/destroy behavior
    destroys the rig when removed from attachable
  validations
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :description cannot be empty/falsy
    is expected to validate that :rig_type cannot be empty/falsy
    is expected to validate that :capacity cannot be empty/falsy
    is expected to validate that :capacity looks like a number greater than or equal to 0
  #apply_rig_to_attachable
    applies rig effect to the attachable unit (FAILED - 406)
  #remove_from
    removes rig effect from the attachable unit (FAILED - 407)
  polymorphic association
    can belong to an attachable BaseUnit (FAILED - 408)
    can be unattached from a unit
  operational data
    has an operational_data field with default values
    can store and update operational data
  .load_from_json
    creates a new rig instance from JSON data
  #process_tick
    does not raise error when called
  #apply_output_effects and #revert_output_effects
    applies and reverts output effects if attachable responds to update_outputs (FAILED - 409)
  #apply_damage_effects and #revert_damage_effects
    applies and reverts damage effects if attachable responds to update_damage_risks (FAILED - 410)

RouteProposal
  calculates vote outcome based on threshold (FAILED - 411)
  fails if votes do not meet threshold (FAILED - 412)

RouteProposalVote
  is valid with valid attributes (FAILED - 413)
  is invalid with an invalid vote value (FAILED - 414)

Settlement::BaseSettlement
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid with a negative current population
    is not valid with a non-integer current population
  associations
    can belong to a player
    has many docked crafts
    has many base units
    has a marketplace association using the correct foreign key
    has a financial account
    destroys the marketplace when destroyed
  storage capacity
    calculates storage capacity by type
    maintains backward compatibility with total storage capacity (liquid and gas only)
    calculates total storage capacity (sum of all storage types)
  Market Integration
    #npc_market_bid
      calls the NpcPriceCalculator with the correct arguments
      returns the calculated price
    #npc_buy_capacity
      when storage is the limiting factor (50 units)
        limits capacity by available storage (50)
      when finances are the limiting factor (20 units)
        limits capacity by financial ability (20)
      when bid price is zero
        returns 0 capacity
      when account or inventory is missing
        returns 0 capacity if account is missing
        returns 0 capacity if inventory is missing
  after_create hooks
    creates a financial account and inventory
  celestial body delegation
    delegates celestial_body to location
  #process_materials
    processes materials using base units
  operational_data
    can store and retrieve operational data
    provides default empty hash if operational_data is empty
    works with energy management methods
  construction cost management
    #construction_cost_percentage
      returns default percentage when not set
      returns custom percentage when set in operational_data
      handles empty operational_data gracefully
      handles missing manufacturing section gracefully
      handles empty operational_data gracefully
    #construction_cost_percentage=
      sets the construction cost percentage in operational_data
      initializes operational_data manufacturing section if empty
      preserves existing operational_data when setting percentage
    #calculate_construction_cost
      calculates construction cost as percentage of purchase cost
      rounds to 2 decimal places
      handles zero purchase cost
      handles string input by converting to float
      handles nil input gracefully
    manufacturing settings
      supports manufacturing efficiency setting
      defaults manufacturing efficiency to 1.0
      supports equipment check setting
      defaults equipment check to true
  construction cost integration
    integrates construction cost calculations with settlement manufacturing data
    preserves other operational_data when updating construction settings
    works correctly when operational_data starts empty

Settlement::City
  validations
    is valid with valid attributes (FAILED - 415)
    is not valid without a location (FAILED - 416)
    is not valid without a name (FAILED - 417)
    is not valid with a negative current population (FAILED - 418)
    is not valid with food_per_person less than or equal to zero (FAILED - 419)
    is not valid with water_per_person less than or equal to zero (FAILED - 420)
    is not valid with energy_per_person less than or equal to zero (FAILED - 421)
  #resource_requirements
    calculates resource requirements correctly (FAILED - 422)

Settlement::NPCColony
  can build a unit (FAILED - 423)
  can establish trade routes (FAILED - 424)
  can perform autonomous tasks (FAILED - 425)
  calculates total population across settlements (FAILED - 426)

Settlement::OrbitalDepot
  inheritance
    inherits from SpaceStation
    inherits from BaseSettlement
  #add_gas
    adds gas to inventory
    stores gas amount correctly
    accumulates multiple additions
    stores metadata with gas
    handles multiple gas types
    raises error for negative amounts
  #remove_gas
    removes gas from inventory
    caps removal at available amount
    returns 0 when gas not available
    filters by metadata when provided
    raises error for negative amounts
  #get_gas
    returns 0 for non-existent gas
    returns correct amount for existing gas
    filters by metadata when provided
  #has_gas?
    returns true when sufficient gas available
    returns false when insufficient gas
    returns false for non-existent gas
  #total_gas_mass
    returns 0 when empty
    sums all gas types
    excludes non-gas items if present
  #gas_inventory_summary
    returns empty hash when no gases
    groups by gas name
  #depot_status
    returns comprehensive status hash
  realistic terraforming scenario
    handles H2 import from Saturn for O2 management
    handles Sabatier reaction H2 consumption
    tracks multiple import batches
  integration with TerraformingManager
    provides interface compatible with PORO OrbitalDepot

Settlement::Outpost
  validations
    is valid with valid attributes (FAILED - 427)
    is not valid without a name (FAILED - 428)
  population capacity
    calculates total capacity from habitat units (FAILED - 429)
    calculates available capacity correctly (FAILED - 430)
    checks if it has capacity for additional population (FAILED - 431)

Settlement::Settlement
  validations
    is valid with valid attributes (FAILED - 432)
    is not valid without a name (FAILED - 433)
  population capacity
    calculates total capacity from habitat units (FAILED - 434)
    calculates available capacity correctly (FAILED - 435)
    checks if it has capacity for additional population (FAILED - 436)

Settlement::SpaceStation
  model structure
    inherits from BaseSettlement
    includes LifeSupport
    includes Docking
    includes Shell concern
    inherits Enclosable through Shell
  validations
    validates settlement_type is station or outpost
  associations
    is expected to have many storage_units
    is expected to have many docked_crafts
    is expected to have one atmosphere
  dimensional interface (from Enclosable)
    #set_dimensions
      stores dimensions in operational_data
      can set diameter for cylindrical stations
    #area_m2
      calculates area for rectangular station
      calculates area for cylindrical station
    #calculate_volume
      calculates volume for rectangular station
      calculates volume for cylindrical station
  shell construction workflow (from Shell concern)
    #schedule_shell_construction!
      returns success result with materials and time estimate
      updates status to framework_construction
      accepts custom panel type
      updates shell composition
    construction phases
      advances through construction phases
      creates atmosphere when sealed
      does not initialize default modules when operational
    status helpers
      responds to Shell concern status methods
      checks sealed status correctly
      checks pressurized status correctly
  power generation (from Enclosable)
    calculates power generation from solar panels
    accounts for panel degradation
    accounts for failed panels
  panel degradation and maintenance (from Enclosable)
    simulates panel degradation over time
    can repair failed panels
    can replace degraded panels
    provides shell status report
  storage capacity management
    #calculate_storage_capacity
      returns 0 when no storage units exist
      sums capacity from all storage units
      ignores units without storage capacity
    #available_capacity
      returns total capacity when empty
      subtracts current inventory mass
    #can_store?
      returns true when sufficient capacity available
      returns false when insufficient capacity
  module management
    #add_module
      adds a new module to the station
      requires station to be operational
    module type queries
      filters modules by type
    #habitat_capacity
      sums capacity from all habitat modules
    #research_efficiency
      sums efficiency from all lab modules
  operational status
    #fully_operational?
      requires shell to be operational
      requires habitat modules
    #station_status
      returns comprehensive status
  damage and repair
    can damage modules
    repairs damaged modules and shell
  integration scenarios
    orbital depot inheriting from space station
      inherits all Shell/Enclosable functionality
      adds depot-specific gas storage
    complete station lifecycle
      goes from planned to fully operational

ShellPrintingJob
  associations
    is expected to belong to settlement required: true
    is expected to belong to printer_unit required: true
    is expected to belong to inflatable_tank required: true
  validations
    is expected to validate that :status cannot be empty/falsy
    is expected to validate that :production_time_hours cannot be empty/falsy
    is expected to validate that :production_time_hours looks like a number greater than 0
  scopes
    returns active jobs (FAILED - 437)
    returns completed jobs (FAILED - 438)
    returns in_progress jobs (FAILED - 439)
  #start!
    changes status to in_progress and sets started_at (FAILED - 440)
  #complete!
    changes status to completed and sets completed_at (FAILED - 441)
  #progress_percentage
    calculates progress percentage (FAILED - 442)
  #time_remaining_hours
    calculates remaining time (FAILED - 443)
  #process_tick
    when job is not complete
      increases progress_hours (FAILED - 444)
    when job completes during tick
      completes the job (FAILED - 445)

SolarSystem
  associations
    has one spatial_location association (FAILED - 446)
    example at ./spec/models/solar_system_spec.rb:30 (FAILED - 447)
    example at ./spec/models/solar_system_spec.rb:31 (FAILED - 448)
    example at ./spec/models/solar_system_spec.rb:32 (FAILED - 449)
    example at ./spec/models/solar_system_spec.rb:33 (FAILED - 450)
    example at ./spec/models/solar_system_spec.rb:34 (FAILED - 451)
    example at ./spec/models/solar_system_spec.rb:35 (FAILED - 452)
    example at ./spec/models/solar_system_spec.rb:36 (FAILED - 453)
    example at ./spec/models/solar_system_spec.rb:38 (FAILED - 454)
  validations
    example at ./spec/models/solar_system_spec.rb:42 (FAILED - 455)
    example at ./spec/models/solar_system_spec.rb:43 (FAILED - 456)
  callbacks
    generates a unique name before create if name is not present (FAILED - 457)
    sets an initial star after create if no stars exist (FAILED - 458)
  #load_star
    loads or creates a star with the given parameters (FAILED - 459)
    updates an existing star if the name matches (FAILED - 460)
  #load_terrestrial_planet
    loads or creates a terrestrial planet (FAILED - 461)
    updates an existing terrestrial planet if the name matches (FAILED - 462)
  #load_gas_giant
    loads or creates a gas giant (FAILED - 463)
    updates an existing gas giant if the name matches (FAILED - 464)
  #load_ice_giant
    loads or creates an ice giant (FAILED - 465)
    updates an existing ice giant if the name matches (FAILED - 466)
  #load_moon
    loads or creates a moon (FAILED - 467)
    updates an existing moon if the name matches (FAILED - 468)
  #load_dwarf_planet
    loads or creates a dwarf planet (FAILED - 469)
    updates an existing dwarf planet if the name matches (FAILED - 470)
  #habitable_zone?
    when a planet is in the habitable zone of at least one star
      returns true (FAILED - 471)
    when a planet is outside the habitable zone of all stars
      returns false (FAILED - 472)
    when there are no stars
      returns false (FAILED - 473)
    when the planet does not have an orbital period
      returns false (FAILED - 474)
  #total_mass
    calculates total mass of all planets and dwarf planets (FAILED - 475)
  star relationships
    can have multiple stars (FAILED - 476)
    identifies the primary star by mass (FAILED - 477)
    supports binary star systems (FAILED - 478)

SpecialMission
  is expected to belong to settlement class_name => Settlement::BaseSettlement required: true
  is expected to validate that :material cannot be empty/falsy
  is expected to validate that :required_quantity cannot be empty/falsy
  is expected to validate that :required_quantity looks like a number greater than 0
  is expected to validate that :reward_eap cannot be empty/falsy
  is expected to validate that :reward_eap looks like a number greater than 0
  enums
    defines status enum
  scopes
    has open scope
  instance methods
    #accept!
      updates status to accepted
    #complete!
      updates status to completed
    #total_reward
      returns the reward_eap

Storage::BaseStorage
  #add_item
Storage unit initialized with a capacity of 100 kg.
    adds item successfully (FAILED - 479)
Storage unit initialized with a capacity of 100 kg.
    fails to add item if not enough capacity
  #remove_item
Storage unit initialized with a capacity of 100 kg.
    removes item successfully (FAILED - 480)
Storage unit initialized with a capacity of 100 kg.
    fails to remove item if not enough available (FAILED - 481)

Storage::GasStorage
  initializes with the correct type (FAILED - 482)

Storage::SolidStorage
  initializes with the correct type (FAILED - 483)

Storage::SurfaceStorage
  validations
    validates presence of required attributes
  #add_pile
    creates a new material pile
    updates existing pile amount
    returns false when material_name is invalid
  #check_item_conditions
    when atmosphere contains corrosive gases
      applies surface conditions to the item
    when atmosphere does not contain corrosive gases
      does not corrode the item

Structures::BaseStructure
  validations
    is valid with valid attributes
    is not valid without a name
    is not valid without a structure_name
    is not valid without a structure_type
  associations
    belongs to a settlement
    belongs to an owner
    has many base_units
    has many modules
  #operational?
    returns false when missing required units
    returns false when power system is offline
    returns true when all requirements are met
    returns false when in maintenance mode
  unit management
    #install_unit
      installs a unit if slot is available
      fails if no slot is available
    #uninstall_unit
      removes an installed unit
      fails for units not attached to the structure
    #build_recommended_units
      builds the recommended units
  module management
    #build_recommended_modules
      builds the recommended modules
  operational mode management
    #current_mode
      returns the current operational mode
      returns 'standby' as default if not set
    #set_operational_mode
      changes the operational mode if valid
      fails if mode is invalid
    #available_modes
      returns all available operational modes
      returns ['standby'] as default if not set
  module effect management
    supports adding and removing module effects via HasModules concern

CelestialBodies::TerrestrialPlanet
  runs TerraSim on planet creation (FAILED - 484)
  #update_biomes
    updates biomes specific to terrestrial planets (FAILED - 485)
  #add_gas
    adds gas and updates the mass (FAILED - 486)
  #calculate_surface_conditions
    calculates surface conditions specific to terrestrial planets (FAILED - 487)

Transaction
  associations
    belongs to an account
    belongs to a recipient
  validations
    requires a transaction_type
    requires a valid transaction_type
    requires an amount
    requires amount to be numeric
  transaction types
    allows deposit transactions
    allows withdraw transactions
    allows transfer transactions

UnitAssemblyJob
  associations
    is expected to belong to base_settlement required: true
    is expected to have many material_requests
  validations
    is expected to validate that :base_settlement cannot be empty/falsy
    is expected to validate that :unit_type cannot be empty/falsy
    is expected to validate that :count cannot be empty/falsy
  #settlement delegation
    delegates settlement to base_settlement
  #materials_gathered?
    returns false when not all materials are fulfilled (FAILED - 488)
    returns true when all materials are fulfilled (FAILED - 489)
    returns true when no material requests exist (FAILED - 490)
  #start_assembly
    starts assembly when materials are gathered (FAILED - 491)
    consumes materials from inventory (FAILED - 492)
    returns false when not materials_pending status (FAILED - 493)
  #complete_assembly
    creates unassembled items in inventory
    marks job as completed
    returns false when not in_progress
  scopes
    .active
      returns jobs that are not completed/failed/canceled

Units::BaseUnit
  validations
    is expected to validate that :identifier cannot be empty/falsy
    is expected to validate that :name cannot be empty/falsy
    is expected to validate that :unit_type cannot be empty/falsy
  associations
    is expected to belong to owner required: true
    is expected to belong to attachable optional: true
    is expected to have many attached_units
    is expected to have one location
    is expected to have one inventory
  create new unit
    creates a valid unit with given attributes
  location and celestial body
    returns the correct location
    returns the correct celestial body
  storage operations
    #store_resource
      stores oxygen in liquid state
      prevents overfilling tank
      validates storage compatibility
    #store_item
      stores items in both inventory and operational data (FAILED - 494)
      respects storage capacity limits
      updates existing items (FAILED - 495)
  general storage operations
    #store_resource
      can store items up to capacity
      tracks available capacity
  inventory integration
    #store_resource
      creates inventory items when storing resources
      updates inventory when removing resources
  unit initialization
    loads correct storage configuration
  #process_resources
    processes material based on composition
  #store_on_surface
    calls add_pile on surface storage
    returns false if attachable does not respond to :surface_storage
    returns false if surface_storage returns nil

Units::Battery
  battery attributes
    reports correct battery capacity
    reports correct battery level
    calculates battery percentage correctly
    handles zero capacity
  #charge_battery
    charges the battery by the specified amount
    limits charging to max charge rate
    limits charging to battery capacity
  #discharge_battery
    discharges the battery by the specified amount
    limits discharging to max discharge rate
    limits discharging to available charge
  interaction with BatteryManagement concern
    has both specialized and concern methods
    prefers specialized methods over concern methods (FAILED - 496)

#overclock
  temporarily increases mining rate

Units::Computer
  attributes
    is expected to respond to #mining_rate_value
    is expected to respond to #efficiency_upgrade_value
    has default values
  #mine
    calculates GCC based on mining rate and efficiency
  #energy_required
    returns default energy required value
  #total_efficiency
    calculates total efficiency with upgrades
  #upgrade_efficiency
    increases efficiency upgrade value
  #overclock
    temporarily increases mining rate

Units::WasteTreatmentUnit
  #operate
Before operation: {"waste" => 50, "energy" => 50, "recycled_materials" => 0, "neutralized_waste" => 0}
    operates successfully and produces recycled and neutralized output (FAILED - 497)
    returns false if insufficient waste is available (FAILED - 498)
    returns false if insufficient power is available (FAILED - 499)

Wormhole
  associations
    is expected to belong to solar_system_a class_name => SolarSystem required: true
    is expected to belong to solar_system_b class_name => SolarSystem required: true
    is expected to have many endpoints class_name => SpatialLocation dependent => destroy (FAILED - 500)
    is expected to have many stabilizers class_name => Craft::BaseCraft inverse_of => stabilizing_wormhole
  validations
    is expected to validate that :solar_system_a cannot be empty/falsy
    is expected to validate that :solar_system_b cannot be empty/falsy
    is expected to validate that :wormhole_type cannot be empty/falsy
    validates different systems
    does not allow zero or negative mass limits
  after creation
    generates endpoints in both systems
  #stabilization_satellites
    returns deployed stabilization satellites within range of either endpoint (FAILED - 501)
  #operational_stabilizers
    returns a unique list of operational direct stabilizers and stabilization satellites (FAILED - 502)
  #appearance_profile
    when natural wormhole
      and stable without artificial station
        returns :naturally_anchored
      and unstable
        returns :exotic_anomalous
      and has hazard zone
        returns :exotic_anomalous
      and has exotic resources
        returns :exotic_anomalous
      and has artificial station built
        returns :artificial_only_stabilized
    when artificial wormhole
      returns :artificial_only_stabilized
  #safe_for_travel?
    with insufficient operational stabilizers
      is not safe
    with enough operational stabilizers
      is safe
  #can_traverse?
    with sufficient mass limit
      returns true (FAILED - 503)
    with insufficient mass limit
      returns false (FAILED - 504)
    when one-way and already traversed
      returns false (FAILED - 505)
  #traverse!
    with endpoint shifting
      randomizes coordinates of endpoint A when not stabilized and mass limit is hit (FAILED - 506)
      randomizes coordinates of endpoint B when not stabilized and mass limit is hit (FAILED - 507)
      does not shift stabilized endpoint A when mass limit is hit (FAILED - 508)
      does not shift stabilized endpoint B when mass limit is hit (FAILED - 509)
  #stabilization_satellites (integration)
All matching satellites: 3, IDs: 209, 210, 211
    returns deployed stabilization satellites within range of either endpoint

AIManager::AiPrioritySystem
  #check_critical
    sorts issues by priority descending
    when life support is critical
      returns life support issue with highest priority
    when atmospheric maintenance is critical
      returns atmospheric issue with high priority
    when debt is critical
      returns debt issue with medium-high priority
  #check_operational
    when resource procurement is needed
      returns resource procurement need
    when construction is needed
      returns construction need
  #can_expand?
    when settlement has critical issues
      returns false
    when settlement has operational needs
      returns false
    when settlement is stable
      returns true
  priority constants
    defines critical priorities
    defines operational priorities

AIManager::DecisionTree
  #make_decisions
    when oxygen is critical
      calls handle_oxygen_refill and returns
    when account is negative
      calls handle_debt_repayment and returns
    when no priorities
      proceeds with normal decision making
  #handle_oxygen_refill
    calls prioritize_oxygen_refill on resource_planner
  #handle_debt_repayment
    sets si_ask_ceiling in settlement operational_data
  #handle_mars_oxygen_maintenance
    calls prioritize_energy_for_o2_generation on resource_planner (FAILED - 510)
  #handle_mars_nitrogen_import
    finds closest resource source and creates interplanetary contract (FAILED - 511)
  Mars planet-aware crisis handling
    when O2 crisis on Mars
      handles O2 crisis through local maintenance, not trade
    when N2 crisis on Mars
      triggers interplanetary contract based on closest source

AIManager::ExpansionService
  .expand_with_intelligence
    successfully expands with probe deployment and asteroid tug integration
    generates settlement plan with appropriate mission type
    includes probe data in the result
    links to appropriate mission profile based on system characteristics
    calculates success probability and ROI
    with moon target
      includes asteroid tug configuration for moon targets
      selects appropriate tug mission based on moon size
    with asteroid target
      includes asteroid tug for asteroid targets
  .expand_with_pattern (legacy)
    expands settlement with pattern when suitable
    fails expansion when pattern is not suitable

AIManager::ManifestParser
  #extract_equipment_from_manifest
    extracts complete equipment data from manifest
    handles missing manifest file gracefully
  #extract_craft_fit
    extracts modules and units from craft fit
    handles nil craft data
  #extract_inventory
    extracts deployable units, supplies, and consumables
  #calculate_economics
    calculates economic profile with path determination
    identifies Earth imports vs local production
  #determine_path
    returns Path A for high Earth dependency
    returns Path B for mixed approach
    returns Path C for mostly local production

AIManager::OperationalManager
  #initialize
    loads trained patterns
    initializes priority system
  #make_decision
    when critical issues exist
      handles critical issues
    when no critical issues but operational needs exist
      handles operational needs
    when stable and expansion is feasible
      considers expansion (FAILED - 512)
    when stable with no expansion opportunities
      maintains current operations (FAILED - 513)
  #execute_decision
    emergency procurement decision
      calls emergency mission service
    resource procurement decision
      calls procurement service
    construction decision
      calls construction service
    expansion decision
      calls expansion service
    debt repayment decision
      calls financial service
  pattern matching
    #find_expansion_pattern
      returns the highest-scoring suitable pattern
      scores patterns based on ISRU ratio and equipment count
    #pattern_suitable_for_expansion?
      accepts patterns with cost and equipment
      rejects patterns without equipment
  decision logging
    logs decisions with timestamps and categories (FAILED - 514)
  #determine_dc_type
    with Ceres
      forms Ceres Development Corporation aligned with Mars
    with Mars
      forms independent Mars Development Corporation
    with Titan
      forms Titan Development Corporation aligned with Saturn
    with unknown world
      falls back to world type classification

AIManager::PatternValidator
  #validate_pattern
    with a valid pattern
      returns valid status for well-formed pattern
    with insufficient life support
      flags insufficient resources
    with invalid equipment IDs
      flags invalid equipment
    with unrealistic cost
      flags suspicious costs
    with aggressive timeline
      flags unrealistic timelines
  helper methods
    #extract_id
      extracts ID from formatted strings
    #estimate_crew_size
      estimates crew based on habitat units
      reduces crew estimate with robots
    #find_consumable_amount
      extracts amounts from consumable strings

AIManager::PriorityHeuristic
  #oxygen_critical?
    when O2 mass is above 15% of target
      returns false
    when O2 mass is below 15% of target
      returns true
  #account_negative?
    when account balance is positive
      returns false
    when account balance is negative
      returns true
  #get_priorities
    when neither condition is met
      returns empty array
    when oxygen is critical
      returns refill_oxygen priority
    when account is negative
      returns debt_repayment priority
    when both conditions are met
      returns both priorities
  #get_priorities on Mars
    when oxygen is critical on Mars
      returns local_oxygen_generation priority instead of refill_oxygen
    when nitrogen is critical on Mars
      returns local_argon_extraction priority
  #calculate_si_ask_price
    returns 95% of the calculated ask price
  Environmental System Integration
    with procedurally generated planet having 95% CO2 and 0.0 Tesla magnetic field
      correctly chooses local O2 production
    with planet having low CO2 and weak magnetic field
      chooses oxygen refill instead of local generation
    with settlement having excess CO and H2
      prioritizes methane synthesis
    with settlement having critical storage capacity
      prioritizes storage module construction

AIManager::SystemArchitect
  Sabatier Refinements
    #get_maintenance_tax_em
      applies 25% discount when sabatier units are active
      does not apply discount when sabatier units are not active
    #sabatier_units_active?
      returns true when contract flag is set

AIManager::SystemArchitect
  #initialize
    analyzes system configuration
  #analyze_system_configuration
    with moons
      identifies large and small moons
    without moons
      identifies moonless system
  #determine_deployment_template
    with 2+ small moons
      returns conversion template
    with large moon
      returns lunar_standard template
    moonless with nearby asteroid
      returns asteroid_capture template
    moonless without asteroid
      returns cycler_staging template
  #deploy_subsurface_foothold
    creates subsurface location (FAILED - 515)
    creates settlement (FAILED - 516)
  #find_nearby_asteroid
    with suitable asteroid
      finds the asteroid (FAILED - 517)
    without suitable asteroid
      returns nil
  #transfer_ownership_to_system_corp
    creates system specific corporation
    transfers settlements

AIManager::SystemIntelligenceService
  #system_status
    with operational structures
      returns correct operational ratio and status (FAILED - 518)
    with all operational structures
      returns healthy status (FAILED - 519)
    with mostly non-operational structures
      returns critical status (FAILED - 520)
  #narrative_status
    critical status
      returns critical narrative
    warning status
      returns warning narrative
    healthy status
      returns healthy narrative
  #licensing_runway
    with USD balance
      calculates runway correctly
    with zero balance
      returns zero runway
    no SSC found
      returns nil
  #sustainability_delta
    calculates positive delta
  #logistics_efficiency
    with contracts
      calculates efficiency
    no contracts
      returns 0.0
  #economic_health_score
    with balances
      calculates score
    no SSC
      returns 0

AIManager::TaskExecutionEngine
  #initialize
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    loads mission and settlement
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    loads task list from profile-based structure
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    initializes current task index to 0
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    initializes material tracking hashes
  #start
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    executes all tasks synchronously
  #execute_next_task
    when all tasks are complete
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      returns false
    when task execution succeeds
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      increments the task index
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      updates mission progress
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      returns true
    when task execution fails
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      logs error
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      returns false
  #execute_task
    with effects-based task
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  Processing 1 effects...
      executes each effect
    with legacy task type
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      calls legacy handler
  #execute_effect
    with deploy_unit effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: deploy_unit
      calls deploy_unit_from_effect
    with set_unit_state effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: set_unit_state
      calls set_unit_state
    with connect_units effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: connect_units
      calls connect_units_from_effect
    with manufacture effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: manufacture
      calls manufacture_from_effect
    with check_unit_state effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: check_unit_state
      calls check_unit_state_from_effect
    with check_unit_connected effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: check_unit_connected
      calls check_unit_connected_from_effect
    with transfer_resource effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: transfer_resource
      calls transfer_resource_from_effect
    with unknown effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Executing effect: unknown_action
Unknown effect action: unknown_action
      returns false
  #deploy_unit_from_effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Deployed: Solar Panel 1
  ✓ Deployed: Solar Panel 2
    creates multiple units when count > 1
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Deployed: Solar Panel 1
  ✓ Deployed: Solar Panel 2
    returns true on success
    when blueprint not found
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✗ Blueprint not found for: Solar Panel
      returns false
  #set_unit_state
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Set unit Test Unit 1 state to active
  ✓ Set unit Test Unit 2 state to active
    updates state for all matching units
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Unit Nonexistent Unit not found, assuming correct state for AI simulation
    returns true even if no units found
  #connect_units_from_effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Connected Power Hub:input ↔ Solar Panel:output
    connects units successfully
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    returns true even if units not found (AI simulation)
  #manufacture_from_effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Manufacturing: 10x ibeam using I-Beam Printer
    • Input: 500 depleted_regolith (local_isru)
  ✓ Manufactured 10x ibeam
    tracks input materials as consumed
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Manufacturing: 10x ibeam using I-Beam Printer
    • Input: 500 depleted_regolith (local_isru)
  ✓ Manufactured 10x ibeam
    tracks output materials as produced
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Manufacturing: 10x ibeam using I-Beam Printer
    • Input: 500 depleted_regolith (local_isru)
  ✓ Manufactured 10x ibeam
    calls ResourceTrackingService with correct parameters
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  → Manufacturing: 10x ibeam using I-Beam Printer
    • Input: 500 depleted_regolith (local_isru)
  ✓ Manufactured 10x ibeam
    returns true on success
  #check_unit_state_from_effect
    when unit is in expected state
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Unit Test Unit is in expected state: ready
      returns true
    when unit is in different state
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ⚠ Unit Test Unit is in state 'ready', expected 'active' (continuing anyway for AI simulation)
      returns true (soft check for AI simulation)
    when unit not found
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ⚠ Unit Missing Unit not found (assuming correct for AI simulation)
      returns true (soft check for AI simulation)
  #check_unit_connected_from_effect
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Verified unit Test Unit connectivity at port input
    returns true when unit exists
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ⚠ Unit Missing Unit not found (assuming connected for AI simulation)
    returns true even when unit not found (soft check)
  #transfer_resource_from_effect
    with continuous transfer
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Configured continuous transfer: water from Tank A → Tank B
      returns true
    with one-time transfer
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
  ✓ Transferred water from Tank A → Tank B
      returns true
  #initiate_construction
    with crater_dome structure
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      creates a crater dome structure (FAILED - 521)
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      uses ConstructionJobService (FAILED - 522)
    with skylight_cover structure
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
      skips skylight for AI simulation
  #update_mission_progress
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    calculates and updates progress percentage
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    updates operational_data with task counts
  #complete_mission
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    updates mission status to completed
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    sets progress to 100
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    sets completion_date
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    calls ResourceTrackingService
  #production_summary
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    generates summary of production
Loading profile from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_profile_v1.json
Loaded profile with 1 phases
Loading phase tasks from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_phase_1.json
  Loaded 2 tasks from test_mission_001_phase_1.json
Total tasks loaded: 2
Loading manifest from: /home/galaxy_game/app/data/missions/test-mission-001/test_mission_001_manifest_v1.json
Loaded manifest with keys: ["template", "manifest_id", "craft", "inventory", "metadata"]
    generates summary of consumption
  .orbital_resupply_cycle
    when conditions are met for resupply
      schedules a material ferry mission (FAILED - 523)
      updates craft status (FAILED - 524)
    when no active projects
      does not schedule missions (FAILED - 525)
  .check_material_surplus
    returns surplus above threshold
    when below threshold
      returns 0

AIManager::TerraformingManager
  #calculate_gas_needs
    with magnetosphere protection
      returns gas needs for warming phase (FAILED - 526)
    without magnetosphere protection
      returns empty hash (FAILED - 527)
    with preservation mode and exceeded limit
      returns empty hash (FAILED - 528)
  #has_magnetosphere_protection?
    with natural magnetosphere
      returns true (FAILED - 529)
    without natural magnetosphere
      returns false (FAILED - 530)
  #atmospheric_reduction_exceeded?
    with preservation mode
      when reduction exceeds 5%
        returns true
      when reduction is below 5%
        returns false
    without preservation mode
      returns false
  #determine_terraforming_phase
    warming phase
      returns warming when temperature is low
    maintenance phase
      returns maintenance when conditions are met
  #should_seed_biosphere?
    with existing biosphere
      returns false
    without biosphere and suitable conditions
      returns true

AIManager::TestScenarioExtractor
  .extract_training_scenarios
    extracts realistic settlement scenarios from test mocks
    includes operational and expansion scenarios
  .convert_to_training_format
    converts scenarios to AI training format

AutonomousMissionService
  .find_or_create_worldhouse_feature
    when a lava tube exists
      returns the existing lava tube (FAILED - 531)
    when no lava tube exists but a valley exists
      returns the existing valley
    when no lava tube or valley exists but a canyon exists
      returns the existing canyon
    when no suitable features exist
      creates a new lava tube feature
    priority order
      prioritizes lava tube over valley and canyon (FAILED - 532)
    when valley exists but no lava tube
      prioritizes valley over canyon
  .execute_base_building_sequence
    calls the feature finding method (FAILED - 533)
    logs mission progress (FAILED - 534)

ConsortiumMembershipService
  allows a corporation to apply for membership with sufficient investment
  rejects non-corporation applicants
  rejects applications with insufficient investment
  dilutes existing members and assigns correct ownership

Construction::OrbitalShipyardService
  .create_shipyard_project
    with valid parameters
      creates a new orbital construction project
      associates the project with the station
      sets the correct blueprint_id
      sets initial status to materials_pending
      initializes progress_percentage to 0
      loads required materials from blueprint
      initializes delivered_materials with zero values
    with invalid blueprint_id
      raises an error
  .deliver_materials
    when material is needed
      consumes the material for the project (FAILED - 535)
      returns the unconsumed quantity (FAILED - 536)
      does not consume more than needed (FAILED - 537)
    when material is not needed
      returns the full quantity (FAILED - 538)
      does not update any project materials (FAILED - 539)
    when project becomes ready
      changes status to in_progress when all materials are delivered (FAILED - 540)
    with multiple projects
      distributes materials across projects (FAILED - 541)
  .update_construction_progress
    increases progress percentage
    does not exceed 100% (FAILED - 542)
    when progress reaches 100%
      completes the project
  .complete_project
    marks the project as completed (FAILED - 543)
    spawns the completed craft
  .spawn_completed_craft
    creates a new craft (FAILED - 544)
    associates the craft with the station (FAILED - 545)
    sets the craft status to docked (FAILED - 546)
    loads operational data from blueprint (FAILED - 547)
  .load_craft_blueprint
    with valid blueprint_id
      loads the blueprint from JSON file
    with invalid blueprint_id
      raises an error

CraterDomeConstructionService
  #construct
    creates a construction job successfully (FAILED - 548)
    when entity is different from service provider
      processes a payment (FAILED - 549)
  #start_construction
    starts the construction process (FAILED - 550)
  #complete_construction
    completes the construction process (FAILED - 551)

End-to-End Economic Simulation

========================================================
E2E SIMULATION: LDC Initial Market Price Determination
========================================================
EAP Final Price for titanium_alloy                     : $137.5 GCC/kg
EAP Final Price for composite_insulation               : $106.0 GCC/kg
EAP Final Price for pressure_valves                    : $116.0 GCC/kg
EAP Final Price for electronics                        : $220.0 GCC/kg

--- Calculating EAP-COGS (Imported Floor Cost) ---
COGS Breakdown:
- Titanium_alloy           : 80.0 kg * $137.5/kg = $11000.0
- Composite_insulation     : 20.0 kg * $106.0/kg = $2120.0
- Pressure_valves          : 10.0 kg * $116.0/kg = $1160.0
- Electronics              : 10.0 kg * $220.0/kg = $2200.0
--------------------------------------------------------
Total Raw Material Cost (pre-waste) : $16480.0
Production Efficiency (1 / Waste)   : 0.95
Total COGS (Material Cost / Eff.)   : $17347.3684

=> EAP-COGS (Imported Floor Price): $17347.37 GCC

--- Determining AI Strategic Listing Price ---
Earth Corp Price (Competitor): $8500.0 GCC
Target Undercut Margin: 5.0%
Final LDC Listing Price: $8075.0 GCC
  simulates the full pipeline to determine the initial market listing price

EconomicConfig
  cryptocurrency mining methods
    returns the GCC max supply
    returns the GCC halving interval days
    returns the GCC issuance model
    returns the GCC difficulty scaling flag
    returns the GCC initial block reward
    returns the GCC minimum block reward
  transport methods
    returns transport rate for bulk_material
    returns transport rate for manufactured
    returns transport rate for high_tech
    falls back to bulk_material rate for unknown categories
  earth pricing methods
    returns earth spot price for known materials
    returns nil for unknown materials

Financial::ExchangeRateService
  #initialize
    initializes with empty rates by default
    initializes with provided rates
  #convert
    returns the amount unchanged when from and to currencies are the same
    converts using the stored rate
    defaults to 1.0 rate when no rate is found
    handles string and symbol currencies
  #get_rate
    returns the stored rate
    returns 1.0 for unknown rate pairs
    normalizes keys to strings
  #set_rate
    sets a new rate
    updates an existing rate
    normalizes keys to strings
  #value_of
    converts item quantity to target currency
    uses default rate when no specific rate exists
  #base_price_for
    when item is found with value
      returns the item value converted to target currency
      defaults to GCC currency when not specified
    when blueprint is found with cost_data
      returns the blueprint cost converted to target currency
    when neither item nor blueprint is found
      returns default value converted to target currency
  #market_price_for
    returns nil (TODO: implement market price lookup)
  #price_for
    returns market price when available
    falls back to base price when market price is not available
  integration with economic config
    works with the initial USD=GCC peg
    supports future currency decoupling

Financial::TaxCollectionService
  .collect_sales_tax
    when tax is applicable
      calculates the correct tax amount
      calls the TransactionManager to move the tax funds
    when tax rate is zero (e.g., for Tax Authority)
      returns 0.0 and does not call the TransactionManager
    when organization is missing a tax rate
      returns 0.0 and does not call the TransactionManager

Financial::TransactionManager
  .create_transfer
    creates a new Financial::Transaction record
    sets the correct attributes on the created transaction
    raises an error if creation fails due to missing ActiveRecord validation (e.g., missing account)

FittingResult
  initializes with success true and empty arrays
  marks success false and adds error when add_error is called

FittingService
  - Installing 1x efficiency_module
    ❌ Failed to install efficiency_module: Max modules reached for this craft (0)
  - Installing 1x gpu_coprocessor_rig
    ❌ Failed to install gpu_coprocessor_rig: Max rigs reached for this craft (0)
Unit definition not found: satellite_battery
Failed to install efficiency_module: Max modules reached for this craft (0)
Failed to install gpu_coprocessor_rig: Max rigs reached for this craft (0)
  fits all components from inventory (FAILED - 552)
  - Installing 1x efficiency_module
    ❌ Failed to install efficiency_module: Max modules reached for this craft (0)
  - Installing 1x gpu_coprocessor_rig
    ❌ Failed to install gpu_coprocessor_rig: Max rigs reached for this craft (0)
  returns errors if inventory is missing items
  - Installing 1x efficiency_module
    ❌ Failed to install efficiency_module: Max modules reached for this craft (0)
  - Installing 1x gpu_coprocessor_rig
    ❌ Failed to install gpu_coprocessor_rig: Max rigs reached for this craft (0)
  fits components without inventory if inventory is nil (FAILED - 553)
  - Installing 1x efficiency_module
  - Installing 1x gpu_coprocessor_rig
  does not persist changes if dry_run is true

GameSimulation
  #initialize
    sets the game_state
  #advance_by_days
    when days is zero or negative
      does not advance the game
    when days is positive
====================
Advancing game by 5 days
Current: Year 2200, Day 100.0
====================
New time: Year 2200, Day 100.0
      advances the game time and saves the state
====================
Advancing game by 1 days
Current: Year 2200, Day 364.0
====================
New time: Year 2200, Day 0.0
      handles year rollover correctly
  #process_celestial_bodies
  Simulating: Earth
    simulates only bodies that should be simulated
  Simulating: Mars
    logs errors if simulation fails

Game
  #advance_by_days
Mars Base One updated for 5 days.
Mars Base One updated for 5 days.
    advances the simulation by the given number of days (FAILED - 554)
Mars Base One updated for 0 days.
Mars Base One updated for 0 days.
    does not advance time if days is zero or negative (FAILED - 555)

Generators::GameDataGenerator
  generates and saves a valid JSON item

Generators::LavaTubeGenerator
  #generate
    with random generation
      creates a lava tube with random features (FAILED - 556)
      generates random dimensions (FAILED - 557)
      generates random attributes (FAILED - 558)
      creates random skylights and access points (FAILED - 559)
    with predefined parameters
      creates a lava tube with specified parameters (FAILED - 560)
      creates predefined skylights and access points (FAILED - 561)
    with minimal parameters
      creates a lava tube with defaults (FAILED - 562)

Generators::ValleyGenerator
  #generate
    with random generation
      creates a valley with random features (FAILED - 563)
      generates random dimensions (FAILED - 564)
      generates segments (FAILED - 565)
      creates random access points (FAILED - 566)
    with predefined parameters
      creates a valley with specified parameters (FAILED - 567)
      creates predefined access points (FAILED - 568)

Logistics::ContractService
  .create_internal_transfer
    with valid settlements
      creates a logistics contract for internal transfer (FAILED - 569)
    with invalid settlements
      returns nil when from_settlement is not an NPC

Logistics::InternalTransferService
  .create_internal_contract
    when transfer is possible
      creates a logistics contract
      creates a provider if needed
    when transfer is not possible
      returns nil when from_settlement lacks material
      returns nil when to_settlement lacks storage
  .process_internal_transfers
    when transfer can be completed
      completes the transfer
    when transfer cannot be completed
      marks contract as failed when material unavailable

Logistics::InventoryManager
  .transfer_item
    when transferring to a station with orbital construction projects
      intercepts materials for orbital construction (FAILED - 570)
      does not add materials to station inventory if all consumed by projects (FAILED - 571)
    when transferring orbital construction materials to non-orbital settlement
      transfers materials normally without interception (FAILED - 572)
    when transferring non-orbital materials to orbital station
      transfers materials normally without interception (FAILED - 573)
  .should_check_orbital_projects?
    returns true for known orbital materials
    returns true for materials containing panel or beam
    returns false for non-orbital materials

Lookup::BlueprintLookupService
  #initialize
    initializes without error
    loads blueprints on initialization
  #find_blueprint
    with real blueprint files
      finds blueprints by exact name match
      finds blueprints by exact ID match
      is case insensitive
      returns nil for non-existent blueprints
      handles empty or nil queries gracefully
    with category filtering
      filters blueprints by category
      returns nil when blueprint exists but category does not match
    with aliases
      finds blueprints by alias
    with partial matches
      finds blueprints by partial name match for queries >= 3 characters
      does not match partial queries shorter than 3 characters
  #all_blueprints
    returns an array
    returns consistent results on multiple calls
    when blueprint files exist
      returns blueprints with expected structure
  #blueprints_by_category
    returns blueprints filtered by category
    returns empty array for non-existent category
    handles nil category gracefully
    is case insensitive for category matching
  #debug_paths
DEBUG: Blueprint Lookup Paths
components: /home/galaxy_game/app/data/blueprints/components (exists: true)
  Contains 17 JSON files
    - high_performance_electronics_bp.json
    - flexible_polymer_tanks_bp.json
    - inflatable_bladders_bp.json
    ... and 14 more
units: /home/galaxy_game/app/data/blueprints/units (exists: true)
  Contains 117 JSON files
    - communication_module_bp.json
    - advanced_computer_bp.json
    - basic_computer_bp.json
    ... and 114 more
modules: /home/galaxy_game/app/data/blueprints/modules (exists: true)
  Contains 24 JSON files
    - harvester_control_module_bp.json
    - life_support_computer_module_bp.json
    - navigation_computer_module_bp.json
    ... and 21 more
rigs: /home/galaxy_game/app/data/blueprints/rigs (exists: true)
  Contains 4 JSON files
    - gpu_coprocessor_rig_bp.json
    - solar_expansion_rig_bp.json
    - thruster_expansion_rig_bp.json
    ... and 1 more
facilities: /home/galaxy_game/app/data/blueprints/facilities (exists: false)
items: /home/galaxy_game/app/data/blueprints/items (exists: true)
  Contains 2 JSON files
    - battery_cells_bp.json
    - battery_pack_bp.json
structures: /home/galaxy_game/app/data/blueprints/structures (exists: true)
  Contains 10 JSON files
    - main_hangar_bay_bp.json
    - standard_rover_hangar_bp.json
    - biome_seed_facility_bp.json
    ... and 7 more
crafts: /home/galaxy_game/app/data/blueprints/crafts (exists: true)
  Contains 10 JSON files
    - harvesting_rover_bp.json
    - heavy_lander_bp.json
    - generic_probe_bp.json
    ... and 7 more
    runs without error
  error handling
    handles missing blueprint directories gracefully
    handles JSON parsing errors gracefully
  real world usage
    when blueprint files exist
      can find common blueprint types
      loads blueprints with valid JSON structure

Lookup::CraftLookupService
  #find_craft
    loads crafts from the correct file structure
    loads JSON files with correct format (FAILED - 574)
    returns nil for nonexistent crafts
    validates input parameters
    uses cached results for subsequent lookups
    with real craft data
      matches by category
      matches by id
      matches by name
      matches by subcategory if present
      matches by partial id with sufficient length
      is case insensitive
      matches by partial name with sufficient length
      handles special characters in queries (PENDING: No special characters in craft name)
      handles whitespace in queries
      can match by multiple criteria simultaneously
    with error handling
      handles JSON parsing errors
      handles IO errors
      handles file not found errors
      handles directory not found errors
      handles invalid path errors
  #debug_paths
DEBUG: Craft Lookup Paths
Base crafts path: /home/galaxy_game/app/data/operational_data/crafts (exists: true)
atmospheric: /home/galaxy_game/app/data/operational_data/crafts/atmospheric (exists: true)
ground: /home/galaxy_game/app/data/operational_data/crafts/ground (exists: true)
space: /home/galaxy_game/app/data/operational_data/crafts/space (exists: true)
    outputs path information without errors
    outputs correct path information
  error handling during initialization
    gracefully handles errors when loading crafts
    initializes successfully even with file system errors
  using actual data files
    finds a specific craft by id
    finds a craft by category
    can find crafts by folder structure

Lookup::EarthReferenceService
  Earth reference data
    loads Earth data from the fixture file
  fallback behavior
    uses fallback values when properties are missing

Lookup::ItemLookupService
  #find_item
    loads items from the correct file structure (FAILED - 575)
    finds consumable items with correct data (PENDING: No consumable item files found)
    finds equipment items with correct data (PENDING: No equipment item files found)
    returns nil when item does not exist
    handles dynamic unassembled items
    handles scrap items dynamically (FAILED - 576)
    caches results for subsequent lookups (PENDING: Item battery_cells not found)
    finds items by partial name match
    is case insensitive
  dynamic item creation
    creates scrap items on the fly (FAILED - 577)
    creates processed items on the fly (FAILED - 578)
    creates used items on the fly (FAILED - 579)
  integration with other lookup services
    converts materials to items when needed
  item loading
    loads items from all configured paths
    handles missing directories gracefully

Lookup::MaterialLookupService
  #find_material
    loads materials from the correct file structure
    finds atmospheric gases by chemical formula
    finds materials case-insensitively
    returns nil for nonexistent materials
  atmosphere gas creation behavior
    correctly maps chemical formulas for atmosphere creation
  material property access
    provides access to material properties directly from data
    has all expected material properties
  #get_material_property
    with valid material
      returns top-level properties
      returns nested properties from properties hash
      returns nil for non-existent properties
    with nil material
      returns nil gracefully
    with nil property name
      returns nil gracefully
  #get_molar_mass
    returns molar mass for existing materials
    returns nil for non-existent materials
  #atmospheric_components
    converts chemical formulas to material data
    filters out unknown materials
    preserves percentage data
  .base_materials_path
    returns a Pathname object
    points to the correct materials directory
  .locate_gases_path
    returns the gases directory path
    uses GalaxyGame::Paths consistently (FAILED - 580)
  MATERIAL_PATHS configuration
    has all expected material types
    has valid path configurations
  #debug_paths
DEBUG: Material Lookup Paths
building: /home/galaxy_game/app/data/resources/materials/building (exists: true)
byproducts: /home/galaxy_game/app/data/resources/materials/byproducts (exists: true)
chemicals: /home/galaxy_game/app/data/resources/materials/chemicals (exists: true)
gases: /home/galaxy_game/app/data/resources/materials/gases (exists: true)
liquids: /home/galaxy_game/app/data/resources/materials/liquids (exists: true)
processed: /home/galaxy_game/app/data/resources/materials/processed (exists: true)
raw: /home/galaxy_game/app/data/resources/materials/raw (exists: true)
    prints path information without errors
    outputs expected format
  error handling
    with corrupted JSON files
      handles JSON parsing errors gracefully (FAILED - 581)
    with missing directories
      handles missing directories gracefully
      handles missing recursive directories gracefully
    with service initialization errors
      continues with empty materials on load failure
      logs errors when initialization fails
  material matching logic
    matches by exact chemical formula
    matches by material ID
    matches by name
    handles partial matches in name and ID
    returns false for non-matches
    handles nil inputs gracefully
  integration with AtmosphereConcern
    provides materials needed for atmospheric calculations

Lookup::ModuleLookupService
  #find_module
    loads modules from the correct file structure
    finds modules by module_type
    finds modules case-insensitively
    returns nil for nonexistent modules
    handles nil and blank module types
  service configuration
    has the correct base path (FAILED - 582)
    has all expected module categories
    includes life_support in module categories
  module data structure validation
    when co2_scrubber module exists
      has all expected module properties
      has correct energy consumption
      has input and output resources
      follows the operational data template
    when life_support module exists
      has basic life support properties
      follows the operational data template
  error handling
    handles JSON parsing errors gracefully
    handles missing base directory gracefully
  integration with BaseModule
    provides data needed for module creation

Lookup::PlanetaryGeologicalFeatureLookupService
  #initialize
    initializes with a celestial body (FAILED - 583)
    loads features during initialization (FAILED - 584)
  #all_features
    returns an empty array when no features exist
    returns all loaded features (FAILED - 585)
    handles multiple JSON files (FAILED - 586)
    handles single feature JSON files (FAILED - 587)
  #find_by_name
    finds a feature by exact name match (FAILED - 588)
    finds a feature by case-insensitive name match (FAILED - 589)
    finds a feature by lowercase name match (FAILED - 590)
    returns nil when feature is not found (FAILED - 591)
    handles symbol input (FAILED - 592)
    returns the first match when multiple features have the same name (FAILED - 593)
  #features_by_type
    returns features of a specific type (FAILED - 594)
    returns features by case-insensitive type match (FAILED - 595)
    returns empty array when no features of that type exist (FAILED - 596)
    handles symbol input (FAILED - 597)
  #feature_summary
    groups features by type (FAILED - 598)
    handles features with nil type (FAILED - 599)
    returns empty hash when no features exist (FAILED - 600)
  path construction
    constructs correct path for planet (FAILED - 601)
    handles missing solar system gracefully
  error handling
    handles JSON parse errors gracefully (FAILED - 602)
    handles missing directories gracefully
    logs debug information about found files (FAILED - 603)

Lookup::StructureLookupService
  #find_structure
    when searching by structure_id and category (type)
      returns the structure data when found in the specified type directory
      returns nil if the structure is not found in any directory
    when searching by structure_id without category (global search)
      returns the structure data if found in any directory
      searches through categories and returns the first match found
      returns nil if the structure is not found in any directory
    when the JSON file is invalid
      returns nil and logs an error
    caching behavior
      reads from the file system only once for the same query
      stores the result in the cache hash

Lookup::UnitLookupService
  #find_unit
    loads units from the correct file structure
    finds units case-insensitively by ID (FAILED - 604)
    returns nil for nonexistent units
    handles nil and blank unit queries gracefully
    with propulsion units
      finds propulsion units by their exact ID (FAILED - 605)
      has expected propulsion unit properties (FAILED - 606)
    with habitat units
      finds habitat units by their ID
    with robot units
      finds robot units by their ID (FAILED - 607)
  service configuration
    has all expected unit categories (FAILED - 608)
  unit data structure validation
    when any propulsion unit exists
      has all expected top-level unit properties (PENDING: No propulsion units found)
      has performance properties if applicable (PENDING: No propulsion units found)
      has operational properties (PENDING: No propulsion units found)
      has maintenance requirements if defined (PENDING: No propulsion units found)
      has operational modes if defined (PENDING: No propulsion units found)
      has telemetry metadata if defined (PENDING: No propulsion units found)
    when any storage unit exists
      has storage capacity properties (PENDING: No storage units found)
      has alias support if defined (PENDING: No storage units found)
  matching behavior
    matches by exact ID (FAILED - 609)
    matches by exact name (FAILED - 610)
    matches by partial ID with sufficient length (FAILED - 611)
    is case insensitive (FAILED - 612)
  #debug_paths
DEBUG: Unit Lookup Paths
computer: /home/galaxy_game/app/data/operational_data/units/computers (exists: true)
droid: /home/galaxy_game/app/data/operational_data/units/droid (exists: false)
energy: /home/galaxy_game/app/data/operational_data/units/energy (exists: true)
habitats: /home/galaxy_game/app/data/operational_data/units/habitats (exists: true)
life_support: /home/galaxy_game/app/data/operational_data/units/life_support (exists: true)
processing: /home/galaxy_game/app/data/operational_data/units/processing (exists: false)
production: /home/galaxy_game/app/data/operational_data/units/production (exists: true)
propulsion: /home/galaxy_game/app/data/operational_data/units/propulsion (exists: true)
storage: /home/galaxy_game/app/data/operational_data/units/storage (exists: true)
structure: /home/galaxy_game/app/data/operational_data/units/structure (exists: false)
specialized: /home/galaxy_game/app/data/operational_data/units/specialized (exists: true)
robots_deployment: /home/galaxy_game/app/data/operational_data/units/robots/deployment (exists: true)
robots_construction: /home/galaxy_game/app/data/operational_data/units/robots/construction (exists: true)
robots_maintenance: /home/galaxy_game/app/data/operational_data/units/robots/maintenance (exists: true)
robots_exploration: /home/galaxy_game/app/data/operational_data/units/robots/exploration (exists: true)
robots_life_support: /home/galaxy_game/app/data/operational_data/units/robots/life_support (exists: true)
robots_logistics: /home/galaxy_game/app/data/operational_data/units/robots/logistics (exists: true)
robots_resource: /home/galaxy_game/app/data/operational_data/units/robots/resource (exists: true)
    outputs path information without errors

ManufacturingService
  .manufacture
    with real blueprints
      creates a UnitAssemblyJob and charges construction cost using real blueprint (FAILED - 613)
      works with different blueprint categories (FAILED - 614)
    with sufficient funds
      creates a UnitAssemblyJob and charges the player construction cost (FAILED - 615)
    with different construction cost percentages
      uses settlement's custom construction percentage (FAILED - 616)
    with real blueprint data
      creates material requests based on actual blueprint requirements (FAILED - 617)
      automatically fulfills material requirements when materials are available (FAILED - 618)
      stores actual blueprint data in specifications (FAILED - 619)
    with invalid blueprint
      returns failure when blueprint not found (FAILED - 620)

Manufacturing::AssemblyService
  .start_assembly
    with all materials available
      creates an assembly job successfully
      charges the tenant fee (FAILED - 621)
    with missing materials and buy_missing = false
      fails and reports missing materials
    with missing materials and buy_missing = true
      buys missing materials and creates job
      fails if cannot afford material costs
    with insufficient funds for tenant fee
      fails with insufficient funds error
    with invalid blueprint
      fails with invalid blueprint error
    with invalid settlement
      fails with invalid settlement error
  job type determination
    for unit blueprints
      creates a UnitAssemblyJob
    for structure blueprints
      creates a ConstructionJob

Component Production Integration
  with real blueprint files
    finds the 3d_printed_ibeam_mk1 blueprint
    producing mk1 I-beams (bootstrap version)
      creates a production job using real blueprint (FAILED - 622)
      consumes depleted_regolith from inventory (FAILED - 623)

Manufacturing::ComponentProductionService
  #produce_component
    with sufficient materials
      creates a component production job
      consumes materials from inventory
      stores material composition in job metadata
    with insufficient materials
      raises an error
    with incompatible printer
      raises an error
  #complete_job
    adds components to inventory
    stores source material composition in component metadata
    adds waste products to inventory
    marks job as completed

Manufacturing::Construction::ConstructionManager
  .assign_builders
    logs and returns true
  .complete?
    returns true if current time >= estimated_completion
    returns false if current time < estimated_completion
    returns false if entity does not respond to estimated_completion
    returns false if estimated_completion is nil

Manufacturing::Construction::CoveringCalculator
  .calculate_materials
    calculates required 3D-printed I-beams from regolith
  .calculate_printer_requirements
    calculates required 3D printer capacity
  .estimate_construction_time
    estimates construction time based on skylight size

Manufacturing::Construction::CoveringService
  #initialize
    initializes with coverable, panel type, and settlement (FAILED - 624)
    uses default panel type if not provided (FAILED - 625)
    finds settlement from coverable if not provided (FAILED - 626)
  #calculate_materials
    calculates base materials using CoveringCalculator (FAILED - 627)
    merges panel-specific materials (FAILED - 628)
    sums quantities for duplicate materials (FAILED - 629)
  #schedule_construction
    returns error if no settlement (FAILED - 630)
    returns error if no blueprint found (FAILED - 631)
    creates a construction job (FAILED - 632)
    creates material requests (FAILED - 633)
    creates equipment requests (FAILED - 634)
    updates coverable status to materials_requested (FAILED - 635)
    returns success with construction job (FAILED - 636)
  #start_construction
    returns false if materials not gathered (FAILED - 637)
    returns false if equipment not gathered (FAILED - 638)
    updates job status to in_progress (FAILED - 639)
    assigns builders through ConstructionManager (FAILED - 640)
    updates coverable status to under_construction (FAILED - 641)
  #track_progress
    returns false if job not in progress (FAILED - 642)
    returns false if construction not complete (FAILED - 643)
    completes construction when work is done (FAILED - 644)
    updates coverable status (FAILED - 645)
    releases equipment (FAILED - 646)
    returns true when complete (FAILED - 647)

Manufacturing::Construction::DomeCalculator
  .calculate_materials
    calculates materials using the same panel system as skylights
    supports different panel types like skylights
    adds dome-specific adjustments
  .calculate_anchor_points
    calculates anchor points based on circumference
    scales with dome size
  .calculate_pressure_sealing
    calculates sealing material based on circumference
  .calculate_construction_cost
    calculates cost based on dome size and materials
    applies complexity multiplier for dome shape
  .estimate_construction_time
    estimates construction time based on dome size
    applies curvature complexity factor

Manufacturing::Construction::DomeService
  #initialize
    initializes with default panel type (FAILED - 648)
    initializes with custom panel type (FAILED - 649)
    defaults service provider to entity (FAILED - 650)
  #schedule_construction
    creates a construction job successfully (FAILED - 651)
    fails when no settlement found (FAILED - 652)
    creates material and equipment requests for player construction (FAILED - 653)
    when entity is different from service provider
      processes payment for contracted construction (FAILED - 654)
      does not create material requests for contracted construction (FAILED - 655)
      marks materials and equipment as provided by contractor (FAILED - 656)
      handles payment failure gracefully (FAILED - 657)
  #start_construction
    starts construction when materials and equipment are ready (FAILED - 658)
    fails when materials not ready for player construction (FAILED - 659)
    bypasses checks for contracted construction (FAILED - 660)
  #track_progress
    completes construction when work is finished (FAILED - 661)
    returns false when construction not complete (FAILED - 662)
    sets correct status for different layer types (FAILED - 663)
    releases equipment when construction completes (FAILED - 664)
  #complete_construction
    completes the construction process (FAILED - 665)
  private methods
    #determine_completion_status
      returns correct status for primary layer (FAILED - 666)
      returns correct status for secondary layer (FAILED - 667)
      returns correct status for both layers (FAILED - 668)
      returns operational for unknown layer types (FAILED - 669)
    #is_player_construction?
      returns true when entity and provider are the same (FAILED - 670)
      returns false when entity and provider are different (FAILED - 671)

Manufacturing::Construction::HangarService
  #initialize
    initializes with default hangar type (FAILED - 672)
    initializes with custom hangar type (FAILED - 673)
    raises error for non-large access points (FAILED - 674)
  #schedule_construction
    creates a hangar structure successfully (FAILED - 675)
    creates a construction job (FAILED - 676)
    connects the access point to the hangar (FAILED - 677)
    fails when no settlement found (FAILED - 678)
    fails when no blueprint found (FAILED - 679)
    creates material and equipment requests (FAILED - 680)
    calculates correct capacity for standard rover hangar (FAILED - 681)
    calculates correct capacity for large craft hangar (FAILED - 682)
  #start_construction
    starts construction when materials and equipment are ready (FAILED - 683)
    fails when materials not ready (FAILED - 684)
    fails when equipment not ready (FAILED - 685)
  #track_progress
    completes construction when work is finished (FAILED - 686)
    returns false when construction not complete (FAILED - 687)
    releases equipment when construction completes (FAILED - 688)
  #calculate_materials
    calculates materials for standard rover hangar (FAILED - 689)
    calculates materials for large craft hangar (FAILED - 690)
    merges blueprint materials with specific materials (FAILED - 691)
  #calculate_construction_time
    calculates base time for standard hangar (FAILED - 692)
    calculates longer time for large craft hangar (FAILED - 693)
  #calculate_equipment_requirements
    calculates equipment requirements (FAILED - 694)

Manufacturing::Construction::SegmentCoveringService
  #initialize
    uses modular_structural_panel as default (FAILED - 695)
    finds settlement from worldhouse (FAILED - 696)
  #calculate_panel_specific_materials
    calculates worldhouse-scale materials (FAILED - 697)
    includes cable calculations for massive segments (FAILED - 698)
    scales materials by panel count (FAILED - 699)
  #complexity_factor
    returns 1.5 base factor for worldhouse (FAILED - 700)
    increases factor for very large segments (FAILED - 701)
  #calculate_equipment_requirements
    requires minimum 10 printers for worldhouse (FAILED - 702)
    requires heavy equipment (FAILED - 703)
    scales equipment for massive segments (FAILED - 704)
  #schedule_construction
    creates construction phases for large segments (FAILED - 705)
    includes phase names and durations (FAILED - 706)

Manufacturing::Construction::SkylightService
  #initialize
    uses skylight-specific default panel type (FAILED - 707)
    finds settlement from lava tube (FAILED - 708)
  #calculate_panel_specific_materials
    calculates transparent panel materials (FAILED - 709)
    calculates solar panel materials (FAILED - 710)
    scales materials by panel count (FAILED - 711)
  #complexity_factor
    returns 1.0 for basic transparent panels (FAILED - 712)
    returns 1.5 for solar panels (FAILED - 713)
    returns 1.3 for thermal insulation (FAILED - 714)
  #determine_completion_status
    returns primary_cover for basic transparent (FAILED - 715)
    returns solar_cover for solar panels (FAILED - 716)
    returns full_cover for structural on primary cover (FAILED - 717)

Manufacturing::CostCalculator
  Earth-Imported COGS (EAP-COGS)

--- Calculating Earth-Imported COGS (EAP-COGS) for Small Fuel Tank ---
    calculates the EAP-COGS (Earth Import Cost) for the unit (FAILED - 718)
  Local Production COGS (LAP-COGS)

--- Calculating Local Production COGS (LAP-COGS) for Small Fuel Tank ---
    calculates the LAP-COGS (Local Production Cost) for the unit (FAILED - 719)

Manufacturing::MaterialProcessingService
  #thermal_extraction
    with valid inputs
      creates a material processing job record
      updates inventory correctly after job completion
    with insufficient raw regolith
      returns an error
  #volatiles_extraction
    with valid inputs
      creates a material processing job record (FAILED - 720)
      produces gases with correct composition after job completion (FAILED - 721)
    with insufficient processed regolith
      returns an error

Manufacturing::MaterialRequest
  .create_material_requests
    creates requests for all required materials (FAILED - 722)

Manufacturing::Processing
  #process
    when owner has sufficient resources and funds
      successfully processes the blueprint and creates unassembled items (FAILED - 723)
    when owner does not have enough resources
      returns an error when resources are insufficient (FAILED - 724)
    when owner does not have enough GCC
      raises an error when GCC is insufficient (FAILED - 725)

Manufacturing::Service
  .manufacture
    with real blueprints
      creates a UnitAssemblyJob and charges construction cost using real blueprint (FAILED - 726)
      works with different blueprint categories (FAILED - 727)
    with sufficient funds
      creates a UnitAssemblyJob and charges the player construction cost (FAILED - 728)
    with different construction cost percentages
      uses settlement's custom construction percentage (FAILED - 729)
    with real blueprint data
      creates material requests based on actual blueprint requirements (FAILED - 730)
      automatically fulfills material requirements when materials are available (FAILED - 731)
      stores actual blueprint data in specifications (FAILED - 732)
    with invalid blueprint
      returns failure when blueprint not found (FAILED - 733)

Manufacturing::ShellPrintingService
  #enclose_inflatable
    with sufficient materials
      creates a shell printing job
      consumes materials from inventory
      stores material composition in job metadata
    with insufficient materials
      raises an error
    with tank not ready
      raises error if tank not deployed
      raises error if tank already has shell
    with incompatible printer
      raises an error
  #complete_job
    marks tank as enclosed
    stores shell materials in tank metadata
    marks job as completed

Market::ConditionUpdaterService
  .call
    updates supply for all tracked resources
    updates demand for all tracked resources, respecting smoothing and growth
    creates a market condition if one does not exist
    initializes a marketplace if the settlement does not have one
  .calculate_new_supply
    returns zero if net change is a large negative and smooths current supply

Market::NpcPriceCalculator
  .calculate_ask
    with cost-based pricing (no market history)
      returns Earth import cost plus markup
      maintains minimum profit margin
    with market-based pricing (sufficient history)
      uses market average with markup
      never goes below cost floor
  .calculate_bid
    with cost-based pricing
      returns Earth import cost with discount
      returns nil if settlement does not want resource
    with inventory adjustments
      pays more when inventory is critical
      pays normal price when inventory is adequate
      does not buy when inventory is excess
  .calculate_spread
    calculates bid-ask spread
    calculates spread percentage correctly
  local production pricing
    when settlement can produce locally
      uses local production cost instead of import cost
      offers much cheaper prices than import
    when settlement cannot produce locally
      falls back to import pricing
  error handling
    returns nil gracefully for unknown materials
    handles settlements without location
    handles nil settlement
  integration with Tier1PriceModeler
    uses Tier1PriceModeler for base cost calculations
  integration with Market::PriceHistory
    queries price history for market-based pricing

Market::TradeExecutionService
  returns true on successful execution (FAILED - 734)
  calls the TaxCollectionService with gross revenue and seller (FAILED - 735)
  calls TransactionManager.create_transfer with the NET amount (FAILED - 736)
  removes inventory from seller (FAILED - 737)
  creates a trade record (FAILED - 738)
  creates a price history record (FAILED - 739)
  creates a supply chain record (FAILED - 740)

MarketListingService
  when selling based on EAP-COGS (Initial Import Phase)

--- Pricing Scenario 1: Initial Import Phase (EAP-COGS) ---
EAP-COGS (Floor): 7178.95 GCC
Earth Price (Competitor): 8500.00 GCC
Listing Price: 8075.0 GCC (5% Undercut)
    sets the price exactly 5% below the Earth Price
  when selling based on LAP-COGS (Local Production Phase)

--- Pricing Scenario 2: Local Production Phase (LAP-COGS) ---
LAP-COGS (Floor): 4715.79 GCC
Earth Price (Competitor): 8500.00 GCC
Listing Price: 8075.0 GCC (5% Undercut)
Margin vs. LAP-COGS: 3359.21 GCC
    sets the price exactly 5% below the Earth Price, maximizing margin
  when COGS is too high to undercut the Earth Price by 5%

--- Pricing Scenario 3: High COGS Edge Case ---
HIGH_COGS (Floor): 8400.0 GCC
Earth Price (Competitor): 8500.00 GCC
Listing Price: 8484.0 GCC (COGS + 1% Margin)
    sets the price to the Minimum Acceptable Price (COGS + 1%)

MaterialGeneratorService
  .generate_material
    returns material data for water
    returns nil for unknown material

MaterialLookupService
  #find_material
    returns the correct material (FAILED - 741)
    returns nil for a nonexistent material (FAILED - 742)

MaterialRequestService
  .create_material_requests
    creates requests for all required materials (FAILED - 743)

MissionContractService
  .create_supply_contract
    creates a supply contract with correct requirements and reward
  .create_construction_contract
    creates a construction contract with project specifications
  .accept
    when eligible accepter
      accepts the contract and updates status
    when ineligible accepter
      does not accept the contract
  .complete
    with valid delivery
      completes the contract and pays reward
    with invalid delivery
      does not complete the contract
  .cancel
    cancels the contract and updates status
  .check_expirations
    expires overdue contracts
  private methods
    .calculate_supply_reward
      calculates reward based on market price and contract terms
    .calculate_delivery_risk
      calculates risk premium based on distance and reliability

Naming::PlanetNameService
  #initialize
    loads name data from JSON file
    handles missing data file gracefully
  #generate_planet_name
    returns a terraformed name when terraformable is true
    returns a neutral name when terraformable is false
    adds suffix when name is not unique
    marks name as used after generation
  #find_unused_name
    uses deterministic selection based on system and index
  #add_suffix_to_name
    adds a suffix to the base name (FAILED - 744)
  #unique?
    returns true for unused names
    returns false for used names
    checks database for existing planets

PlanetUpdateService
  #initialize
    sets up planet and time_skipped
  #run
    with non-planetary body
      returns immediately
    with a terrestrial planet
      simulates in detail for short time periods
      returns an array of events
    with a longer time period
      uses progressive simulation for longer periods
  private methods
    #simulate_detailed
      processes all spheres
      processes sphere interfaces
      updates planet properties
    #simulate_progressive
      uses the correct intervals for different time periods
      checks for events after each simulation step
    #sphere processing methods
      processes atmosphere correctly
      processes geosphere correctly
      processes hydrosphere correctly
      processes biosphere correctly

Pressurization::BasePressurizationService
  #initialize
    sets up the service with default values
    allows custom options
  #calculate_total_moles
    calculates moles based on ideal gas law
  #calculate_needed_gases
    calculates the mass of each gas needed
  #calculate_achievable_pressure
    with sufficient gases
      returns the target pressure
    with insufficient gases
      returns a reduced pressure based on the limiting gas
  #pressurize
    returns a success result with full pressure when gases are sufficient
    deducts the used gases from available gases
    returns partial success with reduced pressure when gases are insufficient

Pressurization::HabitatPressurizationService
  #calculate_habitat_volume
    calculates correct volume for crater dome (FAILED - 745)

Pressurization::StructurePressurizationService
  .pressurize_structure
    when depot tanks are available
      sources gases from depot tanks (FAILED - 746)
      uses depot tank gases for pressurization (FAILED - 747)
    when no depot tanks are available
      falls back to standard pressurization logic
  .source_gases_from_depot_tanks
    when settlement has depot tanks
      aggregates gases from all depot tanks (FAILED - 748)
      returns empty hash when no gases are stored (FAILED - 749)
    when settlement has no depot tanks
      returns empty hash
    when depot tanks have no gas_storage data
      returns empty hash (FAILED - 750)
  mining byproduct integration
    when mining Si produces O2 byproduct
      increases available gases from depot tanks for pressurization (FAILED - 751)

PressurizationService
  #check_sealing_status
    with traditional sealed environment
      returns ready for sealed environment (FAILED - 752)
      returns not ready for unsealed environment (FAILED - 753)
    with pressurization target (lava tube)
      returns not ready when requirements not met (FAILED - 754)
      returns ready when requirements met (FAILED - 755)
    with pressurization target (canyon)
      returns not ready when requirements not met (FAILED - 756)

ProcessingService
  #process
    when owner has sufficient resources and funds
      successfully processes the blueprint and creates unassembled items (FAILED - 757)
    when owner does not have enough resources
      returns an error when resources are insufficient (FAILED - 758)
    when owner does not have enough GCC
      raises an error when GCC is insufficient (FAILED - 759)

RewardService
  .pay_out
    with credits reward
      creates a transaction for the player
      applies market adjustment when specified
    with resources reward
      adds resources to the settlement inventory
    with mixed reward
      pays both credits and resources
    with invalid reward data
      returns false for nil reward
      returns false for unknown reward type

SkylightArrayCalculator
  .calculate_materials
    calculates required 3D-printed I-beams from regolith
  .calculate_printer_requirements
    calculates required 3D printer capacity
  .estimate_construction_time
    estimates construction time based on skylight size

SpecialMissionService
  .generate_critical_mission
    when mission should be generated
      creates a special mission with EAP-based reward
      applies correct bonus multiplier for different urgency levels
      sets appropriate expiry times
    when mission should not be generated
      returns nil when EAP cannot be calculated
      returns nil when should_generate_mission? returns false
  .check_and_generate_missions
    generates missions for settlements with critical shortages
    does not generate missions for settlements with normal levels
  private methods
    .should_generate_mission?
      returns false when settlement has sufficient material
      returns false when internal logistics can handle the shortage
      returns false when mission already exists for material
      returns true when all conditions are met

StarSim::ProceduralGenerator
  #initialize
    loads terraformable templates if they exist
    handles missing template file gracefully
    handles malformed template JSON gracefully
  #generate_system_seed
    generates a complete system structure
    uses the correct system identifier format
  #generate_terrestrial_planets
    with available templates
      uses templates for approximately 40% of planets
      requests terraformed names for template-based planets (FAILED - 760)
      requests neutral names for procedural planets (FAILED - 761)
      applies orbital optimization for template-based planets (FAILED - 762)
      generates procedural planets when not using templates (FAILED - 763)
    without templates
      generates all planets procedurally
  #generate_from_template
    creates planet data based on template
    applies small variations to prevent identical planets
    recalculates dependent properties after variation
  #generate_optimized_orbital_parameters
    places planets near habitable zone for terraformable planets
    calculates orbital period correctly
  #calculate_habitable_zone_center
    returns 1 AU for sun-like stars
    scales with stellar luminosity
    defaults to 1 AU when no star provided
  #generate_biosphere_data
    provides enhanced biosphere for template-based planets (FAILED - 764)
    provides basic biosphere for planets with good conditions (FAILED - 765)
    returns empty biosphere for unsuitable planets (FAILED - 766)
  #generate_stars
    generates stars with realistic spectral types
    respects spectral type probability distribution
  #generate_system_seed_file
Generated seed file: /home/galaxy_game/app/data/generated_star_systems/generated_TEST-SYSTEM_20260113_042405.json
    creates a JSON file with system data
Generated seed file: /home/galaxy_game/app/data/generated_star_systems/generated_TEST-SYSTEM_20260113_042405.json
    includes timestamp in filename
  #load_terraformable_templates
    loads templates successfully
    loads at least 4 templates
    only includes terrestrial planets
    ensures templates have required fields
  integration test
    generates a complete, valid system (FAILED - 767)
    validates schema for all planet types
    uses terraformable templates at an expected rate
    generates large systems without structural degradation

StarSim::SystemGeneratorService
  #generate!
    when generating a random system
      creates the specified number of stars
      creates celestial bodies
      updates the solar system name and identifier
    with a predefined system
      delegates to SystemBuilderService for building the system

StarSim::ProceduralGenerator
  #generate_system
    creates the specified number of stars
    creates the specified number of celestial bodies

TerraSim::AtmosphereSimulationService
  #initialize
    initializes with a celestial body (FAILED - 768)
    sets up the Stefan-Boltzmann constant (FAILED - 769)
  #simulate
    updates the pressure (FAILED - 770)
    calculates the greenhouse effect (FAILED - 771)
    updates temperature data in the atmosphere (FAILED - 772)
    simulates atmospheric loss (FAILED - 773)
    decreases dust (FAILED - 774)
  temperature calculation methods
    calculates stefan_boltzmann_temp correctly (FAILED - 775)
    calculates greenhouse_adjusted_temp correctly (FAILED - 776)
    calculates water_vapor_pressure correctly (FAILED - 777)
  #update_temperatures
    updates all temperature types in atmosphere (FAILED - 778)

TerraSim::BiosphereGeosphereInterfaceService
  #initialize
    sets the celestial body and sphere references
  #simulate
    calculates and updates soil health based on both spheres
    when spheres are missing
      returns nil if biosphere is missing
      returns nil if geosphere is missing

TerraSim::BiosphereSimulationService
  #initialize
    initializes with a celestial body and sets the biosphere
  #simulate
    runs the biosphere simulation steps
    prevents concurrent simulations
    does nothing if biosphere is nil
  #calculate_biosphere_conditions
    calculates and updates habitable ratio and ice latitude
    calls update_biodiversity and influence_atmosphere
  #simulate_ecosystem_interactions
  Simulating interactions in Biome-7d406fae-b926-4916-a735-1197364da126 (Vegetation Cover: 0.51)
    Plant growth: 0.51 → 0.51 (Light: 0.69, Temp: 0.33, Moisture: 0.3)
  Simulating interactions in Biome-fd5868cc-574c-4ea9-baee-0dc8573d7536 (Vegetation Cover: 0.29)
    Plant growth: 0.29 → 0.3 (Light: 0.69, Temp: 0.5, Moisture: 0.7)
    simulates plant growth and updates vegetation cover
    simulates basic animal activity (logging for now)
  #track_species_population
    updates species populations based on birth and death rates
  #manage_food_web
    simulates herbivore consumption and updates vegetation
    simulates carnivore predation and updates prey population
  #balance_biomes
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 70.0
  Adjusting global temperatures:
  - Tropical: 300.0 → 300.88235294117646
  - Polar: 260.0 → 273.1674836601307
  - Target: 301.7647058823529 (based on biome optima)
  Biome Biome-5d4abe1d-1bd2-4e53-b24c-77d8dea47e97: moisture 1, area 82.73%
  Biome Biome-5befbf1a-2e5d-4727-b1cb-804eae0e5563: moisture 0.44, area 91.72%
    attempts to adjust global temperatures towards biome optima
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 70.0
  Adjusting global temperatures:
  - Tropical: 300.0 → 300.88235294117646
  - Polar: 260.0 → 273.1674836601307
  - Target: 301.7647058823529 (based on biome optima)
  Biome Biome-fafaf149-fc68-453c-912d-391e02bc2662: moisture 1, area 19.59%
  Biome Biome-efdeab49-9650-4747-899d-d226e7a2e23f: moisture 0.44, area 17.06%
    adjusts biome moisture levels based on climate type
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 70.0
  Adjusting global temperatures:
  - Tropical: 300.0 → 300.88235294117646
  - Polar: 260.0 → 273.1674836601307
  - Target: 301.7647058823529 (based on biome optima)
  Biome Biome-9aa13109-fb31-4937-8ef2-c1aac43d7c26: moisture 1, area 93.81%
  Biome Biome-19c2d379-1f59-4deb-8ac5-cb172c1d9c7b: moisture 0.44, area 12.02%
    attempts to adjust biome area percentages
  #update_biodiversity
    calculates and updates the biodiversity index
  #calculate_biodiversity
    calculates the biodiversity index based on the number of biomes
  #influence_atmosphere
Atmosphere ID: 5232
Celestial Body's atmosphere_id: 5232
Initial gases after reset:
No life forms with terraforming effects, using default values
Vegetation scaling factor: 0.4
Atmosphere changes over 1 days:
  O2:  0.0 → 0.0 (+4.0e-06%)
  CO2: 0.0 → 0.0 (-4.0e-06%)
  CH4: 0.0 → 0.0 (+1.0e-06%)
Calculated gas masses: O2=0.0, CO2=0.0, CH4=0.0
Final gases after influence_atmosphere:
  - O2: 80.0%, 4.000000000000001e-06 kg
  - CH4: 20.0%, 1.0e-06 kg
    simulates gas exchange with the atmosphere
  private #calculate_light_availability
    calculates light availability based on star luminosity and atmospheric dust
  private #calculate_temperature_suitability
--- DEBUG: Before calculate_temperature_suitability ---
Atmosphere ID: 5234, CelestialBody ID: 4926, Biosphere ID: 3062
Atmosphere temperature_data: {"polar_temperature" => 300.0, "tropical_temperature" => 300.0}
Biosphere tropical_temperature (delegated): 300.0
Biosphere polar_temperature (delegated): 300.0
----------------------------------------------------
--- DEBUG: Before test execution ---
Biosphere tropical_temperature: 300.0
Biosphere polar_temperature: 300.0
Using temperature range that includes actual average: 295.0..305.0
--- DEBUG: Inside test 'within range' ---
Calculated suitability: 1.0
    calculates temperature suitability for a given range when within range
--- DEBUG: Before calculate_temperature_suitability ---
Atmosphere ID: 5235, CelestialBody ID: 4927, Biosphere ID: 3063
Atmosphere temperature_data: {"polar_temperature" => 300.0, "tropical_temperature" => 300.0}
Biosphere tropical_temperature (delegated): 300.0
Biosphere polar_temperature (delegated): 300.0
----------------------------------------------------
--- DEBUG: Inside test 'outside range' ---
Atmosphere temperature_data (after update): {"polar_temperature" => 280.0, "tropical_temperature" => 280.0}
Biosphere tropical_temperature (delegated, after update): 280.0
Biosphere polar_temperature (delegated, after update): 280.0
Calculated suitability: 0.0
------------------------------------------
    calculates temperature suitability for a given range when outside range
  terraforming integration
    #calculate_life_form_atmospheric_effects
      with no life forms
        returns zero effects
      with multiple life forms
        aggregates effects from all species
    #influence_atmosphere with life forms
Using life form atmospheric effects (1 species)
Life form contributions per day: O2=0.1, CO2 consumed=0.05, CH4=0.01
Vegetation scaling factor: 0.4
Atmosphere changes over 10 days:
  O2:  0.0 → 0.4 (+0.4%)
  CO2: 0.0 → 0.0 (-0.2%)
  CH4: 0.0 → 0.1 (+0.1%)
Calculated gas masses: O2=0.4, CO2=0.0, CH4=0.1
DEBUG: Gas records after simulation:
  O2: 0.4 kg
  CH4: 0.1 kg
      uses life form effects when available
Using life form atmospheric effects (1 species)
Life form contributions per day: O2=0.1, CO2 consumed=0.05, CH4=0.01
Vegetation scaling factor: 0.4
Atmosphere changes over 1 days:
  O2:  0.0 → 0.04 (+0.04%)
  CO2: 0.0 → 0.0 (-0.02%)
  CH4: 0.0 → 0.01 (+0.01%)
Calculated gas masses: O2=0.04, CO2=0.0, CH4=0.01
Using life form atmospheric effects (1 species)
Life form contributions per day: O2=0.1, CO2 consumed=0.05, CH4=0.01
Vegetation scaling factor: 0.4
Atmosphere changes over 10 days:
  O2:  0.0 → 0.4 (+0.4%)
  CO2: 0.0 → 0.0 (-0.2%)
  CH4: 0.0 → 0.1 (+0.1%)
Calculated gas masses: O2=0.4, CO2=0.0, CH4=0.1
DEBUG: O2 mass after 1 day: 0.04000000000000001
DEBUG: O2 mass after 10 days: 0.4
      scales effects by time
No life forms with terraforming effects, using default values
Vegetation scaling factor: 0.4
Atmosphere changes over 1 days:
  O2:  0.0 → 0.0 (+4.0e-06%)
  CO2: 0.0 → 0.0 (-4.0e-06%)
  CH4: 0.0 → 0.0 (+1.0e-06%)
Calculated gas masses: O2=0.0, CO2=0.0, CH4=0.0
DEBUG: Gas records after fallback simulation:
  O2: 4.000000000000001e-06 kg
  CH4: 1.0e-06 kg
      falls back to hardcoded values when no life forms
    #simulate with time parameter
  Simulating interactions in Biome-5bb173f0-13d6-4402-932a-404a742f104b (Vegetation Cover: 0.25)
    Plant growth: 0.25 → 0.25 (Light: 0.69, Temp: 0.0, Moisture: 0.7)
  Simulating interactions in Biome-588bd4bd-4309-429b-9ef6-0d4d83060c65 (Vegetation Cover: 1.0)
    Plant growth: 1.0 → 1.0 (Light: 0.69, Temp: 0.0, Moisture: 0.3)
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 70.0
  Adjusting global temperatures:
  - Tropical: 300.0 → 300.88235294117646
  - Polar: 260.0 → 273.1674836601307
  - Target: 301.7647058823529 (based on biome optima)
  Biome Biome-5bb173f0-13d6-4402-932a-404a742f104b: moisture 1, area 28.86%
  Biome Biome-588bd4bd-4309-429b-9ef6-0d4d83060c65: moisture 0.44, area 21.21%
No life forms with terraforming effects, using default values
Vegetation scaling factor: 0.4
Atmosphere changes over 100 days:
  O2:  0.0 → 0.0004 (+0.0004%)
  CO2: 0.0 → 0.0 (-0.0004%)
  CH4: 0.0 → 0.0001 (+0.0001%)
Calculated gas masses: O2=0.0, CO2=0.0, CH4=0.0
      stores time_skipped for use in other methods
  Simulating interactions in Biome-94a04715-df0a-4543-92e7-b6c2f1a53b75 (Vegetation Cover: 0.24)
    Plant growth: 0.24 → 0.24 (Light: 0.69, Temp: 0.0, Moisture: 0.3)
  Simulating interactions in Biome-736075d2-75e3-4e22-9ba6-a1dc2599b442 (Vegetation Cover: 0.45)
    Plant growth: 0.45 → 0.45 (Light: 0.69, Temp: 0.0, Moisture: 0.7)
Balancing biomes based on climate and ecosystem conditions
Global liquid water availability: 70.0
  Adjusting global temperatures:
  - Tropical: 300.0 → 300.88235294117646
  - Polar: 260.0 → 273.1674836601307
  - Target: 301.7647058823529 (based on biome optima)
  Biome Biome-94a04715-df0a-4543-92e7-b6c2f1a53b75: moisture 0.44, area 95.0%
  Biome Biome-736075d2-75e3-4e22-9ba6-a1dc2599b442: moisture 1, area 91.86%
      passes time to influence_atmosphere

TerraSim::ExoticWorldSimulationService
  #initialize
    sets planet-specific options
    accepts custom options
  #planet_type
    determines planet type from temperature and elements
    uses planet_type from celestial body if available
    defaults to terrestrial for unknown combinations
  #simulate_planet_specific_processes
    with an ice giant
DEBUG: planet_type = :ice_giant
DEBUG: temp_range = 
[-100, -50]
DEBUG: primary_elements = 
["Methane"]
      calls ice-specific simulation methods
    with a carbon planet
DEBUG: planet_type = :terrestrial
DEBUG: temp_range = 
[238.0, 338.0]
DEBUG: primary_elements = 
["Silicon", "Oxygen"]
No specific exotic processes for terrestrial planet.
      calls carbon planet-specific methods
  #simulate_diamond_formation
Converted 5.0 kg of Carbon to Diamond.
    converts carbon to diamond
  #simulate_cryovolcanism
Initiating cryovolcanic eruption...
Cryovolcanic eruption complete.
    adds frozen materials to the planet
  #simulate_extreme_pressure
    converts hydrogen to metallic hydrogen at extreme pressure

TerraSim::GeosphereInitializer
  initializing terrestrial planet geosphere
    creates a geosphere with terrestrial properties
  ice giant initialization
    sets up ice_tectonics_enabled for ice giants (PENDING: ice_tectonics_enabled attribute doesn't exist in Geosphere model)
    creates appropriate ice materials
    creates appropriate mantle materials
  exotic materials initialization
    creates hydrogen in metallic state under extreme conditions
  material state determination
    creates hydrogen as gas in the crust
    creates water ice as solid
  #determine_state
    returns solid for materials with Ice in name
    returns gas for hydrogen and helium
    returns metallic_hydrogen for that specific material
  #calculate_layer_mass
    calculates different masses for different layers

TerraSim::GeosphereInitializer
  initializing terrestrial planet geosphere
    creates a geosphere with terrestrial properties
  ice giant initialization
    sets up ice_tectonics_enabled for ice giants (FAILED - 779)
    creates appropriate ice materials
  exotic materials initialization
    creates hydrogen in metallic state under extreme conditions
  regolith property initialization
    initializes regolith properties for planets with atmospheres (FAILED - 780)
    initializes regolith properties for airless bodies (FAILED - 781)

TerraSim::GeosphereSimulationService
  #initialize
    initializes with a celestial body and its geosphere
    sets up initial values from the geosphere
  #simulate
    calls all the simulation methods in order
  #simulate_tectonic_activity
    updates plate positions when tectonic activity is enabled (FAILED - 782)
    does nothing when tectonic activity is disabled
  #manage_regolith_properties
    calculates weathering rate and updates geosphere
  #calculate_weathering_rate
    returns a non-negative value
    with atmosphere and hydrosphere
      calculates a higher weathering rate
  #eruption
💥 EXECUTING eruption 4972-1768278316-899 for body 4972
Adding 239.0 kg of Carbon Dioxide to atmosphere [Emission: carbon_dioxide_6017]
Adding 270.90000000000003 kg of Sulfur Dioxide to atmosphere [Emission: sulfur_dioxide_ff0a]
Adding 628.5 kg of Water to atmosphere [Emission: water_9238]
Adding 214.2 kg of Hydrogen Chloride to atmosphere [Emission: hydrogen_chloride_827e]
Sunlight reduced by 9.0% due to volcanic dust.
Eruption occurred near the ocean, triggering evaporation.
    adds volcanic gases to the atmosphere

TerraSim::HydrosphereSimulationService
  #initialize
    initializes with a celestial body and its spheres
    sets up material lookup service
  #simulate
    calls all simulation methods in order
    prevents recursive calls with simulation flag
    does not run if any required sphere is missing
  #calculate_region_temperatures
    calculates temperatures for all water bodies
    sets water temperatures cooler than surface temperature
  #handle_evaporation
    decreases water body volumes
    adds water vapor to the atmosphere
    handles numeric volume values (not hashes)
  #handle_precipitation
    increases water body volumes
    removes water vapor from the atmosphere
    decreases atmospheric dust concentration
  #calculate_state_distributions
    calculates state distribution based on temperature and pressure
  #handle_ice_melting
    when temperature is above freezing
      melts ice from polar caps
      updates state distribution to decrease solid percentage
      updates state distribution to increase liquid percentage
      does not allow solid percentage to go negative
      adds some melted water as vapor to atmosphere
      does not melt more than maximum allowed per cycle
    when temperature is below freezing
      does not melt any ice
    when ice caps do not exist
      returns early without error
  #update_hydrosphere_volume
    delegates to the hydrosphere model method
  integration: full simulation cycle
    runs a complete simulation without errors
    maintains valid state distribution percentages
    never produces negative state distribution values
  edge cases
    with extreme cold temperature
      handles extreme cold without errors
    with extreme hot temperature
      handles extreme heat without errors
    with zero water bodies
      handles zero volumes without errors

TerraSim::Simulator
  #calc_current
    when star is present
      updates the surface temperature
      simulates the atmosphere
      simulates the biosphere-geosphere interface
    when no star is present
      sets the temperature to space background temperature

Tier1PriceModeler
  #calculate_eap
    with titanium alloy
      calculates the correct EAP
======================================================================
EARTH ANCHOR PRICE (EAP) BREAKDOWN
Material: Titanium Alloy
Route: EARTH → LUNA
======================================================================

1. EARTH BASE COST
   Earth Spot Price:        $15.0 USD/kg
   Refining Factor:         ×2.5
   USD to GCC Peg:          1 USD = 1.0 GCC
   Refined Cost (GCC):      $37.5 GCC/kg

2. TRANSPORT COST
   Transport Category:      manufactured
   Transport Cost:          $150.0 GCC/kg

----------------------------------------------------------------------
FINAL EARTH ANCHOR PRICE:   $187.5 GCC/kg
======================================================================

      can print breakdown without errors
    with composite insulation
      calculates the correct EAP
    with pressure valves
      calculates the correct EAP
    with electronics
      calculates the correct EAP
    with different destinations
      calculates different costs for different routes
    with missing data
      returns 0.0 without crashing
  EAP storage for downstream use
    stores calculated EAPs in a hash
  integration with EconomicConfig
    uses transport costs from config
    uses earth spot prices from config when available
  #print_breakdown
    outputs detailed breakdown
======================================================================
EARTH ANCHOR PRICE (EAP) BREAKDOWN
Material: Titanium Alloy
Route: EARTH → LUNA
======================================================================

1. EARTH BASE COST
   Earth Spot Price:        $15.0 USD/kg
   Refining Factor:         ×2.5
   USD to GCC Peg:          1 USD = 1.0 GCC
   Refined Cost (GCC):      $37.5 GCC/kg

2. TRANSPORT COST
   Transport Category:      manufactured
   Transport Cost:          $150.0 GCC/kg

----------------------------------------------------------------------
FINAL EARTH ANCHOR PRICE:   $187.5 GCC/kg
======================================================================

    returns the calculated EAP

TradeService
  #dynamic_price
    calculates the dynamic price based on scarcity, transportation, and market conditions (FAILED - 783)
  #base_price_for_type
    returns the correct base price for raw materials (FAILED - 784)
    returns the correct base price for processed goods (FAILED - 785)
  #fuel_cost_per_unit
    returns the correct fuel cost per unit (FAILED - 786)
  #distance_to_buyer
    calculates the distance between colonies (FAILED - 787)
  #market_conditions
    returns a random market condition modifier (FAILED - 788)

TransactionService
  .process_transaction
    when the buyer has sufficient funds
      processes the transaction successfully
    when the buyer has insufficient funds
      raises an error and does not process the transaction

UnitModuleAssemblyService
  .build_units_and_modules
    creates units from the recommended fit (FAILED - 789)
    creates modules from the recommended fit (FAILED - 790)
    creates rigs from the recommended fit (FAILED - 791)
    processes custom port configurations (FAILED - 792)
    handles missing inventory items gracefully (FAILED - 793)
    handles missing recommended fit data gracefully (FAILED - 794)
    assigns correct port names to components (FAILED - 795)
  .disconnect_unit
    disconnects a unit and returns it to inventory as an item (FAILED - 796)

WormholeConsortiumFormationService
  creates memberships for founding members and updates consortium operational_data (FAILED - 797)
  updates member operational_data with consortium membership (FAILED - 798)

WormholeExpansionService
  #initialize
    initializes with default values
  #find_expansion_opportunities
    finds systems with available wormhole capacity
    excludes systems at maximum capacity
  #create_gate_construction_contract
    creates a contract for gate construction
  #create_rescue_contract
    creates a rescue contract for disconnected players

Guaranteed Market Sale Transaction
  guaranteed sell order execution
    executes atomically and creates all required records
    does not create a SupplyChain record if no matching buy order exists
    creates a Trade record with correct buyer and seller
    marks the order as filled by returning nil
    records a PriceHistory entry after trade execution
    calls TransactionManager.create_transfer with correct arguments
    creates a SupplyChain record with correct volume and status

Pending: (Failures listed here are expected and do not affect your suite's status)

  1) CelestialBodies::BrownDwarf habitable zones has a limited habitable zone
     # Habitable zone calculations not yet implemented for brown dwarfs
     # ./spec/models/celestial_bodies/brown_dwarf_spec.rb:127

  2) CelestialBodies::BrownDwarf relationships with planets can have orbiting planets
     # Brown dwarf planetary systems not yet implemented
     # ./spec/models/celestial_bodies/brown_dwarf_spec.rb:135

  3) CelestialBodies::Spheres::Geosphere#calculate_materials calculates and updates materials based on crust, mantle, and core composition
     # calculate_materials method not yet implemented
     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:45

  4) CelestialBodies::Spheres::Geosphere callbacks triggers TerraSim service after adding a material
     # run_terrasim_service method not yet implemented
     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:168

  5) CelestialBodies::Spheres::Geosphere material transfers transfers material to atmosphere when heated
     # heat_material method not yet implemented
     # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:219

  6) Galaxy#total_mass calculates total mass properly
     # Implement this when total_mass method exists
     # ./spec/models/galaxy_spec.rb:89

  7) Lookup::CraftLookupService#find_craft with real craft data handles special characters in queries
     # No special characters in craft name
     # ./spec/services/lookup/craft_lookup_service_spec.rb:129

  8) Lookup::ItemLookupService#find_item finds consumable items with correct data
     # No consumable item files found
     # ./spec/services/lookup/item_lookup_service_spec.rb:17

  9) Lookup::ItemLookupService#find_item finds equipment items with correct data
     # No equipment item files found
     # ./spec/services/lookup/item_lookup_service_spec.rb:31

  10) Lookup::ItemLookupService#find_item caches results for subsequent lookups
     # Item battery_cells not found
     # ./spec/services/lookup/item_lookup_service_spec.rb:68

  11) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has all expected top-level unit properties
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:147

  12) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has performance properties if applicable
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:153

  13) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has operational properties
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:158

  14) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has maintenance requirements if defined
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:166

  15) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has operational modes if defined
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:171

  16) Lookup::UnitLookupService unit data structure validation when any propulsion unit exists has telemetry metadata if defined
     # No propulsion units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:179

  17) Lookup::UnitLookupService unit data structure validation when any storage unit exists has storage capacity properties
     # No storage units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:195

  18) Lookup::UnitLookupService unit data structure validation when any storage unit exists has alias support if defined
     # No storage units found
     # ./spec/services/lookup/unit_lookup_service_spec.rb:203

  19) TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants
      # ice_tectonics_enabled attribute doesn't exist in Geosphere model
      Failure/Error: expect(ice_giant.geosphere.ice_tectonics_enabled).to be true

      NoMethodError:
        undefined method 'ice_tectonics_enabled' for an instance of CelestialBodies::Spheres::Geosphere
      # ./spec/services/terra_sim/geosphere_initalizer_spec.rb:82:in 'block (3 levels) in <main>'

Failures:

  1) Alien World Templates Integrity exists and is valid JSON
     Failure/Error: expect(File.exist?(template_path)).to be true

       expected true
            got false
     # ./spec/data/templates/alien_world_templates_spec.rb:16:in 'block (2 levels) in <main>'

  2) Alien World Templates Integrity metadata exists
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:21:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:24:in 'block (3 levels) in <main>'

  3) Alien World Templates Integrity metadata has required fields
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:21:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:37:in 'block (4 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:36:in 'Array#each'
     # ./spec/data/templates/alien_world_templates_spec.rb:36:in 'block (3 levels) in <main>'

  4) Alien World Templates Integrity metadata is versioned correctly
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:21:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:42:in 'block (3 levels) in <main>'

  5) Alien World Templates Integrity terrestrial planet templates exists and is an array
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:51:in 'block (3 levels) in <main>'

  6) Alien World Templates Integrity terrestrial planet templates contains exactly 25 templates
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:55:in 'block (3 levels) in <main>'

  7) Alien World Templates Integrity terrestrial planet templates has unique identifiers
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:59:in 'block (3 levels) in <main>'

  8) Alien World Templates Integrity terrestrial planet templates covers Template-A01 through Template-A25
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:65:in 'block (3 levels) in <main>'

  9) Alien World Templates Integrity terrestrial planet templates all templates are terrestrial
     Failure/Error: JSON.parse(File.read(template_path))

     Errno::ENOENT:
       No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
     # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:48:in 'block (3 levels) in <main>'
     # ./spec/data/templates/alien_world_templates_spec.rb:70:in 'block (3 levels) in <main>'

  10) Alien World Templates Integrity template schema validation each template contains all required fields
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:89:in 'block (3 levels) in <main>'

  11) Alien World Templates Integrity atmospheric constraints contains no oxygen by default
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:100:in 'block (3 levels) in <main>'

  12) Alien World Templates Integrity sanity checks has realistic gravity values
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:110:in 'block (3 levels) in <main>'

  13) Alien World Templates Integrity sanity checks has positive pressure
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:116:in 'block (3 levels) in <main>'

  14) Alien World Templates Integrity sanity checks terraforming difficulty is bounded
      Failure/Error: JSON.parse(File.read(template_path))

      Errno::ENOENT:
        No such file or directory @ rb_sysopen - /home/galaxy_game/data/json-data/templates/alien_world_templates_v1.1.json
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'IO.read'
      # ./spec/data/templates/alien_world_templates_spec.rb:12:in 'block (2 levels) in <main>'
      # ./spec/data/templates/alien_world_templates_spec.rb:122:in 'block (3 levels) in <main>'

  15) GameDataPaths sets the correct path based on environment
      Failure/Error: expect(GalaxyGame::Paths::JSON_DATA).to eq(Rails.root.join('data', 'json-data'))

        expected: #<Pathname:/home/galaxy_game/data/json-data>
             got: #<Pathname:/home/galaxy_game/app/data>

        (compared using ==)

        Diff:
        @@ -1 +1 @@
        -#<Pathname:/home/galaxy_game/data/json-data>
        +#<Pathname:/home/galaxy_game/app/data>
      # ./spec/initializers/game_data_paths_spec.rb:6:in 'block (2 levels) in <main>'

  16) Component Production Game Loop Integration full production cycle produces components through game loop progression
      Failure/Error: expect(job.status).to eq('completed')

        expected: "completed"
             got: "in_progress"

        (compared using ==)
      # ./spec/integration/component_production_game_loop_spec.rb:135:in 'block (3 levels) in <main>'

  17) Component Production Game Loop Integration full production cycle handles partial progress over multiple ticks
      Failure/Error: expect(job.status).to eq('completed')

        expected: "completed"
             got: "in_progress"

        (compared using ==)
      # ./spec/integration/component_production_game_loop_spec.rb:160:in 'block (3 levels) in <main>'

  18) Component Production Game Loop Integration full production cycle processes multiple jobs simultaneously
      Failure/Error: expect(job1.reload.status).to eq('completed')

        expected: "completed"
             got: "in_progress"

        (compared using ==)
      # ./spec/integration/component_production_game_loop_spec.rb:180:in 'block (3 levels) in <main>'

  19) Covering System Integration Lava tube worldhouse covering workflow seals skylights when worldhouse construction completes
      Failure/Error:
        Lookup::PlanetaryGeologicalFeatureLookupService
          .new(celestial_body)
          .find_by_id(feature_id)

      NoMethodError:
        undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
      # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
      # ./app/models/celestial_bodies/features/base_feature.rb:42:in 'CelestialBodies::Features::BaseFeature#name'
      # ./spec/integration/covering_system_integration_spec.rb:76:in 'block (3 levels) in <main>'

  20) Covering System Integration Worldhouse segment covering workflow handles massive scale covering
      Failure/Error:
        Structures::Worldhouse.create!(
          name: 'Valles Marineris Worldhouse',
          geological_feature: valley,
          settlement: mars_settlement,
          owner: mars_settlement.owner,
          structure_name: 'worldhouse',
          operational_data: {
            "structure_type" => "worldhouse",
            "connection_systems" => {
              "power_distribution" => {"status" => "offline", "efficiency" => 85}

      ActiveRecord::RecordInvalid:
        Validation failed: Structure type can't be blank
      # ./spec/integration/covering_system_integration_spec.rb:114:in 'block (3 levels) in <main>'
      # ./spec/integration/covering_system_integration_spec.rb:147:in 'block (3 levels) in <main>'
      # ./spec/integration/covering_system_integration_spec.rb:157:in 'block (3 levels) in <main>'

  21) Covering System Integration Multi-scale comparison uses same system for different scales
      Failure/Error:
        worldhouse = Structures::Worldhouse.create!(
          name: 'Test Worldhouse',
          geological_feature: valley,
          settlement: mars_settlement,
          owner: mars_settlement.owner,
          structure_name: 'worldhouse',
          operational_data: {
            "structure_type" => "worldhouse",
            "connection_systems" => {
              "power_distribution" => {"status" => "offline", "efficiency" => 85}

      ActiveRecord::RecordInvalid:
        Validation failed: Structure type can't be blank
      # ./spec/integration/covering_system_integration_spec.rb:193:in 'block (3 levels) in <main>'

  22) Manufacturing Pipeline End-to-End complete ISRU to enclosed tank pipeline processes raw regolith through all stages to produce an enclosed tank
      Failure/Error: expect(pve_job.status).to eq('completed')

        expected: #<Encoding:UTF-8> "completed"
             got: #<Encoding:US-ASCII> "in_progress"

        (compared using ==)
      # ./spec/integration/manufacturing_pipeline_e2e_spec.rb:365:in 'block (3 levels) in <main>'

  23) Manufacturing Pipeline End-to-End material tracking through pipeline preserves composition metadata through processing chain
      Failure/Error: expect(processed.metadata['composition']).to be_present

      NoMethodError:
        undefined method 'metadata' for nil
      # ./spec/integration/manufacturing_pipeline_e2e_spec.rb:615:in 'block (3 levels) in <main>'

  24) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time decreases CO2 levels after 1 day
      Failure/Error: expect(atmosphere.co2_percentage).to be < initial_co2

        expected: < 95.32000000000001
             got:   99.31808644565675
      # ./spec/integration/terraforming_integration_spec.rb:137:in 'block (5 levels) in <main>'

  25) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time shows progressive changes over 100 days
      Failure/Error: if tropical_temp > 273 && polar_temp < 273

      ArgumentError:
        comparison of String with 273 failed
      # ./app/services/terra_sim/biosphere_simulation_service.rb:250:in 'Comparable#<'
      # ./app/services/terra_sim/biosphere_simulation_service.rb:250:in 'TerraSim::BiosphereSimulationService#calculate_biosphere_conditions'
      # ./app/services/terra_sim/biosphere_simulation_service.rb:24:in 'TerraSim::BiosphereSimulationService#simulate'
      # ./spec/integration/terraforming_integration_spec.rb:148:in 'block (6 levels) in <main>'
      # ./spec/integration/terraforming_integration_spec.rb:146:in 'Array#each'
      # ./spec/integration/terraforming_integration_spec.rb:146:in 'block (5 levels) in <main>'

  26) Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time scales effects by time parameter
      Failure/Error: if tropical_temp > 273 && polar_temp < 273

      ArgumentError:
        comparison of String with 273 failed
      # ./app/services/terra_sim/biosphere_simulation_service.rb:250:in 'Comparable#<'
      # ./app/services/terra_sim/biosphere_simulation_service.rb:250:in 'TerraSim::BiosphereSimulationService#calculate_biosphere_conditions'
      # ./app/services/terra_sim/biosphere_simulation_service.rb:24:in 'TerraSim::BiosphereSimulationService#simulate'
      # ./spec/integration/terraforming_integration_spec.rb:186:in 'block (5 levels) in <main>'

  27) Terraforming Integration realistic terraforming scenario demonstrates full terraforming workflow
      Failure/Error: return composition[formula_or_name].to_f if composition[formula_or_name]

      NoMethodError:
        undefined method 'to_f' for an instance of ActiveSupport::HashWithIndifferentAccess
      # ./app/models/concerns/atmosphere_concern.rb:20:in 'AtmosphereConcern#gas_percentage'
      # ./app/models/concerns/atmosphere_concern.rb:31:in 'AtmosphereConcern#co2_percentage'
      # ./spec/integration/terraforming_integration_spec.rb:327:in 'block (3 levels) in <main>'

  28) Terraforming Workflow Integration transforms atmosphere over time with deployed organisms
      Failure/Error: biosphere.deploy_starter_ecosystem

      NoMethodError:
        undefined method 'deploy_starter_ecosystem' for an instance of CelestialBodies::Spheres::Biosphere
      # ./spec/integration/terraforming_workflow_spec.rb:77:in 'block (2 levels) in <main>'

  29) Terraforming Workflow Integration allows monitoring of terraforming progress
      Failure/Error: biosphere.deploy_terraforming_organism(:cyanobacteria)

      NoMethodError:
        undefined method 'deploy_terraforming_organism' for an instance of CelestialBodies::Spheres::Biosphere
      # ./spec/integration/terraforming_workflow_spec.rb:108:in 'block (2 levels) in <main>'

  30) ConcurrentTaskWorkerJob#perform with manufacturing task during daylight executes the task successfully
      Failure/Error: allow(location).to receive(:solar_output_factor).and_return(1.0)
        #<Location::CelestialLocation id: 1215, name: "Location 4", coordinates: "5.31°N 98.55°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 962, celestial_body_id: 2660, created_at: "2026-01-13 04:09:00.068103000 +0000", updated_at: "2026-01-13 04:09:00.086552000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:30:in 'block (4 levels) in <main>'

  31) ConcurrentTaskWorkerJob#perform with manufacturing task during daylight generates manufacturing byproducts
      Failure/Error: allow(location).to receive(:solar_output_factor).and_return(1.0)
        #<Location::CelestialLocation id: 1216, name: "Location 5", coordinates: "10.94°S 45.31°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 963, celestial_body_id: 2661, created_at: "2026-01-13 04:09:00.451819000 +0000", updated_at: "2026-01-13 04:09:00.469532000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:30:in 'block (4 levels) in <main>'

  32) ConcurrentTaskWorkerJob#perform with manufacturing task during low light does not generate byproducts
      Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.05) # Below 0.1 threshold
        #<Location::CelestialLocation id: 1217, name: "Location 6", coordinates: "34.07°S 131.83°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 964, celestial_body_id: 2662, created_at: "2026-01-13 04:09:00.602415000 +0000", updated_at: "2026-01-13 04:09:00.619831000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:51:in 'block (4 levels) in <main>'

  33) ConcurrentTaskWorkerJob#perform with non-manufacturing task does not attempt byproduct generation
      Failure/Error: solar_factor = settlement.location&.solar_output_factor || 1.0

      NoMethodError:
        undefined method 'solar_output_factor' for an instance of Location::CelestialLocation
      # ./app/jobs/concurrent_task_worker_job.rb:30:in 'ConcurrentTaskWorkerJob#handle_manufacturing_byproducts'
      # ./app/jobs/concurrent_task_worker_job.rb:12:in 'ConcurrentTaskWorkerJob#perform'
      # /usr/local/bundle/gems/i18n-1.14.7/lib/i18n.rb:348:in 'I18n::Base#with_locale'
      # ./spec/jobs/concurrent_task_worker_job_spec.rb:73:in 'block (4 levels) in <main>'

  34) Account#deposit with a valid amount increases the account balance
      Failure/Error:
        expect { player_account.deposit(500, "Test deposit") }
          .to change { player_account.reload.balance }.from(1_000).to(1_500)

        expected `player_account.reload.balance` to have changed from 1000 to 1500, but did not change
      # ./spec/models/account_spec.rb:24:in 'block (4 levels) in <main>'

  35) Account#withdraw when funds are sufficient decreases the account balance
      Failure/Error:
        expect { player_account.withdraw(500, "Test withdrawal") }
          .to change { player_account.reload.balance }.from(1_000).to(500)

        expected `player_account.reload.balance` to have changed from 1000 to 500, but did not change
      # ./spec/models/account_spec.rb:49:in 'block (4 levels) in <main>'

  36) Account#transfer_funds when funds are sufficient transfers the amount from one account to another
      Failure/Error:
        expect { player_account.transfer_funds(500, recipient_account, "Test transfer") }
          .to change { player_account.reload.balance }.from(1_000).to(500)
          .and change { recipient_account.reload.balance }.from(500).to(1_000)

           expected `player_account.reload.balance` to have changed from 1000 to 500, but did not change

        ...and:

           expected `recipient_account.reload.balance` to have changed from 500 to 1000, but did not change
      # ./spec/models/account_spec.rb:74:in 'block (4 levels) in <main>'

  37) Account edge cases when balance is exactly zero allows deposits
      Failure/Error:
        expect { player_account.deposit(1_000, "Deposit to zero balance") }
          .to change { player_account.reload.balance }.from(0).to(1_000)

        expected `player_account.reload.balance` to have changed from 0 to 1000, but did not change
      # ./spec/models/account_spec.rb:120:in 'block (4 levels) in <main>'

  38) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:31:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  39) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:32:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  40) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:33:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  41) Atmosphere validations 
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:29:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:34:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  42) Atmosphere#volume when celestial_body responds to volume returns the celestial_body's volume
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:51:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  43) Atmosphere sealing methods #sealed? returns the sealing status
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:76:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:80:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  44) Atmosphere sealing methods #seal! sets sealing status to true
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:85:in 'block (4 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:88:in 'block (5 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:88:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  45) Atmosphere sealing methods #unseal! sets sealing status to false
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:76:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:94:in 'block (5 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:94:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  46) Atmosphere#habitable? with good conditions returns true
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:104:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  47) Atmosphere#habitable? with low pressure returns false
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:110:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  48) Atmosphere#habitable? with low oxygen returns false
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:117:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  49) Atmosphere#habitable? with high CO2 returns false
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:124:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  50) Atmosphere#habitable? with extreme temperature returns false for too cold
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:131:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  51) Atmosphere#habitable? with extreme temperature returns false for too hot
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:100:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:136:in 'block (4 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  52) Atmosphere AtmosphereConcern inclusion includes AtmosphereConcern methods
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:143:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:146:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  53) Atmosphere JSON fields initializes JSON fields with empty objects
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:153:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:156:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  54) Atmosphere JSON fields allows storing data in JSON fields
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:153:in 'block (3 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:164:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  55) Atmosphere parent validation rejects multiple parents
      Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: solar_system) }

      KeyError:
        Trait not registered: "earth"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/atmosphere_spec.rb:20:in 'block (2 levels) in <main>'
      # ./spec/models/atmosphere_spec.rb:194:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "earth"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  56) Units::BiogasGenerator#operate consumes biomass, organic waste, and energy, producing biogas and fertilizer
      Failure/Error:
        BiogasGenerator.new(
          name: 'Basic Biogas Generator',
          material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
          energy_cost: 15  # Updated to use energy_cost
        )

      NameError:
        uninitialized constant BiogasGenerator
      # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
      # ./spec/models/biogas_generator_spec.rb:19:in 'block (3 levels) in <main>'

  57) Units::BiogasGenerator#operate returns false if insufficient biomass is available
      Failure/Error:
        BiogasGenerator.new(
          name: 'Basic Biogas Generator',
          material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
          energy_cost: 15  # Updated to use energy_cost
        )

      NameError:
        uninitialized constant BiogasGenerator
      # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
      # ./spec/models/biogas_generator_spec.rb:29:in 'block (3 levels) in <main>'

  58) Units::BiogasGenerator#operate returns false if insufficient organic waste is available
      Failure/Error:
        BiogasGenerator.new(
          name: 'Basic Biogas Generator',
          material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
          energy_cost: 15  # Updated to use energy_cost
        )

      NameError:
        uninitialized constant BiogasGenerator
      # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
      # ./spec/models/biogas_generator_spec.rb:34:in 'block (3 levels) in <main>'

  59) Units::BiogasGenerator#operate returns false if insufficient energy is available
      Failure/Error:
        BiogasGenerator.new(
          name: 'Basic Biogas Generator',
          material_list: { 'biomass' => 20, 'organic_waste' => 20, 'biogas_output' => 10, 'fertilizer_output' => 5 },
          energy_cost: 15  # Updated to use energy_cost
        )

      NameError:
        uninitialized constant BiogasGenerator
      # ./spec/models/biogas_generator_spec.rb:6:in 'block (2 levels) in <main>'
      # ./spec/models/biogas_generator_spec.rb:39:in 'block (3 levels) in <main>'

  60) Biosphere and Life Form Integration ecosystem simulation simulates population dynamics
      Failure/Error: expect(@plants.reload.population).not_to eq(10_000)

        expected: value != 10000
             got: 10000

        (compared using ==)
      # ./spec/models/biology/biosphere_integration_spec.rb:54:in 'block (3 levels) in <main>'

  61) Units::BiomassRecycler#operate consumes biomass and energy, producing fertilizer and biofuel
      Failure/Error:
        BiomassRecycler.new(
          name: 'Basic Biomass Recycler',
          material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },
          energy_cost: 20  # Updated to use energy_cost
        )

      NameError:
        uninitialized constant BiomassRecycler
      # ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'
      # ./spec/models/biomass_recycler_spec.rb:19:in 'block (3 levels) in <main>'

  62) Units::BiomassRecycler#operate returns false if insufficient biomass is available
      Failure/Error:
        BiomassRecycler.new(
          name: 'Basic Biomass Recycler',
          material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },
          energy_cost: 20  # Updated to use energy_cost
        )

      NameError:
        uninitialized constant BiomassRecycler
      # ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'
      # ./spec/models/biomass_recycler_spec.rb:28:in 'block (3 levels) in <main>'

  63) Units::BiomassRecycler#operate returns false if insufficient energy is available
      Failure/Error:
        BiomassRecycler.new(
          name: 'Basic Biomass Recycler',
          material_list: { 'biomass' => 50, 'fertilizer_output' => 10, 'biofuel_output' => 5 },
          energy_cost: 20  # Updated to use energy_cost
        )

      NameError:
        uninitialized constant BiomassRecycler
      # ./spec/models/biomass_recycler_spec.rb:6:in 'block (2 levels) in <main>'
      # ./spec/models/biomass_recycler_spec.rb:33:in 'block (3 levels) in <main>'

  64) CelestialBodies::Features::BaseFeature#static_data fetches data from lookup service
      Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:30:in 'block (3 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:39:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  65) CelestialBodies::Features::BaseFeature#static_data caches the data
      Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:30:in 'block (3 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:44:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  66) CelestialBodies::Features::BaseFeature#discover! marks feature as discovered
      Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:51:in 'block (3 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:62:in 'block (4 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:59:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  67) CelestialBodies::Features::BaseFeature#discover! sets discovered_at timestamp
      Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:51:in 'block (3 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:66:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  68) CelestialBodies::Features::BaseFeature#discover! does not overwrite existing discovery
      Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:51:in 'block (3 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:71:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  69) CelestialBodies::Features::BaseFeature status transitions transitions through states correctly
      Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:83:in 'block (3 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:91:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  70) CelestialBodies::Features::BaseFeature status transitions cannot skip states
      Failure/Error: let(:feature) { create(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001') }

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:83:in 'block (3 levels) in <main>'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:108:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  71) CelestialBodies::Features::BaseFeature tier helpers identifies strategic features
      Failure/Error: feature = build(:lava_tube_feature, celestial_body: luna, feature_id: 'luna_lt_001', feature_type: 'lava_tube')

      KeyError:
        Factory not registered: "settlement"
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:5:in 'FactoryBot::Strategy::Build#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/features/base_feature_spec.rb:119:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "settlement"
      #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  72) CelestialBodies::Materials::ExoticMaterial associations 
      Failure/Error:
        described_class.new(
          name: 'Metallic Hydrogen', 
          state: 'metallic_hydrogen',
          geosphere: geosphere,
          rarity: 95,
          stability: 20,
          percentage: 10,
          mass: 1000
        ) 

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:25:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  73) CelestialBodies::Materials::ExoticMaterial validations 
      Failure/Error:
        described_class.new(
          name: 'Metallic Hydrogen', 
          state: 'metallic_hydrogen',
          geosphere: geosphere,
          rarity: 95,
          stability: 20,
          percentage: 10,
          mass: 1000
        ) 

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:29:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  74) CelestialBodies::Materials::ExoticMaterial validations 
      Failure/Error:
        described_class.new(
          name: 'Metallic Hydrogen', 
          state: 'metallic_hydrogen',
          geosphere: geosphere,
          rarity: 95,
          stability: 20,
          percentage: 10,
          mass: 1000
        ) 

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:30:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  75) CelestialBodies::Materials::ExoticMaterial validations 
      Failure/Error:
        described_class.new(
          name: 'Metallic Hydrogen', 
          state: 'metallic_hydrogen',
          geosphere: geosphere,
          rarity: 95,
          stability: 20,
          percentage: 10,
          mass: 1000
        ) 

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:31:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  76) CelestialBodies::Materials::ExoticMaterial state helper methods identifies metallic hydrogen state
      Failure/Error:
        described_class.new(
          name: 'Metallic Hydrogen', 
          state: 'metallic_hydrogen',
          geosphere: geosphere,
          rarity: 95,
          stability: 20,
          percentage: 10,
          mass: 1000
        ) 

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:36:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  77) CelestialBodies::Materials::ExoticMaterial state helper methods identifies plasma state
      Failure/Error:
        described_class.new(
          name: 'Metallic Hydrogen', 
          state: 'metallic_hydrogen',
          geosphere: geosphere,
          rarity: 95,
          stability: 20,
          percentage: 10,
          mass: 1000
        ) 

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:43:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:9:in 'block (2 levels) in <main>'

  78) CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns metallic_hydrogen for hydrogen at extreme pressure
      Failure/Error: hydrogen = described_class.new(name: 'Hydrogen')

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:51:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:51:in 'block (3 levels) in <main>'

  79) CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns plasma at extreme temperatures
      Failure/Error: any_material = described_class.new(name: 'Oxygen')

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:56:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:56:in 'block (3 levels) in <main>'

  80) CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns superfluid for helium at low temperatures
      Failure/Error: helium = described_class.new(name: 'Helium')

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:61:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:61:in 'block (3 levels) in <main>'

  81) CelestialBodies::Materials::ExoticMaterial#phase_transition_at falls back to standard states otherwise
      Failure/Error: iron = described_class.new(name: 'Iron')

      ActiveRecord::StatementInvalid:
        PG::UndefinedTable: ERROR:  relation "exotic_materials" does not exist
        LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
                                    ^
      # ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:68:in 'block (3 levels) in <main>'
      # ------------------
      # --- Caused by: ---
      # PG::UndefinedTable:
      #   ERROR:  relation "exotic_materials" does not exist
      #   LINE 9:  WHERE a.attrelid = '"exotic_materials"'::regclass
      #                               ^
      #   ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:68:in 'block (3 levels) in <main>'

  82) CelestialBodies::MinorBodies::DwarfPlanet validations is valid with valid attributes
      Failure/Error: planet = create(:dwarf_planet, solar_system: solar_system)

      NameError:
        uninitialized constant DwarfPlanet
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:7:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:16:in 'block (3 levels) in <main>'

  83) CelestialBodies::MinorBodies::DwarfPlanet#is_spherical? returns true for dwarf planets
      Failure/Error: planet = create(:dwarf_planet, solar_system: solar_system)

      NameError:
        uninitialized constant DwarfPlanet
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:7:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:22:in 'block (3 levels) in <main>'

  84) CelestialBodies::MinorBodies::DwarfPlanet#calculate_geological_activity calculates geological activity based on mass and age
      Failure/Error: planet = create(:dwarf_planet, solar_system: solar_system)

      NameError:
        uninitialized constant DwarfPlanet
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:29:in 'FactoryBot::Factory#build_class'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:14:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:7:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:29:in 'block (3 levels) in <main>'

  85) CelestialBodies::Planets::Gaseous::GasGiant behaves like a gaseous planet calculates cloud bands based on rotation
      Failure/Error: expect(gaseous_planet.calculate_bands).to be_a(Integer)

      NoMethodError:
        undefined method 'calculate_bands' for an instance of CelestialBodies::GasGiant
      Shared Example Group: "a gaseous planet" called from ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:6
      # ./spec/support/shared_examples/gaseous_planet_examples.rb:34:in 'block (2 levels) in <main>'

  86) CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with Jupiter mass estimates a realistic moon count
      Failure/Error: moon_count = gas_giant.estimate_moon_count

      NoMethodError:
        undefined method 'estimate_moon_count' for an instance of CelestialBodies::GasGiant
      # ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:29:in 'block (5 levels) in <main>'

  87) CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with different masses scales moon count with mass
      Failure/Error: original_count = gas_giant.estimate_moon_count

      NoMethodError:
        undefined method 'estimate_moon_count' for an instance of CelestialBodies::GasGiant
      # ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:36:in 'block (5 levels) in <main>'

  88) CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #ring_system_probability returns a high probability for gas giants
      Failure/Error: probability = gas_giant.ring_system_probability

      NoMethodError:
        undefined method 'ring_system_probability' for an instance of CelestialBodies::GasGiant
      # ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:49:in 'block (4 levels) in <main>'

  89) CelestialBodies::Planets::Gaseous::IceGiant behaves like a gaseous planet calculates cloud bands based on rotation
      Failure/Error: expect(gaseous_planet.calculate_bands).to be_a(Integer)

      NoMethodError:
        undefined method 'calculate_bands' for an instance of CelestialBodies::GasGiant
      Shared Example Group: "a gaseous planet" called from ./spec/models/celestial_bodies/planets/gaseous/ice_giant_spec.rb:4
      # ./spec/support/shared_examples/gaseous_planet_examples.rb:34:in 'block (2 levels) in <main>'

  90) CelestialBodies::Planets::Ocean::HyceanPlanet validations requires an atmosphere to be present
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:8:in 'block (3 levels) in <main>'

  91) CelestialBodies::Planets::Ocean::HyceanPlanet validations requires at least 10% hydrogen in atmosphere
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:17:in 'block (3 levels) in <main>'

  92) CelestialBodies::Planets::Ocean::HyceanPlanet validations requires significant atmospheric pressure (>1 atm)
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:25:in 'block (3 levels) in <main>'

  93) CelestialBodies::Planets::Ocean::HyceanPlanet validations is valid with proper hydrogen content and pressure
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:33:in 'block (3 levels) in <main>'

  94) CelestialBodies::Planets::Ocean::HyceanPlanet validations inherits ocean planet water coverage validation
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:38:in 'block (3 levels) in <main>'

  95) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes base ocean planet factors
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:57:in 'block (3 levels) in <main>'

  96) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes hydrogen blanket greenhouse effect
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:63:in 'block (3 levels) in <main>'

  97) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors calculates pressure habitability zones
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:69:in 'block (3 levels) in <main>'

  98) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors indicates expanded habitable temperature range
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:76:in 'block (3 levels) in <main>'

  99) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates optimal pressure range (10-100 atm) as level 3
      Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

      ActiveRecord::RecordInvalid:
        Validation failed: Molar mass is not a number, Molar mass can't be blank
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
      # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
      # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
      # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:82:in 'block (3 levels) in <main>'

  100) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates moderate pressure range (1-10 or 100-1000 atm) as level 2
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:91:in 'block (3 levels) in <main>'

  101) CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates extreme pressure as level 1
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:100:in 'block (3 levels) in <main>'

  102) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes base ocean planet features
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:111:in 'block (3 levels) in <main>'

  103) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes hydrogen atmosphere features
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:117:in 'block (3 levels) in <main>'

  104) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes extreme storm systems for high pressure atmospheres
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:126:in 'block (3 levels) in <main>'

  105) CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features does not include storm systems for lower pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:135:in 'block (3 levels) in <main>'

  106) CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies hydrogen saturated oceans for high H2 content
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:147:in 'block (3 levels) in <main>'

  107) CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies methane rich oceans when CH4 is present
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:154:in 'block (3 levels) in <main>'

  108) CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry returns unknown when hydrosphere composition is missing
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:163:in 'block (3 levels) in <main>'

  109) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth calculates habitable depth range based on pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:174:in 'block (3 levels) in <main>'

  110) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth sets deeper minimum depth for higher pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:182:in 'block (3 levels) in <main>'

  111) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth ensures maximum depth is greater than minimum
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:192:in 'block (3 levels) in <main>'

  112) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when atmosphere is missing
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:198:in 'block (3 levels) in <main>'

  113) CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when hydrosphere is missing
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:205:in 'block (3 levels) in <main>'

  114) CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) calculates hydrogen percentage from atmosphere
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:215:in 'block (3 levels) in <main>'

  115) CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) returns 0 when H2 gas is not present
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:223:in 'block (3 levels) in <main>'

  116) CelestialBodies::Planets::Ocean::HyceanPlanet STI type sets the correct STI type
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:233:in 'block (3 levels) in <main>'

  117) CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high surface temperature
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:238:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:241:in 'block (3 levels) in <main>'

  118) CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high atmospheric pressure
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:238:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:245:in 'block (3 levels) in <main>'

  119) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has below-freezing surface temperature
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:253:in 'block (3 levels) in <main>'

  120) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has significant ice coverage
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:257:in 'block (3 levels) in <main>'

  121) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has higher ammonia content as antifreeze
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:263:in 'block (3 levels) in <main>'

  122) CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has mixed liquid-solid state distribution
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:250:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:269:in 'block (3 levels) in <main>'

  123) CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet inherits water_volume calculation
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:278:in 'block (3 levels) in <main>'

  124) CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet can analyze water chemistry
       Failure/Error: instance.atmosphere.gases.create!(name: gas_name, percentage: percentage)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:90:in 'block (4 levels) in <main>'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'Array#each'
       # ./spec/factories/celestial_bodies/planets/ocean/hycean_planets.rb:82:in 'block (3 levels) in <main>'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:284:in 'block (3 levels) in <main>'

  125) CelestialBodies::Spheres::Biosphere#transfer_material logs errors when transfer fails due to validation errors
       Failure/Error: Rails.logger.error "Error parsing #{file}: #{e.message}"

         #<ActiveSupport::Logger:0x00007f3e778f98e8 @level=0, @progname=nil, @default_formatter=#<Logger::Formatter:0x00007f3e778d9138 @datetime_format=nil>, @formatter=#<ActiveSupport::Logger::SimpleFormatter:0x00007f3e778d7108 @datetime_format=nil, @thread_key="activesupport_tagged_logging_tags:8640">, @logdev=#<Logger::LogDevice:0x00007f3e778eb2c0 @shift_period_suffix="%Y%m%d", @shift_size=1048576, @shift_age=0, @filename="/home/galaxy_game/log/development.log", @dev=#<File:/home/galaxy_game/log/development.log>, @binmode=false, @reraise_write_errors=[], @mon_data=#<Monitor:0x00007f3e778d9048>, @mon_data_owner_object_id=2824>, @level_override={}> received :error with unexpected arguments
           expected: (/Error transferring material/)
                got: ("Error parsing /home/galaxy_game/app/data/resources/materials/processed/geological/depleted_regolith.json: expected ',' or '}' after object value, got: '\"mechanical_properties\": {\n     '")
         Diff:
         @@ -1 +1 @@
         -[/Error transferring material/]
         +["Error parsing /home/galaxy_game/app/data/resources/materials/processed/geological/depleted_regolith.json: expected ',' or '}' after object value, got: '\"mechanical_properties\": {\n     '"]
       # ./app/services/lookup/material_lookup_service.rb:223:in 'block in Lookup::MaterialLookupService#load_json_files_recursively'
       # ./app/services/lookup/material_lookup_service.rb:217:in 'Array#map'
       # ./app/services/lookup/material_lookup_service.rb:217:in 'Lookup::MaterialLookupService#load_json_files_recursively'
       # ./app/services/lookup/material_lookup_service.rb:170:in 'block in Lookup::MaterialLookupService#load_materials'
       # ./app/services/lookup/material_lookup_service.rb:158:in 'Hash#each'
       # ./app/services/lookup/material_lookup_service.rb:158:in 'Lookup::MaterialLookupService#load_materials'
       # ./app/services/lookup/material_lookup_service.rb:47:in 'Lookup::MaterialLookupService#initialize'
       # ./app/models/concerns/geosphere_concern.rb:354:in 'Class#new'
       # ./app/models/concerns/geosphere_concern.rb:354:in 'GeosphereConcern#physical_state'
       # ./app/models/concerns/geosphere_concern.rb:271:in 'block in GeosphereConcern#update_material_states'
       # ./app/models/concerns/geosphere_concern.rb:269:in 'GeosphereConcern#update_material_states'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:156:in 'block (3 levels) in <main>'
       # ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:204:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # JSON::ParserError:
       #   expected ',' or '}' after object value, got: '"mechanical_properties": {
       #        '
       #   /usr/local/bundle/gems/json-2.10.2/lib/json/common.rb:248:in 'JSON::Ext::Parser.parse'

  126) CelestialBodies::Spheres::Geosphere#add_material adds a material and updates the celestial body and geosphere
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:75:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  127) CelestialBodies::Spheres::Geosphere#add_material adds material to the specified layer
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:114:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  128) CelestialBodies::Spheres::Geosphere#remove_material removes material from the specified layer
       Failure/Error:
         layer_materials.each do |material|
           percentage = (material.amount.to_f / total_mass) * 100
           composition[material.name] = percentage
         end

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:563:in 'GeosphereConcern#update_composition_percentages'
       # ./app/models/concerns/geosphere_concern.rb:225:in 'GeosphereConcern#remove_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:144:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:563:in 'GeosphereConcern#update_composition_percentages'

  129) CelestialBodies::Spheres::Geosphere material management creates materials in correct layer
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:181:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  130) CelestialBodies::Spheres::Geosphere material management updates composition percentages
       Failure/Error: material = materials.find_by(name: name.to_s, location: 'geosphere', layer: layer.to_s)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:197:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:162:in 'GeosphereConcern#add_material'

  131) CelestialBodies::Spheres::Geosphere#extract_volatiles extracts volatiles based on temperature increase
       Failure/Error:
         volatile_material = materials.find_or_initialize_by(
           name: name,
           location: 'geosphere',
           layer: 'crust'
         )

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'Hash#each'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'GeosphereConcern#extract_volatiles'
       # ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:276:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'

  132) CelestialBodies::CelestialBody when not part of a solar system allows distance_from_star to be nil
       Failure/Error: expect(brown_dwarf.solar_system).to be_nil

         expected: nil
              got: #<SolarSystem id: 2154, identifier: "SS-488", name: "Solar System 425", galaxy_id: nil, current_star_...4:13:15.153937000 +0000", updated_at: "2026-01-13 04:13:15.153937000 +0000", wormhole_capacity: 0.0>
       # ./spec/models/celestial_body_spec.rb:19:in 'block (3 levels) in <main>'

  133) CelestialBodies::CelestialBody#add_material creates a new material if it does not exist
       Failure/Error: expect(mars.materials.last.name).to eq('Oxygen')

         expected: "Oxygen"
              got: "oxygen"

         (compared using ==)
       # ./spec/models/celestial_body_spec.rb:26:in 'block (3 levels) in <main>'

  134) CelestialBodies::CelestialBody#add_material updates the amount of an existing material
       Failure/Error: expect(mars.materials.find_by(name: 'Nitrogen').amount).to eq(150)

       NoMethodError:
         undefined method 'amount' for nil
       # ./spec/models/celestial_body_spec.rb:36:in 'block (3 levels) in <main>'

  135) CelestialBodies::CelestialBody#update_gravity calculates and updates the gravity based on mass and radius
       Failure/Error: mars.update_gravity

       NoMethodError:
         undefined method 'update_gravity' for an instance of CelestialBodies::CelestialBody
       # ./spec/models/celestial_body_spec.rb:68:in 'block (3 levels) in <main>'

  136) Units::CompostingUnit#operate consumes organic waste and energy, producing compost
       Failure/Error:
         CompostingUnit.new(
           name: 'Basic Composting Unit',
           material_list: { 'organic_waste' => 40, 'compost_output' => 25 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant CompostingUnit
       # ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/composting_unit_spec.rb:19:in 'block (3 levels) in <main>'

  137) Units::CompostingUnit#operate returns false if insufficient organic waste is available
       Failure/Error:
         CompostingUnit.new(
           name: 'Basic Composting Unit',
           material_list: { 'organic_waste' => 40, 'compost_output' => 25 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant CompostingUnit
       # ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/composting_unit_spec.rb:27:in 'block (3 levels) in <main>'

  138) Units::CompostingUnit#operate returns false if insufficient energy is available
       Failure/Error:
         CompostingUnit.new(
           name: 'Basic Composting Unit',
           material_list: { 'organic_waste' => 40, 'compost_output' => 25 },
           energy_cost: 15  # Updated to use energy_cost
         )

       NameError:
         uninitialized constant CompostingUnit
       # ./spec/models/composting_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/composting_unit_spec.rb:32:in 'block (3 levels) in <main>'

  139) EnergyManagement solar output factor #current_solar_output_factor queries location solar output factor
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.8)
         #<Location::CelestialLocation id: 1259, name: "Location 49", coordinates: "54.27°N 77.73°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 1006, celestial_body_id: 3278, created_at: "2026-01-13 04:13:54.614371000 +0000", updated_at: "2026-01-13 04:13:54.670357000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:197:in 'block (4 levels) in <main>'

  140) EnergyManagement solar output factor #current_solar_output_factor returns 1.0 when no settlement
       Failure/Error: expect(settlement.current_solar_output_factor).to eq(1.0)

       NoMethodError:
         undefined method 'current_solar_output_factor' for #<Settlement::BaseSettlement:0x00007f3e5b13e250>
       # ./spec/models/concerns/energy_management_spec.rb:203:in 'block (4 levels) in <main>'

  141) EnergyManagement solar output factor #solar_daylight? returns true when solar factor > 0.1
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)
         #<Location::CelestialLocation id: 1261, name: "Location 51", coordinates: "14.03°N 86.79°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 1008, celestial_body_id: 3280, created_at: "2026-01-13 04:13:54.967649000 +0000", updated_at: "2026-01-13 04:13:55.007785000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:209:in 'block (4 levels) in <main>'

  142) EnergyManagement solar output factor #solar_daylight? returns false when solar factor <= 0.1
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.05)
         #<Location::CelestialLocation id: 1262, name: "Location 52", coordinates: "82.12°S 153.52°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 1009, celestial_body_id: 3281, created_at: "2026-01-13 04:13:55.136300000 +0000", updated_at: "2026-01-13 04:13:55.171485000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:214:in 'block (4 levels) in <main>'

  143) EnergyManagement solar output factor power generation with solar scaling scales solar unit output by solar factor
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)
         #<Location::CelestialLocation id: 1263, name: "Location 53", coordinates: "72.22°N 128.06°E", locationable_type: "Settlement::BaseSettlement", locationable_id: 1010, celestial_body_id: 3282, created_at: "2026-01-13 04:13:55.302109000 +0000", updated_at: "2026-01-13 04:13:55.339558000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:245:in 'block (4 levels) in <main>'

  144) EnergyManagement solar output factor power generation with solar scaling does not scale non-solar units
       Failure/Error: allow(location).to receive(:solar_output_factor).and_return(0.5)
         #<Location::CelestialLocation id: 1264, name: "Location 54", coordinates: "54.24°S 142.91°W", locationable_type: "Settlement::BaseSettlement", locationable_id: 1011, celestial_body_id: 3283, created_at: "2026-01-13 04:13:55.516481000 +0000", updated_at: "2026-01-13 04:13:55.553390000 +0000", altitude: nil, environmental_data: nil> does not implement: solar_output_factor
       # ./spec/models/concerns/energy_management_spec.rb:251:in 'block (4 levels) in <main>'

  145) GeosphereConcern#reset returns false if base_values lack required keys
       Failure/Error: geosphere.update!(base_values: {})

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
         DETAIL:  Failing row contains (1944, 3286, {"silicon":45.0,"oxygen":45.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 1e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-13 04:14:00.708512, 2026-01-13 04:14:02.720678, 0, 0, 0, {}, null, f, 0).
       # ./spec/models/concerns/geosphere_concern_spec.rb:81:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
       #   DETAIL:  Failing row contains (1944, 3286, {"silicon":45.0,"oxygen":45.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 1e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-13 04:14:00.708512, 2026-01-13 04:14:02.720678, 0, 0, 0, {}, null, f, 0).
       #   ./spec/models/concerns/geosphere_concern_spec.rb:81:in 'block (3 levels) in <main>'

  146) GeosphereConcern#reset does not modify attributes when base_values are empty
       Failure/Error: geosphere.update!(base_values: {})

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
         DETAIL:  Failing row contains (1945, 3287, {"silicon":30.0,"oxygen":60.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 2e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-13 04:14:02.813369, 2026-01-13 04:14:04.929836, 0, 0, 0, {}, null, f, 0).
       # ./spec/models/concerns/geosphere_concern_spec.rb:111:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "base_values" of relation "geospheres" violates not-null constraint
       #   DETAIL:  Failing row contains (1945, 3287, {"silicon":30.0,"oxygen":60.0,"iron":10.0}, {"iron":40.0,"magnesium":40.0,"silicates":20.0}, {"iron":85.0,"nickel":15.0}, 2e+20, 4.9999999999999996e+22, 9.999999999999999e+22, 1000, 100, 60, t, null, 2026-01-13 04:14:02.813369, 2026-01-13 04:14:04.929836, 0, 0, 0, {}, null, f, 0).
       #   ./spec/models/concerns/geosphere_concern_spec.rb:111:in 'block (3 levels) in <main>'

  147) GeosphereConcern#extract_volatiles extracts volatiles based on temperature increase
       Failure/Error:
         volatile_material = materials.find_or_initialize_by(
           name: name,
           location: 'geosphere',
           layer: 'crust'
         )

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'Hash#each'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'GeosphereConcern#extract_volatiles'
       # ./spec/models/concerns/geosphere_concern_spec.rb:173:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'

  148) GeosphereConcern#extract_volatiles adds gases to atmosphere using chemical formula
       Failure/Error:
         volatile_material = materials.find_or_initialize_by(
           name: name,
           location: 'geosphere',
           layer: 'crust'
         )

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'Hash#each'
       # ./app/models/concerns/geosphere_concern.rb:387:in 'GeosphereConcern#extract_volatiles'
       # ./spec/models/concerns/geosphere_concern_spec.rb:193:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ..."."name" = $3 AND "materials"."location" = $4 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:420:in 'block in GeosphereConcern#extract_volatiles'

  149) GeosphereConcern#add_material adds material to the specified layer
       Failure/Error:
         materials.where(location: 'geosphere', layer: layer.to_s).each do |material|
           percentage = (material.amount.to_f / layer_mass) * 100
           composition[material.name.to_s] = percentage
         end

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column materials.layer does not exist
         LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
                                                                      ^
       # ./app/models/concerns/geosphere_concern.rb:466:in 'GeosphereConcern#update_layer_composition'
       # ./app/models/concerns/geosphere_concern.rb:159:in 'GeosphereConcern#add_material'
       # ./spec/models/concerns/geosphere_concern_spec.rb:213:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column materials.layer does not exist
       #   LINE 1: ...able_id" = $2 AND "materials"."location" = $3 AND "materials...
       #                                                                ^
       #   ./app/models/concerns/geosphere_concern.rb:466:in 'GeosphereConcern#update_layer_composition'

  150) HasUnits#install_unit attaches a unit to the craft
       Failure/Error: expect(craft.base_units.first.unit_type).to eq('control_computer') # Matches the factory

         expected: "control_computer"
              got: "computer"

         (compared using ==)
       # ./spec/models/concerns/has_units_spec.rb:121:in 'block (3 levels) in <main>'

  151) Housing population management calculates population capacity from habitat units
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f3e5dffa5a8>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  152) Housing population management uses alias total_capacity for population_capacity
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f3e5dff8c08>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  153) Housing population management calculates available capacity
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f3e5dff6fe8>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  154) Housing population management checks if it has capacity for additional population
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f3e5dff5788>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  155) Housing population management ignores non-habitat units when calculating capacity
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f3e5dff3d48>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  156) Housing population management calculates total population from base units
       Failure/Error: after_initialize :set_default_population_capacity

       NoMethodError:
         undefined method 'after_initialize' for class #<Class:0x00007f3e5dff2308>
       # ./app/models/concerns/housing.rb:9:in 'block in <module:Housing>'
       # ./spec/models/concerns/housing_spec.rb:7:in 'Module#include'
       # ./spec/models/concerns/housing_spec.rb:7:in 'block (3 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#initialize'
       # ./spec/models/concerns/housing_spec.rb:6:in 'Class#new'
       # ./spec/models/concerns/housing_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:19:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/housing_spec.rb:24:in 'block (2 levels) in <main>'

  157) MaterialPropertiesConcern exotic state handling identifies exotic states
       Failure/Error: expect(material.exotic_state?).to be false

       NoMethodError:
         undefined method 'exotic_state?' for an instance of #<Class:0x00007f3e5e2bbcd8>(id: integer, geosphere_id: integer, name: string, layer: string, percentage: decimal, mass: decimal, state: string, melting_point: decimal, boiling_point: decimal, is_volatile: boolean, category: string, created_at: datetime, updated_at: datetime)
       # ./spec/models/concerns/material_properties_concern_spec.rb:206:in 'block (3 levels) in <main>'

  158) MaterialPropertiesConcern exotic state handling calculates phase transitions for exotic conditions
       Failure/Error: expect(hydrogen.state_at(300, 1_500_000)).to eq('metallic_hydrogen')

         expected: "metallic_hydrogen"
              got: "gas"

         (compared using ==)
       # ./spec/models/concerns/material_properties_concern_spec.rb:239:in 'block (3 levels) in <main>'

  159) Mineable#mine_gcc mines from satellites and computers
       Failure/Error: @account = double('Account', update: true) # Mocking the account

       NoMethodError:
         undefined method 'double' for an instance of TestModel
       # ./spec/models/concerns/mineable_spec.rb:11:in 'TestModel#initialize'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'Class#new'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/mineable_spec.rb:24:in 'block (3 levels) in <main>'

  160) Mineable#mine_gcc does not exceed available power
       Failure/Error: @account = double('Account', update: true) # Mocking the account

       NoMethodError:
         undefined method 'double' for an instance of TestModel
       # ./spec/models/concerns/mineable_spec.rb:11:in 'TestModel#initialize'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'Class#new'
       # ./spec/models/concerns/mineable_spec.rb:17:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/mineable_spec.rb:24:in 'block (3 levels) in <main>'

  161) Structures::Coverable#schedule_covering! creates a construction job
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:255:in 'block (4 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:254:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  162) Structures::Coverable#schedule_covering! returns success result
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:260:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  163) Structures::Coverable#schedule_covering! updates status to materials_requested
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:270:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  164) Structures::Coverable#schedule_covering! accepts custom panel type
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:278:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  165) Structures::Coverable#schedule_covering! stores panel_type on coverable
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:288:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  166) Structures::Coverable#schedule_covering! uses default panel type if not specified
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:295:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  167) Structures::Coverable#schedule_covering! creates material and equipment requests
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:305:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  168) Structures::Coverable#schedule_covering! updates shell composition
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:311:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  169) Structures::Coverable#schedule_covering! fails if already covered
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:320:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  170) Structures::Coverable integration scenarios lava tube opening handles medium opening
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:586:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  171) Structures::Coverable complete covering workflow goes through full lifecycle
       Failure/Error: let(:settlement) { create(:settlement, owner: player, location: location) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/concerns/structures/coverable_spec.rb:69:in 'block (2 levels) in <main>'
       # ./spec/models/concerns/structures/coverable_spec.rb:602:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  172) Structures::Shell#schedule_shell_construction! sets construction_date
       Failure/Error: expect(shell_structure.reload.construction_date).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/models/concerns/structures/shell_spec.rb:315:in 'block (3 levels) in <main>'

  173) ConsortiumMembership is invalid if member is not a corporation
       Failure/Error:
         membership = ConsortiumMembership.new(
           consortium: consortium,
           member: non_corp,
           investment_amount: 1_000_000,
           ownership_percentage: 10.0,
           voting_power: 1000
         )

       ActiveRecord::AssociationTypeMismatch:
         Organizations::BaseOrganization(#9536) expected, got #<Double "Player"> which is an instance of RSpec::Mocks::Double(#118240)
       # ./spec/models/consortium_membership_spec.rb:23:in 'block (2 levels) in <main>'

  174) ConstructionJob validations and attributes is valid with required attributes
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:14:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  175) ConstructionJob validations and attributes requires a jobable
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:23:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  176) ConstructionJob validations and attributes accepts a valid job_type
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:30:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  177) ConstructionJob validations and attributes accepts a valid status
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:46:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  178) ConstructionJob validations and attributes stores target_values as JSON
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:65:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  179) ConstructionJob associations has many material_requests
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  180) ConstructionJob associations has many equipment_requests
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  181) ConstructionJob associations belongs to a jobable
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  182) ConstructionJob associations belongs to a settlement
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:88:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  183) ConstructionJob enum functionality correctly stores and retrieves job_type as an enum
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:133:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  184) ConstructionJob enum functionality correctly stores and retrieves status as an enum
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:133:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  185) ConstructionJob convenience methods #materials_gathered? returns true when all material requests are fulfilled
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  186) ConstructionJob convenience methods #materials_gathered? returns false when some material requests are pending
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  187) ConstructionJob convenience methods #equipment_gathered? returns true when no equipment requests exist
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  188) ConstructionJob convenience methods #equipment_gathered? returns true when all equipment requests are fulfilled
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  189) ConstructionJob convenience methods #equipment_gathered? returns false when some equipment requests are pending
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  190) ConstructionJob convenience methods #infer_settlement returns the jobable's settlement if available
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  191) ConstructionJob convenience methods #infer_settlement returns the jobable if it is a Settlement
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  192) ConstructionJob convenience methods #infer_settlement finds a settlement by location if available
       Failure/Error: let(:settlement) { create(:settlement, name: "Test Settlement", location: location, owner: player) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/construction_job_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/construction_job_spec.rb:190:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  193) Craft::BaseCraft associations 
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  194) Craft::BaseCraft associations 
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  195) Craft::BaseCraft associations 
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  196) Craft::BaseCraft associations 
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  197) Craft::BaseCraft location handling can access location through helper method
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  198) Craft::BaseCraft location handling can switch between spatial and celestial locations
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  199) Craft::BaseCraft initialization assembles a new craft from inventory and applies the correct variant
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  200) Craft::BaseCraft loading craft info loads the correct craft data from the lookup service
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  201) Craft::BaseCraft player construction starts with no units
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  202) Craft::BaseCraft player construction allows installing units
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  203) Craft::BaseCraft player construction allows uninstalling units
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  204) Craft::BaseCraft variant configuration loads a variant configuration
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  205) Craft::BaseCraft variant configuration changes between variants
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  206) Craft::BaseCraft variant configuration provides a list of available variants
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  207) Craft::BaseCraft variant configuration handles missing variants gracefully
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  208) Craft::BaseCraft atmosphere creation creates an atmosphere after creation
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  209) Craft::BaseCraft unit integration integrates with settlement units
       Failure/Error:
         FactoryBot.create(:item,
           inventory: @craft_instance.inventory,
           amount: unit_info['count'],
           name: unit_info['name'],
           metadata: { 'unit_type' => unit_info['id'] }
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/base_craft_spec.rb:63:in 'block (3 levels) in <main>'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'Array#each'
       # ./spec/models/craft/base_craft_spec.rb:62:in 'block (2 levels) in <main>'

  210) Craft::Harvester validations is valid with a positive extraction_rate
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  211) Craft::Harvester validations is invalid with a negative extraction_rate
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  212) Craft::Harvester#extract_resources when extracting from a valid target increases inventory with extracted resources
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  213) Craft::Harvester#extract_resources when extracting from an invalid target raises an error
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  214) Craft::Harvester#extract_resources when storage is full raises an error
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  215) Craft::Harvester#process_resources converts raw material into refined material
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  216) Craft::Harvester#process_resources does nothing if no processable materials are present
       Failure/Error: let(:harvester) { create(:craft_harvester, player: player) }

       KeyError:
         Factory not registered: "craft_harvester"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/craft/harvester_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/craft/harvester_spec.rb:9:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "craft_harvester"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  217) Craft::VariantManager#initialize loads base data and variants
       Failure/Error: expect(variant_manager.instance_variable_get(:@base_data)).to be_present
         expected `{}.present?` to be truthy, got false
       # ./spec/models/craft/variant_manager_spec.rb:67:in 'block (3 levels) in <main>'

  218) Craft::VariantManager#get_variant merges base data with standard variant data
       Failure/Error: expect(merged_data['id']).to eq('heavy_lift_transport')

         expected: "heavy_lift_transport"
              got: "heavy_lift_transport_standard"

         (compared using ==)
       # ./spec/models/craft/variant_manager_spec.rb:105:in 'block (3 levels) in <main>'

  219) Craft::VariantManager#get_variant merges base data with lunar variant data
       Failure/Error: expect(merged_data['systems']['life_support']['capacity']).to eq('enhanced')

       NoMethodError:
         undefined method '[]' for nil
       # ./spec/models/craft/variant_manager_spec.rb:121:in 'block (3 levels) in <main>'

  220) Craft::VariantManager#get_variant properly merges nested hashes
       Failure/Error: expect(merged_data['resource_management']['consumables']['fuel']['current']).to eq(0)

         expected: 0
              got: nil

         (compared using ==)
       # ./spec/models/craft/variant_manager_spec.rb:148:in 'block (3 levels) in <main>'

  221) Settlement::Dome calculates used capacity (current occupancy) correctly
       Failure/Error: dome = Dome.create(name: "Research Dome", capacity: 100, current_occupancy: 50)

       NameError:
         uninitialized constant Dome
       # ./spec/models/dome_spec.rb:6:in 'block (2 levels) in <main>'

  222) Settlement::Dome calculates remaining capacity correctly
       Failure/Error: dome = Dome.create(name: "Living Dome", capacity: 200, current_occupancy: 50)

       NameError:
         uninitialized constant Dome
       # ./spec/models/dome_spec.rb:11:in 'block (2 levels) in <main>'

  223) Settlement::Dome ensures current occupancy does not exceed total capacity
       Failure/Error: dome = Dome.new(name: "Living Dome", capacity: 100, current_occupancy: 150)

       NameError:
         uninitialized constant Dome
       # ./spec/models/dome_spec.rb:16:in 'block (2 levels) in <main>'

  224) CelestialBodies::DwarfPlanet#calculate_surface_conditions calculates surface conditions specific to dwarf planets
       Failure/Error:
         DwarfPlanet.create!(
           name: "Pluto",
           size: 0.18,
           gravity: 0.62,
           density: 1.86,
           orbital_period: 90560,
           mass: 1.303e22, # Example mass in kg
           radius: 1.19e6, # Example radius in meters
           gas_quantities: { "Nitrogen" => 8000, "Methane" => 1000 },
           temperature: 44.0 # Example temperature

       NameError:
         uninitialized constant DwarfPlanet
       # ./spec/models/dwarf_planet_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/dwarf_planet_spec.rb:20:in 'block (3 levels) in <main>'

  225) CelestialBodies::DwarfPlanet#update_biomes updates biomes specific to dwarf planets
       Failure/Error:
         DwarfPlanet.create!(
           name: "Pluto",
           size: 0.18,
           gravity: 0.62,
           density: 1.86,
           orbital_period: 90560,
           mass: 1.303e22, # Example mass in kg
           radius: 1.19e6, # Example radius in meters
           gas_quantities: { "Nitrogen" => 8000, "Methane" => 1000 },
           temperature: 44.0 # Example temperature

       NameError:
         uninitialized constant DwarfPlanet
       # ./spec/models/dwarf_planet_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/dwarf_planet_spec.rb:27:in 'block (3 levels) in <main>'

  226) Environment validations is valid with valid attributes
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:12:in 'block (3 levels) in <main>'

  227) Environment validations is not valid without a biome
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:16:in 'block (3 levels) in <main>'

  228) Environment validations is not valid without a planet
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:21:in 'block (3 levels) in <main>'

  229) Environment validations is not valid without a temperature
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:26:in 'block (3 levels) in <main>'

  230) Environment validations is not valid without a pressure
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:31:in 'block (3 levels) in <main>'

  231) Environment validations is not valid without a humidity
       Failure/Error: let(:environment) { Environment.create(biome: biome, celestial_body: planet, temperature: 28.0, pressure: 1.0, humidity: 85.0) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'biome' for Environment.
       # ./spec/models/environment_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/environment_spec.rb:36:in 'block (3 levels) in <main>'

  232) Environment associations belongs to a biome
       Failure/Error: should belong_to(:biome)
         Expected Environment to have a belongs_to association called biome (no association called biome)
       # ./spec/models/environment_spec.rb:43:in 'block (3 levels) in <main>'

  233) Environment associations belongs to a celestial_body
       Failure/Error: should belong_to(:celestial_body)
         Expected Environment to have a belongs_to association called celestial_body (no association called celestial_body)
       # ./spec/models/environment_spec.rb:47:in 'block (3 levels) in <main>'

  234) EquipmentRequest validations is valid with required attributes
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (448, Test Dome, Crater Dome, null, 1204, Player, 2305, null, Location::CelestialLocation, 1500, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:15.903422, 2026-01-13 04:18:15.903422, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:15:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (448, Test Dome, Crater Dome, null, 1204, Player, 2305, null, Location::CelestialLocation, 1500, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:15.903422, 2026-01-13 04:18:15.903422, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  235) EquipmentRequest validations requires an equipment_type
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (449, Test Dome, Crater Dome, null, 1205, Player, 2307, null, Location::CelestialLocation, 1502, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:16.182783, 2026-01-13 04:18:16.182783, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (449, Test Dome, Crater Dome, null, 1205, Player, 2307, null, Location::CelestialLocation, 1502, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:16.182783, 2026-01-13 04:18:16.182783, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  236) EquipmentRequest validations requires quantity_requested to be present
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (450, Test Dome, Crater Dome, null, 1206, Player, 2309, null, Location::CelestialLocation, 1504, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:16.449484, 2026-01-13 04:18:16.449484, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:33:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (450, Test Dome, Crater Dome, null, 1206, Player, 2309, null, Location::CelestialLocation, 1504, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:16.449484, 2026-01-13 04:18:16.449484, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  237) EquipmentRequest validations requires quantity_requested to be greater than 0
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (451, Test Dome, Crater Dome, null, 1207, Player, 2311, null, Location::CelestialLocation, 1506, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:16.727421, 2026-01-13 04:18:16.727421, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (451, Test Dome, Crater Dome, null, 1207, Player, 2311, null, Location::CelestialLocation, 1506, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:16.727421, 2026-01-13 04:18:16.727421, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  238) EquipmentRequest validations requires quantity_requested to be a number
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (452, Test Dome, Crater Dome, null, 1208, Player, 2313, null, Location::CelestialLocation, 1508, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.025643, 2026-01-13 04:18:17.025643, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:52:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (452, Test Dome, Crater Dome, null, 1208, Player, 2313, null, Location::CelestialLocation, 1508, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.025643, 2026-01-13 04:18:17.025643, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  239) EquipmentRequest validations allows negative quantity_requested to be invalid
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (453, Test Dome, Crater Dome, null, 1209, Player, 2315, null, Location::CelestialLocation, 1510, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.321261, 2026-01-13 04:18:17.321261, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (453, Test Dome, Crater Dome, null, 1209, Player, 2315, null, Location::CelestialLocation, 1510, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.321261, 2026-01-13 04:18:17.321261, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  240) EquipmentRequest associations belongs to a requestable (polymorphic)
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (454, Test Dome, Crater Dome, null, 1210, Player, 2317, null, Location::CelestialLocation, 1512, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.619906, 2026-01-13 04:18:17.619906, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:72:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:75:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (454, Test Dome, Crater Dome, null, 1210, Player, 2317, null, Location::CelestialLocation, 1512, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.619906, 2026-01-13 04:18:17.619906, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  241) EquipmentRequest associations can be associated with different requestable types
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (455, Test Dome, Crater Dome, null, 1211, Player, 2319, null, Location::CelestialLocation, 1514, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.888288, 2026-01-13 04:18:17.888288, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:80:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (455, Test Dome, Crater Dome, null, 1211, Player, 2319, null, Location::CelestialLocation, 1514, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:17.888288, 2026-01-13 04:18:17.888288, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  242) EquipmentRequest enums status enum defaults to pending status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (456, Test Dome, Crater Dome, null, 1212, Player, 2321, null, Location::CelestialLocation, 1516, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:18.179451, 2026-01-13 04:18:18.179451, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:102:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (456, Test Dome, Crater Dome, null, 1212, Player, 2321, null, Location::CelestialLocation, 1516, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:18.179451, 2026-01-13 04:18:18.179451, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  243) EquipmentRequest enums status enum can be set to different statuses
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (457, Test Dome, Crater Dome, null, 1213, Player, 2323, null, Location::CelestialLocation, 1518, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:18.529581, 2026-01-13 04:18:18.529581, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:106:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (457, Test Dome, Crater Dome, null, 1213, Player, 2323, null, Location::CelestialLocation, 1518, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:18.529581, 2026-01-13 04:18:18.529581, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  244) EquipmentRequest enums status enum accepts string values for status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (458, Test Dome, Crater Dome, null, 1214, Player, 2325, null, Location::CelestialLocation, 1520, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:18.850719, 2026-01-13 04:18:18.850719, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:112:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (458, Test Dome, Crater Dome, null, 1214, Player, 2325, null, Location::CelestialLocation, 1520, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:18.850719, 2026-01-13 04:18:18.850719, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  245) EquipmentRequest enums status enum provides query methods for each status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (459, Test Dome, Crater Dome, null, 1215, Player, 2327, null, Location::CelestialLocation, 1522, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:19.152393, 2026-01-13 04:18:19.152393, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:117:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (459, Test Dome, Crater Dome, null, 1215, Player, 2327, null, Location::CelestialLocation, 1522, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:19.152393, 2026-01-13 04:18:19.152393, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  246) EquipmentRequest enums priority enum defaults to normal priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (460, Test Dome, Crater Dome, null, 1216, Player, 2329, null, Location::CelestialLocation, 1524, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:19.5561, 2026-01-13 04:18:19.5561, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:137:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (460, Test Dome, Crater Dome, null, 1216, Player, 2329, null, Location::CelestialLocation, 1524, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:19.5561, 2026-01-13 04:18:19.5561, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  247) EquipmentRequest enums priority enum can be set to different priorities
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (461, Test Dome, Crater Dome, null, 1217, Player, 2331, null, Location::CelestialLocation, 1526, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:20.013428, 2026-01-13 04:18:20.013428, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:141:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (461, Test Dome, Crater Dome, null, 1217, Player, 2331, null, Location::CelestialLocation, 1526, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:20.013428, 2026-01-13 04:18:20.013428, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  248) EquipmentRequest enums priority enum accepts string values for priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (462, Test Dome, Crater Dome, null, 1218, Player, 2333, null, Location::CelestialLocation, 1528, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:20.430438, 2026-01-13 04:18:20.430438, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:147:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (462, Test Dome, Crater Dome, null, 1218, Player, 2333, null, Location::CelestialLocation, 1528, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:20.430438, 2026-01-13 04:18:20.430438, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  249) EquipmentRequest enums priority enum provides query methods for each priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (463, Test Dome, Crater Dome, null, 1219, Player, 2335, null, Location::CelestialLocation, 1530, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:20.750233, 2026-01-13 04:18:20.750233, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:89:in 'block (3 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:152:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (463, Test Dome, Crater Dome, null, 1219, Player, 2335, null, Location::CelestialLocation, 1530, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:20.750233, 2026-01-13 04:18:20.750233, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  250) EquipmentRequest scopes .pending_requests returns pending and partially fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (464, Test Dome, Crater Dome, null, 1220, Player, 2337, null, Location::CelestialLocation, 1532, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.036664, 2026-01-13 04:18:21.036664, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (464, Test Dome, Crater Dome, null, 1220, Player, 2337, null, Location::CelestialLocation, 1532, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.036664, 2026-01-13 04:18:21.036664, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  251) EquipmentRequest scopes .fulfilled returns only fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (465, Test Dome, Crater Dome, null, 1221, Player, 2339, null, Location::CelestialLocation, 1534, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.320354, 2026-01-13 04:18:21.320354, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (465, Test Dome, Crater Dome, null, 1221, Player, 2339, null, Location::CelestialLocation, 1534, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.320354, 2026-01-13 04:18:21.320354, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  252) EquipmentRequest scopes .for_equipment returns requests for a specific equipment type
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (466, Test Dome, Crater Dome, null, 1222, Player, 2341, null, Location::CelestialLocation, 1536, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.649824, 2026-01-13 04:18:21.649824, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (466, Test Dome, Crater Dome, null, 1222, Player, 2341, null, Location::CelestialLocation, 1536, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.649824, 2026-01-13 04:18:21.649824, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  253) EquipmentRequest scopes .for_equipment returns empty when no equipment of that type is requested
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (467, Test Dome, Crater Dome, null, 1223, Player, 2343, null, Location::CelestialLocation, 1538, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.937677, 2026-01-13 04:18:21.937677, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:163:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (467, Test Dome, Crater Dome, null, 1223, Player, 2343, null, Location::CelestialLocation, 1538, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:21.937677, 2026-01-13 04:18:21.937677, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  254) EquipmentRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (468, Test Dome, Crater Dome, null, 1224, Player, 2345, null, Location::CelestialLocation, 1540, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:22.279583, 2026-01-13 04:18:22.279583, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:204:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (468, Test Dome, Crater Dome, null, 1224, Player, 2345, null, Location::CelestialLocation, 1540, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:22.279583, 2026-01-13 04:18:22.279583, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  255) EquipmentRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (469, Test Dome, Crater Dome, null, 1225, Player, 2347, null, Location::CelestialLocation, 1542, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:22.5553, 2026-01-13 04:18:22.5553, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:213:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (469, Test Dome, Crater Dome, null, 1225, Player, 2347, null, Location::CelestialLocation, 1542, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:22.5553, 2026-01-13 04:18:22.5553, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  256) EquipmentRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (470, Test Dome, Crater Dome, null, 1226, Player, 2349, null, Location::CelestialLocation, 1544, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:22.829862, 2026-01-13 04:18:22.829862, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:222:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (470, Test Dome, Crater Dome, null, 1226, Player, 2349, null, Location::CelestialLocation, 1544, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:22.829862, 2026-01-13 04:18:22.829862, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  257) EquipmentRequest instance methods #quantity_still_needed handles quantity_fulfilled being 0
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (471, Test Dome, Crater Dome, null, 1227, Player, 2351, null, Location::CelestialLocation, 1546, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.124351, 2026-01-13 04:18:23.124351, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:231:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (471, Test Dome, Crater Dome, null, 1227, Player, 2351, null, Location::CelestialLocation, 1546, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.124351, 2026-01-13 04:18:23.124351, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  258) EquipmentRequest factory creates a valid equipment request with factory
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (472, Test Dome, Crater Dome, null, 1228, Player, 2353, null, Location::CelestialLocation, 1548, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.381262, 2026-01-13 04:18:23.381262, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:242:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (472, Test Dome, Crater Dome, null, 1228, Player, 2353, null, Location::CelestialLocation, 1548, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.381262, 2026-01-13 04:18:23.381262, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  259) EquipmentRequest factory creates equipment request with specific attributes
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (473, Test Dome, Crater Dome, null, 1229, Player, 2355, null, Location::CelestialLocation, 1550, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.658624, 2026-01-13 04:18:23.658624, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:249:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (473, Test Dome, Crater Dome, null, 1229, Player, 2355, null, Location::CelestialLocation, 1550, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.658624, 2026-01-13 04:18:23.658624, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  260) EquipmentRequest edge cases and data integrity handles very large quantity requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (474, Test Dome, Crater Dome, null, 1230, Player, 2357, null, Location::CelestialLocation, 1552, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.978289, 2026-01-13 04:18:23.978289, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:263:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (474, Test Dome, Crater Dome, null, 1230, Player, 2357, null, Location::CelestialLocation, 1552, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:23.978289, 2026-01-13 04:18:23.978289, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  261) EquipmentRequest edge cases and data integrity maintains data integrity when updating status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (475, Test Dome, Crater Dome, null, 1231, Player, 2359, null, Location::CelestialLocation, 1554, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:24.259371, 2026-01-13 04:18:24.259371, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:271:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (475, Test Dome, Crater Dome, null, 1231, Player, 2359, null, Location::CelestialLocation, 1554, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:24.259371, 2026-01-13 04:18:24.259371, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  262) EquipmentRequest edge cases and data integrity handles equipment_type with special characters
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (476, Test Dome, Crater Dome, null, 1232, Player, 2361, null, Location::CelestialLocation, 1556, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:24.533056, 2026-01-13 04:18:24.533056, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/equipment_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/equipment_request_spec.rb:283:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (476, Test Dome, Crater Dome, null, 1232, Player, 2361, null, Location::CelestialLocation, 1556, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:18:24.533056, 2026-01-13 04:18:24.533056, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  263) Financial::Account Development Corporation (DC) Trade allows DC-to-DC trade on the virtual ledger via operational_data flags
       Failure/Error:
         expect { 
           builder_acc.transfer_funds(5000, supplier_acc, "Modular Habitation Units") 
         }.not_to raise_error

         expected no Exception, got #<RuntimeError: Insufficient funds> with backtrace:
           # ./app/models/financial/account.rb:31:in 'Financial::Account#transfer_funds'
           # ./spec/models/financial/account_spec.rb:170:in 'block (4 levels) in <main>'
           # ./spec/models/financial/account_spec.rb:169:in 'block (3 levels) in <main>'
       # ./spec/models/financial/account_spec.rb:169:in 'block (3 levels) in <main>'

  264) Financial::Transaction currency precision supports high precision for GCC (8 decimal places)
       Failure/Error: expect(transaction.reload.amount).to eq(gcc_amount)

         expected: 0.12345678
              got: 0.12e0

         (compared using ==)
       # ./spec/models/financial/transaction_spec.rb:89:in 'block (3 levels) in <main>'

  265) Game#assign_task adds a new task to the task list with correct completion time
       Failure/Error:
         @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|
           c.name = 'Galactic Crypto Currency'
           c.is_system_currency = true
           c.precision = 8
         end

       NameError:
         uninitialized constant Currency
       # ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'

  266) Game#advance_time advances game time and completes a task
       Failure/Error:
         @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|
           c.name = 'Galactic Crypto Currency'
           c.is_system_currency = true
           c.precision = 8
         end

       NameError:
         uninitialized constant Currency
       # ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'

  267) Game#advance_time with no tasks prints a message when there are no tasks
       Failure/Error:
         @gcc = Currency.find_or_create_by!(symbol: 'GCC') do |c|
           c.name = 'Galactic Crypto Currency'
           c.is_system_currency = true
           c.precision = 8
         end

       NameError:
         uninitialized constant Currency
       # ./spec/models/game_spec.rb:6:in 'block (2 levels) in <main>'

  268) CelestialBodies::GasGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
       Failure/Error:
         GasGiant.create!(
           name: "Jupiter",
           size: 11.2,
           gravity: 24.79,
           density: 1.33,
           orbital_period: 4331,
           mass: 1.898e27, # Example mass in kg
           radius: 6.99e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 8580000, "Helium" => 1520000 },
           temperature: 165.0 # Example temperature

       NameError:
         uninitialized constant GasGiant
       # ./spec/models/gas_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/gas_giant_spec.rb:20:in 'block (3 levels) in <main>'

  269) CelestialBodies::GasGiant#calculate_gravity calculates gravity based on mass and radius
       Failure/Error:
         GasGiant.create!(
           name: "Jupiter",
           size: 11.2,
           gravity: 24.79,
           density: 1.33,
           orbital_period: 4331,
           mass: 1.898e27, # Example mass in kg
           radius: 6.99e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 8580000, "Helium" => 1520000 },
           temperature: 165.0 # Example temperature

       NameError:
         uninitialized constant GasGiant
       # ./spec/models/gas_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/gas_giant_spec.rb:27:in 'block (3 levels) in <main>'

  270) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :liquid_volume looks like a number
       Failure/Error: it { should validate_numericality_of(:liquid_volume) }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :liquid_volume on the
         CelestialBodies::Spheres::Hydrosphere to "abcd", but that attribute does
         not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'
       # ./spec/models/hydrosphere_spec.rb:13:in 'block (3 levels) in <main>'

  271) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :lakes looks like a number
       Failure/Error: it { should validate_numericality_of(:lakes) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :lakes
         looks like a number, but this could not be proved.
           After setting :lakes to ‹"abcd"›, the matcher expected the
           CelestialBodies::Spheres::Hydrosphere to be invalid, but it was valid
           instead.
       # ./spec/models/hydrosphere_spec.rb:14:in 'block (3 levels) in <main>'

  272) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :rivers looks like a number
       Failure/Error: it { should validate_numericality_of(:rivers) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :rivers
         looks like a number, but this could not be proved.
           After setting :rivers to ‹"abcd"›, the matcher expected the
           CelestialBodies::Spheres::Hydrosphere to be invalid, but it was valid
           instead.
       # ./spec/models/hydrosphere_spec.rb:15:in 'block (3 levels) in <main>'

  273) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :oceans looks like a number
       Failure/Error: it { should validate_numericality_of(:oceans) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :oceans
         looks like a number, but this could not be proved.
           After setting :oceans to ‹"abcd"›, the matcher expected the
           CelestialBodies::Spheres::Hydrosphere to be invalid, but it was valid
           instead.
       # ./spec/models/hydrosphere_spec.rb:16:in 'block (3 levels) in <main>'

  274) CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :ice looks like a number
       Failure/Error: it { should validate_numericality_of(:ice) }

         Expected CelestialBodies::Spheres::Hydrosphere to validate that :ice
         looks like a number, but this could not be proved.
           After setting :ice to ‹"abcd"› -- which was read back as ‹0.0› -- the
           matcher expected the CelestialBodies::Spheres::Hydrosphere to be
           invalid, but it was valid instead.

           As indicated in the message above, :ice seems to be changing certain
           values as they are set, and this could have something to do with why
           this test is failing. If you've overridden the writer method for this
           attribute, then you may need to change it to make this test pass, or
           do something else entirely.
       # ./spec/models/hydrosphere_spec.rb:17:in 'block (3 levels) in <main>'

  275) CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calls update_liquid_materials_from_celestial_body
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:22:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  276) CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calculates the liquid volume after setup
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:22:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  277) CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds liquid materials to the hydrosphere
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  278) CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds ice to the hydrosphere
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  279) CelestialBodies::Spheres::Hydrosphere#add_liquid distributes liquid between oceans, lakes, and rivers
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:58:in 'block (4 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:58:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  280) CelestialBodies::Spheres::Hydrosphere#calculate_liquid_volume calculates the total liquid volume correctly
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:66:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  281) CelestialBodies::Spheres::Hydrosphere#update_water_cycle melts ice when temperature is above freezing
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:79:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  282) CelestialBodies::Spheres::Hydrosphere#update_water_cycle does not melt ice when temperature is below freezing
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:79:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  283) CelestialBodies::Spheres::Hydrosphere#evaporate_liquids evaporates liquids when conditions are met
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_hydrosphere, celestial_body: celestial_body) }

       KeyError:
         Factory not registered: "celestial_bodies_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/hydrosphere_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/hydrosphere_spec.rb:99:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  284) CelestialBodies::IceGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
       Failure/Error:
         IceGiant.create!(
           name: "Uranus",
           size: 4.0,
           gravity: 8.69,
           density: 1.27,
           orbital_period: 30660,
           mass: 8.681e25, # Example mass in kg
           radius: 2.54e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 830000, "Helium" => 140000 },
           temperature: 76.0 # Example temperature

       NameError:
         uninitialized constant IceGiant
       # ./spec/models/ice_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/ice_giant_spec.rb:20:in 'block (3 levels) in <main>'

  285) CelestialBodies::IceGiant#calculate_gravity calculates gravity based on mass and radius
       Failure/Error:
         IceGiant.create!(
           name: "Uranus",
           size: 4.0,
           gravity: 8.69,
           density: 1.27,
           orbital_period: 30660,
           mass: 8.681e25, # Example mass in kg
           radius: 2.54e7, # Example radius in meters
           gas_quantities: { "Hydrogen" => 830000, "Helium" => 140000 },
           temperature: 76.0 # Example temperature

       NameError:
         uninitialized constant IceGiant
       # ./spec/models/ice_giant_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/ice_giant_spec.rb:27:in 'block (3 levels) in <main>'

  286) Item regolith handling gets composition from celestial body geosphere
       Failure/Error: expect(luna.identifier).to eq('LUNA-01')

         expected: "LUNA-01"
              got: "LUNA-38"

         (compared using ==)
       # ./spec/models/item_spec.rb:300:in 'block (3 levels) in <main>'

  287) CelestialBodies::Materials::Liquid associations 
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:9:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  288) CelestialBodies::Materials::Liquid validations is valid with valid attributes
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:14:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  289) CelestialBodies::Materials::Liquid validations is not valid without a name
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:18:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  290) CelestialBodies::Materials::Liquid validations is not valid without an amount
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  291) CelestialBodies::Materials::Liquid validations is not valid with a negative amount
       Failure/Error: let(:hydrosphere) { create(:celestial_bodies_spheres_hydrosphere) }

       KeyError:
         Factory not registered: "celestial_bodies_spheres_hydrosphere"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/liquid_material_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/liquid_material_spec.rb:30:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "celestial_bodies_spheres_hydrosphere"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  292) Location::CelestialLocation validations is expected to validate that :name cannot be empty/falsy
       Failure/Error: it { is_expected.to validate_presence_of(:name) }

         Expected Location::CelestialLocation to validate that :name cannot be
         empty/falsy, but this could not be proved.
           After setting :name to ‹""›, the matcher expected the
           Location::CelestialLocation to be invalid, but it was valid instead.
       # ./spec/models/location/celestial_location_spec.rb:15:in 'block (3 levels) in <main>'

  293) Location::CelestialLocation orbital mechanics #orbital_period returns nil for surface locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Surface Location',
           coordinates: '40.71°N 74.01°W',
           altitude: 0
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:316:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:327:in 'block (4 levels) in <main>'

  294) Location::CelestialLocation orbital mechanics #orbital_period calculates period for orbital locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Orbital Location',
           coordinates: '0.00°N 0.00°E',
           altitude: 408_000
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:306:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:332:in 'block (4 levels) in <main>'

  295) Location::CelestialLocation orbital mechanics #orbital_velocity returns nil for surface locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Surface Location',
           coordinates: '40.71°N 74.01°W',
           altitude: 0
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:316:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:350:in 'block (4 levels) in <main>'

  296) Location::CelestialLocation orbital mechanics #orbital_velocity calculates velocity for orbital locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Orbital Location',
           coordinates: '0.00°N 0.00°E',
           altitude: 408_000
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:306:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:355:in 'block (4 levels) in <main>'

  297) Location::CelestialLocation orbital mechanics #gravity returns surface gravity for surface locations
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Surface Location',
           coordinates: '40.71°N 74.01°W',
           altitude: 0
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:316:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:373:in 'block (4 levels) in <main>'

  298) Location::CelestialLocation orbital mechanics #gravity calculates reduced gravity at altitude
       Failure/Error:
         location = Location::Location::CelestialLocation.new(
           name: 'Orbital Location',
           coordinates: '0.00°N 0.00°E',
           altitude: 408_000
         )

       NameError:
         uninitialized constant Location::Location
       # ./spec/models/location/celestial_location_spec.rb:306:in 'block (3 levels) in <main>'
       # ./spec/models/location/celestial_location_spec.rb:377:in 'block (4 levels) in <main>'

  299) Location::CelestialLocation#description describes surface locations
       Failure/Error:
         location = Location::CelestialLocation.new(
           name: 'Surface Location',
           celestial_body: body,
           coordinates: '28.50°N 80.60°W',
           altitude: 0
         )

       ActiveRecord::AssociationTypeMismatch:
         CelestialBodies::CelestialBody(#8888) expected, got #<Double "Body"> which is an instance of RSpec::Mocks::Double(#118240)
       # ./spec/models/location/celestial_location_spec.rb:401:in 'block (3 levels) in <main>'

  300) Location::CelestialLocation#description describes orbital locations
       Failure/Error:
         location = Location::CelestialLocation.new(
           name: 'Orbital Location',
           celestial_body: body,
           coordinates: '0.00°N 0.00°E',
           altitude: 400_000
         )

       ActiveRecord::AssociationTypeMismatch:
         CelestialBodies::CelestialBody(#8888) expected, got #<Double "Body"> which is an instance of RSpec::Mocks::Double(#118240)
       # ./spec/models/location/celestial_location_spec.rb:415:in 'block (3 levels) in <main>'

  301) Location::SpatialLocation#update_location updates coordinates
       Failure/Error: expect(spatial_location.update_location(new_coords)).to be true

       NoMethodError:
         undefined method 'update_location' for an instance of Location::SpatialLocation
       # ./spec/models/location/spatial_location_spec.rb:76:in 'block (3 levels) in <main>'

  302) Market::Marketplace#find_matching_orders when order is a Sell order calls the settlement NPC methods
       Failure/Error: expect { marketplace.find_matching_orders(sell_order) }.not_to raise_error

         expected no Exception, got #<ArgumentError: 'Sell' is not a valid order_type> with backtrace:
           # ./spec/models/market/marketplace_spec.rb:65:in 'block (3 levels) in <main>'
           # ./spec/models/market/marketplace_spec.rb:84:in 'block (5 levels) in <main>'
           # ./spec/models/market/marketplace_spec.rb:84:in 'block (4 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:84:in 'block (4 levels) in <main>'

  303) Market::Marketplace#find_matching_orders when order is not a Sell order returns an empty array
       Failure/Error:
         Market::Order.create!(
           market_condition: market_condition,
           orderable: player,
           base_settlement_id: settlement.id,
           resource: 'LOX',
           quantity: 100,
           order_type: 'Buy'
         )

       ArgumentError:
         'Buy' is not a valid order_type
       # ./spec/models/market/marketplace_spec.rb:90:in 'block (4 levels) in <main>'
       # ./spec/models/market/marketplace_spec.rb:101:in 'block (4 levels) in <main>'

  304) Market::Marketplace#place_order creates an order
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  305) Market::Marketplace#place_order converts volume parameter to quantity
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  306) Market::Marketplace#place_order sets the base_settlement_id
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  307) Market::Marketplace#place_order removes unused parameters
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  308) Market::Marketplace#place_order when order is fully filled returns nil
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  309) Market::Marketplace#place_order when order is fully filled sets order quantity to zero
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  310) Market::Marketplace#place_order when order is partially filled returns the order
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  311) Market::Marketplace#place_order when no matching orders exist returns the unfilled order
       Failure/Error: allow(FinancialManager).to receive(:transfer).and_return(true)

       NameError:
         uninitialized constant FinancialManager
       # ./spec/models/market/marketplace_spec.rb:133:in 'block (3 levels) in <main>'

  312) Market::Marketplace#execute_trades delegates the entire trade execution to Market::TradeExecutionService
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       Zeitwerk::NameError:
         expected file /home/galaxy_game/app/models/organizations/corporation.rb to define constant Organizations::Corporation, but didn't
       # /usr/local/bundle/gems/zeitwerk-2.7.1/lib/zeitwerk/loader/callbacks.rb:33:in 'Zeitwerk::Loader::Callbacks#on_file_autoloaded'
       # /usr/local/bundle/gems/zeitwerk-2.7.1/lib/zeitwerk/core_ext/kernel.rb:27:in 'Kernel#require'
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  313) Market::Marketplace#execute_trades updates the order quantity to zero when fully filled
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  314) Market::Marketplace#execute_trades wraps the execution in a transaction
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  315) Market::Marketplace#execute_trades when partially filled updates the order quantity to remaining amount
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/models/market/marketplace_spec.rb:343:in 'block (3 levels) in <main>'

  316) Market::TransactionFee validations is expected to validate that :fee_type cannot be empty/falsy
       Failure/Error: it { should validate_presence_of(:fee_type) }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :fee_type on the Market::TransactionFee to
         nil, but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#run_allow_or_disallow_matcher'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:103:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#disallows_value_of'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:258:in 'Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#disallows_original_or_typecast_value?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:180:in 'block in Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:179:in 'Array#all?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_presence_of_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidatePresenceOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:5:in 'block (3 levels) in <main>'

  317) Market::TransactionFee validations is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"›
       Failure/Error: it { should validate_inclusion_of(:fee_type).in_array(%w[percentage fixed]) }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :fee_type on the Market::TransactionFee to
         "percentage", but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:42:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:28:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_failing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:395:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:179:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#run_allow_or_disallow_matcher'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validation_matcher.rb:98:in 'Shoulda::Matchers::ActiveModel::ValidationMatcher#allows_value_of'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:468:in 'block in Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#allows_all_values_in_array?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:467:in 'Array#all?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:467:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#allows_all_values_in_array?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:417:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#matches_for_array?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_inclusion_of_matcher.rb:376:in 'Shoulda::Matchers::ActiveModel::ValidateInclusionOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:6:in 'block (3 levels) in <main>'

  318) Market::TransactionFee validations is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil
       Failure/Error: it { should validate_numericality_of(:percentage).is_greater_than_or_equal_to(0).allow_nil }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :percentage on the Market::TransactionFee
         to "-1", but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:36:in 'block in Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Array#reject'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:13:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/comparison_matcher.rb:79:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::ComparisonMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:7:in 'block (3 levels) in <main>'

  319) Market::TransactionFee validations is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil
       Failure/Error: it { should validate_numericality_of(:fixed_amount).is_greater_than_or_equal_to(0).allow_nil }

       Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeDoesNotExistError:
         The matcher attempted to set :fixed_amount on the Market::TransactionFee
         to "-1", but that attribute does not exist.
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:214:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#attribute_does_not_exist!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setter.rb:78:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSetter#set!'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:38:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher/attribute_setters_and_validators.rb:24:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher::AttributeSettersAndValidators#first_passing'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Kernel#public_send'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:536:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#run'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/allow_value_matcher.rb:401:in 'Shoulda::Matchers::ActiveModel::AllowValueMatcher#does_not_match?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/disallow_value_matcher.rb:32:in 'Shoulda::Matchers::ActiveModel::DisallowValueMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:36:in 'block in Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Array#reject'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:35:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#failing_submatchers'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/submatchers.rb:13:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::Submatchers#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/numericality_matchers/comparison_matcher.rb:79:in 'Shoulda::Matchers::ActiveModel::NumericalityMatchers::ComparisonMatcher#matches?'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:646:in 'block in Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Array#each'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Enumerable#detect'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:645:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#first_submatcher_that_fails_to_match'
       # /usr/local/bundle/gems/shoulda-matchers-5.3.0/lib/shoulda/matchers/active_model/validate_numericality_of_matcher.rb:480:in 'Shoulda::Matchers::ActiveModel::ValidateNumericalityOfMatcher#matches?'
       # ./spec/models/market/transaction_fee_spec.rb:8:in 'block (3 levels) in <main>'

  320) Market::TransactionFee#calculate calculates percentage fee
       Failure/Error: fee = build(:transaction_fee, fee_type: 'percentage', percentage: 5, fixed_amount: nil)

       NoMethodError:
         undefined method 'fee_type=' for an instance of Market::TransactionFee
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/transaction_fee_spec.rb:13:in 'block (3 levels) in <main>'

  321) Market::TransactionFee#calculate calculates fixed fee
       Failure/Error: fee = build(:transaction_fee, fee_type: 'fixed', percentage: nil, fixed_amount: 10)

       NoMethodError:
         undefined method 'fee_type=' for an instance of Market::TransactionFee
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/transaction_fee_spec.rb:18:in 'block (3 levels) in <main>'

  322) Market::TransactionFee#calculate returns 0 for unknown fee_type
       Failure/Error: fee = build(:transaction_fee, fee_type: 'other', percentage: nil, fixed_amount: nil)

       NoMethodError:
         undefined method 'fee_type=' for an instance of Market::TransactionFee
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/market/transaction_fee_spec.rb:23:in 'block (3 levels) in <main>'

  323) MaterialRequest validations is valid with required attributes
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (477, Test Dome, Crater Dome, null, 1308, Player, 2501, null, Location::CelestialLocation, 1650, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:07.957553, 2026-01-13 04:19:07.957553, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:15:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (477, Test Dome, Crater Dome, null, 1308, Player, 2501, null, Location::CelestialLocation, 1650, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:07.957553, 2026-01-13 04:19:07.957553, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  324) MaterialRequest validations requires a material_name
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (478, Test Dome, Crater Dome, null, 1309, Player, 2503, null, Location::CelestialLocation, 1652, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:08.236873, 2026-01-13 04:19:08.236873, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (478, Test Dome, Crater Dome, null, 1309, Player, 2503, null, Location::CelestialLocation, 1652, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:08.236873, 2026-01-13 04:19:08.236873, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  325) MaterialRequest validations requires quantity_requested to be present
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (479, Test Dome, Crater Dome, null, 1310, Player, 2505, null, Location::CelestialLocation, 1654, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:08.519303, 2026-01-13 04:19:08.519303, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:33:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (479, Test Dome, Crater Dome, null, 1310, Player, 2505, null, Location::CelestialLocation, 1654, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:08.519303, 2026-01-13 04:19:08.519303, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  326) MaterialRequest validations requires quantity_requested to be greater than 0
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (480, Test Dome, Crater Dome, null, 1311, Player, 2507, null, Location::CelestialLocation, 1656, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:08.781389, 2026-01-13 04:19:08.781389, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:42:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (480, Test Dome, Crater Dome, null, 1311, Player, 2507, null, Location::CelestialLocation, 1656, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:08.781389, 2026-01-13 04:19:08.781389, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  327) MaterialRequest validations requires quantity_requested to be a number
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (481, Test Dome, Crater Dome, null, 1312, Player, 2509, null, Location::CelestialLocation, 1658, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:09.080181, 2026-01-13 04:19:09.080181, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:52:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (481, Test Dome, Crater Dome, null, 1312, Player, 2509, null, Location::CelestialLocation, 1658, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:09.080181, 2026-01-13 04:19:09.080181, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  328) MaterialRequest associations belongs to a requestable (polymorphic)
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (482, Test Dome, Crater Dome, null, 1313, Player, 2511, null, Location::CelestialLocation, 1660, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:09.414528, 2026-01-13 04:19:09.414528, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:62:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:65:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (482, Test Dome, Crater Dome, null, 1313, Player, 2511, null, Location::CelestialLocation, 1660, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:09.414528, 2026-01-13 04:19:09.414528, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  329) MaterialRequest associations can be associated with different requestable types
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (483, Test Dome, Crater Dome, null, 1314, Player, 2513, null, Location::CelestialLocation, 1662, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:09.731672, 2026-01-13 04:19:09.731672, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:70:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (483, Test Dome, Crater Dome, null, 1314, Player, 2513, null, Location::CelestialLocation, 1662, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:09.731672, 2026-01-13 04:19:09.731672, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  330) MaterialRequest enums status enum defaults to pending status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (484, Test Dome, Crater Dome, null, 1315, Player, 2515, null, Location::CelestialLocation, 1664, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.026639, 2026-01-13 04:19:10.026639, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:92:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (484, Test Dome, Crater Dome, null, 1315, Player, 2515, null, Location::CelestialLocation, 1664, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.026639, 2026-01-13 04:19:10.026639, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  331) MaterialRequest enums status enum can be set to different statuses
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (485, Test Dome, Crater Dome, null, 1316, Player, 2517, null, Location::CelestialLocation, 1666, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.317648, 2026-01-13 04:19:10.317648, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:96:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (485, Test Dome, Crater Dome, null, 1316, Player, 2517, null, Location::CelestialLocation, 1666, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.317648, 2026-01-13 04:19:10.317648, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  332) MaterialRequest enums status enum accepts string values for status
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (486, Test Dome, Crater Dome, null, 1317, Player, 2519, null, Location::CelestialLocation, 1668, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.599164, 2026-01-13 04:19:10.599164, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:102:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (486, Test Dome, Crater Dome, null, 1317, Player, 2519, null, Location::CelestialLocation, 1668, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.599164, 2026-01-13 04:19:10.599164, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  333) MaterialRequest enums priority enum defaults to normal priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (487, Test Dome, Crater Dome, null, 1318, Player, 2521, null, Location::CelestialLocation, 1670, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.927961, 2026-01-13 04:19:10.927961, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:118:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (487, Test Dome, Crater Dome, null, 1318, Player, 2521, null, Location::CelestialLocation, 1670, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:10.927961, 2026-01-13 04:19:10.927961, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  334) MaterialRequest enums priority enum can be set to different priorities
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (488, Test Dome, Crater Dome, null, 1319, Player, 2523, null, Location::CelestialLocation, 1672, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:11.254032, 2026-01-13 04:19:11.254032, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:122:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (488, Test Dome, Crater Dome, null, 1319, Player, 2523, null, Location::CelestialLocation, 1672, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:11.254032, 2026-01-13 04:19:11.254032, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  335) MaterialRequest enums priority enum accepts string values for priority
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (489, Test Dome, Crater Dome, null, 1320, Player, 2525, null, Location::CelestialLocation, 1674, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:11.551965, 2026-01-13 04:19:11.551965, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:79:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:128:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (489, Test Dome, Crater Dome, null, 1320, Player, 2525, null, Location::CelestialLocation, 1674, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:11.551965, 2026-01-13 04:19:11.551965, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  336) MaterialRequest scopes .pending_requests returns pending and partially fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (490, Test Dome, Crater Dome, null, 1321, Player, 2527, null, Location::CelestialLocation, 1676, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:11.856266, 2026-01-13 04:19:11.856266, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:135:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (490, Test Dome, Crater Dome, null, 1321, Player, 2527, null, Location::CelestialLocation, 1676, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:11.856266, 2026-01-13 04:19:11.856266, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  337) MaterialRequest scopes .fulfilled returns only fulfilled requests
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (491, Test Dome, Crater Dome, null, 1322, Player, 2529, null, Location::CelestialLocation, 1678, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:12.142917, 2026-01-13 04:19:12.142917, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:135:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (491, Test Dome, Crater Dome, null, 1322, Player, 2529, null, Location::CelestialLocation, 1678, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:12.142917, 2026-01-13 04:19:12.142917, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  338) MaterialRequest scopes .for_material returns requests for a specific material
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (492, Test Dome, Crater Dome, null, 1323, Player, 2531, null, Location::CelestialLocation, 1680, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:12.437062, 2026-01-13 04:19:12.437062, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:135:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (492, Test Dome, Crater Dome, null, 1323, Player, 2531, null, Location::CelestialLocation, 1680, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:12.437062, 2026-01-13 04:19:12.437062, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  339) MaterialRequest delegations delegates settlement to requestable
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (493, Test Dome, Crater Dome, null, 1324, Player, 2533, null, Location::CelestialLocation, 1682, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:12.752459, 2026-01-13 04:19:12.752459, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:168:in 'block (3 levels) in <main>'
       # ./spec/models/material_request_spec.rb:171:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (493, Test Dome, Crater Dome, null, 1324, Player, 2533, null, Location::CelestialLocation, 1682, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:12.752459, 2026-01-13 04:19:12.752459, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  340) MaterialRequest delegations handles nil settlement gracefully
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (494, Test Dome, Crater Dome, null, 1325, Player, 2535, null, Location::CelestialLocation, 1684, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.051895, 2026-01-13 04:19:13.051895, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:176:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (494, Test Dome, Crater Dome, null, 1325, Player, 2535, null, Location::CelestialLocation, 1684, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.051895, 2026-01-13 04:19:13.051895, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  341) MaterialRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (495, Test Dome, Crater Dome, null, 1326, Player, 2537, null, Location::CelestialLocation, 1686, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.344739, 2026-01-13 04:19:13.344739, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:185:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (495, Test Dome, Crater Dome, null, 1326, Player, 2537, null, Location::CelestialLocation, 1686, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.344739, 2026-01-13 04:19:13.344739, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  342) MaterialRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (496, Test Dome, Crater Dome, null, 1327, Player, 2539, null, Location::CelestialLocation, 1688, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.631319, 2026-01-13 04:19:13.631319, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:194:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (496, Test Dome, Crater Dome, null, 1327, Player, 2539, null, Location::CelestialLocation, 1688, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.631319, 2026-01-13 04:19:13.631319, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  343) MaterialRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (497, Test Dome, Crater Dome, null, 1328, Player, 2541, null, Location::CelestialLocation, 1690, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.902835, 2026-01-13 04:19:13.902835, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:203:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (497, Test Dome, Crater Dome, null, 1328, Player, 2541, null, Location::CelestialLocation, 1690, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:13.902835, 2026-01-13 04:19:13.902835, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  344) MaterialRequest instance methods #gas_request? returns true when material is a gas
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (498, Test Dome, Crater Dome, null, 1329, Player, 2543, null, Location::CelestialLocation, 1692, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:14.198853, 2026-01-13 04:19:14.198853, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:222:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (498, Test Dome, Crater Dome, null, 1329, Player, 2543, null, Location::CelestialLocation, 1692, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:14.198853, 2026-01-13 04:19:14.198853, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  345) MaterialRequest instance methods #gas_request? returns false when material is not a gas
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (499, Test Dome, Crater Dome, null, 1330, Player, 2545, null, Location::CelestialLocation, 1694, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:14.621402, 2026-01-13 04:19:14.621402, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:229:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (499, Test Dome, Crater Dome, null, 1330, Player, 2545, null, Location::CelestialLocation, 1694, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:14.621402, 2026-01-13 04:19:14.621402, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  346) MaterialRequest instance methods #gas_request? returns false when material data is not found
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (500, Test Dome, Crater Dome, null, 1331, Player, 2547, null, Location::CelestialLocation, 1696, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:14.912727, 2026-01-13 04:19:14.912727, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:235:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (500, Test Dome, Crater Dome, null, 1331, Player, 2547, null, Location::CelestialLocation, 1696, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:14.912727, 2026-01-13 04:19:14.912727, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  347) MaterialRequest instance methods #gas_request? returns false when material data has no category
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (501, Test Dome, Crater Dome, null, 1332, Player, 2549, null, Location::CelestialLocation, 1698, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:15.204076, 2026-01-13 04:19:15.204076, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:212:in 'block (4 levels) in <main>'
       # ./spec/models/material_request_spec.rb:242:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (501, Test Dome, Crater Dome, null, 1332, Player, 2549, null, Location::CelestialLocation, 1698, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:15.204076, 2026-01-13 04:19:15.204076, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  348) MaterialRequest factory creates a valid material request with factory
       Failure/Error: let(:crater_dome) { create(:crater_dome, :with_dimensions, name: "Test Dome", settlement: settlement) }

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (502, Test Dome, Crater Dome, null, 1333, Player, 2551, null, Location::CelestialLocation, 1700, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:15.486311, 2026-01-13 04:19:15.486311, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/material_request_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/material_request_spec.rb:251:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (502, Test Dome, Crater Dome, null, 1333, Player, 2551, null, Location::CelestialLocation, 1700, 0, {"status": "planned", "dimensions": {"depth": 40.0, "diameter": ..., 2026-01-13 04:19:15.486311, 2026-01-13 04:19:15.486311, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  349) CelestialBodies::Material validations is not valid without a state
       Failure/Error: expect(material).to_not be_valid
         expected #<CelestialBodies::Material id: 978, name: "Material 15", amount: 100.0, boiling_point: nil, melting_point: nil, state_at_room_temp: nil, state: nil, location: "surface", is_volatile: false, materializable_type: nil, materializable_id: nil, celestial_body_id: 4128, created_at: "2026-01-13 04:19:16.087629000 +0000", updated_at: "2026-01-13 04:19:16.087629000 +0000", layer: nil> not to be valid
       # ./spec/models/material_spec.rb:29:in 'block (3 levels) in <main>'

  350) CelestialBodies::Material validations is not valid with an invalid state
       Failure/Error: material.state = 'unknown_state'

       ArgumentError:
         'unknown_state' is not a valid state
       # ./spec/models/material_spec.rb:40:in 'block (3 levels) in <main>'

  351) CelestialBodies::Material validations is not valid with non-numeric melting and boiling points
       Failure/Error: expect(material).to_not be_valid
         expected #<CelestialBodies::Material id: 982, name: "Material 19", amount: 100.0, boiling_point: 0.0, melting_point: 0.0, state_at_room_temp: nil, state: "solid", location: "surface", is_volatile: false, materializable_type: nil, materializable_id: nil, celestial_body_id: 4132, created_at: "2026-01-13 04:19:16.563770000 +0000", updated_at: "2026-01-13 04:19:16.563770000 +0000", layer: nil> not to be valid
       # ./spec/models/material_spec.rb:53:in 'block (3 levels) in <main>'

  352) CelestialBodies::Material#state_at returns "solid" when temperature is below the adjusted melting point
       Failure/Error: expect(material.state_at(250, 1.0)).to eq('solid')

       NoMethodError:
         undefined method 'state_at' for an instance of CelestialBodies::Material
       # ./spec/models/material_spec.rb:65:in 'block (3 levels) in <main>'

  353) CelestialBodies::Material#state_at returns "liquid" when temperature is between the adjusted melting and boiling points
       Failure/Error: expect(material.state_at(400, 1.0)).to eq('liquid')

       NoMethodError:
         undefined method 'state_at' for an instance of CelestialBodies::Material
       # ./spec/models/material_spec.rb:69:in 'block (3 levels) in <main>'

  354) CelestialBodies::Material#state_at returns "gas" when temperature is above the adjusted boiling point
       Failure/Error: expect(material.state_at(600, 1.0)).to eq('gas')

       NoMethodError:
         undefined method 'state_at' for an instance of CelestialBodies::Material
       # ./spec/models/material_spec.rb:73:in 'block (3 levels) in <main>'

  355) OrbitalRelationship associations belongs to primary_body polymorphically
       Failure/Error: relationship = OrbitalRelationship.new(primary_body: star)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:12:in 'block (3 levels) in <main>'

  356) OrbitalRelationship associations belongs to secondary_body polymorphically
       Failure/Error: relationship = OrbitalRelationship.new(secondary_body: planet)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'secondary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:17:in 'block (3 levels) in <main>'

  357) OrbitalRelationship validations is valid with valid attributes
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:34:in 'block (3 levels) in <main>'

  358) OrbitalRelationship validations relationship_type validation requires relationship_type to be present
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.except(:relationship_type))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:40:in 'block (4 levels) in <main>'

  359) OrbitalRelationship validations relationship_type validation validates relationship_type inclusion
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(relationship_type: type))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:49:in 'block (5 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:48:in 'Array#each'
       # ./spec/models/orbital_relationship_spec.rb:48:in 'block (4 levels) in <main>'

  360) OrbitalRelationship validations numerical validations validates distance is positive
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(distance: -1))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:60:in 'block (4 levels) in <main>'

  361) OrbitalRelationship validations numerical validations validates semi_major_axis is positive
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(semi_major_axis: -1))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:66:in 'block (4 levels) in <main>'

  362) OrbitalRelationship validations numerical validations validates eccentricity is between 0 and 1
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(eccentricity: 0.5))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:72:in 'block (4 levels) in <main>'

  363) OrbitalRelationship validations numerical validations validates orbital_period is positive
       Failure/Error: relationship = OrbitalRelationship.new(valid_attributes.merge(orbital_period: -1))

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:81:in 'block (4 levels) in <main>'

  364) OrbitalRelationship validations uniqueness validation prevents duplicate relationships between same bodies
       Failure/Error: OrbitalRelationship.create!(valid_attributes)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'primary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:88:in 'block (4 levels) in <main>'

  365) OrbitalRelationship backward compatibility methods #sun returns primary_body when it's a Star
       Failure/Error:
         create(:orbital_relationship, 
           primary_body: star, 
           secondary_body: planet, 
           relationship_type: 'star_planet'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:99:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:108:in 'block (4 levels) in <main>'

  366) OrbitalRelationship backward compatibility methods #sun returns nil when primary_body is not a Star
       Failure/Error:
         planet_moon_relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:112:in 'block (4 levels) in <main>'

  367) OrbitalRelationship backward compatibility methods #sun= sets primary_body and relationship_type
       Failure/Error: relationship = OrbitalRelationship.new(secondary_body: planet)

       ActiveModel::UnknownAttributeError:
         unknown attribute 'secondary_body' for OrbitalRelationship.
       # ./spec/models/orbital_relationship_spec.rb:123:in 'block (4 levels) in <main>'

  368) OrbitalRelationship backward compatibility methods #celestial_body returns secondary_body when it's a CelestialBody
       Failure/Error:
         create(:orbital_relationship, 
           primary_body: star, 
           secondary_body: planet, 
           relationship_type: 'star_planet'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:99:in 'block (3 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:133:in 'block (4 levels) in <main>'

  369) OrbitalRelationship backward compatibility methods #celestial_body= sets secondary_body
       Failure/Error: relationship.celestial_body = planet

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/orbital_relationship_spec.rb:140:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant OrbitalRelationship::CelestialBody
       #   ./spec/models/orbital_relationship_spec.rb:140:in 'block (4 levels) in <main>'

  370) OrbitalRelationship relationship type helpers identifies star_planet relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:149:in 'block (3 levels) in <main>'

  371) OrbitalRelationship relationship type helpers identifies planet_moon relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:159:in 'block (3 levels) in <main>'

  372) OrbitalRelationship relationship type helpers identifies binary_star relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: binary_star,
           relationship_type: 'binary_star'
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:169:in 'block (3 levels) in <main>'

  373) OrbitalRelationship energy calculations #stellar_energy_input calculates stellar energy based on luminosity and distance
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11  # 1 AU
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:182:in 'block (4 levels) in <main>'

  374) OrbitalRelationship energy calculations #stellar_energy_input returns 0 when primary_body doesn't have luminosity
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon',
           distance: 3.844e8
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:194:in 'block (4 levels) in <main>'

  375) OrbitalRelationship energy calculations #tidal_heating calculates tidal heating for planet-moon relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon',
           distance: 3.844e8,  # Earth-Moon distance
           eccentricity: 0.0549  # Moon's eccentricity
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:207:in 'block (4 levels) in <main>'

  376) OrbitalRelationship energy calculations #tidal_heating includes eccentricity factor in calculation
       Failure/Error:
         low_ecc = create(:orbital_relationship,
           primary_body: planet,
           secondary_body: moon,
           relationship_type: 'planet_moon',
           distance: 3.844e8,
           eccentricity: 0.01
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:220:in 'block (4 levels) in <main>'

  377) OrbitalRelationship energy calculations #energy_input returns stellar energy for star_planet relationships
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:242:in 'block (4 levels) in <main>'

  378) OrbitalRelationship energy calculations #energy_input returns combined tidal and reflected energy for planet_moon relationships
       Failure/Error:
         star_planet = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:254:in 'block (4 levels) in <main>'

  379) OrbitalRelationship terraforming reflected_energy and energy_input returns extra energy for star_planet with orbital mirrors and albedo adjustment
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           distance: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:278:in 'block (3 levels) in <main>'

  380) OrbitalRelationship orbital mechanics #orbital_distance returns semi_major_axis when available
       Failure/Error:
         relationship = create(:orbital_relationship,
           distance: 1.0e11,
           semi_major_axis: 1.5e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:301:in 'block (4 levels) in <main>'

  381) OrbitalRelationship orbital mechanics #orbital_distance falls back to distance when semi_major_axis is nil
       Failure/Error:
         relationship = create(:orbital_relationship,
           distance: 1.0e11,
           semi_major_axis: nil
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:309:in 'block (4 levels) in <main>'

  382) OrbitalRelationship orbital mechanics #orbital_distance returns 0 when both are nil
       Failure/Error:
         relationship = create(:orbital_relationship,
           distance: nil,
           semi_major_axis: nil
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:317:in 'block (4 levels) in <main>'

  383) OrbitalRelationship orbital mechanics #calculated_orbital_period calculates orbital period using Kepler's Third Law
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star,
           secondary_body: planet,
           relationship_type: 'star_planet',
           semi_major_axis: 1.496e11  # 1 AU
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:327:in 'block (4 levels) in <main>'

  384) OrbitalRelationship orbital mechanics #calculated_orbital_period returns nil when primary_body has no mass
       Failure/Error:
         relationship = create(:orbital_relationship,
           primary_body: star_with_mass,
           secondary_body: planet,
           semi_major_axis: 1.496e11
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:340:in 'block (4 levels) in <main>'

  385) OrbitalRelationship orbital mechanics #current_orbital_position calculates orbital position based on time
       Failure/Error:
         relationship = create(:orbital_relationship,
           orbital_period: 30.0,  # 30 day period
           epoch_time: epoch,
           mean_anomaly_at_epoch: 0
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:354:in 'block (4 levels) in <main>'

  386) OrbitalRelationship orbital mechanics #current_orbital_position returns nil when orbital_period or epoch_time is missing
       Failure/Error:
         relationship = create(:orbital_relationship,
           orbital_period: nil,
           epoch_time: nil
         )

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:366:in 'block (4 levels) in <main>'

  387) OrbitalRelationship private methods #masses_present? returns true when both bodies have mass
       Failure/Error: let(:relationship) { create(:orbital_relationship, primary_body: star, secondary_body: planet) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:378:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:381:in 'block (4 levels) in <main>'

  388) OrbitalRelationship private methods #masses_present? returns false when primary_body has no mass
       Failure/Error: let(:relationship) { create(:orbital_relationship, primary_body: star, secondary_body: planet) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:378:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:386:in 'block (4 levels) in <main>'

  389) OrbitalRelationship private methods #extract_mass extracts mass from Star objects
       Failure/Error: let(:relationship) { create(:orbital_relationship) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:391:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:394:in 'block (4 levels) in <main>'

  390) OrbitalRelationship private methods #extract_mass extracts and converts mass from CelestialBody objects
       Failure/Error: let(:relationship) { create(:orbital_relationship) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:391:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:399:in 'block (4 levels) in <main>'

  391) OrbitalRelationship private methods #extract_mass returns nil for unsupported object types
       Failure/Error: let(:relationship) { create(:orbital_relationship) }

       NoMethodError:
         undefined method 'primary_body=' for an instance of OrbitalRelationship
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/orbital_relationship_spec.rb:391:in 'block (4 levels) in <main>'
       # ./spec/models/orbital_relationship_spec.rb:404:in 'block (4 levels) in <main>'

  392) Organizations::BaseOrganization distributes profits to members based on ownership
       Failure/Error: allow(consortium).to receive(:calculate_revenue).and_return(1_000_000)
         #<Organizations::BaseOrganization id: 212, name: "Test Organization 61", identifier: "ORG66", organization_type: "consortium", operational_data: {}, description: nil, owner_type: nil, owner_id: nil, created_at: "2026-01-13 04:19:29.191892000 +0000", updated_at: "2026-01-13 04:19:29.191892000 +0000"> does not implement: calculate_revenue
       # ./spec/models/organizations/base_organization_profit_spec.rb:9:in 'block (2 levels) in <main>'

  393) Organizations::TaxAuthority.instance always returns the same single instance
       Failure/Error: expect(Organizations::TaxAuthority.count).to eq(1)

         expected: 1
              got: 2

         (compared using ==)
       # ./spec/models/organizations/tax_authority_spec.rb:24:in 'block (3 levels) in <main>'

  394) PlanetBiome 
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:15:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  395) PlanetBiome 
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  396) PlanetBiome is valid with valid attributes
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:20:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  397) PlanetBiome is not valid without a biome
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:24:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  398) PlanetBiome is not valid without a celestial_body
       Failure/Error:
         described_class.new(
           biome: biome,
           celestial_body: celestial_body
         )

       NameError:
         Rails couldn't find a valid model for CelestialBody association. Please provide the :class_name option on the association declaration. If :class_name is already provided, make sure it's an ActiveRecord::Base subclass.
       # ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/models/planet_biome_spec.rb:29:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # NameError:
       #   uninitialized constant PlanetBiome::CelestialBody
       #   ./spec/models/planet_biome_spec.rb:8:in 'block (2 levels) in <main>'

  399) PlantEnvironment validations is valid with valid attributes
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:14:in 'block (3 levels) in <main>'

  400) PlantEnvironment validations is not valid without a plant
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:18:in 'block (3 levels) in <main>'

  401) PlantEnvironment validations is not valid without an environment
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:23:in 'block (3 levels) in <main>'

  402) PlantEnvironment validations is not valid with duplicate plant and environment pair
       Failure/Error: let(:plant) { Plant.create!(name: "Fern", growth_temperature_range: "20..30", growth_humidity_range: "50..80") }

       ActiveRecord::RecordInvalid:
         Validation failed: Environment must exist
       # ./spec/models/plant_environment_spec.rb:9:in 'block (2 levels) in <main>'
       # ./spec/models/plant_environment_spec.rb:28:in 'block (3 levels) in <main>'

  403) Plant validations is valid with valid attributes
       Failure/Error: expect(plant).to be_valid
         expected #<Plant id: nil, name: "Cactus", growth_temperature_range: "20..30", growth_humidity_range: "10..30", description: "A hardy plant adapted to dry environments", created_at: nil, updated_at: nil> to be valid, but got errors: Environment must exist
       # ./spec/models/plant_spec.rb:10:in 'block (3 levels) in <main>'

  404) Plant methods can grow in a given environment if conditions are met
       Failure/Error: environment = Environment.create(biome: biome, planet: Planet.first, temperature: 25.0, pressure: 1.0, humidity: 20.0)

       NameError:
         uninitialized constant Planet
       # ./spec/models/plant_spec.rb:37:in 'block (3 levels) in <main>'

  405) Plant methods cannot grow in a given environment if conditions are not met
       Failure/Error: environment = Environment.create(biome: biome, planet: Planet.first, temperature: 35.0, pressure: 1.0, humidity: 80.0)

       NameError:
         uninitialized constant Planet
       # ./spec/models/plant_spec.rb:43:in 'block (3 levels) in <main>'

  406) Rigs::BaseRig#apply_rig_to_attachable applies rig effect to the attachable unit
       Failure/Error: expect(base_unit).to receive(:update_consumables).at_least(:once)
         #<Units::BaseUnit id: 417, identifier: "UNIT56", name: "Test Unit 48", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 219, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-13 04:19:31.710168000 +0000", updated_at: "2026-01-13 04:19:31.710168000 +0000"> does not implement: update_consumables
       # ./spec/models/rigs/base_rig_spec.rb:24:in 'block (3 levels) in <main>'

  407) Rigs::BaseRig#remove_from removes rig effect from the attachable unit
       Failure/Error: expect(base_unit).to receive(:update_consumables).at_least(:once)
         #<Units::BaseUnit id: 418, identifier: "UNIT57", name: "Test Unit 49", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 220, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-13 04:19:31.741977000 +0000", updated_at: "2026-01-13 04:19:31.741977000 +0000"> does not implement: update_consumables
       # ./spec/models/rigs/base_rig_spec.rb:31:in 'block (3 levels) in <main>'

  408) Rigs::BaseRig polymorphic association can belong to an attachable BaseUnit
       Failure/Error: expect(base_unit.persisted_rigs).to include(rig)

       NoMethodError:
         undefined method 'persisted_rigs' for an instance of Units::BaseUnit
       # ./spec/models/rigs/base_rig_spec.rb:39:in 'block (3 levels) in <main>'

  409) Rigs::BaseRig#apply_output_effects and #revert_output_effects applies and reverts output effects if attachable responds to update_outputs
       Failure/Error: allow(base_unit).to receive(:update_outputs)
         #<Units::BaseUnit id: 424, identifier: "UNIT63", name: "Test Unit 55", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 226, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-13 04:19:31.988272000 +0000", updated_at: "2026-01-13 04:19:31.988272000 +0000"> does not implement: update_outputs
       # ./spec/models/rigs/base_rig_spec.rb:108:in 'block (3 levels) in <main>'

  410) Rigs::BaseRig#apply_damage_effects and #revert_damage_effects applies and reverts damage effects if attachable responds to update_damage_risks
       Failure/Error: allow(base_unit).to receive(:update_damage_risks)
         #<Units::BaseUnit id: 425, identifier: "UNIT64", name: "Test Unit 56", unit_type: "basic_unit", operational_data: {}, location_type: nil, location_id: nil, owner_type: "Organizations::BaseOrganization", owner_id: 227, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: "2026-01-13 04:19:32.029621000 +0000", updated_at: "2026-01-13 04:19:32.029621000 +0000"> does not implement: update_damage_risks
       # ./spec/models/rigs/base_rig_spec.rb:130:in 'block (3 levels) in <main>'

  411) RouteProposal calculates vote outcome based on threshold
       Failure/Error: votes_in_favor = votes.where(vote: 'approve').sum(:voting_power)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column route_proposal_votes.route_proposal_id does not exist
         LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
                                                                      ^
       # ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'
       # ./spec/models/route_proposal_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column route_proposal_votes.route_proposal_id does not exist
       #   LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
       #                                                                ^
       #   ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'

  412) RouteProposal fails if votes do not meet threshold
       Failure/Error: votes_in_favor = votes.where(vote: 'approve').sum(:voting_power)

       ActiveRecord::StatementInvalid:
         PG::UndefinedColumn: ERROR:  column route_proposal_votes.route_proposal_id does not exist
         LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
                                                                      ^
       # ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'
       # ./spec/models/route_proposal_spec.rb:19:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::UndefinedColumn:
       #   ERROR:  column route_proposal_votes.route_proposal_id does not exist
       #   LINE 1: ..."voting_power") FROM "route_proposal_votes" WHERE "route_pro...
       #                                                                ^
       #   ./app/models/route_proposal.rb:12:in 'RouteProposal#calculate_vote_outcome'

  413) RouteProposalVote is valid with valid attributes
       Failure/Error: let(:proposal) { create(:route_proposal) }

       KeyError:
         Factory not registered: "route_proposal"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/route_proposal_vote_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/route_proposal_vote_spec.rb:8:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "route_proposal"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  414) RouteProposalVote is invalid with an invalid vote value
       Failure/Error: let(:proposal) { create(:route_proposal) }

       KeyError:
         Factory not registered: "route_proposal"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/route_proposal_vote_spec.rb:4:in 'block (2 levels) in <main>'
       # ./spec/models/route_proposal_vote_spec.rb:13:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "route_proposal"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  415) Settlement::City validations is valid with valid attributes
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:21:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  416) Settlement::City validations is not valid without a location
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:25:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  417) Settlement::City validations is not valid without a name
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:30:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  418) Settlement::City validations is not valid with a negative current population
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:35:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  419) Settlement::City validations is not valid with food_per_person less than or equal to zero
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:40:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  420) Settlement::City validations is not valid with water_per_person less than or equal to zero
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:45:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  421) Settlement::City validations is not valid with energy_per_person less than or equal to zero
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:50:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  422) Settlement::City#resource_requirements calculates resource requirements correctly
       Failure/Error:
         build(:city, :independent, 
           location: location, 
           current_population: 100, 
           food_per_person: 2, 
           water_per_person: 1, 
           energy_per_person: 3
         ) 

       KeyError:
         Factory not registered: "city"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/city_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/city_spec.rb:57:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "city"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  423) Settlement::NPCColony can build a unit
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  424) Settlement::NPCColony can establish trade routes
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  425) Settlement::NPCColony can perform autonomous tasks
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  426) Settlement::NPCColony calculates total population across settlements
       Failure/Error: let(:npc_colony) { Settlement::NPCColony.create(name: "AI Colony", population_capacity: 100, funds: 1000) }

       ActiveModel::UnknownAttributeError:
         unknown attribute 'population_capacity' for Settlement::NPCColony.
       # ./spec/models/settlement/n_p_c_colony_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/n_p_c_colony_spec.rb:10:in 'block (2 levels) in <main>'

  427) Settlement::Outpost validations is valid with valid attributes
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  428) Settlement::Outpost validations is not valid without a name
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  429) Settlement::Outpost population capacity calculates total capacity from habitat units
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  430) Settlement::Outpost population capacity calculates available capacity correctly
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  431) Settlement::Outpost population capacity checks if it has capacity for additional population
       Failure/Error: let(:outpost) { create(:outpost, :independent, name: "Mars Outpost", current_population: 0) }

       KeyError:
         Factory not registered: "outpost"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/outpost_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/outpost_spec.rb:10:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "outpost"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  432) Settlement::Settlement validations is valid with valid attributes
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  433) Settlement::Settlement validations is not valid without a name
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  434) Settlement::Settlement population capacity calculates total capacity from habitat units
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  435) Settlement::Settlement population capacity calculates available capacity correctly
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  436) Settlement::Settlement population capacity checks if it has capacity for additional population
       Failure/Error: let(:settlement) { build(:settlement, :independent, name: "New Earth Base") }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/settlement/settlement_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/settlement/settlement_spec.rb:14:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  437) ShellPrintingJob scopes returns active jobs
       Failure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  438) ShellPrintingJob scopes returns completed jobs
       Failure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  439) ShellPrintingJob scopes returns in_progress jobs
       Failure/Error: let!(:pending_job) { create(:shell_printing_job, status: 'pending') }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:32:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  440) ShellPrintingJob#start! changes status to in_progress and sets started_at
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:51:in 'block (4 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:51:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  441) ShellPrintingJob#complete! changes status to completed and sets completed_at
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:57:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  442) ShellPrintingJob#progress_percentage calculates progress percentage
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:67:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  443) ShellPrintingJob#time_remaining_hours calculates remaining time
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:75:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  444) ShellPrintingJob#process_tick when job is not complete increases progress_hours
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:83:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  445) ShellPrintingJob#process_tick when job completes during tick completes the job
       Failure/Error: let(:printer_unit) { create(:unit, owner: settlement) }

       KeyError:
         Factory not registered: "unit"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/shell_printing_job_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/models/shell_printing_job_spec.rb:83:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "unit"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  446) SolarSystem associations has one spatial_location association
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  447) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  448) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  449) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  450) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  451) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  452) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  453) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  454) SolarSystem associations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  455) SolarSystem validations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  456) SolarSystem validations 
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  457) SolarSystem callbacks generates a unique name before create if name is not present
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  458) SolarSystem callbacks sets an initial star after create if no stars exist
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  459) SolarSystem#load_star loads or creates a star with the given parameters
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  460) SolarSystem#load_star updates an existing star if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  461) SolarSystem#load_terrestrial_planet loads or creates a terrestrial planet
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  462) SolarSystem#load_terrestrial_planet updates an existing terrestrial planet if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  463) SolarSystem#load_gas_giant loads or creates a gas giant
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  464) SolarSystem#load_gas_giant updates an existing gas giant if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  465) SolarSystem#load_ice_giant loads or creates an ice giant
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  466) SolarSystem#load_ice_giant updates an existing ice giant if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  467) SolarSystem#load_moon loads or creates a moon
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  468) SolarSystem#load_moon updates an existing moon if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  469) SolarSystem#load_dwarf_planet loads or creates a dwarf planet
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  470) SolarSystem#load_dwarf_planet updates an existing dwarf planet if the name matches
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  471) SolarSystem#habitable_zone? when a planet is in the habitable zone of at least one star returns true
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  472) SolarSystem#habitable_zone? when a planet is outside the habitable zone of all stars returns false
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  473) SolarSystem#habitable_zone? when there are no stars returns false
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  474) SolarSystem#habitable_zone? when the planet does not have an orbital period returns false
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  475) SolarSystem#total_mass calculates total mass of all planets and dwarf planets
       Failure/Error: let!(:jupiter) { create(:gas_giant, name: "Jupiter", solar_system: solar_system) }

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:256:in 'block (3 levels) in <main>'

  476) SolarSystem star relationships can have multiple stars
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  477) SolarSystem star relationships identifies the primary star by mass
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  478) SolarSystem star relationships supports binary star systems
       Failure/Error:
         create(:gas_giant, 
                solar_system: solar_system,
                mass: 1.898e27, 
                name: 'Jupiter', 
                size: 11.0,
                properties: {})

       ActiveRecord::RecordInvalid:
         Validation failed: Identifier can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/models/solar_system_spec.rb:14:in 'block (2 levels) in <main>'

  479) Storage::BaseStorage#add_item adds item successfully
       Failure/Error:
           def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}
             Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata
         
             return false unless can_store?(name, amount)
             owner ||= determine_default_owner
         
             if specialized_storage_required?(name)
               store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata
             elsif capacity_exceeded?(amount + total_stored)
               handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata

       ArgumentError:
         wrong number of arguments (given 1, expected 2..4)
       # ./app/models/inventory.rb:18:in 'add_item'
       # ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'
       # ./spec/models/storage/base_storage_spec.rb:10:in 'block (3 levels) in <main>'

  480) Storage::BaseStorage#remove_item removes item successfully
       Failure/Error:
           def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}
             Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata
         
             return false unless can_store?(name, amount)
             owner ||= determine_default_owner
         
             if specialized_storage_required?(name)
               store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata
             elsif capacity_exceeded?(amount + total_stored)
               handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata

       ArgumentError:
         wrong number of arguments (given 1, expected 2..4)
       # ./app/models/inventory.rb:18:in 'add_item'
       # ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'
       # ./spec/models/storage/base_storage_spec.rb:24:in 'block (3 levels) in <main>'

  481) Storage::BaseStorage#remove_item fails to remove item if not enough available
       Failure/Error:
           def add_item(name, amount, owner = nil, metadata = {}) # <--- ADDED metadata = {}
             Rails.logger.debug "Inventory#add_item: name=#{name}, amount=#{amount}, owner=#{owner}, metadata=#{metadata}" # <--- ADDED metadata
         
             return false unless can_store?(name, amount)
             owner ||= determine_default_owner
         
             if specialized_storage_required?(name)
               store_in_inventory(name, amount, owner, metadata) # <--- ADDED metadata
             elsif capacity_exceeded?(amount + total_stored)
               handle_surface_storage(name, amount, owner, metadata) # <--- ADDED metadata

       ArgumentError:
         wrong number of arguments (given 1, expected 2..4)
       # ./app/models/inventory.rb:18:in 'add_item'
       # ./app/models/storage/base_storage.rb:17:in 'Storage::BaseStorage#add_item'
       # ./spec/models/storage/base_storage_spec.rb:31:in 'block (3 levels) in <main>'

  482) Storage::GasStorage initializes with the correct type
       Failure/Error:
         def initialize(capacity, gas_type, pressure = 1.0) # Default pressure at 1.0 atm
           super(capacity, 'Gas')                        # Specify type as 'Gas'
           @gas_type = gas_type                          # Store the type of gas
           @pressure = pressure                          # Store the pressure

       ArgumentError:
         wrong number of arguments (given 1, expected 2..3)
       # ./app/models/storage/gas_storage.rb:6:in 'initialize'
       # ./spec/models/storage/gas_storage_spec.rb:5:in 'Class#new'
       # ./spec/models/storage/gas_storage_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/storage/gas_storage_spec.rb:8:in 'block (2 levels) in <main>'

  483) Storage::SolidStorage initializes with the correct type
       Failure/Error:
         def initialize(capacity, solid_type)
           super(capacity, 'Solid')                      # Specify type as 'Solid'
           @solid_type = solid_type                      # Store the type of solid
         end

       ArgumentError:
         wrong number of arguments (given 1, expected 2)
       # ./app/models/storage/solid_storage.rb:6:in 'initialize'
       # ./spec/models/storage/solid_storage_spec.rb:5:in 'Class#new'
       # ./spec/models/storage/solid_storage_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/models/storage/solid_storage_spec.rb:8:in 'block (2 levels) in <main>'

  484) CelestialBodies::TerrestrialPlanet runs TerraSim on planet creation
       Failure/Error: expect_any_instance_of(TerraSim).to receive(:calc_current)
         TerraSim does not implement #calc_current
       # ./spec/models/terrestrial_planets_spec.rb:34:in 'block (2 levels) in <main>'

  485) CelestialBodies::TerrestrialPlanet#update_biomes updates biomes specific to terrestrial planets
       Failure/Error: planet.temperature = -60 # Example temperature for Mars

       NoMethodError:
         undefined method 'temperature=' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet
       # ./spec/models/terrestrial_planets_spec.rb:10:in 'block (3 levels) in <main>'

  486) CelestialBodies::TerrestrialPlanet#add_gas adds gas and updates the mass
       Failure/Error: planet.add_gas('Oxygen', 1000)

       NoMethodError:
         undefined method 'add_gas' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet
       # ./spec/models/terrestrial_planets_spec.rb:20:in 'block (3 levels) in <main>'

  487) CelestialBodies::TerrestrialPlanet#calculate_surface_conditions calculates surface conditions specific to terrestrial planets
       Failure/Error: planet.calculate_surface_conditions

       NoMethodError:
         undefined method 'calculate_surface_conditions' for an instance of CelestialBodies::Planets::Rocky::TerrestrialPlanet
       # ./spec/models/terrestrial_planets_spec.rb:28:in 'block (3 levels) in <main>'

  488) UnitAssemblyJob#materials_gathered? returns false when not all materials are fulfilled
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:41:in 'block (3 levels) in <main>'

  489) UnitAssemblyJob#materials_gathered? returns true when all materials are fulfilled
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:41:in 'block (3 levels) in <main>'

  490) UnitAssemblyJob#materials_gathered? returns true when no material requests exist
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:41:in 'block (3 levels) in <main>'

  491) UnitAssemblyJob#start_assembly starts assembly when materials are gathered
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:86:in 'block (3 levels) in <main>'

  492) UnitAssemblyJob#start_assembly consumes materials from inventory
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:86:in 'block (3 levels) in <main>'

  493) UnitAssemblyJob#start_assembly returns false when not materials_pending status
       Failure/Error:
         job.material_requests.create!(
           material_name: 'Steel',
           quantity_requested: 100,
           status: 'fulfilled_by_player'
         )

       ArgumentError:
         'fulfilled_by_player' is not a valid status
       # ./spec/models/unit_assembly_job_spec.rb:86:in 'block (3 levels) in <main>'

  494) Units::BaseUnit storage operations #store_item stores items in both inventory and operational data
       Failure/Error: expect(storage_unit.store_item('steel_bar', 10)).to be true

         expected true
              got false
       # ./spec/models/units/base_unit_spec.rb:124:in 'block (4 levels) in <main>'

  495) Units::BaseUnit storage operations #store_item updates existing items
       Failure/Error: expect(storage_unit.store_item('steel_bar', 15)).to be true

         expected true
              got false
       # ./spec/models/units/base_unit_spec.rb:141:in 'block (4 levels) in <main>'

  496) Units::Battery interaction with BatteryManagement concern prefers specialized methods over concern methods
       Failure/Error: expect(battery).to receive(:charge_battery).with(20.0)

         (#<Units::Battery id: nil, identifier: "BATTERY_001", name: "Test Battery", unit_type: "satellite_battery", operational_data: {"battery" => {"capacity" => 500.0, "current_charge" => 420.0, "max_charge_rate_kw" => 50.0, "max_discharge_rate_kw" => 75.0, "efficiency" => 0.95}}, location_type: nil, location_id: nil, owner_type: nil, owner_id: nil, attachable_type: nil, attachable_id: nil, base_unit_id: nil, created_at: nil, updated_at: nil>).charge_battery(20.0)
             expected: 1 time with arguments: (20.0)
             received: 0 times
       # ./spec/models/units/battery_spec.rb:107:in 'block (3 levels) in <main>'

  497) Units::WasteTreatmentUnit#operate operates successfully and produces recycled and neutralized output
       Failure/Error:
         Units::WasteTreatmentUnit.new(
           name: 'Basic Waste Treatment Unit',
           material_list: { 'waste' => 30, 'recycled_output' => 15, 'neutralized_output' => 5 },
           energy_cost: 10
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'energy_cost' for Units::WasteTreatmentUnit.
       # ./spec/models/waste_treatment_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/waste_treatment_unit_spec.rb:20:in 'block (3 levels) in <main>'

  498) Units::WasteTreatmentUnit#operate returns false if insufficient waste is available
       Failure/Error:
         Units::WasteTreatmentUnit.new(
           name: 'Basic Waste Treatment Unit',
           material_list: { 'waste' => 30, 'recycled_output' => 15, 'neutralized_output' => 5 },
           energy_cost: 10
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'energy_cost' for Units::WasteTreatmentUnit.
       # ./spec/models/waste_treatment_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/waste_treatment_unit_spec.rb:29:in 'block (3 levels) in <main>'

  499) Units::WasteTreatmentUnit#operate returns false if insufficient power is available
       Failure/Error:
         Units::WasteTreatmentUnit.new(
           name: 'Basic Waste Treatment Unit',
           material_list: { 'waste' => 30, 'recycled_output' => 15, 'neutralized_output' => 5 },
           energy_cost: 10
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'energy_cost' for Units::WasteTreatmentUnit.
       # ./spec/models/waste_treatment_unit_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/models/waste_treatment_unit_spec.rb:34:in 'block (3 levels) in <main>'

  500) Wormhole associations is expected to have many endpoints class_name => SpatialLocation dependent => destroy
       Failure/Error: it { is_expected.to have_many(:endpoints).class_name('SpatialLocation').dependent(:destroy) }
         Expected Wormhole to have a has_many association called endpoints (endpoints should resolve to SpatialLocation for class_name)
       # ./spec/models/wormhole_spec.rb:44:in 'block (3 levels) in <main>'

  501) Wormhole#stabilization_satellites returns deployed stabilization satellites within range of either endpoint
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:116:in 'block (3 levels) in <main>'

  502) Wormhole#operational_stabilizers returns a unique list of operational direct stabilizers and stabilization satellites
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:137:in 'block (3 levels) in <main>'

  503) Wormhole#can_traverse? with sufficient mass limit returns true
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:249:in 'block (3 levels) in <main>'

  504) Wormhole#can_traverse? with insufficient mass limit returns false
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:249:in 'block (3 levels) in <main>'

  505) Wormhole#can_traverse? when one-way and already traversed returns false
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:249:in 'block (3 levels) in <main>'

  506) Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint A when not stabilized and mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  507) Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint B when not stabilized and mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  508) Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint A when mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  509) Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint B when mass limit is hit
       Failure/Error:
         SpatialLocation.create!(
           name: "Test Endpoint A",
           spatial_context: system_a,
           locationable: w,  # Use the polymorphic association
           x_coordinate: 0,
           y_coordinate: 0,
           z_coordinate: 0
         )

       NameError:
         uninitialized constant SpatialLocation
       # ./spec/models/wormhole_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/models/wormhole_spec.rb:314:in 'block (3 levels) in <main>'

  510) AIManager::DecisionTree#handle_mars_oxygen_maintenance calls prioritize_energy_for_o2_generation on resource_planner
       Failure/Error: production_units = unit_lookup.find_units_by_trait('production_output', gas_type)

       NoMethodError:
         undefined method 'find_units_by_trait' for an instance of Lookup::UnitLookupService
       # ./app/services/ai_manager/decision_tree.rb:212:in 'AIManager::DecisionTree#handle_atmospheric_maintenance'
       # ./app/services/ai_manager/decision_tree.rb:229:in 'AIManager::DecisionTree#handle_mars_oxygen_maintenance'
       # ./spec/services/ai_manager/decision_tree_spec.rb:84:in 'block (3 levels) in <main>'

  511) AIManager::DecisionTree#handle_mars_nitrogen_import finds closest resource source and creates interplanetary contract
       Failure/Error: production_units = unit_lookup.find_units_by_trait('production_output', gas_type)

       NoMethodError:
         undefined method 'find_units_by_trait' for an instance of Lookup::UnitLookupService
       # ./app/services/ai_manager/decision_tree.rb:212:in 'AIManager::DecisionTree#handle_atmospheric_maintenance'
       # ./app/services/ai_manager/decision_tree.rb:233:in 'AIManager::DecisionTree#handle_mars_nitrogen_import'
       # ./spec/services/ai_manager/decision_tree_spec.rb:101:in 'block (3 levels) in <main>'

  512) AIManager::OperationalManager#make_decision when stable and expansion is feasible considers expansion
       Failure/Error:
         allow(operational_manager).to receive(:consider_expansion).and_return({
           action: :expansion, pattern: :venus_pattern, reason: :pattern_match
         })

         #<AIManager::OperationalManager:0x00007f3e56b455f0 @settlement=#<Double "Settlement">, @patterns={callisto_settlement_patterns: {callisto_foothold_settlement: {description: "Callisto foothold - radiation protection, surface mining operations, subsurface resource access", target_world: "callisto", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 390, phases: [{id: "radiation_survey", name: "Radiation Environment Assessment & Site Selection", duration: 120, crew_required: 4, equipment_focus: "radiation_monitoring"}, {id: "surface_mining", name: "Surface Regolith Mining & Processing", duration: 120, crew_required: 6, equipment_focus: "mining_operations"}, {id: "subsurface_exploration", name: "Deep Subsurface Resource Assessment", duration: 90, crew_required: 8, equipment_focus: "deep_drilling"}, {id: "protected_habitation", name: "Radiation-Shielded Habitat & Operations Center", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "mining_rig (2)", "deep_drill (2)", "radiation_shield_generator (2)"], units: ["shielded_habitat (2)", "regolith_processor (2)", "drilling_platform (1)", "radiation_monitor (3)"]}, inventory: {deployable_units: ["mining_drill (2)", "radiation_sensor (4)", "surface_rover (2)", "orbital_radiation_mapper (1)"], supplies: ["enriched_uranium_fuel (3500 kilogram)", "shielding_materials (1200 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["surface_regolith", "subsurface_ice", "silicate_materials", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "heavy_shielding", "mining_equipment"], construction_materials: ["radiation_shielding", "reinforced_structures", "cryogenic_storage"], estimated_import_timeline: 390}, isru_capabilities: {oxygen_production_rate: 20, hydrogen_production_rate: 15, water_production_rate: 30, power_generation: 400}}, economic_model: {estimated_cost: 4800000, import_ratio: 0.55, revenue_streams: ["rare_materials", "radiation_research", "mining_exports"], break_even_timeline: 780}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 22, expansion_triggers: ["radiation_shielding_verified", "mining_operations_stable"], population_sources: ["earth_mining_engineers", "ganymede_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 8000, challenges: ["extreme_radiation", "surface_instability", "resource_scarcity", "thermal_extremes"]}}}, ceres_settlement_patterns: {ceres_foothold_settlement: {description: "Ceres foothold - water ice mining, nickel-iron ore extraction, asteroid belt coordination hub", target_world: "ceres", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 200, phases: [{id: "resource_survey", name: "Asteroid Resource Survey & Mining Site Selection", duration: 40, crew_required: 4, equipment_focus: "geological_survey"}, {id: "water_ice_extraction", name: "Water Ice Mining & Cryogenic Storage", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ore_processing", name: "Nickel-Iron Ore Extraction & Processing", duration: 50, crew_required: 5, equipment_focus: "ore_processing"}, {id: "belt_coordination", name: "Asteroid Belt Operations Center & Trade Hub", duration: 50, crew_required: 8, equipment_focus: "coordination_hub"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "water_extractor (4)", "ore_processor (3)", "cryogenic_storage (2)"], units: ["modular_habitat_unit (2)", "ice_drilling_rig (2)", "ore_mining_rig (2)", "belt_communications_array (1)"]}, inventory: {deployable_units: ["geological_scanner (3)", "mining_drone (4)", "orbital_scanner_satellite (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "hydrogen_stores (300 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, economic_model: {estimated_gcc_cost: 850000, local_production_ratio: 0.75, revenue_streams: [{resource: "water_ice", volume: "high", market_value: "medium", trade_partners: ["mars_development_corporation", "vesta_development_corporation"]}, {resource: "nickel_iron_ore", volume: "high", market_value: "high", trade_partners: ["mars_development_corporation", "earth_development_corporation"]}], operational_costs: {power: "nuclear", maintenance: "medium", crew_rotation: "quarterly"}}, environmental_considerations: {gravity: "microgravity", atmosphere: "none", temperature: "cryogenic", radiation: "high", dust: "significant", challenges: ["microgravity_operations", "thermal_management", "dust_contamination"], advantages: ["abundant_water_ice", "rich_mineral_deposits", "strategic_belt_position"]}, expansion_potential: {follow_on_settlements: ["ceres_main_base", "belt_mining_outposts"], regional_influence: "asteroid_belt_coordination", strategic_value: "resource_extraction_hub"}}}, europa_settlement_patterns: {europa_foothold_settlement: {description: "Europa foothold - subsurface ocean access, ice drilling operations, astrobiology research", target_world: "europa", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 360, phases: [{id: "surface_analysis", name: "Surface Geology Analysis & Landing Site Selection", duration: 90, crew_required: 4, equipment_focus: "geological_survey"}, {id: "ice_penetration", name: "Ice Sheet Drilling & Subsurface Access", duration: 120, crew_required: 6, equipment_focus: "ice_drilling"}, {id: "ocean_sampling", name: "Subsurface Ocean Exploration & Sampling", duration: 90, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "research_station", name: "Permanent Research Station & Long-Term Monitoring", duration: 60, crew_required: 12, equipment_focus: "research_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "ice_drilling_rig (2)", "ocean_probe (3)", "radiation_shielded_habitat (2)"], units: ["cryogenic_habitat (2)", "drilling_platform (1)", "ocean_sampler (2)", "seismic_monitor (1)"]}, inventory: {deployable_units: ["ice_penetrator (2)", "ocean_rover (1)", "seismic_sensor (3)", "radiation_monitor (2)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "thermal_drilling_bits (50)"], consumables: ["oxygen (5000 kilogram)", "water (20000 kilogram)", "food (5000 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "geological_heat", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "thermal_drilling_equipment", "radiation_shielding"], construction_materials: ["radiation_shielding", "cryogenic_materials", "pressure_vessels"], estimated_import_timeline: 360}, isru_capabilities: {oxygen_production_rate: 25, hydrogen_production_rate: 20, water_production_rate: 40, power_generation: 350}}, economic_model: {estimated_cost: 5500000, import_ratio: 0.65, revenue_streams: ["scientific_discoveries", "ocean_data", "water_exports"], break_even_timeline: 720}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["ocean_access_established", "radiation_protection_verified"], population_sources: ["earth_astrobiologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 10000, challenges: ["extreme_radiation", "cryogenic_surface", "ocean_pressure", "ice_instability"]}}}, ganymede_settlement_patterns: {ganymede_foothold_settlement: {description: "Ganymede foothold - magnetic field protection, subsurface ocean exploration, ice resource utilization", target_world: "ganymede", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 330, phases: [{id: "magnetic_analysis", name: "Magnetic Field Analysis & Radiation Assessment", duration: 75, crew_required: 4, equipment_focus: "magnetic_survey"}, {id: "ice_resource_development", name: "Surface Ice Mining & Resource Processing", duration: 90, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ocean_penetration", name: "Subsurface Ocean Access & Exploration", duration: 105, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "permanent_base", name: "Magnetic-Shielded Base & Scientific Operations", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "ice_mining_rig (2)", "ocean_drilling_system (2)", "magnetic_shield_generator (1)"], units: ["radiation_shielded_habitat (2)", "ice_processor (2)", "ocean_probe (2)", "magnetic_monitor (1)"]}, inventory: {deployable_units: ["ice_drill (2)", "ocean_sampler (2)", "magnetic_sensor (3)", "radiation_detector (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "shielding_materials (800 kilogram)"], consumables: ["oxygen (4500 kilogram)", "water (18000 kilogram)", "food (4500 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "magnetic_field", "silicate_materials"], import_requirements: {critical_imports: ["hydrogen", "magnetic_shielding", "deep_drilling_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels", "cryogenic_materials"], estimated_import_timeline: 330}, isru_capabilities: {oxygen_production_rate: 30, hydrogen_production_rate: 25, water_production_rate: 35, power_generation: 300}}, economic_model: {estimated_cost: 5000000, import_ratio: 0.6, revenue_streams: ["magnetic_research", "ocean_discoveries", "ice_resources"], break_even_timeline: 660}, population_model: {initial_population: 12, growth_rate: "moderate", support_capacity: 25, expansion_triggers: ["magnetic_shielding_verified", "ocean_access_established"], population_sources: ["earth_magnetic_specialists", "europa_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4000, challenges: ["radiation_environment", "cryogenic_conditions", "ocean_depth", "magnetic_interference"]}}}, io_settlement_patterns: {io_foothold_settlement: {description: "Io foothold - geothermal energy utilization, sulfur processing, volcanic activity monitoring", target_world: "io", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 420, phases: [{id: "volcanic_assessment", name: "Volcanic Activity Analysis & Safe Zone Identification", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "geothermal_harvesting", name: "Geothermal Energy Extraction & Power Generation", duration: 120, crew_required: 6, equipment_focus: "energy_systems"}, {id: "sulfur_processing", name: "Sulfur Compound Mining & Processing", duration: 90, crew_required: 8, equipment_focus: "chemical_processing"}, {id: "thermal_habitation", name: "Heat-Shielded Habitat & Research Operations", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["geothermal_power_plant (3)", "heat_shield_generator (2)", "sulfur_processor (2)", "volcanic_monitor (3)"], units: ["thermal_habitat (2)", "geothermal_drill (2)", "chemical_reactor (2)", "seismic_sensor (2)"]}, inventory: {deployable_units: ["volcanic_probe (3)", "heat_shield (4)", "sulfur_extractor (2)", "thermal_rover (1)"], supplies: ["thermal_insulation (1500 kilogram)", "corrosion_resistant_materials (800 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (14000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["geothermal_energy", "sulfur_compounds", "volcanic_gases", "surface_materials"], import_requirements: {critical_imports: ["hydrogen", "extreme_heat_shielding", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "heat_resistant_alloys", "radiation_shielding"], estimated_import_timeline: 420}, isru_capabilities: {oxygen_production_rate: 15, sulfur_production_rate: 40, hydrogen_production_rate: 10, power_generation: 500}}, economic_model: {estimated_cost: 6500000, import_ratio: 0.75, revenue_streams: ["geothermal_energy", "sulfur_exports", "volcanic_research"], break_even_timeline: 840}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 18, expansion_triggers: ["thermal_protection_verified", "geothermal_stability_confirmed"], population_sources: ["earth_volcanologists", "venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 6000, challenges: ["extreme_temperatures", "volcanic_activity", "radiation", "corrosive_environment"]}}}, luna_settlement_patterns: {luna_foothold_settlement: {description: "Minimal lunar foothold - survey, ISRU oxygen/water, basic habitat", target_world: "luna", priority: "foothold", phase_structure: {total_phases: 3, estimated_total_duration: 180, phases: [{id: "survey_deployment", name: "Orbital Survey & Landing Site Selection", duration: 30, crew_required: 2, equipment_focus: "remote_sensing"}, {id: "isru_establishment", name: "ISRU Oxygen & Water Production Setup", duration: 60, crew_required: 4, equipment_focus: "resource_extraction"}, {id: "minimal_habitation", name: "Basic Crew Habitat & Life Support", duration: 90, crew_required: 6, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "oxygen_generator (3)", "water_extractor (2)"], units: ["modular_habitat_unit (2)", "regolith_processor (1)", "helium3_mining_rig (1)"]}, inventory: {deployable_units: ["orbital_survey_satellite (1)", "surface_rover (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, resource_dependencies: {local_resources_required: ["regolith", "water_ice", "helium3"], import_requirements: {critical_imports: ["oxygen", "water", "food"], construction_materials: ["structural_materials"], estimated_import_timeline: 180}, isru_capabilities: {oxygen_production_rate: 25, water_production_rate: 15, power_generation: 200}}, economic_model: {estimated_cost: 2500000, import_ratio: 0.4, revenue_streams: ["helium3_sales", "research_data"], break_even_timeline: 360}, population_model: {initial_population: 6, growth_rate: "slow", support_capacity: 12, expansion_triggers: ["isru_self_sufficiency", "helium3_exports"], population_sources: ["earth_transfers", "trained_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 720}}}, mars_settlement_patterns: {mars_foothold_settlement: {description: "Mars foothold - atmospheric CO2 utilization, regolith processing, subsurface water access", target_world: "mars", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 240, phases: [{id: "atmospheric_analysis", name: "Atmospheric Composition Analysis & Site Selection", duration: 45, crew_required: 3, equipment_focus: "atmospheric_science"}, {id: "co2_isru_setup", name: "CO2 Sabatier Process & Oxygen Production", duration: 75, crew_required: 5, equipment_focus: "chemical_processing"}, {id: "water_ice_mining", name: "Subsurface Water Ice Mining & Purification", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "surface_habitation", name: "Pressurized Habitat & Radiation Protection", duration: 60, crew_required: 8, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "sabatier_reactor (2)", "atmospheric_processor (2)", "water_extractor (3)"], units: ["modular_habitat_unit (3)", "radiation_shielded_habitat (1)", "ice_drilling_rig (1)", "regolith_processor (2)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "surface_rover (2)", "orbital_weather_satellite (1)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "hydrogen_stores (500 kilogram)"], consumables: ["oxygen (3000 kilogram)", "water (12000 kilogram)", "food (3000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "water_ice", "regolith", "solar_energy"], import_requirements: {critical_imports: ["hydrogen", "specialized_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels"], estimated_import_timeline: 240}, isru_capabilities: {oxygen_production_rate: 40, water_production_rate: 25, methane_production_rate: 15, power_generation: 300}}, economic_model: {estimated_cost: 4000000, import_ratio: 0.5, revenue_streams: ["methane_fuel_sales", "scientific_data", "water_exports"], break_even_timeline: 480}, population_model: {initial_population: 8, growth_rate: "moderate", support_capacity: 20, expansion_triggers: ["atmospheric_self_sufficiency", "water_independence"], population_sources: ["earth_transfers", "luna_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 2400, challenges: ["thin_atmosphere", "radiation", "dust_storms"]}}}, titan_settlement_patterns: {titan_foothold_settlement: {description: "Titan foothold - hydrocarbon lake utilization, cryogenic processing, methane atmosphere operations", target_world: "titan", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 270, phases: [{id: "atmospheric_descent", name: "Atmospheric Descent & Surface Site Selection", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "hydrocarbon_processing", name: "Methane/Ethane Extraction & Processing", duration: 90, crew_required: 6, equipment_focus: "cryogenic_processing"}, {id: "lake_exploration", name: "Hydrocarbon Lake Survey & Resource Assessment", duration: 75, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_habitation", name: "Cryogenic Habitat & Long-Term Operations", duration: 45, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "methane_processor (3)", "cryogenic_extractor (2)", "atmospheric_heater (2)"], units: ["cryogenic_habitat (2)", "lake_sampling_rig (1)", "methane_refinery (2)", "surface_rover (3)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "cryogenic_drill (1)", "methane_sensor (3)", "orbital_imager (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "thermal_insulation (500 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (10000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["methane_atmosphere", "ethane_lakes", "nitrogen_atmosphere", "cryogenic_ice"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 270}, isru_capabilities: {methane_production_rate: 35, oxygen_production_rate: 20, hydrogen_production_rate: 15, power_generation: 250}}, economic_model: {estimated_cost: 4500000, import_ratio: 0.6, revenue_streams: ["hydrocarbon_exports", "cryogenic_research", "methane_fuel"], break_even_timeline: 540}, population_model: {initial_population: 10, growth_rate: "moderate", support_capacity: 30, expansion_triggers: ["hydrocarbon_self_sufficiency", "cryogenic_habitation_stability"], population_sources: ["earth_scientists", "mars_venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 3000, challenges: ["cryogenic_temperatures", "toxic_atmosphere", "low_gravity", "dust_storms"]}}}, triton_settlement_patterns: {triton_foothold_settlement: {description: "Triton foothold - cryovolcanic activity, nitrogen atmosphere utilization, geyser monitoring", target_world: "triton", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 450, phases: [{id: "cryovolcanic_survey", name: "Cryovolcanic Activity Analysis & Landing Assessment", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "nitrogen_processing", name: "Atmospheric Nitrogen Capture & Processing", duration: 120, crew_required: 6, equipment_focus: "atmospheric_processing"}, {id: "surface_exploration", name: "Geyser Field Survey & Resource Mapping", duration: 120, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_operations", name: "Cryogenic Habitat & Long-Term Research", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "nitrogen_processor (2)", "cryogenic_extractor (2)", "geyser_monitor (2)"], units: ["cryogenic_habitat (2)", "atmospheric_collector (2)", "surface_rover (2)", "thermal_sensor (3)"]}, inventory: {deployable_units: ["cryovolcanic_probe (2)", "nitrogen_harvester (2)", "geyser_sampler (1)", "orbital_mapper (1)"], supplies: ["thermal_insulation (1000 kilogram)", "cryogenic_fluids (500 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["nitrogen_atmosphere", "water_ice", "cryovolcanic_materials", "geyser_vapors"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "cryogenic_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 450}, isru_capabilities: {oxygen_production_rate: 20, nitrogen_production_rate: 35, hydrogen_production_rate: 15, power_generation: 280}}, economic_model: {estimated_cost: 5200000, import_ratio: 0.65, revenue_streams: ["cryovolcanic_research", "nitrogen_exports", "geyser_data"], break_even_timeline: 900}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["cryogenic_systems_stable", "nitrogen_self_sufficiency"], population_sources: ["earth_cryovolcanologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4500, challenges: ["extreme_cold", "thin_atmosphere", "cryovolcanic_activity", "orbital_instability"]}}}, venus_settlement_patterns: {venus_foothold_settlement: {description: "Venus foothold - high-altitude floating habitats, CO2 processing, extreme temperature operations", target_world: "venus", priority: "foothold", phase_structure: {total_phases: 5, estimated_total_duration: 300, phases: [{id: "atmospheric_entry", name: "Atmospheric Entry & High-Altitude Station Establishment", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "floating_platform_deployment", name: "Aerostat Platform Deployment & Stabilization", duration: 90, crew_required: 6, equipment_focus: "aerostat_technology"}, {id: "co2_utilization", name: "CO2 Separation & Resource Extraction", duration: 75, crew_required: 8, equipment_focus: "chemical_separation"}, {id: "energy_harvesting", name: "Solar Energy Collection & Power Distribution", duration: 45, crew_required: 7, equipment_focus: "energy_systems"}, {id: "expanded_operations", name: "Multi-Platform Network & Research Operations", duration: 30, crew_required: 10, equipment_focus: "network_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "co2_separator (3)", "aerostat_platform (4)", "atmospheric_processor (2)"], units: ["floating_habitat (2)", "energy_collection_array (3)", "chemical_reactor (2)", "communication_relay (1)"]}, inventory: {deployable_units: ["atmospheric_probe (3)", "aerostat_balloon (4)", "solar_collector (6)", "weather_satellite (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "specialized_alloys (1000 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (15000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "sulfuric_acid_vapors", "solar_energy", "atmospheric_pressure"], import_requirements: {critical_imports: ["hydrogen", "heat_shielding", "corrosion_resistant_materials"], construction_materials: ["titanium_alloys", "ceramic_composites", "radiation_shielding"], estimated_import_timeline: 300}, isru_capabilities: {oxygen_production_rate: 30, sulfur_production_rate: 20, carbon_production_rate: 25, power_generation: 400}}, economic_model: {estimated_cost: 6000000, import_ratio: 0.7, revenue_streams: ["rare_materials", "atmospheric_data", "energy_exports"], break_even_timeline: 600}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 25, expansion_triggers: ["atmospheric_self_sufficiency", "platform_network_stability"], population_sources: ["earth_specialists", "mars_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 5000, challenges: ["extreme_temperatures", "corrosive_atmosphere", "high_pressure", "acid_clouds"]}}}}, @priorities=#<AIManager::AiPrioritySystem:0x00007f3e5a7d2b30 @last_check=Tue, 13 Jan 2026 04:21:24.664032406 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f3e5a7d1f78 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f3e567843d0 @settlement_id=1, @decision_history=[{timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:26:59 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:26:59 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:27:00 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:27:00 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:34:25 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:34:25 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:34:25 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:34:25 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:53:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:53:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:53:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:53:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:12:18 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:12:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:12:18 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:12:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:52:13 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:52:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:52:13 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:52:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:10:40 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:10:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:10:40 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:10:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:31:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:31:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:31:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:31:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:37:15 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:37:15 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:37:15 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:37:15 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:55:40 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:55:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:55:40 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:55:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 02:03:34 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 02:03:34 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 02:03:34 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 02:03:34 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 03:11:09 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 03:11:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 03:11:09 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 03:11:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 04:51:21 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 04:51:21 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 04:51:21 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 04:51:21 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 05:22:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 05:22:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 05:22:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 05:22:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:34:49 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:34:49 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:34:49 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:34:49 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:58:09 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:58:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:58:09 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:58:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:18:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:18:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:18:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:18:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:49:50 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:49:50 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:49:50 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:49:50 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:03:54 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:03:54 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:03:54 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:03:54 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:31:10 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:31:10 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:31:10 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:31:10 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 16:47:29 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 16:47:29 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 16:47:29 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 16:47:29 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 17:08:42 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 17:08:42 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 17:08:42 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 17:08:42 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 00:39:03 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 00:39:03 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 00:39:03 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 00:39:03 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 01:36:18 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 01:36:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 01:36:18 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 01:36:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:29:33 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:29:33 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:29:33 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:29:33 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:50:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:50:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:50:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:50:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 04:21:24 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 04:21:24 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 04:21:24 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 04:21:24 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion
       # ./spec/services/ai_manager/operational_manager_spec.rb:54:in 'block (4 levels) in <main>'

  513) AIManager::OperationalManager#make_decision when stable with no expansion opportunities maintains current operations
       Failure/Error:
         allow(operational_manager).to receive(:consider_expansion).and_return({
           action: :maintain, reason: :no_suitable_expansion
         })

         #<AIManager::OperationalManager:0x00007f3e563e6778 @settlement=#<Double "Settlement">, @patterns={callisto_settlement_patterns: {callisto_foothold_settlement: {description: "Callisto foothold - radiation protection, surface mining operations, subsurface resource access", target_world: "callisto", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 390, phases: [{id: "radiation_survey", name: "Radiation Environment Assessment & Site Selection", duration: 120, crew_required: 4, equipment_focus: "radiation_monitoring"}, {id: "surface_mining", name: "Surface Regolith Mining & Processing", duration: 120, crew_required: 6, equipment_focus: "mining_operations"}, {id: "subsurface_exploration", name: "Deep Subsurface Resource Assessment", duration: 90, crew_required: 8, equipment_focus: "deep_drilling"}, {id: "protected_habitation", name: "Radiation-Shielded Habitat & Operations Center", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "mining_rig (2)", "deep_drill (2)", "radiation_shield_generator (2)"], units: ["shielded_habitat (2)", "regolith_processor (2)", "drilling_platform (1)", "radiation_monitor (3)"]}, inventory: {deployable_units: ["mining_drill (2)", "radiation_sensor (4)", "surface_rover (2)", "orbital_radiation_mapper (1)"], supplies: ["enriched_uranium_fuel (3500 kilogram)", "shielding_materials (1200 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["surface_regolith", "subsurface_ice", "silicate_materials", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "heavy_shielding", "mining_equipment"], construction_materials: ["radiation_shielding", "reinforced_structures", "cryogenic_storage"], estimated_import_timeline: 390}, isru_capabilities: {oxygen_production_rate: 20, hydrogen_production_rate: 15, water_production_rate: 30, power_generation: 400}}, economic_model: {estimated_cost: 4800000, import_ratio: 0.55, revenue_streams: ["rare_materials", "radiation_research", "mining_exports"], break_even_timeline: 780}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 22, expansion_triggers: ["radiation_shielding_verified", "mining_operations_stable"], population_sources: ["earth_mining_engineers", "ganymede_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 8000, challenges: ["extreme_radiation", "surface_instability", "resource_scarcity", "thermal_extremes"]}}}, ceres_settlement_patterns: {ceres_foothold_settlement: {description: "Ceres foothold - water ice mining, nickel-iron ore extraction, asteroid belt coordination hub", target_world: "ceres", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 200, phases: [{id: "resource_survey", name: "Asteroid Resource Survey & Mining Site Selection", duration: 40, crew_required: 4, equipment_focus: "geological_survey"}, {id: "water_ice_extraction", name: "Water Ice Mining & Cryogenic Storage", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ore_processing", name: "Nickel-Iron Ore Extraction & Processing", duration: 50, crew_required: 5, equipment_focus: "ore_processing"}, {id: "belt_coordination", name: "Asteroid Belt Operations Center & Trade Hub", duration: 50, crew_required: 8, equipment_focus: "coordination_hub"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "water_extractor (4)", "ore_processor (3)", "cryogenic_storage (2)"], units: ["modular_habitat_unit (2)", "ice_drilling_rig (2)", "ore_mining_rig (2)", "belt_communications_array (1)"]}, inventory: {deployable_units: ["geological_scanner (3)", "mining_drone (4)", "orbital_scanner_satellite (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "hydrogen_stores (300 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, economic_model: {estimated_gcc_cost: 850000, local_production_ratio: 0.75, revenue_streams: [{resource: "water_ice", volume: "high", market_value: "medium", trade_partners: ["mars_development_corporation", "vesta_development_corporation"]}, {resource: "nickel_iron_ore", volume: "high", market_value: "high", trade_partners: ["mars_development_corporation", "earth_development_corporation"]}], operational_costs: {power: "nuclear", maintenance: "medium", crew_rotation: "quarterly"}}, environmental_considerations: {gravity: "microgravity", atmosphere: "none", temperature: "cryogenic", radiation: "high", dust: "significant", challenges: ["microgravity_operations", "thermal_management", "dust_contamination"], advantages: ["abundant_water_ice", "rich_mineral_deposits", "strategic_belt_position"]}, expansion_potential: {follow_on_settlements: ["ceres_main_base", "belt_mining_outposts"], regional_influence: "asteroid_belt_coordination", strategic_value: "resource_extraction_hub"}}}, europa_settlement_patterns: {europa_foothold_settlement: {description: "Europa foothold - subsurface ocean access, ice drilling operations, astrobiology research", target_world: "europa", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 360, phases: [{id: "surface_analysis", name: "Surface Geology Analysis & Landing Site Selection", duration: 90, crew_required: 4, equipment_focus: "geological_survey"}, {id: "ice_penetration", name: "Ice Sheet Drilling & Subsurface Access", duration: 120, crew_required: 6, equipment_focus: "ice_drilling"}, {id: "ocean_sampling", name: "Subsurface Ocean Exploration & Sampling", duration: 90, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "research_station", name: "Permanent Research Station & Long-Term Monitoring", duration: 60, crew_required: 12, equipment_focus: "research_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "ice_drilling_rig (2)", "ocean_probe (3)", "radiation_shielded_habitat (2)"], units: ["cryogenic_habitat (2)", "drilling_platform (1)", "ocean_sampler (2)", "seismic_monitor (1)"]}, inventory: {deployable_units: ["ice_penetrator (2)", "ocean_rover (1)", "seismic_sensor (3)", "radiation_monitor (2)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "thermal_drilling_bits (50)"], consumables: ["oxygen (5000 kilogram)", "water (20000 kilogram)", "food (5000 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "geological_heat", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "thermal_drilling_equipment", "radiation_shielding"], construction_materials: ["radiation_shielding", "cryogenic_materials", "pressure_vessels"], estimated_import_timeline: 360}, isru_capabilities: {oxygen_production_rate: 25, hydrogen_production_rate: 20, water_production_rate: 40, power_generation: 350}}, economic_model: {estimated_cost: 5500000, import_ratio: 0.65, revenue_streams: ["scientific_discoveries", "ocean_data", "water_exports"], break_even_timeline: 720}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["ocean_access_established", "radiation_protection_verified"], population_sources: ["earth_astrobiologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 10000, challenges: ["extreme_radiation", "cryogenic_surface", "ocean_pressure", "ice_instability"]}}}, ganymede_settlement_patterns: {ganymede_foothold_settlement: {description: "Ganymede foothold - magnetic field protection, subsurface ocean exploration, ice resource utilization", target_world: "ganymede", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 330, phases: [{id: "magnetic_analysis", name: "Magnetic Field Analysis & Radiation Assessment", duration: 75, crew_required: 4, equipment_focus: "magnetic_survey"}, {id: "ice_resource_development", name: "Surface Ice Mining & Resource Processing", duration: 90, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ocean_penetration", name: "Subsurface Ocean Access & Exploration", duration: 105, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "permanent_base", name: "Magnetic-Shielded Base & Scientific Operations", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "ice_mining_rig (2)", "ocean_drilling_system (2)", "magnetic_shield_generator (1)"], units: ["radiation_shielded_habitat (2)", "ice_processor (2)", "ocean_probe (2)", "magnetic_monitor (1)"]}, inventory: {deployable_units: ["ice_drill (2)", "ocean_sampler (2)", "magnetic_sensor (3)", "radiation_detector (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "shielding_materials (800 kilogram)"], consumables: ["oxygen (4500 kilogram)", "water (18000 kilogram)", "food (4500 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "magnetic_field", "silicate_materials"], import_requirements: {critical_imports: ["hydrogen", "magnetic_shielding", "deep_drilling_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels", "cryogenic_materials"], estimated_import_timeline: 330}, isru_capabilities: {oxygen_production_rate: 30, hydrogen_production_rate: 25, water_production_rate: 35, power_generation: 300}}, economic_model: {estimated_cost: 5000000, import_ratio: 0.6, revenue_streams: ["magnetic_research", "ocean_discoveries", "ice_resources"], break_even_timeline: 660}, population_model: {initial_population: 12, growth_rate: "moderate", support_capacity: 25, expansion_triggers: ["magnetic_shielding_verified", "ocean_access_established"], population_sources: ["earth_magnetic_specialists", "europa_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4000, challenges: ["radiation_environment", "cryogenic_conditions", "ocean_depth", "magnetic_interference"]}}}, io_settlement_patterns: {io_foothold_settlement: {description: "Io foothold - geothermal energy utilization, sulfur processing, volcanic activity monitoring", target_world: "io", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 420, phases: [{id: "volcanic_assessment", name: "Volcanic Activity Analysis & Safe Zone Identification", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "geothermal_harvesting", name: "Geothermal Energy Extraction & Power Generation", duration: 120, crew_required: 6, equipment_focus: "energy_systems"}, {id: "sulfur_processing", name: "Sulfur Compound Mining & Processing", duration: 90, crew_required: 8, equipment_focus: "chemical_processing"}, {id: "thermal_habitation", name: "Heat-Shielded Habitat & Research Operations", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["geothermal_power_plant (3)", "heat_shield_generator (2)", "sulfur_processor (2)", "volcanic_monitor (3)"], units: ["thermal_habitat (2)", "geothermal_drill (2)", "chemical_reactor (2)", "seismic_sensor (2)"]}, inventory: {deployable_units: ["volcanic_probe (3)", "heat_shield (4)", "sulfur_extractor (2)", "thermal_rover (1)"], supplies: ["thermal_insulation (1500 kilogram)", "corrosion_resistant_materials (800 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (14000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["geothermal_energy", "sulfur_compounds", "volcanic_gases", "surface_materials"], import_requirements: {critical_imports: ["hydrogen", "extreme_heat_shielding", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "heat_resistant_alloys", "radiation_shielding"], estimated_import_timeline: 420}, isru_capabilities: {oxygen_production_rate: 15, sulfur_production_rate: 40, hydrogen_production_rate: 10, power_generation: 500}}, economic_model: {estimated_cost: 6500000, import_ratio: 0.75, revenue_streams: ["geothermal_energy", "sulfur_exports", "volcanic_research"], break_even_timeline: 840}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 18, expansion_triggers: ["thermal_protection_verified", "geothermal_stability_confirmed"], population_sources: ["earth_volcanologists", "venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 6000, challenges: ["extreme_temperatures", "volcanic_activity", "radiation", "corrosive_environment"]}}}, luna_settlement_patterns: {luna_foothold_settlement: {description: "Minimal lunar foothold - survey, ISRU oxygen/water, basic habitat", target_world: "luna", priority: "foothold", phase_structure: {total_phases: 3, estimated_total_duration: 180, phases: [{id: "survey_deployment", name: "Orbital Survey & Landing Site Selection", duration: 30, crew_required: 2, equipment_focus: "remote_sensing"}, {id: "isru_establishment", name: "ISRU Oxygen & Water Production Setup", duration: 60, crew_required: 4, equipment_focus: "resource_extraction"}, {id: "minimal_habitation", name: "Basic Crew Habitat & Life Support", duration: 90, crew_required: 6, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "oxygen_generator (3)", "water_extractor (2)"], units: ["modular_habitat_unit (2)", "regolith_processor (1)", "helium3_mining_rig (1)"]}, inventory: {deployable_units: ["orbital_survey_satellite (1)", "surface_rover (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, resource_dependencies: {local_resources_required: ["regolith", "water_ice", "helium3"], import_requirements: {critical_imports: ["oxygen", "water", "food"], construction_materials: ["structural_materials"], estimated_import_timeline: 180}, isru_capabilities: {oxygen_production_rate: 25, water_production_rate: 15, power_generation: 200}}, economic_model: {estimated_cost: 2500000, import_ratio: 0.4, revenue_streams: ["helium3_sales", "research_data"], break_even_timeline: 360}, population_model: {initial_population: 6, growth_rate: "slow", support_capacity: 12, expansion_triggers: ["isru_self_sufficiency", "helium3_exports"], population_sources: ["earth_transfers", "trained_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 720}}}, mars_settlement_patterns: {mars_foothold_settlement: {description: "Mars foothold - atmospheric CO2 utilization, regolith processing, subsurface water access", target_world: "mars", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 240, phases: [{id: "atmospheric_analysis", name: "Atmospheric Composition Analysis & Site Selection", duration: 45, crew_required: 3, equipment_focus: "atmospheric_science"}, {id: "co2_isru_setup", name: "CO2 Sabatier Process & Oxygen Production", duration: 75, crew_required: 5, equipment_focus: "chemical_processing"}, {id: "water_ice_mining", name: "Subsurface Water Ice Mining & Purification", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "surface_habitation", name: "Pressurized Habitat & Radiation Protection", duration: 60, crew_required: 8, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "sabatier_reactor (2)", "atmospheric_processor (2)", "water_extractor (3)"], units: ["modular_habitat_unit (3)", "radiation_shielded_habitat (1)", "ice_drilling_rig (1)", "regolith_processor (2)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "surface_rover (2)", "orbital_weather_satellite (1)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "hydrogen_stores (500 kilogram)"], consumables: ["oxygen (3000 kilogram)", "water (12000 kilogram)", "food (3000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "water_ice", "regolith", "solar_energy"], import_requirements: {critical_imports: ["hydrogen", "specialized_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels"], estimated_import_timeline: 240}, isru_capabilities: {oxygen_production_rate: 40, water_production_rate: 25, methane_production_rate: 15, power_generation: 300}}, economic_model: {estimated_cost: 4000000, import_ratio: 0.5, revenue_streams: ["methane_fuel_sales", "scientific_data", "water_exports"], break_even_timeline: 480}, population_model: {initial_population: 8, growth_rate: "moderate", support_capacity: 20, expansion_triggers: ["atmospheric_self_sufficiency", "water_independence"], population_sources: ["earth_transfers", "luna_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 2400, challenges: ["thin_atmosphere", "radiation", "dust_storms"]}}}, titan_settlement_patterns: {titan_foothold_settlement: {description: "Titan foothold - hydrocarbon lake utilization, cryogenic processing, methane atmosphere operations", target_world: "titan", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 270, phases: [{id: "atmospheric_descent", name: "Atmospheric Descent & Surface Site Selection", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "hydrocarbon_processing", name: "Methane/Ethane Extraction & Processing", duration: 90, crew_required: 6, equipment_focus: "cryogenic_processing"}, {id: "lake_exploration", name: "Hydrocarbon Lake Survey & Resource Assessment", duration: 75, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_habitation", name: "Cryogenic Habitat & Long-Term Operations", duration: 45, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "methane_processor (3)", "cryogenic_extractor (2)", "atmospheric_heater (2)"], units: ["cryogenic_habitat (2)", "lake_sampling_rig (1)", "methane_refinery (2)", "surface_rover (3)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "cryogenic_drill (1)", "methane_sensor (3)", "orbital_imager (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "thermal_insulation (500 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (10000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["methane_atmosphere", "ethane_lakes", "nitrogen_atmosphere", "cryogenic_ice"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 270}, isru_capabilities: {methane_production_rate: 35, oxygen_production_rate: 20, hydrogen_production_rate: 15, power_generation: 250}}, economic_model: {estimated_cost: 4500000, import_ratio: 0.6, revenue_streams: ["hydrocarbon_exports", "cryogenic_research", "methane_fuel"], break_even_timeline: 540}, population_model: {initial_population: 10, growth_rate: "moderate", support_capacity: 30, expansion_triggers: ["hydrocarbon_self_sufficiency", "cryogenic_habitation_stability"], population_sources: ["earth_scientists", "mars_venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 3000, challenges: ["cryogenic_temperatures", "toxic_atmosphere", "low_gravity", "dust_storms"]}}}, triton_settlement_patterns: {triton_foothold_settlement: {description: "Triton foothold - cryovolcanic activity, nitrogen atmosphere utilization, geyser monitoring", target_world: "triton", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 450, phases: [{id: "cryovolcanic_survey", name: "Cryovolcanic Activity Analysis & Landing Assessment", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "nitrogen_processing", name: "Atmospheric Nitrogen Capture & Processing", duration: 120, crew_required: 6, equipment_focus: "atmospheric_processing"}, {id: "surface_exploration", name: "Geyser Field Survey & Resource Mapping", duration: 120, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_operations", name: "Cryogenic Habitat & Long-Term Research", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "nitrogen_processor (2)", "cryogenic_extractor (2)", "geyser_monitor (2)"], units: ["cryogenic_habitat (2)", "atmospheric_collector (2)", "surface_rover (2)", "thermal_sensor (3)"]}, inventory: {deployable_units: ["cryovolcanic_probe (2)", "nitrogen_harvester (2)", "geyser_sampler (1)", "orbital_mapper (1)"], supplies: ["thermal_insulation (1000 kilogram)", "cryogenic_fluids (500 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["nitrogen_atmosphere", "water_ice", "cryovolcanic_materials", "geyser_vapors"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "cryogenic_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 450}, isru_capabilities: {oxygen_production_rate: 20, nitrogen_production_rate: 35, hydrogen_production_rate: 15, power_generation: 280}}, economic_model: {estimated_cost: 5200000, import_ratio: 0.65, revenue_streams: ["cryovolcanic_research", "nitrogen_exports", "geyser_data"], break_even_timeline: 900}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["cryogenic_systems_stable", "nitrogen_self_sufficiency"], population_sources: ["earth_cryovolcanologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4500, challenges: ["extreme_cold", "thin_atmosphere", "cryovolcanic_activity", "orbital_instability"]}}}, venus_settlement_patterns: {venus_foothold_settlement: {description: "Venus foothold - high-altitude floating habitats, CO2 processing, extreme temperature operations", target_world: "venus", priority: "foothold", phase_structure: {total_phases: 5, estimated_total_duration: 300, phases: [{id: "atmospheric_entry", name: "Atmospheric Entry & High-Altitude Station Establishment", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "floating_platform_deployment", name: "Aerostat Platform Deployment & Stabilization", duration: 90, crew_required: 6, equipment_focus: "aerostat_technology"}, {id: "co2_utilization", name: "CO2 Separation & Resource Extraction", duration: 75, crew_required: 8, equipment_focus: "chemical_separation"}, {id: "energy_harvesting", name: "Solar Energy Collection & Power Distribution", duration: 45, crew_required: 7, equipment_focus: "energy_systems"}, {id: "expanded_operations", name: "Multi-Platform Network & Research Operations", duration: 30, crew_required: 10, equipment_focus: "network_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "co2_separator (3)", "aerostat_platform (4)", "atmospheric_processor (2)"], units: ["floating_habitat (2)", "energy_collection_array (3)", "chemical_reactor (2)", "communication_relay (1)"]}, inventory: {deployable_units: ["atmospheric_probe (3)", "aerostat_balloon (4)", "solar_collector (6)", "weather_satellite (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "specialized_alloys (1000 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (15000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "sulfuric_acid_vapors", "solar_energy", "atmospheric_pressure"], import_requirements: {critical_imports: ["hydrogen", "heat_shielding", "corrosion_resistant_materials"], construction_materials: ["titanium_alloys", "ceramic_composites", "radiation_shielding"], estimated_import_timeline: 300}, isru_capabilities: {oxygen_production_rate: 30, sulfur_production_rate: 20, carbon_production_rate: 25, power_generation: 400}}, economic_model: {estimated_cost: 6000000, import_ratio: 0.7, revenue_streams: ["rare_materials", "atmospheric_data", "energy_exports"], break_even_timeline: 600}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 25, expansion_triggers: ["atmospheric_self_sufficiency", "platform_network_stability"], population_sources: ["earth_specialists", "mars_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 5000, challenges: ["extreme_temperatures", "corrosive_atmosphere", "high_pressure", "acid_clouds"]}}}}, @priorities=#<AIManager::AiPrioritySystem:0x00007f3e59fb3ee0 @last_check=Tue, 13 Jan 2026 04:21:24.698393674 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f3e59fb3968 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f3e561aa338 @settlement_id=1, @decision_history=[{timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:26:59 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:26:59 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:27:00 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:27:00 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:34:25 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:34:25 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:34:25 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:34:25 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:53:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:53:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:53:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:53:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:12:18 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:12:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:12:18 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:12:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:52:13 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:52:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:52:13 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:52:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:10:40 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:10:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:10:40 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:10:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:31:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:31:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:31:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:31:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:37:15 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:37:15 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:37:15 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:37:15 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:55:40 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:55:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:55:40 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:55:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 02:03:34 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 02:03:34 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 02:03:34 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 02:03:34 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 03:11:09 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 03:11:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 03:11:09 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 03:11:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 04:51:21 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 04:51:21 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 04:51:21 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 04:51:21 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 05:22:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 05:22:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 05:22:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 05:22:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:34:49 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:34:49 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:34:49 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:34:49 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:58:09 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:58:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:58:09 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:58:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:18:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:18:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:18:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:18:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:49:50 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:49:50 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:49:50 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:49:50 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:03:54 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:03:54 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:03:54 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:03:54 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:31:10 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:31:10 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:31:10 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:31:10 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 16:47:29 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 16:47:29 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 16:47:29 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 16:47:29 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 17:08:42 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 17:08:42 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 17:08:42 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 17:08:42 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 00:39:03 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 00:39:03 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 00:39:03 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 00:39:03 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 01:36:18 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 01:36:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 01:36:18 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 01:36:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:29:33 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:29:33 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:29:33 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:29:33 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:50:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:50:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:50:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:50:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 04:21:24 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 04:21:24 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 04:21:24 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 04:21:24 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion
       # ./spec/services/ai_manager/operational_manager_spec.rb:71:in 'block (4 levels) in <main>'

  514) AIManager::OperationalManager decision logging logs decisions with timestamps and categories
       Failure/Error: allow(operational_manager).to receive(:consider_expansion).and_return({ action: :maintain, reason: :stable })
         #<AIManager::OperationalManager:0x00007f3e56243da8 @settlement=#<Double "Settlement">, @patterns={callisto_settlement_patterns: {callisto_foothold_settlement: {description: "Callisto foothold - radiation protection, surface mining operations, subsurface resource access", target_world: "callisto", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 390, phases: [{id: "radiation_survey", name: "Radiation Environment Assessment & Site Selection", duration: 120, crew_required: 4, equipment_focus: "radiation_monitoring"}, {id: "surface_mining", name: "Surface Regolith Mining & Processing", duration: 120, crew_required: 6, equipment_focus: "mining_operations"}, {id: "subsurface_exploration", name: "Deep Subsurface Resource Assessment", duration: 90, crew_required: 8, equipment_focus: "deep_drilling"}, {id: "protected_habitation", name: "Radiation-Shielded Habitat & Operations Center", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "mining_rig (2)", "deep_drill (2)", "radiation_shield_generator (2)"], units: ["shielded_habitat (2)", "regolith_processor (2)", "drilling_platform (1)", "radiation_monitor (3)"]}, inventory: {deployable_units: ["mining_drill (2)", "radiation_sensor (4)", "surface_rover (2)", "orbital_radiation_mapper (1)"], supplies: ["enriched_uranium_fuel (3500 kilogram)", "shielding_materials (1200 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["surface_regolith", "subsurface_ice", "silicate_materials", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "heavy_shielding", "mining_equipment"], construction_materials: ["radiation_shielding", "reinforced_structures", "cryogenic_storage"], estimated_import_timeline: 390}, isru_capabilities: {oxygen_production_rate: 20, hydrogen_production_rate: 15, water_production_rate: 30, power_generation: 400}}, economic_model: {estimated_cost: 4800000, import_ratio: 0.55, revenue_streams: ["rare_materials", "radiation_research", "mining_exports"], break_even_timeline: 780}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 22, expansion_triggers: ["radiation_shielding_verified", "mining_operations_stable"], population_sources: ["earth_mining_engineers", "ganymede_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 8000, challenges: ["extreme_radiation", "surface_instability", "resource_scarcity", "thermal_extremes"]}}}, ceres_settlement_patterns: {ceres_foothold_settlement: {description: "Ceres foothold - water ice mining, nickel-iron ore extraction, asteroid belt coordination hub", target_world: "ceres", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 200, phases: [{id: "resource_survey", name: "Asteroid Resource Survey & Mining Site Selection", duration: 40, crew_required: 4, equipment_focus: "geological_survey"}, {id: "water_ice_extraction", name: "Water Ice Mining & Cryogenic Storage", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ore_processing", name: "Nickel-Iron Ore Extraction & Processing", duration: 50, crew_required: 5, equipment_focus: "ore_processing"}, {id: "belt_coordination", name: "Asteroid Belt Operations Center & Trade Hub", duration: 50, crew_required: 8, equipment_focus: "coordination_hub"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "water_extractor (4)", "ore_processor (3)", "cryogenic_storage (2)"], units: ["modular_habitat_unit (2)", "ice_drilling_rig (2)", "ore_mining_rig (2)", "belt_communications_array (1)"]}, inventory: {deployable_units: ["geological_scanner (3)", "mining_drone (4)", "orbital_scanner_satellite (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "hydrogen_stores (300 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, economic_model: {estimated_gcc_cost: 850000, local_production_ratio: 0.75, revenue_streams: [{resource: "water_ice", volume: "high", market_value: "medium", trade_partners: ["mars_development_corporation", "vesta_development_corporation"]}, {resource: "nickel_iron_ore", volume: "high", market_value: "high", trade_partners: ["mars_development_corporation", "earth_development_corporation"]}], operational_costs: {power: "nuclear", maintenance: "medium", crew_rotation: "quarterly"}}, environmental_considerations: {gravity: "microgravity", atmosphere: "none", temperature: "cryogenic", radiation: "high", dust: "significant", challenges: ["microgravity_operations", "thermal_management", "dust_contamination"], advantages: ["abundant_water_ice", "rich_mineral_deposits", "strategic_belt_position"]}, expansion_potential: {follow_on_settlements: ["ceres_main_base", "belt_mining_outposts"], regional_influence: "asteroid_belt_coordination", strategic_value: "resource_extraction_hub"}}}, europa_settlement_patterns: {europa_foothold_settlement: {description: "Europa foothold - subsurface ocean access, ice drilling operations, astrobiology research", target_world: "europa", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 360, phases: [{id: "surface_analysis", name: "Surface Geology Analysis & Landing Site Selection", duration: 90, crew_required: 4, equipment_focus: "geological_survey"}, {id: "ice_penetration", name: "Ice Sheet Drilling & Subsurface Access", duration: 120, crew_required: 6, equipment_focus: "ice_drilling"}, {id: "ocean_sampling", name: "Subsurface Ocean Exploration & Sampling", duration: 90, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "research_station", name: "Permanent Research Station & Long-Term Monitoring", duration: 60, crew_required: 12, equipment_focus: "research_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "ice_drilling_rig (2)", "ocean_probe (3)", "radiation_shielded_habitat (2)"], units: ["cryogenic_habitat (2)", "drilling_platform (1)", "ocean_sampler (2)", "seismic_monitor (1)"]}, inventory: {deployable_units: ["ice_penetrator (2)", "ocean_rover (1)", "seismic_sensor (3)", "radiation_monitor (2)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "thermal_drilling_bits (50)"], consumables: ["oxygen (5000 kilogram)", "water (20000 kilogram)", "food (5000 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "geological_heat", "radiation_environment"], import_requirements: {critical_imports: ["hydrogen", "thermal_drilling_equipment", "radiation_shielding"], construction_materials: ["radiation_shielding", "cryogenic_materials", "pressure_vessels"], estimated_import_timeline: 360}, isru_capabilities: {oxygen_production_rate: 25, hydrogen_production_rate: 20, water_production_rate: 40, power_generation: 350}}, economic_model: {estimated_cost: 5500000, import_ratio: 0.65, revenue_streams: ["scientific_discoveries", "ocean_data", "water_exports"], break_even_timeline: 720}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["ocean_access_established", "radiation_protection_verified"], population_sources: ["earth_astrobiologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "low", worldhouse_suitability: "limited", ai_management_required: true, estimated_completion: 10000, challenges: ["extreme_radiation", "cryogenic_surface", "ocean_pressure", "ice_instability"]}}}, ganymede_settlement_patterns: {ganymede_foothold_settlement: {description: "Ganymede foothold - magnetic field protection, subsurface ocean exploration, ice resource utilization", target_world: "ganymede", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 330, phases: [{id: "magnetic_analysis", name: "Magnetic Field Analysis & Radiation Assessment", duration: 75, crew_required: 4, equipment_focus: "magnetic_survey"}, {id: "ice_resource_development", name: "Surface Ice Mining & Resource Processing", duration: 90, crew_required: 6, equipment_focus: "ice_mining"}, {id: "ocean_penetration", name: "Subsurface Ocean Access & Exploration", duration: 105, crew_required: 8, equipment_focus: "ocean_exploration"}, {id: "permanent_base", name: "Magnetic-Shielded Base & Scientific Operations", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "ice_mining_rig (2)", "ocean_drilling_system (2)", "magnetic_shield_generator (1)"], units: ["radiation_shielded_habitat (2)", "ice_processor (2)", "ocean_probe (2)", "magnetic_monitor (1)"]}, inventory: {deployable_units: ["ice_drill (2)", "ocean_sampler (2)", "magnetic_sensor (3)", "radiation_detector (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "shielding_materials (800 kilogram)"], consumables: ["oxygen (4500 kilogram)", "water (18000 kilogram)", "food (4500 day)"]}}, resource_dependencies: {local_resources_required: ["water_ice", "subsurface_ocean", "magnetic_field", "silicate_materials"], import_requirements: {critical_imports: ["hydrogen", "magnetic_shielding", "deep_drilling_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels", "cryogenic_materials"], estimated_import_timeline: 330}, isru_capabilities: {oxygen_production_rate: 30, hydrogen_production_rate: 25, water_production_rate: 35, power_generation: 300}}, economic_model: {estimated_cost: 5000000, import_ratio: 0.6, revenue_streams: ["magnetic_research", "ocean_discoveries", "ice_resources"], break_even_timeline: 660}, population_model: {initial_population: 12, growth_rate: "moderate", support_capacity: 25, expansion_triggers: ["magnetic_shielding_verified", "ocean_access_established"], population_sources: ["earth_magnetic_specialists", "europa_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4000, challenges: ["radiation_environment", "cryogenic_conditions", "ocean_depth", "magnetic_interference"]}}}, io_settlement_patterns: {io_foothold_settlement: {description: "Io foothold - geothermal energy utilization, sulfur processing, volcanic activity monitoring", target_world: "io", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 420, phases: [{id: "volcanic_assessment", name: "Volcanic Activity Analysis & Safe Zone Identification", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "geothermal_harvesting", name: "Geothermal Energy Extraction & Power Generation", duration: 120, crew_required: 6, equipment_focus: "energy_systems"}, {id: "sulfur_processing", name: "Sulfur Compound Mining & Processing", duration: 90, crew_required: 8, equipment_focus: "chemical_processing"}, {id: "thermal_habitation", name: "Heat-Shielded Habitat & Research Operations", duration: 60, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["geothermal_power_plant (3)", "heat_shield_generator (2)", "sulfur_processor (2)", "volcanic_monitor (3)"], units: ["thermal_habitat (2)", "geothermal_drill (2)", "chemical_reactor (2)", "seismic_sensor (2)"]}, inventory: {deployable_units: ["volcanic_probe (3)", "heat_shield (4)", "sulfur_extractor (2)", "thermal_rover (1)"], supplies: ["thermal_insulation (1500 kilogram)", "corrosion_resistant_materials (800 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (14000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["geothermal_energy", "sulfur_compounds", "volcanic_gases", "surface_materials"], import_requirements: {critical_imports: ["hydrogen", "extreme_heat_shielding", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "heat_resistant_alloys", "radiation_shielding"], estimated_import_timeline: 420}, isru_capabilities: {oxygen_production_rate: 15, sulfur_production_rate: 40, hydrogen_production_rate: 10, power_generation: 500}}, economic_model: {estimated_cost: 6500000, import_ratio: 0.75, revenue_streams: ["geothermal_energy", "sulfur_exports", "volcanic_research"], break_even_timeline: 840}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 18, expansion_triggers: ["thermal_protection_verified", "geothermal_stability_confirmed"], population_sources: ["earth_volcanologists", "venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 6000, challenges: ["extreme_temperatures", "volcanic_activity", "radiation", "corrosive_environment"]}}}, luna_settlement_patterns: {luna_foothold_settlement: {description: "Minimal lunar foothold - survey, ISRU oxygen/water, basic habitat", target_world: "luna", priority: "foothold", phase_structure: {total_phases: 3, estimated_total_duration: 180, phases: [{id: "survey_deployment", name: "Orbital Survey & Landing Site Selection", duration: 30, crew_required: 2, equipment_focus: "remote_sensing"}, {id: "isru_establishment", name: "ISRU Oxygen & Water Production Setup", duration: 60, crew_required: 4, equipment_focus: "resource_extraction"}, {id: "minimal_habitation", name: "Basic Crew Habitat & Life Support", duration: 90, crew_required: 6, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "oxygen_generator (3)", "water_extractor (2)"], units: ["modular_habitat_unit (2)", "regolith_processor (1)", "helium3_mining_rig (1)"]}, inventory: {deployable_units: ["orbital_survey_satellite (1)", "surface_rover (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)"], consumables: ["oxygen (2000 kilogram)", "water (8000 kilogram)", "food (2000 day)"]}}, resource_dependencies: {local_resources_required: ["regolith", "water_ice", "helium3"], import_requirements: {critical_imports: ["oxygen", "water", "food"], construction_materials: ["structural_materials"], estimated_import_timeline: 180}, isru_capabilities: {oxygen_production_rate: 25, water_production_rate: 15, power_generation: 200}}, economic_model: {estimated_cost: 2500000, import_ratio: 0.4, revenue_streams: ["helium3_sales", "research_data"], break_even_timeline: 360}, population_model: {initial_population: 6, growth_rate: "slow", support_capacity: 12, expansion_triggers: ["isru_self_sufficiency", "helium3_exports"], population_sources: ["earth_transfers", "trained_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 720}}}, mars_settlement_patterns: {mars_foothold_settlement: {description: "Mars foothold - atmospheric CO2 utilization, regolith processing, subsurface water access", target_world: "mars", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 240, phases: [{id: "atmospheric_analysis", name: "Atmospheric Composition Analysis & Site Selection", duration: 45, crew_required: 3, equipment_focus: "atmospheric_science"}, {id: "co2_isru_setup", name: "CO2 Sabatier Process & Oxygen Production", duration: 75, crew_required: 5, equipment_focus: "chemical_processing"}, {id: "water_ice_mining", name: "Subsurface Water Ice Mining & Purification", duration: 60, crew_required: 6, equipment_focus: "ice_mining"}, {id: "surface_habitation", name: "Pressurized Habitat & Radiation Protection", duration: 60, crew_required: 8, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (3)", "sabatier_reactor (2)", "atmospheric_processor (2)", "water_extractor (3)"], units: ["modular_habitat_unit (3)", "radiation_shielded_habitat (1)", "ice_drilling_rig (1)", "regolith_processor (2)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "surface_rover (2)", "orbital_weather_satellite (1)"], supplies: ["enriched_uranium_fuel (3000 kilogram)", "hydrogen_stores (500 kilogram)"], consumables: ["oxygen (3000 kilogram)", "water (12000 kilogram)", "food (3000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "water_ice", "regolith", "solar_energy"], import_requirements: {critical_imports: ["hydrogen", "specialized_equipment"], construction_materials: ["radiation_shielding", "pressure_vessels"], estimated_import_timeline: 240}, isru_capabilities: {oxygen_production_rate: 40, water_production_rate: 25, methane_production_rate: 15, power_generation: 300}}, economic_model: {estimated_cost: 4000000, import_ratio: 0.5, revenue_streams: ["methane_fuel_sales", "scientific_data", "water_exports"], break_even_timeline: 480}, population_model: {initial_population: 8, growth_rate: "moderate", support_capacity: 20, expansion_triggers: ["atmospheric_self_sufficiency", "water_independence"], population_sources: ["earth_transfers", "luna_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 2400, challenges: ["thin_atmosphere", "radiation", "dust_storms"]}}}, titan_settlement_patterns: {titan_foothold_settlement: {description: "Titan foothold - hydrocarbon lake utilization, cryogenic processing, methane atmosphere operations", target_world: "titan", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 270, phases: [{id: "atmospheric_descent", name: "Atmospheric Descent & Surface Site Selection", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "hydrocarbon_processing", name: "Methane/Ethane Extraction & Processing", duration: 90, crew_required: 6, equipment_focus: "cryogenic_processing"}, {id: "lake_exploration", name: "Hydrocarbon Lake Survey & Resource Assessment", duration: 75, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_habitation", name: "Cryogenic Habitat & Long-Term Operations", duration: 45, crew_required: 10, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "methane_processor (3)", "cryogenic_extractor (2)", "atmospheric_heater (2)"], units: ["cryogenic_habitat (2)", "lake_sampling_rig (1)", "methane_refinery (2)", "surface_rover (3)"]}, inventory: {deployable_units: ["atmospheric_probe (2)", "cryogenic_drill (1)", "methane_sensor (3)", "orbital_imager (1)"], supplies: ["enriched_uranium_fuel (2000 kilogram)", "thermal_insulation (500 kilogram)"], consumables: ["oxygen (3500 kilogram)", "water (10000 kilogram)", "food (3500 day)"]}}, resource_dependencies: {local_resources_required: ["methane_atmosphere", "ethane_lakes", "nitrogen_atmosphere", "cryogenic_ice"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "corrosion_resistant_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 270}, isru_capabilities: {methane_production_rate: 35, oxygen_production_rate: 20, hydrogen_production_rate: 15, power_generation: 250}}, economic_model: {estimated_cost: 4500000, import_ratio: 0.6, revenue_streams: ["hydrocarbon_exports", "cryogenic_research", "methane_fuel"], break_even_timeline: 540}, population_model: {initial_population: 10, growth_rate: "moderate", support_capacity: 30, expansion_triggers: ["hydrocarbon_self_sufficiency", "cryogenic_habitation_stability"], population_sources: ["earth_scientists", "mars_venus_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 3000, challenges: ["cryogenic_temperatures", "toxic_atmosphere", "low_gravity", "dust_storms"]}}}, triton_settlement_patterns: {triton_foothold_settlement: {description: "Triton foothold - cryovolcanic activity, nitrogen atmosphere utilization, geyser monitoring", target_world: "triton", priority: "foothold", phase_structure: {total_phases: 4, estimated_total_duration: 450, phases: [{id: "cryovolcanic_survey", name: "Cryovolcanic Activity Analysis & Landing Assessment", duration: 150, crew_required: 4, equipment_focus: "volcanic_monitoring"}, {id: "nitrogen_processing", name: "Atmospheric Nitrogen Capture & Processing", duration: 120, crew_required: 6, equipment_focus: "atmospheric_processing"}, {id: "surface_exploration", name: "Geyser Field Survey & Resource Mapping", duration: 120, crew_required: 8, equipment_focus: "surface_exploration"}, {id: "cryogenic_operations", name: "Cryogenic Habitat & Long-Term Research", duration: 60, crew_required: 12, equipment_focus: "habitation"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "nitrogen_processor (2)", "cryogenic_extractor (2)", "geyser_monitor (2)"], units: ["cryogenic_habitat (2)", "atmospheric_collector (2)", "surface_rover (2)", "thermal_sensor (3)"]}, inventory: {deployable_units: ["cryovolcanic_probe (2)", "nitrogen_harvester (2)", "geyser_sampler (1)", "orbital_mapper (1)"], supplies: ["thermal_insulation (1000 kilogram)", "cryogenic_fluids (500 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (16000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["nitrogen_atmosphere", "water_ice", "cryovolcanic_materials", "geyser_vapors"], import_requirements: {critical_imports: ["hydrogen", "thermal_management", "cryogenic_equipment"], construction_materials: ["thermal_insulation", "cryogenic_vessels", "radiation_shielding"], estimated_import_timeline: 450}, isru_capabilities: {oxygen_production_rate: 20, nitrogen_production_rate: 35, hydrogen_production_rate: 15, power_generation: 280}}, economic_model: {estimated_cost: 5200000, import_ratio: 0.65, revenue_streams: ["cryovolcanic_research", "nitrogen_exports", "geyser_data"], break_even_timeline: 900}, population_model: {initial_population: 12, growth_rate: "slow", support_capacity: 20, expansion_triggers: ["cryogenic_systems_stable", "nitrogen_self_sufficiency"], population_sources: ["earth_cryovolcanologists", "titan_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "medium", worldhouse_suitability: "good", ai_management_required: true, estimated_completion: 4500, challenges: ["extreme_cold", "thin_atmosphere", "cryovolcanic_activity", "orbital_instability"]}}}, venus_settlement_patterns: {venus_foothold_settlement: {description: "Venus foothold - high-altitude floating habitats, CO2 processing, extreme temperature operations", target_world: "venus", priority: "foothold", phase_structure: {total_phases: 5, estimated_total_duration: 300, phases: [{id: "atmospheric_entry", name: "Atmospheric Entry & High-Altitude Station Establishment", duration: 60, crew_required: 4, equipment_focus: "atmospheric_entry"}, {id: "floating_platform_deployment", name: "Aerostat Platform Deployment & Stabilization", duration: 90, crew_required: 6, equipment_focus: "aerostat_technology"}, {id: "co2_utilization", name: "CO2 Separation & Resource Extraction", duration: 75, crew_required: 8, equipment_focus: "chemical_separation"}, {id: "energy_harvesting", name: "Solar Energy Collection & Power Distribution", duration: 45, crew_required: 7, equipment_focus: "energy_systems"}, {id: "expanded_operations", name: "Multi-Platform Network & Research Operations", duration: 30, crew_required: 10, equipment_focus: "network_operations"}]}, equipment_requirements: {craft_fit: {modules: ["nuclear_power_plant (2)", "co2_separator (3)", "aerostat_platform (4)", "atmospheric_processor (2)"], units: ["floating_habitat (2)", "energy_collection_array (3)", "chemical_reactor (2)", "communication_relay (1)"]}, inventory: {deployable_units: ["atmospheric_probe (3)", "aerostat_balloon (4)", "solar_collector (6)", "weather_satellite (2)"], supplies: ["enriched_uranium_fuel (2500 kilogram)", "specialized_alloys (1000 kilogram)"], consumables: ["oxygen (4000 kilogram)", "water (15000 kilogram)", "food (4000 day)"]}}, resource_dependencies: {local_resources_required: ["co2_atmosphere", "sulfuric_acid_vapors", "solar_energy", "atmospheric_pressure"], import_requirements: {critical_imports: ["hydrogen", "heat_shielding", "corrosion_resistant_materials"], construction_materials: ["titanium_alloys", "ceramic_composites", "radiation_shielding"], estimated_import_timeline: 300}, isru_capabilities: {oxygen_production_rate: 30, sulfur_production_rate: 20, carbon_production_rate: 25, power_generation: 400}}, economic_model: {estimated_cost: 6000000, import_ratio: 0.7, revenue_streams: ["rare_materials", "atmospheric_data", "energy_exports"], break_even_timeline: 600}, population_model: {initial_population: 10, growth_rate: "slow", support_capacity: 25, expansion_triggers: ["atmospheric_self_sufficiency", "platform_network_stability"], population_sources: ["earth_specialists", "mars_experience_crew"]}, terraforming_readiness: {paraterraforming_potential: "high", worldhouse_suitability: "excellent", ai_management_required: true, estimated_completion: 5000, challenges: ["extreme_temperatures", "corrosive_atmosphere", "high_pressure", "acid_clouds"]}}}}, @priorities=#<AIManager::AiPrioritySystem:0x00007f3e593141f8 @last_check=Tue, 13 Jan 2026 04:21:24.921065166 UTC +00:00>, @world_knowledge=#<AIManager::WorldKnowledgeService:0x00007f3e59312ad8 @celestial_body={}>, @last_decision=nil, @decision_log=[], @performance_tracker=#<AIManager::PerformanceTracker:0x00007f3e56496740 @settlement_id=1, @decision_history=[{timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:37:38 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:37:38 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 02:54:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 02:54:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 03:44:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 03:44:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 21:43:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.7, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 21:43:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:10:14 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 0.9, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:10:14 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:26:59 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:26:59 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:27:00 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:27:00 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:40:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:40:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 22:56:26 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 22:56:26 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:04:48 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:04:48 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:32:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:32:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:34:25 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:34:25 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:34:25 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:34:25 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:53:35 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:53:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-11 23:53:35 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-11 23:53:35 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:12:18 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:12:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:12:18 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:12:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:52:13 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:52:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 00:52:13 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 00:52:13 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:10:40 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:10:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:10:40 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:10:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:31:04 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:31:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:31:04 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:31:04 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:37:15 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:37:15 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:37:15 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:37:15 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:55:40 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:55:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 01:55:40 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 01:55:40 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 02:03:34 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 02:03:34 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 02:03:34 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 02:03:34 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 03:11:09 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 03:11:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 03:11:09 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 03:11:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 04:51:21 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 04:51:21 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 04:51:21 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 04:51:21 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 05:22:11 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 05:22:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 05:22:11 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 05:22:11 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:34:49 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:34:49 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:34:49 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:34:49 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:58:09 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:58:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 13:58:09 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 13:58:09 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:18:39 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:18:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:18:39 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:18:39 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:49:50 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:49:50 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 14:49:50 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 14:49:50 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:03:54 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:03:54 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:03:54 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:03:54 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:31:10 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:31:10 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 15:31:10 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 15:31:10 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 16:47:29 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 16:47:29 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 16:47:29 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 16:47:29 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 17:08:42 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 17:08:42 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-12 17:08:42 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-12 17:08:42 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 00:39:03 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 00:39:03 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 00:39:03 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 00:39:03 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 01:36:18 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 01:36:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 01:36:18 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 01:36:18 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:29:33 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:29:33 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:29:33 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:29:33 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:50:02 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:50:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 03:50:02 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 03:50:02 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 04:21:24 UTC", decision: {action: "emergency_procurement", resource: "oxygen", reason: "life_support_critical"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 04:21:24 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}, {timestamp: "2026-01-13 04:21:24 UTC", decision: {action: "resource_procurement", resource: "water", amount: 1000, reason: "resource_shortage", adapted_from: "emergency_procurement", adaptation_confidence: 1.0, adaptation_reason: "learned_from_past_experience"}, context: {oxygen_level: 75, water_level: 80, food_level: 85, debt_level: 10000, construction_queue_size: 0, available_resources: {oxygen: 200, water: 300, food: 400}, isru_capability: 0.7, timestamp: "2026-01-13 04:21:24 UTC"}, outcome: nil, success_score: nil, lessons_learned: []}], @pattern_performance={}, @adaptation_rules={}>> does not implement: consider_expansion
       # ./spec/services/ai_manager/operational_manager_spec.rb:185:in 'block (3 levels) in <main>'

  515) AIManager::SystemArchitect#deploy_subsurface_foothold creates subsurface location
       Failure/Error: expect { architect.send(:deploy_subsurface_foothold) }.to change(CelestialLocation, :count).by(1)

       NameError:
         uninitialized constant CelestialLocation
       # ./spec/services/ai_manager/system_architect_spec.rb:100:in 'block (3 levels) in <main>'

  516) AIManager::SystemArchitect#deploy_subsurface_foothold creates settlement
       Failure/Error:
         Structures::BaseStructure.create!(
           name: "Primary Habitat Module - #{settlement.name} - #{Time.now.to_i}-#{rand(1000)}",
           structure_name: 'habitat',
           settlement: settlement,
           owner: settlement.owner,
           operational_data: { 
             pressurized: true, 
             radiation_shielded: true, 
             structure_type: 'habitat',
             status: 'operational'

       ActiveRecord::RecordInvalid:
         Validation failed: Structure type can't be blank
       # ./app/services/ai_manager/system_architect.rb:471:in 'AIManager::SystemArchitect#create_habitat_structures'
       # ./app/services/ai_manager/system_architect.rb:385:in 'AIManager::SystemArchitect#deploy_initial_habitats'
       # ./app/services/ai_manager/system_architect.rb:152:in 'AIManager::SystemArchitect#deploy_subsurface_foothold'
       # ./spec/services/ai_manager/system_architect_spec.rb:104:in 'block (4 levels) in <main>'
       # ./spec/services/ai_manager/system_architect_spec.rb:104:in 'block (3 levels) in <main>'

  517) AIManager::SystemArchitect#find_nearby_asteroid with suitable asteroid finds the asteroid
       Failure/Error: let!(:asteroid) { create(:asteroid, solar_system: solar_system) }

       KeyError:
         Factory not registered: "asteroid"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_architect_spec.rb:118:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "asteroid"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  518) AIManager::SystemIntelligenceService#system_status with operational structures returns correct operational ratio and status
       Failure/Error: let!(:operational_structure) { create(:base_structure, :operational) }

       KeyError:
         Trait not registered: "operational"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:181:in 'FactoryBot::Definition#aggregate_from_traits_and_self'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:37:in 'FactoryBot::Definition#to_create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition_hierarchy.rb:6:in 'FactoryBot::DefinitionHierarchy.build_from_definition'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:128:in 'FactoryBot::Factory#build_hierarchy'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:91:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_intelligence_service_spec.rb:12:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "operational"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  519) AIManager::SystemIntelligenceService#system_status with all operational structures returns healthy status
       Failure/Error: let!(:structure1) { create(:base_structure, :operational) }

       KeyError:
         Trait not registered: "operational"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:181:in 'FactoryBot::Definition#aggregate_from_traits_and_self'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:37:in 'FactoryBot::Definition#to_create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition_hierarchy.rb:6:in 'FactoryBot::DefinitionHierarchy.build_from_definition'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:128:in 'FactoryBot::Factory#build_hierarchy'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:91:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_intelligence_service_spec.rb:35:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "operational"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  520) AIManager::SystemIntelligenceService#system_status with mostly non-operational structures returns critical status
       Failure/Error: let!(:structure1) { create(:base_structure, :non_operational, location: create(:celestial_location, celestial_body: celestial_body)) }

       KeyError:
         Trait not registered: "non_operational"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:181:in 'FactoryBot::Definition#aggregate_from_traits_and_self'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:37:in 'FactoryBot::Definition#to_create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition_hierarchy.rb:6:in 'FactoryBot::DefinitionHierarchy.build_from_definition'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:128:in 'FactoryBot::Factory#build_hierarchy'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:91:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/system_intelligence_service_spec.rb:56:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "non_operational"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  521) AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure creates a crater dome structure
       Failure/Error:
         crater_dome = Structures::CraterDome.create!(
           name: structure_name,
           structure_name: structure_name,
           owner: @settlement,
           location: dome_location,
           settlement: @settlement,
           operational_data: {
             'structure_type' => 'crater_dome',
             'dimensions' => {
               'diameter' => task['diameter'] || 100.0,

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (543, Test Dome (1660), Test Dome (1660), null, 1660, Settlement::BaseSettlement, 1660, null, Location::CelestialLocation, 2007, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-13 04:21:42.135133, 2026-01-13 04:21:42.135133, null, null, 0, 0).
       # ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:519:in 'block (5 levels) in <main>'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:518:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (543, Test Dome (1660), Test Dome (1660), null, 1660, Settlement::BaseSettlement, 1660, null, Location::CelestialLocation, 2007, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-13 04:21:42.135133, 2026-01-13 04:21:42.135133, null, null, 0, 0).
       #   ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'

  522) AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure uses ConstructionJobService
       Failure/Error:
         crater_dome = Structures::CraterDome.create!(
           name: structure_name,
           structure_name: structure_name,
           owner: @settlement,
           location: dome_location,
           settlement: @settlement,
           operational_data: {
             'structure_type' => 'crater_dome',
             'dimensions' => {
               'diameter' => task['diameter'] || 100.0,

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (544, Test Dome (1661), Test Dome (1661), null, 1661, Settlement::BaseSettlement, 1661, null, Location::CelestialLocation, 2008, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-13 04:21:42.215577, 2026-01-13 04:21:42.215577, null, null, 0, 0).
       # ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:529:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (544, Test Dome (1661), Test Dome (1661), null, 1661, Settlement::BaseSettlement, 1661, null, Location::CelestialLocation, 2008, 0, {"dimensions": {"depth": 30.0, "diameter": 150.0}, "structure_ty..., 2026-01-13 04:21:42.215577, 2026-01-13 04:21:42.215577, null, null, 0, 0).
       #   ./app/services/ai_manager/task_execution_engine.rb:309:in 'AIManager::TaskExecutionEngine#initiate_construction'

  523) AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply schedules a material ferry mission
       Failure/Error: @hlt_craft = create(:base_craft, docked_at: @lunar_settlement, status: 'operational')

       NoMethodError:
         undefined method 'status=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:632:in 'block (3 levels) in <main>'

  524) AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply updates craft status
       Failure/Error: @hlt_craft = create(:base_craft, docked_at: @lunar_settlement, status: 'operational')

       NoMethodError:
         undefined method 'status=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:632:in 'block (3 levels) in <main>'

  525) AIManager::TaskExecutionEngine.orbital_resupply_cycle when no active projects does not schedule missions
       Failure/Error: @hlt_craft = create(:base_craft, docked_at: @lunar_settlement, status: 'operational')

       NoMethodError:
         undefined method 'status=' for an instance of Craft::BaseCraft
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'Kernel#public_send'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/ai_manager/task_execution_engine_spec.rb:632:in 'block (3 levels) in <main>'

  526) AIManager::TerraformingManager#calculate_gas_needs with magnetosphere protection returns gas needs for warming phase
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./app/services/ai_manager/terraforming_manager.rb:46:in 'AIManager::TerraformingManager#calculate_gas_needs'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:21:in 'block (4 levels) in <main>'

  527) AIManager::TerraformingManager#calculate_gas_needs without magnetosphere protection returns empty hash
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./app/services/ai_manager/terraforming_manager.rb:46:in 'AIManager::TerraformingManager#calculate_gas_needs'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:28:in 'block (4 levels) in <main>'

  528) AIManager::TerraformingManager#calculate_gas_needs with preservation mode and exceeded limit returns empty hash
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./app/services/ai_manager/terraforming_manager.rb:46:in 'AIManager::TerraformingManager#calculate_gas_needs'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:38:in 'block (4 levels) in <main>'

  529) AIManager::TerraformingManager#has_magnetosphere_protection? with natural magnetosphere returns true
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:49:in 'block (4 levels) in <main>'

  530) AIManager::TerraformingManager#has_magnetosphere_protection? without natural magnetosphere returns false
       Failure/Error: world.magnetosphere_protection?

       NoMethodError:
         undefined method 'magnetosphere_protection?' for an instance of CelestialBodies::CelestialBody
       # ./app/services/ai_manager/terraforming_manager.rb:599:in 'AIManager::TerraformingManager#has_magnetosphere_protection?'
       # ./spec/services/ai_manager/terraforming_manager_spec.rb:55:in 'block (4 levels) in <main>'

  531) AutonomousMissionService.find_or_create_worldhouse_feature when a lava tube exists returns the existing lava tube
       Failure/Error: let!(:lava_tube) { create(:lava_tube_feature, celestial_body: celestial_body, status: 'natural') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:10:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  532) AutonomousMissionService.find_or_create_worldhouse_feature priority order prioritizes lava tube over valley and canyon
       Failure/Error: let!(:lava_tube) { create(:lava_tube_feature, celestial_body: celestial_body, status: 'natural') }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:52:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  533) AutonomousMissionService.execute_base_building_sequence calls the feature finding method
       Failure/Error: allow(described_class).to receive(:find_or_create_worldhouse_feature).and_return(create(:lava_tube_feature))

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:78:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  534) AutonomousMissionService.execute_base_building_sequence logs mission progress
       Failure/Error: allow(described_class).to receive(:find_or_create_worldhouse_feature).and_return(create(:lava_tube_feature))

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/autonomous_mission_service_spec.rb:78:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  535) Construction::OrbitalShipyardService.deliver_materials when material is needed consumes the material for the project
       Failure/Error: active_projects = station.orbital_construction_projects.where(status: ['materials_pending', 'in_progress'])

       NoMethodError:
         undefined method 'orbital_construction_projects' for an instance of Settlement::BaseSettlement
       # ./app/services/construction/orbital_shipyard_service.rb:26:in 'Construction::OrbitalShipyardService.deliver_materials'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:76:in 'block (5 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:75:in 'block (4 levels) in <main>'

  536) Construction::OrbitalShipyardService.deliver_materials when material is needed returns the unconsumed quantity
       Failure/Error: active_projects = station.orbital_construction_projects.where(status: ['materials_pending', 'in_progress'])

       NoMethodError:
         undefined method 'orbital_construction_projects' for an instance of Settlement::BaseSettlement
       # ./app/services/construction/orbital_shipyard_service.rb:26:in 'Construction::OrbitalShipyardService.deliver_materials'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:81:in 'block (4 levels) in <main>'

  537) Construction::OrbitalShipyardService.deliver_materials when material is needed does not consume more than needed
       Failure/Error: active_projects = station.orbital_construction_projects.where(status: ['materials_pending', 'in_progress'])

       NoMethodError:
         undefined method 'orbital_construction_projects' for an instance of Settlement::BaseSettlement
       # ./app/services/construction/orbital_shipyard_service.rb:26:in 'Construction::OrbitalShipyardService.deliver_materials'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:87:in 'block (4 levels) in <main>'

  538) Construction::OrbitalShipyardService.deliver_materials when material is not needed returns the full quantity
       Failure/Error: active_projects = station.orbital_construction_projects.where(status: ['materials_pending', 'in_progress'])

       NoMethodError:
         undefined method 'orbital_construction_projects' for an instance of Settlement::BaseSettlement
       # ./app/services/construction/orbital_shipyard_service.rb:26:in 'Construction::OrbitalShipyardService.deliver_materials'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:97:in 'block (4 levels) in <main>'

  539) Construction::OrbitalShipyardService.deliver_materials when material is not needed does not update any project materials
       Failure/Error: active_projects = station.orbital_construction_projects.where(status: ['materials_pending', 'in_progress'])

       NoMethodError:
         undefined method 'orbital_construction_projects' for an instance of Settlement::BaseSettlement
       # ./app/services/construction/orbital_shipyard_service.rb:26:in 'Construction::OrbitalShipyardService.deliver_materials'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:103:in 'block (4 levels) in <main>'

  540) Construction::OrbitalShipyardService.deliver_materials when project becomes ready changes status to in_progress when all materials are delivered
       Failure/Error: active_projects = station.orbital_construction_projects.where(status: ['materials_pending', 'in_progress'])

       NoMethodError:
         undefined method 'orbital_construction_projects' for an instance of Settlement::BaseSettlement
       # ./app/services/construction/orbital_shipyard_service.rb:26:in 'Construction::OrbitalShipyardService.deliver_materials'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:114:in 'block (4 levels) in <main>'

  541) Construction::OrbitalShipyardService.deliver_materials with multiple projects distributes materials across projects
       Failure/Error: active_projects = station.orbital_construction_projects.where(status: ['materials_pending', 'in_progress'])

       NoMethodError:
         undefined method 'orbital_construction_projects' for an instance of Settlement::BaseSettlement
       # ./app/services/construction/orbital_shipyard_service.rb:26:in 'Construction::OrbitalShipyardService.deliver_materials'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:134:in 'block (4 levels) in <main>'

  542) Construction::OrbitalShipyardService.update_construction_progress does not exceed 100%
       Failure/Error:
         craft = Craft::BaseCraft.create!(
           name: "#{blueprint['name']} #{Time.current.to_i}",
           craft_name: blueprint['id'],
           craft_type: blueprint['category'],
           owner: project.station.owner, # Station owner
           operational_data: blueprint['operational_data'] || {},
           docked_at: project.station,
           status: :docked
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'status' for Craft::BaseCraft.
       # ./app/services/construction/orbital_shipyard_service.rb:125:in 'Construction::OrbitalShipyardService.spawn_completed_craft'
       # ./app/services/construction/orbital_shipyard_service.rb:54:in 'Construction::OrbitalShipyardService.complete_project'
       # ./app/services/construction/orbital_shipyard_service.rb:117:in 'Construction::OrbitalShipyardService.advance_construction'
       # ./app/services/construction/orbital_shipyard_service.rb:45:in 'block in Construction::OrbitalShipyardService.update_construction_progress'
       # ./app/services/construction/orbital_shipyard_service.rb:44:in 'Construction::OrbitalShipyardService.update_construction_progress'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:157:in 'block (3 levels) in <main>'

  543) Construction::OrbitalShipyardService.complete_project marks the project as completed
       Failure/Error:
         craft = Craft::BaseCraft.create!(
           name: "#{blueprint['name']} #{Time.current.to_i}",
           craft_name: blueprint['id'],
           craft_type: blueprint['category'],
           owner: project.station.owner, # Station owner
           operational_data: blueprint['operational_data'] || {},
           docked_at: project.station,
           status: :docked
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'status' for Craft::BaseCraft.
       # ./app/services/construction/orbital_shipyard_service.rb:125:in 'Construction::OrbitalShipyardService.spawn_completed_craft'
       # ./app/services/construction/orbital_shipyard_service.rb:54:in 'Construction::OrbitalShipyardService.complete_project'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:178:in 'block (3 levels) in <main>'

  544) Construction::OrbitalShipyardService.spawn_completed_craft creates a new craft
       Failure/Error:
         craft = Craft::BaseCraft.create!(
           name: "#{blueprint['name']} #{Time.current.to_i}",
           craft_name: blueprint['id'],
           craft_type: blueprint['category'],
           owner: project.station.owner, # Station owner
           operational_data: blueprint['operational_data'] || {},
           docked_at: project.station,
           status: :docked
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'status' for Craft::BaseCraft.
       # ./app/services/construction/orbital_shipyard_service.rb:125:in 'Construction::OrbitalShipyardService.spawn_completed_craft'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:194:in 'block (4 levels) in <main>'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:193:in 'block (3 levels) in <main>'

  545) Construction::OrbitalShipyardService.spawn_completed_craft associates the craft with the station
       Failure/Error:
         craft = Craft::BaseCraft.create!(
           name: "#{blueprint['name']} #{Time.current.to_i}",
           craft_name: blueprint['id'],
           craft_type: blueprint['category'],
           owner: project.station.owner, # Station owner
           operational_data: blueprint['operational_data'] || {},
           docked_at: project.station,
           status: :docked
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'status' for Craft::BaseCraft.
       # ./app/services/construction/orbital_shipyard_service.rb:125:in 'Construction::OrbitalShipyardService.spawn_completed_craft'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:199:in 'block (3 levels) in <main>'

  546) Construction::OrbitalShipyardService.spawn_completed_craft sets the craft status to docked
       Failure/Error:
         craft = Craft::BaseCraft.create!(
           name: "#{blueprint['name']} #{Time.current.to_i}",
           craft_name: blueprint['id'],
           craft_type: blueprint['category'],
           owner: project.station.owner, # Station owner
           operational_data: blueprint['operational_data'] || {},
           docked_at: project.station,
           status: :docked
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'status' for Craft::BaseCraft.
       # ./app/services/construction/orbital_shipyard_service.rb:125:in 'Construction::OrbitalShipyardService.spawn_completed_craft'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:204:in 'block (3 levels) in <main>'

  547) Construction::OrbitalShipyardService.spawn_completed_craft loads operational data from blueprint
       Failure/Error:
         craft = Craft::BaseCraft.create!(
           name: "#{blueprint['name']} #{Time.current.to_i}",
           craft_name: blueprint['id'],
           craft_type: blueprint['category'],
           owner: project.station.owner, # Station owner
           operational_data: blueprint['operational_data'] || {},
           docked_at: project.station,
           status: :docked
         )

       ActiveModel::UnknownAttributeError:
         unknown attribute 'status' for Craft::BaseCraft.
       # ./app/services/construction/orbital_shipyard_service.rb:125:in 'Construction::OrbitalShipyardService.spawn_completed_craft'
       # ./spec/services/construction/orbital_shipyard_service_spec.rb:209:in 'block (3 levels) in <main>'

  548) CraterDomeConstructionService#construct creates a construction job successfully
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  549) CraterDomeConstructionService#construct when entity is different from service provider processes a payment
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  550) CraterDomeConstructionService#start_construction starts the construction process
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  551) CraterDomeConstructionService#complete_construction completes the construction process
       Failure/Error:
         let!(:settlement) { create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )}

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/crater_dome_construction_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  552) FittingService fits all components from inventory
       Failure/Error: expect(result.success?).to be true

         expected true
              got false
       # ./spec/services/fitting_service_spec.rb:33:in 'block (2 levels) in <main>'

  553) FittingService fits components without inventory if inventory is nil
       Failure/Error: expect(result.success?).to be true

         expected true
              got false
       # ./spec/services/fitting_service_spec.rb:49:in 'block (2 levels) in <main>'

  554) Game#advance_by_days advances the simulation by the given number of days
       Failure/Error:
         def simulate
           update_pressure
           calculate_greenhouse_effect
           update_temperatures
           simulate_atmospheric_loss
           decrease_dust(0.1)
         end

       ArgumentError:
         wrong number of arguments (given 1, expected 0)
       # ./app/services/terra_sim/atmosphere_simulation_service.rb:11:in 'simulate'
       # ./app/services/planet_update_service.rb:154:in 'PlanetUpdateService#process_atmosphere'
       # ./app/services/planet_update_service.rb:39:in 'PlanetUpdateService#simulate_detailed'
       # ./app/services/planet_update_service.rb:26:in 'PlanetUpdateService#run'
       # ./app/models/game.rb:104:in 'block in Game#process_planets'
       # ./app/models/game.rb:101:in 'Game#process_planets'
       # ./app/models/game.rb:53:in 'Game#advance_by_days'
       # ./spec/services/game_spec.rb:68:in 'block (3 levels) in <main>'

  555) Game#advance_by_days does not advance time if days is zero or negative
       Failure/Error:
         def simulate
           update_pressure
           calculate_greenhouse_effect
           update_temperatures
           simulate_atmospheric_loss
           decrease_dust(0.1)
         end

       ArgumentError:
         wrong number of arguments (given 1, expected 0)
       # ./app/services/terra_sim/atmosphere_simulation_service.rb:11:in 'simulate'
       # ./app/services/planet_update_service.rb:154:in 'PlanetUpdateService#process_atmosphere'
       # ./app/services/planet_update_service.rb:39:in 'PlanetUpdateService#simulate_detailed'
       # ./app/services/planet_update_service.rb:26:in 'PlanetUpdateService#run'
       # ./app/models/game.rb:104:in 'block in Game#process_planets'
       # ./app/models/game.rb:101:in 'Game#process_planets'
       # ./app/models/game.rb:53:in 'Game#advance_by_days'
       # ./spec/services/game_spec.rb:74:in 'block (3 levels) in <main>'

  556) Generators::LavaTubeGenerator#generate with random generation creates a lava tube with random features
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:11:in 'block (4 levels) in <main>'

  557) Generators::LavaTubeGenerator#generate with random generation generates random dimensions
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:23:in 'block (4 levels) in <main>'

  558) Generators::LavaTubeGenerator#generate with random generation generates random attributes
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:32:in 'block (4 levels) in <main>'

  559) Generators::LavaTubeGenerator#generate with random generation creates random skylights and access points
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./app/services/generators/lava_tube_generator.rb:157:in 'block in Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:146:in 'Generators::LavaTubeGenerator#generate_skylights'
       # ./app/services/generators/lava_tube_generator.rb:140:in 'Generators::LavaTubeGenerator#generate_random_features'
       # ./app/services/generators/lava_tube_generator.rb:21:in 'Generators::LavaTubeGenerator#generate'
       # ./spec/services/generators/lava_tube_generator_spec.rb:41:in 'block (4 levels) in <main>'

  560) Generators::LavaTubeGenerator#generate with predefined parameters creates a lava tube with specified parameters
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/lava_tube.rb:12:in 'CelestialBodies::Features::LavaTube#length_m'
       # ./spec/services/generators/lava_tube_generator_spec.rb:95:in 'block (4 levels) in <main>'

  561) Generators::LavaTubeGenerator#generate with predefined parameters creates predefined skylights and access points
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./spec/services/generators/lava_tube_generator_spec.rb:116:in 'block (4 levels) in <main>'

  562) Generators::LavaTubeGenerator#generate with minimal parameters creates a lava tube with defaults
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./spec/services/generators/lava_tube_generator_spec.rb:135:in 'block (4 levels) in <main>'

  563) Generators::ValleyGenerator#generate with random generation creates a valley with random features
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/valley.rb:10:in 'CelestialBodies::Features::Valley#length_m'
       # ./app/services/generators/valley_generator.rb:163:in 'block in Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:151:in 'Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:21:in 'Generators::ValleyGenerator#generate'
       # ./spec/services/generators/valley_generator_spec.rb:10:in 'block (4 levels) in <main>'

  564) Generators::ValleyGenerator#generate with random generation generates random dimensions
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/valley.rb:10:in 'CelestialBodies::Features::Valley#length_m'
       # ./app/services/generators/valley_generator.rb:163:in 'block in Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:151:in 'Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:21:in 'Generators::ValleyGenerator#generate'
       # ./spec/services/generators/valley_generator_spec.rb:22:in 'block (4 levels) in <main>'

  565) Generators::ValleyGenerator#generate with random generation generates segments
       Failure/Error: segments = valley.segments

       NoMethodError:
         undefined method 'segments' for an instance of CelestialBodies::Features::Valley
       # ./spec/services/generators/valley_generator_spec.rb:33:in 'block (4 levels) in <main>'

  566) Generators::ValleyGenerator#generate with random generation creates random access points
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/valley.rb:10:in 'CelestialBodies::Features::Valley#length_m'
       # ./app/services/generators/valley_generator.rb:163:in 'block in Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:151:in 'Generators::ValleyGenerator#generate_random_features'
       # ./app/services/generators/valley_generator.rb:21:in 'Generators::ValleyGenerator#generate'
       # ./spec/services/generators/valley_generator_spec.rb:46:in 'block (4 levels) in <main>'

  567) Generators::ValleyGenerator#generate with predefined parameters creates a valley with specified parameters
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./app/models/celestial_bodies/features/valley.rb:10:in 'CelestialBodies::Features::Valley#length_m'
       # ./spec/services/generators/valley_generator_spec.rb:88:in 'block (4 levels) in <main>'

  568) Generators::ValleyGenerator#generate with predefined parameters creates predefined access points
       Failure/Error:
         Lookup::PlanetaryGeologicalFeatureLookupService
           .new(celestial_body)
           .find_by_id(feature_id)

       NoMethodError:
         undefined method 'find_by_id' for an instance of Lookup::PlanetaryGeologicalFeatureLookupService
       # ./app/models/celestial_bodies/features/base_feature.rb:30:in 'CelestialBodies::Features::BaseFeature#static_data'
       # ./spec/services/generators/valley_generator_spec.rb:102:in 'block (4 levels) in <main>'

  569) Logistics::ContractService.create_internal_transfer with valid settlements creates a logistics contract for internal transfer
       Failure/Error: expect(contract).to be_persisted
         expected nil to respond to `persisted?`
       # ./spec/services/logistics/contract_service_spec.rb:23:in 'block (4 levels) in <main>'

  570) Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects intercepts materials for orbital construction
       Failure/Error: to_inventory.inventoryable.orbital? &&

       NoMethodError:
         undefined method 'orbital?' for an instance of Settlement::BaseSettlement
       # ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'
       # ./spec/services/logistics/inventory_manager_spec.rb:28:in 'block (4 levels) in <main>'

  571) Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects does not add materials to station inventory if all consumed by projects
       Failure/Error: to_inventory.inventoryable.orbital? &&

       NoMethodError:
         undefined method 'orbital?' for an instance of Settlement::BaseSettlement
       # ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'
       # ./spec/services/logistics/inventory_manager_spec.rb:45:in 'block (4 levels) in <main>'

  572) Logistics::InventoryManager.transfer_item when transferring orbital construction materials to non-orbital settlement transfers materials normally without interception
       Failure/Error: to_inventory.inventoryable.orbital? &&

       NoMethodError:
         undefined method 'orbital?' for an instance of Settlement::BaseSettlement
       # ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'
       # ./spec/services/logistics/inventory_manager_spec.rb:65:in 'block (4 levels) in <main>'

  573) Logistics::InventoryManager.transfer_item when transferring non-orbital materials to orbital station transfers materials normally without interception
       Failure/Error: to_inventory.inventoryable.orbital? &&

       NoMethodError:
         undefined method 'orbital?' for an instance of Settlement::BaseSettlement
       # ./app/services/logistics/inventory_manager.rb:9:in 'Logistics::InventoryManager.transfer_item'
       # ./spec/services/logistics/inventory_manager_spec.rb:84:in 'block (4 levels) in <main>'

  574) Lookup::CraftLookupService#find_craft loads JSON files with correct format
       Failure/Error: expect(data).to have_key('id')
         expected `{"ai_decision_logic" => {"crew_availability_check" => "required", "fuel_availability_check" => "requi...euvers", "operational_kw" => 2500, "peak_surge_kw" => 8000}, "template" => "craft_operational_data"}.has_key?("id")` to be truthy, got false
       # ./spec/services/lookup/craft_lookup_service_spec.rb:27:in 'block (4 levels) in <main>'
       # ./spec/services/lookup/craft_lookup_service_spec.rb:24:in 'Array#each'
       # ./spec/services/lookup/craft_lookup_service_spec.rb:24:in 'block (3 levels) in <main>'

  575) Lookup::ItemLookupService#find_item loads items from the correct file structure
       Failure/Error: items_path = described_class.base_items_path.to_s

       NoMethodError:
         undefined method 'base_items_path' for class Lookup::ItemLookupService
       # ./spec/services/lookup/item_lookup_service_spec.rb:9:in 'block (3 levels) in <main>'

  576) Lookup::ItemLookupService#find_item handles scrap items dynamically
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:63:in 'block (3 levels) in <main>'

  577) Lookup::ItemLookupService dynamic item creation creates scrap items on the fly
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:126:in 'block (3 levels) in <main>'

  578) Lookup::ItemLookupService dynamic item creation creates processed items on the fly
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:134:in 'block (3 levels) in <main>'

  579) Lookup::ItemLookupService dynamic item creation creates used items on the fly
       Failure/Error: expect(result).to be_a(Hash)
         expected nil to be a kind of Hash
       # ./spec/services/lookup/item_lookup_service_spec.rb:142:in 'block (3 levels) in <main>'

  580) Lookup::MaterialLookupService.locate_gases_path uses GalaxyGame::Paths consistently
       Failure/Error: expect(path).to eq(expected_path)

         expected: "/home/galaxy_game/app/data/resources/materials/gases"
              got: "/home/galaxy_game/home/galaxy_game/app/data/resources/materials/gases"

         (compared using ==)
       # ./spec/services/lookup/material_lookup_service_spec.rb:210:in 'block (3 levels) in <main>'

  581) Lookup::MaterialLookupService error handling with corrupted JSON files handles JSON parsing errors gracefully
       Failure/Error: Rails.logger.error "Error parsing #{file}: #{e.message}"

         #<ActiveSupport::Logger:0x00007f3e778f98e8 @level=0, @progname=nil, @default_formatter=#<Logger::Formatter:0x00007f3e778d9138 @datetime_format=nil>, @formatter=#<ActiveSupport::Logger::SimpleFormatter:0x00007f3e778d7108 @datetime_format=nil, @thread_key="activesupport_tagged_logging_tags:8640">, @logdev=#<Logger::LogDevice:0x00007f3e778eb2c0 @shift_period_suffix="%Y%m%d", @shift_size=1048576, @shift_age=0, @filename="/home/galaxy_game/log/development.log", @dev=#<File:/home/galaxy_game/log/development.log>, @binmode=false, @reraise_write_errors=[], @mon_data=#<Monitor:0x00007f3e778d9048>, @mon_data_owner_object_id=2824>, @level_override={}> received :error with unexpected arguments
           expected: (/Invalid JSON in file:/)
                got: ("Error parsing /tmp/d20260113-3943-qz96pi/corrupted.json: expected object key, got 'invalid json }")
         Diff:
         @@ -1 +1 @@
         -[/Invalid JSON in file:/]
         +["Error parsing /tmp/d20260113-3943-qz96pi/corrupted.json: expected object key, got 'invalid json }"]
       # ./app/services/lookup/material_lookup_service.rb:201:in 'block in Lookup::MaterialLookupService#load_json_files'
       # ./app/services/lookup/material_lookup_service.rb:195:in 'Array#map'
       # ./app/services/lookup/material_lookup_service.rb:195:in 'Lookup::MaterialLookupService#load_json_files'
       # ./spec/services/lookup/material_lookup_service_spec.rb:256:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # JSON::ParserError:
       #   expected object key, got 'invalid json }
       #   /usr/local/bundle/gems/json-2.10.2/lib/json/common.rb:248:in 'JSON::Ext::Parser.parse'

  582) Lookup::ModuleLookupService service configuration has the correct base path
       Failure/Error: expect(actual_path).to eq(expected_path)

         expected: "/home/galaxy_game/data/json-data/operational_data/modules"
              got: "/home/galaxy_game/app/data/operational_data/modules"

         (compared using ==)
       # ./spec/services/lookup/module_lookup_service_spec.rb:52:in 'block (3 levels) in <main>'

  583) Lookup::PlanetaryGeologicalFeatureLookupService#initialize initializes with a celestial body
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:21:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  584) Lookup::PlanetaryGeologicalFeatureLookupService#initialize loads features during initialization
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:27:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  585) Lookup::PlanetaryGeologicalFeatureLookupService#all_features returns all loaded features
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:55:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  586) Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles multiple JSON files
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:64:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  587) Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles single feature JSON files
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:81:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  588) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by exact name match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  589) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by case-insensitive name match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  590) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by lowercase name match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  591) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns nil when feature is not found
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  592) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name handles symbol input
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  593) Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns the first match when multiple features have the same name
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  594) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features of a specific type
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  595) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features by case-insensitive type match
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  596) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns empty array when no features of that type exist
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  597) Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type handles symbol input
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:179:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  598) Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary groups features by type
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:226:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  599) Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary handles features with nil type
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:226:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  600) Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary returns empty hash when no features exist
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:226:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  601) Lookup::PlanetaryGeologicalFeatureLookupService path construction constructs correct path for planet
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:260:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  602) Lookup::PlanetaryGeologicalFeatureLookupService error handling handles JSON parse errors gracefully
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:282:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  603) Lookup::PlanetaryGeologicalFeatureLookupService error handling logs debug information about found files
       Failure/Error: let(:earth) { create(:terrestrial_planet, :earth, solar_system: sol) }

       KeyError:
         Trait not registered: "earth"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:43:in 'FactoryBot::Internal.trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:160:in 'FactoryBot::Definition#trait_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'block in FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'Array#map'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:156:in 'FactoryBot::Definition#additional_traits'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:59:in 'block in FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/definition.rb:56:in 'FactoryBot::Definition#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:90:in 'FactoryBot::Factory#compile'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:35:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:297:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "earth"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  604) Lookup::UnitLookupService#find_unit finds units case-insensitively by ID
       Failure/Error: expect(unit_upper).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:109:in 'block (3 levels) in <main>'

  605) Lookup::UnitLookupService#find_unit with propulsion units finds propulsion units by their exact ID
       Failure/Error:
         expect(found_unit).to be_present,
           "Unit #{unit_id} not found. Check if '#{File.basename(propulsion_files.first)}' exists"

         Unit basic_engine not found. Check if 'basic_engine_data.json' exists
       # ./spec/services/lookup/unit_lookup_service_spec.rb:58:in 'block (4 levels) in <main>'

  606) Lookup::UnitLookupService#find_unit with propulsion units has expected propulsion unit properties
       Failure/Error: expect(propulsion_unit).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:67:in 'block (4 levels) in <main>'

  607) Lookup::UnitLookupService#find_unit with robot units finds robot units by their ID
       Failure/Error:
         expect(robot_unit).to be_present,
           "Robot unit #{unit_id} not found. Check its JSON file in #{GalaxyGame::Paths::ROBOTS_DEPLOYMENT_UNITS_PATH}"

         Robot unit car_300_deployment_robot_mk1 not found. Check its JSON file in /home/galaxy_game/app/data/operational_data/units/robots/deployment
       # ./spec/services/lookup/unit_lookup_service_spec.rb:97:in 'block (4 levels) in <main>'

  608) Lookup::UnitLookupService service configuration has all expected unit categories
       Failure/Error: expect(actual_categories).to match_array(expected_categories)

         expected collection contained:  ["communication", "computer", "construction", "control", "droid", "em_processing", "energy", "gravita...gistics", "robots_maintenance", "robots_resource", "sensors", "specialized", "storage", "structure"]
         actual collection contained:    ["computer", "droid", "energy", "habitats", "life_support", "processing", "production", "propulsion",... "robots_logistics", "robots_maintenance", "robots_resource", "specialized", "storage", "structure"]
         the missing elements were:      ["communication", "construction", "control", "em_processing", "gravitational_control", "infrastructure", "power", "resource", "sensors"]
       # ./spec/services/lookup/unit_lookup_service_spec.rb:132:in 'block (3 levels) in <main>'

  609) Lookup::UnitLookupService matching behavior matches by exact ID
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:219:in 'block (3 levels) in <main>'

  610) Lookup::UnitLookupService matching behavior matches by exact name
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:224:in 'block (3 levels) in <main>'

  611) Lookup::UnitLookupService matching behavior matches by partial ID with sufficient length
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:231:in 'block (3 levels) in <main>'

  612) Lookup::UnitLookupService matching behavior is case insensitive
       Failure/Error: expect(result).to be_present
         expected `nil.present?` to be truthy, got false
       # ./spec/services/lookup/unit_lookup_service_spec.rb:235:in 'block (3 levels) in <main>'

  613) ManufacturingService.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  614) ManufacturingService.manufacture with real blueprints works with different blueprint categories
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  615) ManufacturingService.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  616) ManufacturingService.manufacture with different construction cost percentages uses settlement's custom construction percentage
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  617) ManufacturingService.manufacture with real blueprint data creates material requests based on actual blueprint requirements
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  618) ManufacturingService.manufacture with real blueprint data automatically fulfills material requirements when materials are available
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  619) ManufacturingService.manufacture with real blueprint data stores actual blueprint data in specifications
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  620) ManufacturingService.manufacture with invalid blueprint returns failure when blueprint not found
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manfacturing_service_spec.rb:38:in 'block (2 levels) in <main>'

  621) Manufacturing::AssemblyService.start_assembly with all materials available charges the tenant fee
       Failure/Error: expect(player.account.reload.balance).to eq(initial_player_balance)

         expected: 0.1e4
              got: 0.964e3

         (compared using ==)
       # ./spec/services/manufacturing/assembly_service_spec.rb:70:in 'block (4 levels) in <main>'

  622) Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) creates a production job using real blueprint
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/manufacturing/component_production_integration_spec.rb:58:in 'block (4 levels) in <main>'

  623) Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) consumes depleted_regolith from inventory
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/manufacturing/component_production_integration_spec.rb:58:in 'block (4 levels) in <main>'

  624) Manufacturing::Construction::CoveringService#initialize initializes with coverable, panel type, and settlement
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:11:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  625) Manufacturing::Construction::CoveringService#initialize uses default panel type if not provided
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:19:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  626) Manufacturing::Construction::CoveringService#initialize finds settlement from coverable if not provided
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  627) Manufacturing::Construction::CoveringService#calculate_materials calculates base materials using CoveringCalculator
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:34:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  628) Manufacturing::Construction::CoveringService#calculate_materials merges panel-specific materials
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:52:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  629) Manufacturing::Construction::CoveringService#calculate_materials sums quantities for duplicate materials
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:65:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  630) Manufacturing::Construction::CoveringService#schedule_construction returns error if no settlement
       Failure/Error: coverable_without_settlement = create(:crater_dome, name: 'Unique Test Dome', settlement: nil)

       ActiveRecord::NotNullViolation:
         PG::NotNullViolation: ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
         DETAIL:  Failing row contains (545, Unique Test Dome, Crater Dome, null, null, Player, 3003, null, Location::CelestialLocation, 2127, 0, {"status": "planned", "dimensions": {"depth": 30.0, "diameter": ..., 2026-01-13 04:23:19.714504, 2026-01-13 04:23:19.714504, null, null, 0, 0).
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:86:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # PG::NotNullViolation:
       #   ERROR:  null value in column "structure_type" of relation "structures" violates not-null constraint
       #   DETAIL:  Failing row contains (545, Unique Test Dome, Crater Dome, null, null, Player, 3003, null, Location::CelestialLocation, 2127, 0, {"status": "planned", "dimensions": {"depth": 30.0, "diameter": ..., 2026-01-13 04:23:19.714504, 2026-01-13 04:23:19.714504, null, null, 0, 0).
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'

  631) Manufacturing::Construction::CoveringService#schedule_construction returns error if no blueprint found
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:95:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  632) Manufacturing::Construction::CoveringService#schedule_construction creates a construction job
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:105:in 'block (4 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:104:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  633) Manufacturing::Construction::CoveringService#schedule_construction creates material requests
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:111:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  634) Manufacturing::Construction::CoveringService#schedule_construction creates equipment requests
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:116:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  635) Manufacturing::Construction::CoveringService#schedule_construction updates coverable status to materials_requested
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:120:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  636) Manufacturing::Construction::CoveringService#schedule_construction returns success with construction job
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:125:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  637) Manufacturing::Construction::CoveringService#start_construction returns false if materials not gathered
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:143:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  638) Manufacturing::Construction::CoveringService#start_construction returns false if equipment not gathered
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:148:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  639) Manufacturing::Construction::CoveringService#start_construction updates job status to in_progress
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:155:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  640) Manufacturing::Construction::CoveringService#start_construction assigns builders through ConstructionManager
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:164:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  641) Manufacturing::Construction::CoveringService#start_construction updates coverable status to under_construction
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:137:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:172:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  642) Manufacturing::Construction::CoveringService#track_progress returns false if job not in progress
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:185:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:192:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  643) Manufacturing::Construction::CoveringService#track_progress returns false if construction not complete
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:182:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:198:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  644) Manufacturing::Construction::CoveringService#track_progress completes construction when work is done
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:185:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:205:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  645) Manufacturing::Construction::CoveringService#track_progress updates coverable status
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:213:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  646) Manufacturing::Construction::CoveringService#track_progress releases equipment
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:185:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:220:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  647) Manufacturing::Construction::CoveringService#track_progress returns true when complete
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:7:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:182:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/covering_service_spec.rb:228:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  648) Manufacturing::Construction::DomeService#initialize initializes with default panel type
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  649) Manufacturing::Construction::DomeService#initialize initializes with custom panel type
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  650) Manufacturing::Construction::DomeService#initialize defaults service provider to entity
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  651) Manufacturing::Construction::DomeService#schedule_construction creates a construction job successfully
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  652) Manufacturing::Construction::DomeService#schedule_construction fails when no settlement found
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  653) Manufacturing::Construction::DomeService#schedule_construction creates material and equipment requests for player construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  654) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider processes payment for contracted construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  655) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider does not create material requests for contracted construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  656) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider marks materials and equipment as provided by contractor
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  657) Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider handles payment failure gracefully
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  658) Manufacturing::Construction::DomeService#start_construction starts construction when materials and equipment are ready
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  659) Manufacturing::Construction::DomeService#start_construction fails when materials not ready for player construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  660) Manufacturing::Construction::DomeService#start_construction bypasses checks for contracted construction
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  661) Manufacturing::Construction::DomeService#track_progress completes construction when work is finished
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  662) Manufacturing::Construction::DomeService#track_progress returns false when construction not complete
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  663) Manufacturing::Construction::DomeService#track_progress sets correct status for different layer types
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  664) Manufacturing::Construction::DomeService#track_progress releases equipment when construction completes
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  665) Manufacturing::Construction::DomeService#complete_construction completes the construction process
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  666) Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for primary layer
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  667) Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for secondary layer
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  668) Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for both layers
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  669) Manufacturing::Construction::DomeService private methods #determine_completion_status returns operational for unknown layer types
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  670) Manufacturing::Construction::DomeService private methods #is_player_construction? returns true when entity and provider are the same
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  671) Manufacturing::Construction::DomeService private methods #is_player_construction? returns false when entity and provider are different
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Jezero Base", 
           location: crater_location,
           owner: player,
           settlement_type: :base,
           current_population: 10
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/dome_service_spec.rb:18:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  672) Manufacturing::Construction::HangarService#initialize initializes with default hangar type
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  673) Manufacturing::Construction::HangarService#initialize initializes with custom hangar type
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  674) Manufacturing::Construction::HangarService#initialize raises error for non-large access points
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  675) Manufacturing::Construction::HangarService#schedule_construction creates a hangar structure successfully
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  676) Manufacturing::Construction::HangarService#schedule_construction creates a construction job
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  677) Manufacturing::Construction::HangarService#schedule_construction connects the access point to the hangar
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  678) Manufacturing::Construction::HangarService#schedule_construction fails when no settlement found
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  679) Manufacturing::Construction::HangarService#schedule_construction fails when no blueprint found
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  680) Manufacturing::Construction::HangarService#schedule_construction creates material and equipment requests
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  681) Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for standard rover hangar
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  682) Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for large craft hangar
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  683) Manufacturing::Construction::HangarService#start_construction starts construction when materials and equipment are ready
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  684) Manufacturing::Construction::HangarService#start_construction fails when materials not ready
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  685) Manufacturing::Construction::HangarService#start_construction fails when equipment not ready
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  686) Manufacturing::Construction::HangarService#track_progress completes construction when work is finished
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  687) Manufacturing::Construction::HangarService#track_progress returns false when construction not complete
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  688) Manufacturing::Construction::HangarService#track_progress releases equipment when construction completes
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  689) Manufacturing::Construction::HangarService#calculate_materials calculates materials for standard rover hangar
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  690) Manufacturing::Construction::HangarService#calculate_materials calculates materials for large craft hangar
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  691) Manufacturing::Construction::HangarService#calculate_materials merges blueprint materials with specific materials
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  692) Manufacturing::Construction::HangarService#calculate_construction_time calculates base time for standard hangar
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  693) Manufacturing::Construction::HangarService#calculate_construction_time calculates longer time for large craft hangar
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  694) Manufacturing::Construction::HangarService#calculate_equipment_requirements calculates equipment requirements
       Failure/Error:
         create(:settlement, 
           :independent,
           name: "Olympus Base", 
           location: location,
           owner: player
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/hangar_service_spec.rb:16:in 'block (2 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  695) Manufacturing::Construction::SegmentCoveringService#initialize uses modular_structural_panel as default
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:19:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  696) Manufacturing::Construction::SegmentCoveringService#initialize finds settlement from worldhouse
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  697) Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials calculates worldhouse-scale materials
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:33:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  698) Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials includes cable calculations for massive segments
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:41:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  699) Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials scales materials by panel count
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:52:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  700) Manufacturing::Construction::SegmentCoveringService#complexity_factor returns 1.5 base factor for worldhouse
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:62:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  701) Manufacturing::Construction::SegmentCoveringService#complexity_factor increases factor for very large segments
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:67:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  702) Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires minimum 10 printers for worldhouse
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:78:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  703) Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires heavy equipment
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:85:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  704) Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements scales equipment for massive segments
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:75:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:92:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  705) Manufacturing::Construction::SegmentCoveringService#schedule_construction creates construction phases for large segments
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  706) Manufacturing::Construction::SegmentCoveringService#schedule_construction includes phase names and durations
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:10:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:105:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  707) Manufacturing::Construction::SkylightService#initialize uses skylight-specific default panel type
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:19:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  708) Manufacturing::Construction::SkylightService#initialize finds settlement from lava tube
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:24:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  709) Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates transparent panel materials
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:33:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  710) Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates solar panel materials
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:41:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  711) Manufacturing::Construction::SkylightService#calculate_panel_specific_materials scales materials by panel count
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:30:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:51:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  712) Manufacturing::Construction::SkylightService#complexity_factor returns 1.0 for basic transparent panels
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:60:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  713) Manufacturing::Construction::SkylightService#complexity_factor returns 1.5 for solar panels
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:65:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  714) Manufacturing::Construction::SkylightService#complexity_factor returns 1.3 for thermal insulation
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:70:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  715) Manufacturing::Construction::SkylightService#determine_completion_status returns primary_cover for basic transparent
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:76:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:79:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  716) Manufacturing::Construction::SkylightService#determine_completion_status returns solar_cover for solar panels
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:76:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:84:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  717) Manufacturing::Construction::SkylightService#determine_completion_status returns full_cover for structural on primary cover
       Failure/Error: let(:settlement) { create(:settlement) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:12:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/construction/skylight_service_spec.rb:89:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  718) Manufacturing::CostCalculator Earth-Imported COGS (EAP-COGS) calculates the EAP-COGS (Earth Import Cost) for the unit
       Failure/Error: base_efficiency = @blueprint.dig('production_data', 'base_material_efficiency') || @blueprint['waste_factor'] ? (1.0 - @blueprint['waste_factor']) : 1.0

       TypeError:
         nil can't be coerced into Float
       # ./app/services/manufacturing/cost_calculator.rb:83:in 'Float#-'
       # ./app/services/manufacturing/cost_calculator.rb:83:in 'Manufacturing::CostCalculator#print_breakdown'
       # ./spec/services/manufacturing/cost_calculator_spec.rb:68:in 'block (3 levels) in <main>'

  719) Manufacturing::CostCalculator Local Production COGS (LAP-COGS) calculates the LAP-COGS (Local Production Cost) for the unit
       Failure/Error: base_efficiency = @blueprint.dig('production_data', 'base_material_efficiency') || @blueprint['waste_factor'] ? (1.0 - @blueprint['waste_factor']) : 1.0

       TypeError:
         nil can't be coerced into Float
       # ./app/services/manufacturing/cost_calculator.rb:83:in 'Float#-'
       # ./app/services/manufacturing/cost_calculator.rb:83:in 'Manufacturing::CostCalculator#print_breakdown'
       # ./spec/services/manufacturing/cost_calculator_spec.rb:89:in 'block (3 levels) in <main>'

  720) Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs creates a material processing job record
       Failure/Error:
         Item.create!(
           inventory: @settlement.inventory,
           name: "inert_regolith_waste",
           amount: inert_waste_produced,
           owner: @settlement.owner,
           storage_method: 'bulk_storage',
           metadata: inert_metadata
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/services/manufacturing/material_processing_service.rb:158:in 'block in Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
       # ./app/services/manufacturing/material_processing_service.rb:142:in 'Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
       # ./app/services/manufacturing/material_processing_service.rb:101:in 'Manufacturing::MaterialProcessingService#complete_job'
       # ./app/models/material_processing_job.rb:53:in 'MaterialProcessingJob#complete!'
       # ./app/models/material_processing_job.rb:44:in 'MaterialProcessingJob#process_tick'
       # ./spec/services/manufacturing/material_processing_service_spec.rb:105:in 'block (4 levels) in <main>'
       # ./spec/services/manufacturing/material_processing_service_spec.rb:9:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/material_processing_service_spec.rb:8:in 'block (2 levels) in <main>'

  721) Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs produces gases with correct composition after job completion
       Failure/Error:
         Item.create!(
           inventory: @settlement.inventory,
           name: "inert_regolith_waste",
           amount: inert_waste_produced,
           owner: @settlement.owner,
           storage_method: 'bulk_storage',
           metadata: inert_metadata
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/services/manufacturing/material_processing_service.rb:158:in 'block in Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
       # ./app/services/manufacturing/material_processing_service.rb:142:in 'Manufacturing::MaterialProcessingService#complete_volatiles_extraction'
       # ./app/services/manufacturing/material_processing_service.rb:101:in 'Manufacturing::MaterialProcessingService#complete_job'
       # ./app/models/material_processing_job.rb:53:in 'MaterialProcessingJob#complete!'
       # ./app/models/material_processing_job.rb:44:in 'MaterialProcessingJob#process_tick'
       # ./spec/services/manufacturing/material_processing_service_spec.rb:113:in 'block (4 levels) in <main>'
       # ./spec/services/manufacturing/material_processing_service_spec.rb:9:in 'block (3 levels) in <main>'
       # ./spec/services/manufacturing/material_processing_service_spec.rb:8:in 'block (2 levels) in <main>'

  722) Manufacturing::MaterialRequest.create_material_requests creates requests for all required materials
       Failure/Error: let(:construction_job) { create(:construction_job, blueprint: blueprint) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/manufacturing/material_request_system_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/material_request_system_spec.rb:9:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  723) Manufacturing::Processing#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
       Failure/Error: celestial_location = CelestialLocation.find_by(name: @owner.active_location)

       NameError:
         uninitialized constant Manufacturing::Processing::CelestialLocation
       # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'
       # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'
       # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'
       # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'
       # ./spec/services/manufacturing/processing_spec.rb:102:in 'block (4 levels) in <main>'

  724) Manufacturing::Processing#process when owner does not have enough resources returns an error when resources are insufficient
       Failure/Error:
         expect {
           service.process
         }.to raise_error(RuntimeError, /Insufficient resources: Steel/)

         expected RuntimeError with message matching /Insufficient resources: Steel/, got #<NameError: uninitialized constant Manufacturing::Processing::CelestialLocation> with backtrace:
           # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'
           # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'
           # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'
           # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'
           # ./spec/services/manufacturing/processing_spec.rb:116:in 'block (5 levels) in <main>'
           # ./spec/services/manufacturing/processing_spec.rb:115:in 'block (4 levels) in <main>'
       # ./spec/services/manufacturing/processing_spec.rb:115:in 'block (4 levels) in <main>'

  725) Manufacturing::Processing#process when owner does not have enough GCC raises an error when GCC is insufficient
       Failure/Error:
         expect {
           service.process
         }.to raise_error(RuntimeError, "Insufficient GCC")

         expected RuntimeError with "Insufficient GCC", got #<NameError: uninitialized constant Manufacturing::Processing::CelestialLocation> with backtrace:
           # ./app/services/manufacturing/processing.rb:58:in 'Manufacturing::Processing#find_owners_current_location'
           # ./app/services/manufacturing/processing.rb:13:in 'Manufacturing::Processing#initialize'
           # ./spec/services/manufacturing/processing_spec.rb:97:in 'Class#new'
           # ./spec/services/manufacturing/processing_spec.rb:97:in 'block (2 levels) in <main>'
           # ./spec/services/manufacturing/processing_spec.rb:128:in 'block (5 levels) in <main>'
           # ./spec/services/manufacturing/processing_spec.rb:127:in 'block (4 levels) in <main>'
       # ./spec/services/manufacturing/processing_spec.rb:127:in 'block (4 levels) in <main>'

  726) Manufacturing::Service.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  727) Manufacturing::Service.manufacture with real blueprints works with different blueprint categories
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  728) Manufacturing::Service.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  729) Manufacturing::Service.manufacture with different construction cost percentages uses settlement's custom construction percentage
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  730) Manufacturing::Service.manufacture with real blueprint data creates material requests based on actual blueprint requirements
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  731) Manufacturing::Service.manufacture with real blueprint data automatically fulfills material requirements when materials are available
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  732) Manufacturing::Service.manufacture with real blueprint data stores actual blueprint data in specifications
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  733) Manufacturing::Service.manufacture with invalid blueprint returns failure when blueprint not found
       Failure/Error:
         settlement.inventory.items.create!(
           name: 'precision_components',
           amount: 200,
           owner: player,
           material_type: 'component'
         )

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./spec/services/manufacturing/service_spec.rb:38:in 'block (2 levels) in <main>'

  734) Market::TradeExecutionService returns true on successful execution
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  735) Market::TradeExecutionService calls the TaxCollectionService with gross revenue and seller
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  736) Market::TradeExecutionService calls TransactionManager.create_transfer with the NET amount
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  737) Market::TradeExecutionService removes inventory from seller
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  738) Market::TradeExecutionService creates a trade record
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  739) Market::TradeExecutionService creates a price history record
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  740) Market::TradeExecutionService creates a supply chain record
       Failure/Error: unless Organizations::Corporation.method_defined?(:remove_inventory)

       NameError:
         uninitialized constant Organizations::Corporation
       # ./spec/services/market/trade_execution_service_spec.rb:7:in 'block (2 levels) in <main>'

  741) MaterialLookupService#find_material returns the correct material
       Failure/Error: item = items.find { |i| i['chemical_formula'].casecmp?(name) }

       NoMethodError:
         undefined method 'casecmp?' for nil
       # ./app/services/material_lookup_service.rb:14:in 'block (2 levels) in MaterialLookupService#find_material'
       # ./app/services/material_lookup_service.rb:14:in 'Array#each'
       # ./app/services/material_lookup_service.rb:14:in 'Enumerable#find'
       # ./app/services/material_lookup_service.rb:14:in 'block in MaterialLookupService#find_material'
       # ./app/services/material_lookup_service.rb:8:in 'Hash#each'
       # ./app/services/material_lookup_service.rb:8:in 'MaterialLookupService#find_material'
       # ./spec/services/material_lookup_service_spec.rb:17:in 'block (3 levels) in <main>'

  742) MaterialLookupService#find_material returns nil for a nonexistent material
       Failure/Error: item = items.find { |i| i['chemical_formula'].casecmp?(name) }

       NoMethodError:
         undefined method 'casecmp?' for nil
       # ./app/services/material_lookup_service.rb:14:in 'block (2 levels) in MaterialLookupService#find_material'
       # ./app/services/material_lookup_service.rb:14:in 'Array#each'
       # ./app/services/material_lookup_service.rb:14:in 'Enumerable#find'
       # ./app/services/material_lookup_service.rb:14:in 'block in MaterialLookupService#find_material'
       # ./app/services/material_lookup_service.rb:8:in 'Hash#each'
       # ./app/services/material_lookup_service.rb:8:in 'MaterialLookupService#find_material'
       # ./spec/services/material_lookup_service_spec.rb:22:in 'block (3 levels) in <main>'

  743) MaterialRequestService.create_material_requests creates requests for all required materials
       Failure/Error: let(:construction_job) { create(:construction_job, blueprint: blueprint) }

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/material_request_service_spec.rb:5:in 'block (2 levels) in <main>'
       # ./spec/services/material_request_service_spec.rb:9:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  744) Naming::PlanetNameService#add_suffix_to_name adds a suffix to the base name
       Failure/Error: expect(result).to eq("Aurelion I")

         expected: "Aurelion I"
              got: "Aurelion II"

         (compared using ==)
       # ./spec/services/naming/planet_name_service_spec.rb:92:in 'block (3 levels) in <main>'

  745) Pressurization::HabitatPressurizationService#calculate_habitat_volume calculates correct volume for crater dome
       Failure/Error: dome = build(:crater_dome)

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:5:in 'FactoryBot::Strategy::Build#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/build.rb:9:in 'FactoryBot::Strategy::Build#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization/habitat_pressurization_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/pressurization/habitat_pressurization_service_spec.rb:20:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  746) Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available sources gases from depot tanks
       Failure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }

       KeyError:
         Factory not registered: "depot_tank"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization/structure_pressurization_service_spec.rb:10:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "depot_tank"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  747) Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available uses depot tank gases for pressurization
       Failure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }

       KeyError:
         Factory not registered: "depot_tank"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization/structure_pressurization_service_spec.rb:10:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "depot_tank"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  748) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks aggregates gases from all depot tanks
       Failure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }

       KeyError:
         Factory not registered: "depot_tank"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization/structure_pressurization_service_spec.rb:48:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "depot_tank"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  749) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks returns empty hash when no gases are stored
       Failure/Error: let!(:depot_tank1) { create(:depot_tank, settlement: settlement) }

       KeyError:
         Factory not registered: "depot_tank"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization/structure_pressurization_service_spec.rb:48:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "depot_tank"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  750) Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when depot tanks have no gas_storage data returns empty hash
       Failure/Error: let!(:depot_tank) { create(:depot_tank, settlement: settlement) }

       KeyError:
         Factory not registered: "depot_tank"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization/structure_pressurization_service_spec.rb:83:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "depot_tank"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  751) Pressurization::StructurePressurizationService mining byproduct integration when mining Si produces O2 byproduct increases available gases from depot tanks for pressurization
       Failure/Error: let!(:depot_tank) { create(:depot_tank, settlement: settlement) }

       KeyError:
         Factory not registered: "depot_tank"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization/structure_pressurization_service_spec.rb:100:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "depot_tank"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  752) PressurizationService#check_sealing_status with traditional sealed environment returns ready for sealed environment
       Failure/Error: result = service.check_sealing_status

       NoMethodError:
         undefined method 'check_sealing_status' for an instance of PressurizationService
       # ./spec/services/pressurization_service_spec.rb:26:in 'block (4 levels) in <main>'

  753) PressurizationService#check_sealing_status with traditional sealed environment returns not ready for unsealed environment
       Failure/Error: result = service.check_sealing_status

       NoMethodError:
         undefined method 'check_sealing_status' for an instance of PressurizationService
       # ./spec/services/pressurization_service_spec.rb:32:in 'block (4 levels) in <main>'

  754) PressurizationService#check_sealing_status with pressurization target (lava tube) returns not ready when requirements not met
       Failure/Error:
         create(:lava_tube,
           operational_data: {
             'pressurization_requirements' => { 'plugs' => 2, 'domes' => 1 },
             'pressurization_progress' => {
               'seals' => { 'plugs' => 1, 'domes' => 0 }
             }
           }
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization_service_spec.rb:40:in 'block (4 levels) in <main>'
       # ./spec/services/pressurization_service_spec.rb:63:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  755) PressurizationService#check_sealing_status with pressurization target (lava tube) returns ready when requirements met
       Failure/Error:
         create(:lava_tube,
           operational_data: {
             'pressurization_requirements' => { 'plugs' => 2, 'domes' => 1 },
             'pressurization_progress' => {
               'seals' => { 'plugs' => 2, 'domes' => 1 },
               'ready_for_pressurization' => true
             }
           }
         )

       KeyError:
         Factory not registered: "settlement"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:5:in 'FactoryBot::Strategy::Create#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:33:in 'FactoryBot::Evaluator#association'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute/association.rb:19:in 'block in FactoryBot::Attribute::Association#to_proc'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'BasicObject#instance_exec'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluator.rb:75:in 'block in define_attribute'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:59:in 'FactoryBot::AttributeAssigner#get'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:16:in 'block (2 levels) in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'Array#each'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:15:in 'block in FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/attribute_assigner.rb:14:in 'FactoryBot::AttributeAssigner#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:10:in 'FactoryBot::Evaluation#object'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/pressurization_service_spec.rb:51:in 'block (4 levels) in <main>'
       # ./spec/services/pressurization_service_spec.rb:70:in 'block (4 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "settlement"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  756) PressurizationService#check_sealing_status with pressurization target (canyon) returns not ready when requirements not met
       Failure/Error: @atmosphere = environment.atmospheric_data

       NoMethodError:
         undefined method 'atmospheric_data' for an instance of CelestialBodies::Features::Canyon
       # ./app/models/pressurization_service.rb:5:in 'PressurizationService#initialize'
       # ./spec/services/pressurization_service_spec.rb:89:in 'Class#new'
       # ./spec/services/pressurization_service_spec.rb:89:in 'block (4 levels) in <main>'

  757) ProcessingService#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
       Failure/Error: celestial_location = CelestialLocation.find_by(name: @owner.active_location)

       NameError:
         uninitialized constant ProcessingService::CelestialLocation
       # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'
       # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'
       # ./spec/services/processing_service_spec.rb:97:in 'Class#new'
       # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'
       # ./spec/services/processing_service_spec.rb:102:in 'block (4 levels) in <main>'

  758) ProcessingService#process when owner does not have enough resources returns an error when resources are insufficient
       Failure/Error:
         expect {
           service.process
         }.to raise_error(RuntimeError, /Insufficient resources: Steel/)

         expected RuntimeError with message matching /Insufficient resources: Steel/, got #<NameError: uninitialized constant ProcessingService::CelestialLocation> with backtrace:
           # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'
           # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'
           # ./spec/services/processing_service_spec.rb:97:in 'Class#new'
           # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'
           # ./spec/services/processing_service_spec.rb:116:in 'block (5 levels) in <main>'
           # ./spec/services/processing_service_spec.rb:115:in 'block (4 levels) in <main>'
       # ./spec/services/processing_service_spec.rb:115:in 'block (4 levels) in <main>'

  759) ProcessingService#process when owner does not have enough GCC raises an error when GCC is insufficient
       Failure/Error:
         expect {
           service.process
         }.to raise_error(RuntimeError, "Insufficient GCC")

         expected RuntimeError with "Insufficient GCC", got #<NameError: uninitialized constant ProcessingService::CelestialLocation> with backtrace:
           # ./app/services/processing_service.rb:58:in 'ProcessingService#find_owners_current_location'
           # ./app/services/processing_service.rb:13:in 'ProcessingService#initialize'
           # ./spec/services/processing_service_spec.rb:97:in 'Class#new'
           # ./spec/services/processing_service_spec.rb:97:in 'block (2 levels) in <main>'
           # ./spec/services/processing_service_spec.rb:128:in 'block (5 levels) in <main>'
           # ./spec/services/processing_service_spec.rb:127:in 'block (4 levels) in <main>'
       # ./spec/services/processing_service_spec.rb:127:in 'block (4 levels) in <main>'

  760) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests terraformed names for template-based planets
       Failure/Error:
         count.times do |i|
           @planet_counter += 1
           moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
           moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
           
           # Moons are smaller, with random sizes
           mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
           radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
           
           volume = (4.0/3.0) * Math::PI * (radius ** 3)

       NoMethodError:
         undefined method 'times' for an instance of Float
       # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
       # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./spec/services/star_sim/procedural_generator_spec.rb:166:in 'block (4 levels) in <main>'

  761) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests neutral names for procedural planets
       Failure/Error:
         count.times do |i|
           @planet_counter += 1
           moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
           moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
           
           # Moons are smaller, with random sizes
           mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
           radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
           
           volume = (4.0/3.0) * Math::PI * (radius ** 3)

       NoMethodError:
         undefined method 'times' for an instance of Float
       # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
       # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./spec/services/star_sim/procedural_generator_spec.rb:178:in 'block (4 levels) in <main>'

  762) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates applies orbital optimization for template-based planets
       Failure/Error:
         count.times do |i|
           @planet_counter += 1
           moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
           moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
           
           # Moons are smaller, with random sizes
           mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
           radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
           
           volume = (4.0/3.0) * Math::PI * (radius ** 3)

       NoMethodError:
         undefined method 'times' for an instance of Float
       # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
       # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./spec/services/star_sim/procedural_generator_spec.rb:196:in 'block (4 levels) in <main>'

  763) StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates generates procedural planets when not using templates
       Failure/Error:
         count.times do |i|
           @planet_counter += 1
           moon_name = "#{planet_data['name']} #{roman_numeral(i + 1)}"
           moon_identifier = "#{planet_data['identifier']}-MOON-#{i + 1}"
           
           # Moons are smaller, with random sizes
           mass = rand(0.0001..0.1) * 7.34e22  # Up to 0.1 lunar masses
           radius = rand(0.1..1.5) * 1.738e6   # Up to 1.5 lunar radii
           
           volume = (4.0/3.0) * Math::PI * (radius ** 3)

       NoMethodError:
         undefined method 'times' for an instance of Float
       # ./app/services/star_sim/procedural_generator.rb:1000:in 'StarSim::ProceduralGenerator#generate_moons_for_planet'
       # ./app/services/star_sim/procedural_generator.rb:440:in 'block in StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./app/services/star_sim/procedural_generator.rb:382:in 'StarSim::ProceduralGenerator#generate_terrestrial_planets'
       # ./spec/services/star_sim/procedural_generator_spec.rb:204:in 'block (4 levels) in <main>'

  764) StarSim::ProceduralGenerator#generate_biosphere_data provides enhanced biosphere for template-based planets
       Failure/Error: expect(result[:biodiversity_index]).to be > 0

         expected: > 0
              got:   nil
       # ./spec/services/star_sim/procedural_generator_spec.rb:324:in 'block (3 levels) in <main>'

  765) StarSim::ProceduralGenerator#generate_biosphere_data provides basic biosphere for planets with good conditions
       Failure/Error: expect(result[:biodiversity_index]).to be >= 0

         expected: >= 0
              got:    nil
       # ./spec/services/star_sim/procedural_generator_spec.rb:338:in 'block (3 levels) in <main>'

  766) StarSim::ProceduralGenerator#generate_biosphere_data returns empty biosphere for unsuitable planets
       Failure/Error: expect(result[:biodiversity_index]).to eq(0.0)

         expected: 0.0
              got: nil

         (compared using ==)
       # ./spec/services/star_sim/procedural_generator_spec.rb:350:in 'block (3 levels) in <main>'

  767) StarSim::ProceduralGenerator integration test generates a complete, valid system
       Failure/Error: expect(planet).to have_key(:biosphere)
         expected `{"albedo" => 0.5773228004189769, :atmosphere => {"composition" => {"N2" => {"percentage" => 78.0}, "O... "size" => 0.7270206966690276, "surface_temperature" => 309.94282925336495, "type" => "terrestrial"}.has_key?(:biosphere)` to be truthy, got false
       # ./spec/services/star_sim/procedural_generator_spec.rb:469:in 'block (4 levels) in <main>'
       # ./spec/services/star_sim/procedural_generator_spec.rb:455:in 'Array#each'
       # ./spec/services/star_sim/procedural_generator_spec.rb:455:in 'block (3 levels) in <main>'

  768) TerraSim::AtmosphereSimulationService#initialize initializes with a celestial body
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:24:in 'block (3 levels) in <main>'

  769) TerraSim::AtmosphereSimulationService#initialize sets up the Stefan-Boltzmann constant
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:28:in 'block (3 levels) in <main>'

  770) TerraSim::AtmosphereSimulationService#simulate updates the pressure
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  771) TerraSim::AtmosphereSimulationService#simulate calculates the greenhouse effect
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  772) TerraSim::AtmosphereSimulationService#simulate updates temperature data in the atmosphere
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  773) TerraSim::AtmosphereSimulationService#simulate simulates atmospheric loss
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  774) TerraSim::AtmosphereSimulationService#simulate decreases dust
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:41:in 'block (3 levels) in <main>'

  775) TerraSim::AtmosphereSimulationService temperature calculation methods calculates stefan_boltzmann_temp correctly
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:91:in 'block (3 levels) in <main>'

  776) TerraSim::AtmosphereSimulationService temperature calculation methods calculates greenhouse_adjusted_temp correctly
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:91:in 'block (3 levels) in <main>'

  777) TerraSim::AtmosphereSimulationService temperature calculation methods calculates water_vapor_pressure correctly
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:91:in 'block (3 levels) in <main>'

  778) TerraSim::AtmosphereSimulationService#update_temperatures updates all temperature types in atmosphere
       Failure/Error: create(:gas, atmosphere: atmosphere, name: 'CH4', percentage: 0.0002, mass: 3.7e12)

       ActiveRecord::RecordInvalid:
         Validation failed: Molar mass is not a number, Molar mass can't be blank
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:14:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:20:in 'block (2 levels) in <main>'
       # ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:124:in 'block (3 levels) in <main>'

  779) TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants FIXED
       Expected pending 'ice_tectonics_enabled attribute doesn't exist in Geosphere model' to fail. No error was raised.
       # ./spec/services/terra_sim/geosphere_initializer_spec.rb:88

  780) TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for planets with atmospheres
       Failure/Error: allow_any_instance_of(TerraSim::GeosphereInitializer).to receive(:determine_regolith_depth).and_return(3.0)
         TerraSim::GeosphereInitializer does not implement #determine_regolith_depth
       # ./spec/services/terra_sim/geosphere_initializer_spec.rb:155:in 'block (3 levels) in <main>'

  781) TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for airless bodies
       Failure/Error: allow_any_instance_of(TerraSim::GeosphereInitializer).to receive(:determine_regolith_depth).and_return(3.0)
         TerraSim::GeosphereInitializer does not implement #determine_regolith_depth
       # ./spec/services/terra_sim/geosphere_initializer_spec.rb:155:in 'block (3 levels) in <main>'

  782) TerraSim::GeosphereSimulationService#simulate_tectonic_activity updates plate positions when tectonic activity is enabled
       Failure/Error: if @geosphere.ice_tectonic_enabled

       NoMethodError:
         private method 'ice_tectonic_enabled' called for #<CelestialBodies::Spheres::Geosphere:0x00007f3e562f3848>
       # ./app/services/terra_sim/geosphere_simulation_service.rb:56:in 'TerraSim::GeosphereSimulationService#simulate_tectonic_activity'
       # ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:52:in 'block (3 levels) in <main>'

  783) TradeService#dynamic_price calculates the dynamic price based on scarcity, transportation, and market conditions
       Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

       ActiveRecord::RecordInvalid:
         Validation failed: Colony must have at least two settlements
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:12:in 'block (3 levels) in <main>'

  784) TradeService#base_price_for_type returns the correct base price for raw materials
       Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

       ActiveRecord::RecordInvalid:
         Validation failed: Colony must have at least two settlements
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:28:in 'block (3 levels) in <main>'

  785) TradeService#base_price_for_type returns the correct base price for processed goods
       Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

       ActiveRecord::RecordInvalid:
         Validation failed: Colony must have at least two settlements
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:33:in 'block (3 levels) in <main>'

  786) TradeService#fuel_cost_per_unit returns the correct fuel cost per unit
       Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

       ActiveRecord::RecordInvalid:
         Validation failed: Colony must have at least two settlements
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:41:in 'block (3 levels) in <main>'

  787) TradeService#distance_to_buyer calculates the distance between colonies
       Failure/Error: planet_a = create(:planet, distance_from: 10000)

       KeyError:
         Factory not registered: "planet"
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/decorator.rb:10:in 'FactoryBot::Decorator#method_missing'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/internal.rb:70:in 'FactoryBot::Internal.factory_by_name'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:12:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/trade_service_spec.rb:48:in 'block (3 levels) in <main>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "planet"
       #   /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/registry.rb:23:in 'FactoryBot::Registry#find'

  788) TradeService#market_conditions returns a random market condition modifier
       Failure/Error: let(:colony) { create(:colony, name: 'Colony A') }

       ActiveRecord::RecordInvalid:
         Validation failed: Colony must have at least two settlements
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/evaluation.rb:15:in 'FactoryBot::Evaluation#create'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:12:in 'block in FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy/create.rb:9:in 'FactoryBot::Strategy::Create#result'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory.rb:46:in 'FactoryBot::Factory#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:29:in 'block in FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/factory_runner.rb:28:in 'FactoryBot::FactoryRunner#run'
       # /usr/local/bundle/gems/factory_bot-6.5.1/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in 'block in FactoryBot::Syntax::Methods#define_singular_strategy_method'
       # ./spec/services/trade_service_spec.rb:6:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:8:in 'block (2 levels) in <main>'
       # ./spec/services/trade_service_spec.rb:60:in 'block (3 levels) in <main>'

  789) UnitModuleAssemblyService.build_units_and_modules creates units from the recommended fit
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  790) UnitModuleAssemblyService.build_units_and_modules creates modules from the recommended fit
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  791) UnitModuleAssemblyService.build_units_and_modules creates rigs from the recommended fit
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  792) UnitModuleAssemblyService.build_units_and_modules processes custom port configurations
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  793) UnitModuleAssemblyService.build_units_and_modules handles missing inventory items gracefully
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  794) UnitModuleAssemblyService.build_units_and_modules handles missing recommended fit data gracefully
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  795) UnitModuleAssemblyService.build_units_and_modules assigns correct port names to components
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  796) UnitModuleAssemblyService.disconnect_unit disconnects a unit and returns it to inventory as an item
       Failure/Error: item.save!

       ActiveRecord::RecordInvalid:
         Validation failed: Name must be a valid item, material, unit, craft, rig, or blueprint
       # ./app/models/inventory.rb:137:in 'Inventory#store_in_inventory'
       # ./app/models/inventory.rb:29:in 'Inventory#add_item'
       # ./spec/services/unit_module_assembly_service_spec.rb:44:in 'block (2 levels) in <main>'

  797) WormholeConsortiumFormationService creates memberships for founding members and updates consortium operational_data
       Failure/Error: member.operational_data['consortium_memberships'] ||= []

       NoMethodError:
         undefined method '[]' for nil
       # ./app/services/wormhole_consortium_formation_service.rb:44:in 'block in WormholeConsortiumFormationService.form_consortium'
       # ./app/services/wormhole_consortium_formation_service.rb:27:in 'Hash#each'
       # ./app/services/wormhole_consortium_formation_service.rb:27:in 'WormholeConsortiumFormationService.form_consortium'
       # ./spec/services/wormhole_consortium_formation_service_spec.rb:12:in 'block (3 levels) in <main>'
       # ./spec/services/wormhole_consortium_formation_service_spec.rb:11:in 'block (2 levels) in <main>'

  798) WormholeConsortiumFormationService updates member operational_data with consortium membership
       Failure/Error: member.operational_data['consortium_memberships'] ||= []

       NoMethodError:
         undefined method '[]' for nil
       # ./app/services/wormhole_consortium_formation_service.rb:44:in 'block in WormholeConsortiumFormationService.form_consortium'
       # ./app/services/wormhole_consortium_formation_service.rb:27:in 'Hash#each'
       # ./app/services/wormhole_consortium_formation_service.rb:27:in 'WormholeConsortiumFormationService.form_consortium'
       # ./spec/services/wormhole_consortium_formation_service_spec.rb:22:in 'block (2 levels) in <main>'

Finished in 19 minutes 20 seconds (files took 42.62 seconds to load)
3110 examples, 798 failures, 19 pending

Failed examples:

rspec ./spec/data/templates/alien_world_templates_spec.rb:15 # Alien World Templates Integrity exists and is valid JSON
rspec ./spec/data/templates/alien_world_templates_spec.rb:23 # Alien World Templates Integrity metadata exists
rspec ./spec/data/templates/alien_world_templates_spec.rb:27 # Alien World Templates Integrity metadata has required fields
rspec ./spec/data/templates/alien_world_templates_spec.rb:41 # Alien World Templates Integrity metadata is versioned correctly
rspec ./spec/data/templates/alien_world_templates_spec.rb:50 # Alien World Templates Integrity terrestrial planet templates exists and is an array
rspec ./spec/data/templates/alien_world_templates_spec.rb:54 # Alien World Templates Integrity terrestrial planet templates contains exactly 25 templates
rspec ./spec/data/templates/alien_world_templates_spec.rb:58 # Alien World Templates Integrity terrestrial planet templates has unique identifiers
rspec ./spec/data/templates/alien_world_templates_spec.rb:63 # Alien World Templates Integrity terrestrial planet templates covers Template-A01 through Template-A25
rspec ./spec/data/templates/alien_world_templates_spec.rb:69 # Alien World Templates Integrity terrestrial planet templates all templates are terrestrial
rspec ./spec/data/templates/alien_world_templates_spec.rb:88 # Alien World Templates Integrity template schema validation each template contains all required fields
rspec ./spec/data/templates/alien_world_templates_spec.rb:99 # Alien World Templates Integrity atmospheric constraints contains no oxygen by default
rspec ./spec/data/templates/alien_world_templates_spec.rb:109 # Alien World Templates Integrity sanity checks has realistic gravity values
rspec ./spec/data/templates/alien_world_templates_spec.rb:115 # Alien World Templates Integrity sanity checks has positive pressure
rspec ./spec/data/templates/alien_world_templates_spec.rb:121 # Alien World Templates Integrity sanity checks terraforming difficulty is bounded
rspec ./spec/initializers/game_data_paths_spec.rb:4 # GameDataPaths sets the correct path based on environment
rspec ./spec/integration/component_production_game_loop_spec.rb:117 # Component Production Game Loop Integration full production cycle produces components through game loop progression
rspec ./spec/integration/component_production_game_loop_spec.rb:148 # Component Production Game Loop Integration full production cycle handles partial progress over multiple ticks
rspec ./spec/integration/component_production_game_loop_spec.rb:164 # Component Production Game Loop Integration full production cycle processes multiple jobs simultaneously
rspec ./spec/integration/covering_system_integration_spec.rb:43 # Covering System Integration Lava tube worldhouse covering workflow seals skylights when worldhouse construction completes
rspec ./spec/integration/covering_system_integration_spec.rb:155 # Covering System Integration Worldhouse segment covering workflow handles massive scale covering
rspec ./spec/integration/covering_system_integration_spec.rb:176 # Covering System Integration Multi-scale comparison uses same system for different scales
rspec ./spec/integration/manufacturing_pipeline_e2e_spec.rb:277 # Manufacturing Pipeline End-to-End complete ISRU to enclosed tank pipeline processes raw regolith through all stages to produce an enclosed tank
rspec ./spec/integration/manufacturing_pipeline_e2e_spec.rb:589 # Manufacturing Pipeline End-to-End material tracking through pipeline preserves composition metadata through processing chain
rspec ./spec/integration/terraforming_integration_spec.rb:130 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time decreases CO2 levels after 1 day
rspec ./spec/integration/terraforming_integration_spec.rb:140 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time shows progressive changes over 100 days
rspec ./spec/integration/terraforming_integration_spec.rb:171 # Terraforming Integration end-to-end terraforming simulation with starter ecosystem deployed simulation over time scales effects by time parameter
rspec ./spec/integration/terraforming_integration_spec.rb:258 # Terraforming Integration realistic terraforming scenario demonstrates full terraforming workflow
rspec ./spec/integration/terraforming_workflow_spec.rb:69 # Terraforming Workflow Integration transforms atmosphere over time with deployed organisms
rspec ./spec/integration/terraforming_workflow_spec.rb:107 # Terraforming Workflow Integration allows monitoring of terraforming progress
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:34 # ConcurrentTaskWorkerJob#perform with manufacturing task during daylight executes the task successfully
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:41 # ConcurrentTaskWorkerJob#perform with manufacturing task during daylight generates manufacturing byproducts
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:54 # ConcurrentTaskWorkerJob#perform with manufacturing task during low light does not generate byproducts
rspec ./spec/jobs/concurrent_task_worker_job_spec.rb:70 # ConcurrentTaskWorkerJob#perform with non-manufacturing task does not attempt byproduct generation
rspec ./spec/models/account_spec.rb:23 # Account#deposit with a valid amount increases the account balance
rspec ./spec/models/account_spec.rb:48 # Account#withdraw when funds are sufficient decreases the account balance
rspec ./spec/models/account_spec.rb:73 # Account#transfer_funds when funds are sufficient transfers the amount from one account to another
rspec ./spec/models/account_spec.rb:119 # Account edge cases when balance is exactly zero allows deposits
rspec ./spec/models/atmosphere_spec.rb:31 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:32 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:33 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:34 # Atmosphere validations 
rspec ./spec/models/atmosphere_spec.rb:54 # Atmosphere#volume when celestial_body responds to volume returns the celestial_body's volume
rspec ./spec/models/atmosphere_spec.rb:79 # Atmosphere sealing methods #sealed? returns the sealing status
rspec ./spec/models/atmosphere_spec.rb:87 # Atmosphere sealing methods #seal! sets sealing status to true
rspec ./spec/models/atmosphere_spec.rb:93 # Atmosphere sealing methods #unseal! sets sealing status to false
rspec ./spec/models/atmosphere_spec.rb:103 # Atmosphere#habitable? with good conditions returns true
rspec ./spec/models/atmosphere_spec.rb:109 # Atmosphere#habitable? with low pressure returns false
rspec ./spec/models/atmosphere_spec.rb:116 # Atmosphere#habitable? with low oxygen returns false
rspec ./spec/models/atmosphere_spec.rb:123 # Atmosphere#habitable? with high CO2 returns false
rspec ./spec/models/atmosphere_spec.rb:130 # Atmosphere#habitable? with extreme temperature returns false for too cold
rspec ./spec/models/atmosphere_spec.rb:135 # Atmosphere#habitable? with extreme temperature returns false for too hot
rspec ./spec/models/atmosphere_spec.rb:145 # Atmosphere AtmosphereConcern inclusion includes AtmosphereConcern methods
rspec ./spec/models/atmosphere_spec.rb:155 # Atmosphere JSON fields initializes JSON fields with empty objects
rspec ./spec/models/atmosphere_spec.rb:163 # Atmosphere JSON fields allows storing data in JSON fields
rspec ./spec/models/atmosphere_spec.rb:188 # Atmosphere parent validation rejects multiple parents
rspec ./spec/models/biogas_generator_spec.rb:18 # Units::BiogasGenerator#operate consumes biomass, organic waste, and energy, producing biogas and fertilizer
rspec ./spec/models/biogas_generator_spec.rb:27 # Units::BiogasGenerator#operate returns false if insufficient biomass is available
rspec ./spec/models/biogas_generator_spec.rb:32 # Units::BiogasGenerator#operate returns false if insufficient organic waste is available
rspec ./spec/models/biogas_generator_spec.rb:37 # Units::BiogasGenerator#operate returns false if insufficient energy is available
rspec ./spec/models/biology/biosphere_integration_spec.rb:45 # Biosphere and Life Form Integration ecosystem simulation simulates population dynamics
rspec ./spec/models/biomass_recycler_spec.rb:18 # Units::BiomassRecycler#operate consumes biomass and energy, producing fertilizer and biofuel
rspec ./spec/models/biomass_recycler_spec.rb:26 # Units::BiomassRecycler#operate returns false if insufficient biomass is available
rspec ./spec/models/biomass_recycler_spec.rb:31 # Units::BiomassRecycler#operate returns false if insufficient energy is available
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:38 # CelestialBodies::Features::BaseFeature#static_data fetches data from lookup service
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:43 # CelestialBodies::Features::BaseFeature#static_data caches the data
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:58 # CelestialBodies::Features::BaseFeature#discover! marks feature as discovered
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:65 # CelestialBodies::Features::BaseFeature#discover! sets discovered_at timestamp
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:70 # CelestialBodies::Features::BaseFeature#discover! does not overwrite existing discovery
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:90 # CelestialBodies::Features::BaseFeature status transitions transitions through states correctly
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:107 # CelestialBodies::Features::BaseFeature status transitions cannot skip states
rspec ./spec/models/celestial_bodies/features/base_feature_spec.rb:114 # CelestialBodies::Features::BaseFeature tier helpers identifies strategic features
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:25 # CelestialBodies::Materials::ExoticMaterial associations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:29 # CelestialBodies::Materials::ExoticMaterial validations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:30 # CelestialBodies::Materials::ExoticMaterial validations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:31 # CelestialBodies::Materials::ExoticMaterial validations 
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:35 # CelestialBodies::Materials::ExoticMaterial state helper methods identifies metallic hydrogen state
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:42 # CelestialBodies::Materials::ExoticMaterial state helper methods identifies plasma state
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:50 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns metallic_hydrogen for hydrogen at extreme pressure
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:55 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns plasma at extreme temperatures
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:60 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at returns superfluid for helium at low temperatures
rspec ./spec/models/celestial_bodies/materials/exotic_material_spec.rb:65 # CelestialBodies::Materials::ExoticMaterial#phase_transition_at falls back to standard states otherwise
rspec ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:15 # CelestialBodies::MinorBodies::DwarfPlanet validations is valid with valid attributes
rspec ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:21 # CelestialBodies::MinorBodies::DwarfPlanet#is_spherical? returns true for dwarf planets
rspec ./spec/models/celestial_bodies/minor_bodies/dwarf_planet_spec.rb:28 # CelestialBodies::MinorBodies::DwarfPlanet#calculate_geological_activity calculates geological activity based on mass and age
rspec './spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb[1:1:4]' # CelestialBodies::Planets::Gaseous::GasGiant behaves like a gaseous planet calculates cloud bands based on rotation
rspec ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:27 # CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with Jupiter mass estimates a realistic moon count
rspec ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:35 # CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #estimate_moon_count with different masses scales moon count with mass
rspec ./spec/models/celestial_bodies/planets/gaseous/gas_giant_spec.rb:48 # CelestialBodies::Planets::Gaseous::GasGiant gas giant specific methods #ring_system_probability returns a high probability for gas giants
rspec './spec/models/celestial_bodies/planets/gaseous/ice_giant_spec.rb[1:1:4]' # CelestialBodies::Planets::Gaseous::IceGiant behaves like a gaseous planet calculates cloud bands based on rotation
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:7 # CelestialBodies::Planets::Ocean::HyceanPlanet validations requires an atmosphere to be present
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:15 # CelestialBodies::Planets::Ocean::HyceanPlanet validations requires at least 10% hydrogen in atmosphere
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:24 # CelestialBodies::Planets::Ocean::HyceanPlanet validations requires significant atmospheric pressure (>1 atm)
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:31 # CelestialBodies::Planets::Ocean::HyceanPlanet validations is valid with proper hydrogen content and pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:36 # CelestialBodies::Planets::Ocean::HyceanPlanet validations inherits ocean planet water coverage validation
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:56 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes base ocean planet factors
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:62 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors includes hydrogen blanket greenhouse effect
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:68 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors calculates pressure habitability zones
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:75 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors indicates expanded habitable temperature range
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:81 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates optimal pressure range (10-100 atm) as level 3
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:90 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates moderate pressure range (1-10 or 100-1000 atm) as level 2
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:99 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitability_factors rates extreme pressure as level 1
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:110 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes base ocean planet features
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:116 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes hydrogen atmosphere features
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:125 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features includes extreme storm systems for high pressure atmospheres
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:134 # CelestialBodies::Planets::Ocean::HyceanPlanet#surface_features does not include storm systems for lower pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:145 # CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies hydrogen saturated oceans for high H2 content
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:152 # CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry identifies methane rich oceans when CH4 is present
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:162 # CelestialBodies::Planets::Ocean::HyceanPlanet#ocean_chemistry returns unknown when hydrosphere composition is missing
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:173 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth calculates habitable depth range based on pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:181 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth sets deeper minimum depth for higher pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:191 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth ensures maximum depth is greater than minimum
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:197 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when atmosphere is missing
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:204 # CelestialBodies::Planets::Ocean::HyceanPlanet#habitable_layer_depth returns nil when hydrosphere is missing
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:213 # CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) calculates hydrogen percentage from atmosphere
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:221 # CelestialBodies::Planets::Ocean::HyceanPlanet#hydrogen_percentage (private method) returns 0 when H2 gas is not present
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:232 # CelestialBodies::Planets::Ocean::HyceanPlanet STI type sets the correct STI type
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:240 # CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high surface temperature
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:244 # CelestialBodies::Planets::Ocean::HyceanPlanet with :extreme trait has very high atmospheric pressure
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:252 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has below-freezing surface temperature
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:256 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has significant ice coverage
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:262 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has higher ammonia content as antifreeze
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:268 # CelestialBodies::Planets::Ocean::HyceanPlanet with :cold trait has mixed liquid-solid state distribution
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:277 # CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet inherits water_volume calculation
rspec ./spec/models/celestial_bodies/planets/ocean/hycean_planet_spec.rb:283 # CelestialBodies::Planets::Ocean::HyceanPlanet inheritance from OceanPlanet can analyze water chemistry
rspec ./spec/models/celestial_bodies/spheres/biosphere_spec.rb:193 # CelestialBodies::Spheres::Biosphere#transfer_material logs errors when transfer fails due to validation errors
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:58 # CelestialBodies::Spheres::Geosphere#add_material adds a material and updates the celestial body and geosphere
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:101 # CelestialBodies::Spheres::Geosphere#add_material adds material to the specified layer
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:130 # CelestialBodies::Spheres::Geosphere#remove_material removes material from the specified layer
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:175 # CelestialBodies::Spheres::Geosphere material management creates materials in correct layer
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:192 # CelestialBodies::Spheres::Geosphere material management updates composition percentages
rspec ./spec/models/celestial_bodies/spheres/geosphere_spec.rb:275 # CelestialBodies::Spheres::Geosphere#extract_volatiles extracts volatiles based on temperature increase
rspec ./spec/models/celestial_body_spec.rb:16 # CelestialBodies::CelestialBody when not part of a solar system allows distance_from_star to be nil
rspec ./spec/models/celestial_body_spec.rb:24 # CelestialBodies::CelestialBody#add_material creates a new material if it does not exist
rspec ./spec/models/celestial_body_spec.rb:30 # CelestialBodies::CelestialBody#add_material updates the amount of an existing material
rspec ./spec/models/celestial_body_spec.rb:67 # CelestialBodies::CelestialBody#update_gravity calculates and updates the gravity based on mass and radius
rspec ./spec/models/composting_unit_spec.rb:18 # Units::CompostingUnit#operate consumes organic waste and energy, producing compost
rspec ./spec/models/composting_unit_spec.rb:25 # Units::CompostingUnit#operate returns false if insufficient organic waste is available
rspec ./spec/models/composting_unit_spec.rb:30 # Units::CompostingUnit#operate returns false if insufficient energy is available
rspec ./spec/models/concerns/energy_management_spec.rb:196 # EnergyManagement solar output factor #current_solar_output_factor queries location solar output factor
rspec ./spec/models/concerns/energy_management_spec.rb:201 # EnergyManagement solar output factor #current_solar_output_factor returns 1.0 when no settlement
rspec ./spec/models/concerns/energy_management_spec.rb:208 # EnergyManagement solar output factor #solar_daylight? returns true when solar factor > 0.1
rspec ./spec/models/concerns/energy_management_spec.rb:213 # EnergyManagement solar output factor #solar_daylight? returns false when solar factor <= 0.1
rspec ./spec/models/concerns/energy_management_spec.rb:243 # EnergyManagement solar output factor power generation with solar scaling scales solar unit output by solar factor
rspec ./spec/models/concerns/energy_management_spec.rb:249 # EnergyManagement solar output factor power generation with solar scaling does not scale non-solar units
rspec ./spec/models/concerns/geosphere_concern_spec.rb:76 # GeosphereConcern#reset returns false if base_values lack required keys
rspec ./spec/models/concerns/geosphere_concern_spec.rb:96 # GeosphereConcern#reset does not modify attributes when base_values are empty
rspec ./spec/models/concerns/geosphere_concern_spec.rb:171 # GeosphereConcern#extract_volatiles extracts volatiles based on temperature increase
rspec ./spec/models/concerns/geosphere_concern_spec.rb:180 # GeosphereConcern#extract_volatiles adds gases to atmosphere using chemical formula
rspec ./spec/models/concerns/geosphere_concern_spec.rb:212 # GeosphereConcern#add_material adds material to the specified layer
rspec ./spec/models/concerns/has_units_spec.rb:114 # HasUnits#install_unit attaches a unit to the craft
rspec ./spec/models/concerns/housing_spec.rb:57 # Housing population management calculates population capacity from habitat units
rspec ./spec/models/concerns/housing_spec.rb:61 # Housing population management uses alias total_capacity for population_capacity
rspec ./spec/models/concerns/housing_spec.rb:65 # Housing population management calculates available capacity
rspec ./spec/models/concerns/housing_spec.rb:70 # Housing population management checks if it has capacity for additional population
rspec ./spec/models/concerns/housing_spec.rb:76 # Housing population management ignores non-habitat units when calculating capacity
rspec ./spec/models/concerns/housing_spec.rb:81 # Housing population management calculates total population from base units
rspec ./spec/models/concerns/material_properties_concern_spec.rb:204 # MaterialPropertiesConcern exotic state handling identifies exotic states
rspec ./spec/models/concerns/material_properties_concern_spec.rb:218 # MaterialPropertiesConcern exotic state handling calculates phase transitions for exotic conditions
rspec ./spec/models/concerns/mineable_spec.rb:29 # Mineable#mine_gcc mines from satellites and computers
rspec ./spec/models/concerns/mineable_spec.rb:34 # Mineable#mine_gcc does not exceed available power
rspec ./spec/models/concerns/structures/coverable_spec.rb:253 # Structures::Coverable#schedule_covering! creates a construction job
rspec ./spec/models/concerns/structures/coverable_spec.rb:259 # Structures::Coverable#schedule_covering! returns success result
rspec ./spec/models/concerns/structures/coverable_spec.rb:269 # Structures::Coverable#schedule_covering! updates status to materials_requested
rspec ./spec/models/concerns/structures/coverable_spec.rb:275 # Structures::Coverable#schedule_covering! accepts custom panel type
rspec ./spec/models/concerns/structures/coverable_spec.rb:285 # Structures::Coverable#schedule_covering! stores panel_type on coverable
rspec ./spec/models/concerns/structures/coverable_spec.rb:294 # Structures::Coverable#schedule_covering! uses default panel type if not specified
rspec ./spec/models/concerns/structures/coverable_spec.rb:301 # Structures::Coverable#schedule_covering! creates material and equipment requests
rspec ./spec/models/concerns/structures/coverable_spec.rb:308 # Structures::Coverable#schedule_covering! updates shell composition
rspec ./spec/models/concerns/structures/coverable_spec.rb:317 # Structures::Coverable#schedule_covering! fails if already covered
rspec ./spec/models/concerns/structures/coverable_spec.rb:578 # Structures::Coverable integration scenarios lava tube opening handles medium opening
rspec ./spec/models/concerns/structures/coverable_spec.rb:596 # Structures::Coverable complete covering workflow goes through full lifecycle
rspec ./spec/models/concerns/structures/shell_spec.rb:312 # Structures::Shell#schedule_shell_construction! sets construction_date
rspec ./spec/models/consortium_membership_spec.rb:22 # ConsortiumMembership is invalid if member is not a corporation
rspec ./spec/models/construction_job_spec.rb:12 # ConstructionJob validations and attributes is valid with required attributes
rspec ./spec/models/construction_job_spec.rb:22 # ConstructionJob validations and attributes requires a jobable
rspec ./spec/models/construction_job_spec.rb:28 # ConstructionJob validations and attributes accepts a valid job_type
rspec ./spec/models/construction_job_spec.rb:44 # ConstructionJob validations and attributes accepts a valid status
rspec ./spec/models/construction_job_spec.rb:63 # ConstructionJob validations and attributes stores target_values as JSON
rspec ./spec/models/construction_job_spec.rb:96 # ConstructionJob associations has many material_requests
rspec ./spec/models/construction_job_spec.rb:109 # ConstructionJob associations has many equipment_requests
rspec ./spec/models/construction_job_spec.rb:121 # ConstructionJob associations belongs to a jobable
rspec ./spec/models/construction_job_spec.rb:125 # ConstructionJob associations belongs to a settlement
rspec ./spec/models/construction_job_spec.rb:140 # ConstructionJob enum functionality correctly stores and retrieves job_type as an enum
rspec ./spec/models/construction_job_spec.rb:164 # ConstructionJob enum functionality correctly stores and retrieves status as an enum
rspec ./spec/models/construction_job_spec.rb:198 # ConstructionJob convenience methods #materials_gathered? returns true when all material requests are fulfilled
rspec ./spec/models/construction_job_spec.rb:214 # ConstructionJob convenience methods #materials_gathered? returns false when some material requests are pending
rspec ./spec/models/construction_job_spec.rb:234 # ConstructionJob convenience methods #equipment_gathered? returns true when no equipment requests exist
rspec ./spec/models/construction_job_spec.rb:239 # ConstructionJob convenience methods #equipment_gathered? returns true when all equipment requests are fulfilled
rspec ./spec/models/construction_job_spec.rb:250 # ConstructionJob convenience methods #equipment_gathered? returns false when some equipment requests are pending
rspec ./spec/models/construction_job_spec.rb:263 # ConstructionJob convenience methods #infer_settlement returns the jobable's settlement if available
rspec ./spec/models/construction_job_spec.rb:267 # ConstructionJob convenience methods #infer_settlement returns the jobable if it is a Settlement
rspec ./spec/models/construction_job_spec.rb:272 # ConstructionJob convenience methods #infer_settlement finds a settlement by location if available
rspec ./spec/models/craft/base_craft_spec.rb:128 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:129 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:130 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:131 # Craft::BaseCraft associations 
rspec ./spec/models/craft/base_craft_spec.rb:135 # Craft::BaseCraft location handling can access location through helper method
rspec ./spec/models/craft/base_craft_spec.rb:139 # Craft::BaseCraft location handling can switch between spatial and celestial locations
rspec ./spec/models/craft/base_craft_spec.rb:189 # Craft::BaseCraft initialization assembles a new craft from inventory and applies the correct variant
rspec ./spec/models/craft/base_craft_spec.rb:209 # Craft::BaseCraft loading craft info loads the correct craft data from the lookup service
rspec ./spec/models/craft/base_craft_spec.rb:244 # Craft::BaseCraft player construction starts with no units
rspec ./spec/models/craft/base_craft_spec.rb:248 # Craft::BaseCraft player construction allows installing units
rspec ./spec/models/craft/base_craft_spec.rb:258 # Craft::BaseCraft player construction allows uninstalling units
rspec ./spec/models/craft/base_craft_spec.rb:313 # Craft::BaseCraft variant configuration loads a variant configuration
rspec ./spec/models/craft/base_craft_spec.rb:320 # Craft::BaseCraft variant configuration changes between variants
rspec ./spec/models/craft/base_craft_spec.rb:330 # Craft::BaseCraft variant configuration provides a list of available variants
rspec ./spec/models/craft/base_craft_spec.rb:335 # Craft::BaseCraft variant configuration handles missing variants gracefully
rspec ./spec/models/craft/base_craft_spec.rb:361 # Craft::BaseCraft atmosphere creation creates an atmosphere after creation
rspec ./spec/models/craft/base_craft_spec.rb:377 # Craft::BaseCraft unit integration integrates with settlement units
rspec ./spec/models/craft/harvester_spec.rb:18 # Craft::Harvester validations is valid with a positive extraction_rate
rspec ./spec/models/craft/harvester_spec.rb:23 # Craft::Harvester validations is invalid with a negative extraction_rate
rspec ./spec/models/craft/harvester_spec.rb:31 # Craft::Harvester#extract_resources when extracting from a valid target increases inventory with extracted resources
rspec ./spec/models/craft/harvester_spec.rb:40 # Craft::Harvester#extract_resources when extracting from an invalid target raises an error
rspec ./spec/models/craft/harvester_spec.rb:51 # Craft::Harvester#extract_resources when storage is full raises an error
rspec ./spec/models/craft/harvester_spec.rb:63 # Craft::Harvester#process_resources converts raw material into refined material
rspec ./spec/models/craft/harvester_spec.rb:73 # Craft::Harvester#process_resources does nothing if no processable materials are present
rspec ./spec/models/craft/variant_manager_spec.rb:66 # Craft::VariantManager#initialize loads base data and variants
rspec ./spec/models/craft/variant_manager_spec.rb:102 # Craft::VariantManager#get_variant merges base data with standard variant data
rspec ./spec/models/craft/variant_manager_spec.rb:113 # Craft::VariantManager#get_variant merges base data with lunar variant data
rspec ./spec/models/craft/variant_manager_spec.rb:124 # Craft::VariantManager#get_variant properly merges nested hashes
rspec ./spec/models/dome_spec.rb:5 # Settlement::Dome calculates used capacity (current occupancy) correctly
rspec ./spec/models/dome_spec.rb:10 # Settlement::Dome calculates remaining capacity correctly
rspec ./spec/models/dome_spec.rb:15 # Settlement::Dome ensures current occupancy does not exceed total capacity
rspec ./spec/models/dwarf_planet_spec.rb:19 # CelestialBodies::DwarfPlanet#calculate_surface_conditions calculates surface conditions specific to dwarf planets
rspec ./spec/models/dwarf_planet_spec.rb:26 # CelestialBodies::DwarfPlanet#update_biomes updates biomes specific to dwarf planets
rspec ./spec/models/environment_spec.rb:11 # Environment validations is valid with valid attributes
rspec ./spec/models/environment_spec.rb:15 # Environment validations is not valid without a biome
rspec ./spec/models/environment_spec.rb:20 # Environment validations is not valid without a planet
rspec ./spec/models/environment_spec.rb:25 # Environment validations is not valid without a temperature
rspec ./spec/models/environment_spec.rb:30 # Environment validations is not valid without a pressure
rspec ./spec/models/environment_spec.rb:35 # Environment validations is not valid without a humidity
rspec ./spec/models/environment_spec.rb:42 # Environment associations belongs to a biome
rspec ./spec/models/environment_spec.rb:46 # Environment associations belongs to a celestial_body
rspec ./spec/models/equipment_request_spec.rb:13 # EquipmentRequest validations is valid with required attributes
rspec ./spec/models/equipment_request_spec.rb:22 # EquipmentRequest validations requires an equipment_type
rspec ./spec/models/equipment_request_spec.rb:31 # EquipmentRequest validations requires quantity_requested to be present
rspec ./spec/models/equipment_request_spec.rb:40 # EquipmentRequest validations requires quantity_requested to be greater than 0
rspec ./spec/models/equipment_request_spec.rb:50 # EquipmentRequest validations requires quantity_requested to be a number
rspec ./spec/models/equipment_request_spec.rb:60 # EquipmentRequest validations allows negative quantity_requested to be invalid
rspec ./spec/models/equipment_request_spec.rb:74 # EquipmentRequest associations belongs to a requestable (polymorphic)
rspec ./spec/models/equipment_request_spec.rb:78 # EquipmentRequest associations can be associated with different requestable types
rspec ./spec/models/equipment_request_spec.rb:101 # EquipmentRequest enums status enum defaults to pending status
rspec ./spec/models/equipment_request_spec.rb:105 # EquipmentRequest enums status enum can be set to different statuses
rspec ./spec/models/equipment_request_spec.rb:111 # EquipmentRequest enums status enum accepts string values for status
rspec ./spec/models/equipment_request_spec.rb:116 # EquipmentRequest enums status enum provides query methods for each status
rspec ./spec/models/equipment_request_spec.rb:136 # EquipmentRequest enums priority enum defaults to normal priority
rspec ./spec/models/equipment_request_spec.rb:140 # EquipmentRequest enums priority enum can be set to different priorities
rspec ./spec/models/equipment_request_spec.rb:146 # EquipmentRequest enums priority enum accepts string values for priority
rspec ./spec/models/equipment_request_spec.rb:151 # EquipmentRequest enums priority enum provides query methods for each priority
rspec ./spec/models/equipment_request_spec.rb:171 # EquipmentRequest scopes .pending_requests returns pending and partially fulfilled requests
rspec ./spec/models/equipment_request_spec.rb:179 # EquipmentRequest scopes .fulfilled returns only fulfilled requests
rspec ./spec/models/equipment_request_spec.rb:187 # EquipmentRequest scopes .for_equipment returns requests for a specific equipment type
rspec ./spec/models/equipment_request_spec.rb:193 # EquipmentRequest scopes .for_equipment returns empty when no equipment of that type is requested
rspec ./spec/models/equipment_request_spec.rb:202 # EquipmentRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
rspec ./spec/models/equipment_request_spec.rb:211 # EquipmentRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
rspec ./spec/models/equipment_request_spec.rb:220 # EquipmentRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
rspec ./spec/models/equipment_request_spec.rb:229 # EquipmentRequest instance methods #quantity_still_needed handles quantity_fulfilled being 0
rspec ./spec/models/equipment_request_spec.rb:241 # EquipmentRequest factory creates a valid equipment request with factory
rspec ./spec/models/equipment_request_spec.rb:247 # EquipmentRequest factory creates equipment request with specific attributes
rspec ./spec/models/equipment_request_spec.rb:261 # EquipmentRequest edge cases and data integrity handles very large quantity requests
rspec ./spec/models/equipment_request_spec.rb:270 # EquipmentRequest edge cases and data integrity maintains data integrity when updating status
rspec ./spec/models/equipment_request_spec.rb:281 # EquipmentRequest edge cases and data integrity handles equipment_type with special characters
rspec ./spec/models/financial/account_spec.rb:164 # Financial::Account Development Corporation (DC) Trade allows DC-to-DC trade on the virtual ledger via operational_data flags
rspec ./spec/models/financial/transaction_spec.rb:85 # Financial::Transaction currency precision supports high precision for GCC (8 decimal places)
rspec ./spec/models/game_spec.rb:61 # Game#assign_task adds a new task to the task list with correct completion time
rspec ./spec/models/game_spec.rb:85 # Game#advance_time advances game time and completes a task
rspec ./spec/models/game_spec.rb:94 # Game#advance_time with no tasks prints a message when there are no tasks
rspec ./spec/models/gas_giant_spec.rb:19 # CelestialBodies::GasGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
rspec ./spec/models/gas_giant_spec.rb:26 # CelestialBodies::GasGiant#calculate_gravity calculates gravity based on mass and radius
rspec ./spec/models/hydrosphere_spec.rb:13 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :liquid_volume looks like a number
rspec ./spec/models/hydrosphere_spec.rb:14 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :lakes looks like a number
rspec ./spec/models/hydrosphere_spec.rb:15 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :rivers looks like a number
rspec ./spec/models/hydrosphere_spec.rb:16 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :oceans looks like a number
rspec ./spec/models/hydrosphere_spec.rb:17 # CelestialBodies::Spheres::Hydrosphere validations is expected to validate that :ice looks like a number
rspec ./spec/models/hydrosphere_spec.rb:25 # CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calls update_liquid_materials_from_celestial_body
rspec ./spec/models/hydrosphere_spec.rb:30 # CelestialBodies::Spheres::Hydrosphere#setup_liquid_materials calculates the liquid volume after setup
rspec ./spec/models/hydrosphere_spec.rb:45 # CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds liquid materials to the hydrosphere
rspec ./spec/models/hydrosphere_spec.rb:49 # CelestialBodies::Spheres::Hydrosphere#update_liquid_materials_from_celestial_body adds ice to the hydrosphere
rspec ./spec/models/hydrosphere_spec.rb:57 # CelestialBodies::Spheres::Hydrosphere#add_liquid distributes liquid between oceans, lakes, and rivers
rspec ./spec/models/hydrosphere_spec.rb:65 # CelestialBodies::Spheres::Hydrosphere#calculate_liquid_volume calculates the total liquid volume correctly
rspec ./spec/models/hydrosphere_spec.rb:84 # CelestialBodies::Spheres::Hydrosphere#update_water_cycle melts ice when temperature is above freezing
rspec ./spec/models/hydrosphere_spec.rb:89 # CelestialBodies::Spheres::Hydrosphere#update_water_cycle does not melt ice when temperature is below freezing
rspec ./spec/models/hydrosphere_spec.rb:105 # CelestialBodies::Spheres::Hydrosphere#evaporate_liquids evaporates liquids when conditions are met
rspec ./spec/models/ice_giant_spec.rb:19 # CelestialBodies::IceGiant#calculate_atmospheric_pressure calculates atmospheric pressure based on gas quantities
rspec ./spec/models/ice_giant_spec.rb:26 # CelestialBodies::IceGiant#calculate_gravity calculates gravity based on mass and radius
rspec ./spec/models/item_spec.rb:296 # Item regolith handling gets composition from celestial body geosphere
rspec ./spec/models/liquid_material_spec.rb:9 # CelestialBodies::Materials::Liquid associations 
rspec ./spec/models/liquid_material_spec.rb:13 # CelestialBodies::Materials::Liquid validations is valid with valid attributes
rspec ./spec/models/liquid_material_spec.rb:17 # CelestialBodies::Materials::Liquid validations is not valid without a name
rspec ./spec/models/liquid_material_spec.rb:23 # CelestialBodies::Materials::Liquid validations is not valid without an amount
rspec ./spec/models/liquid_material_spec.rb:29 # CelestialBodies::Materials::Liquid validations is not valid with a negative amount
rspec ./spec/models/location/celestial_location_spec.rb:15 # Location::CelestialLocation validations is expected to validate that :name cannot be empty/falsy
rspec ./spec/models/location/celestial_location_spec.rb:326 # Location::CelestialLocation orbital mechanics #orbital_period returns nil for surface locations
rspec ./spec/models/location/celestial_location_spec.rb:330 # Location::CelestialLocation orbital mechanics #orbital_period calculates period for orbital locations
rspec ./spec/models/location/celestial_location_spec.rb:349 # Location::CelestialLocation orbital mechanics #orbital_velocity returns nil for surface locations
rspec ./spec/models/location/celestial_location_spec.rb:353 # Location::CelestialLocation orbital mechanics #orbital_velocity calculates velocity for orbital locations
rspec ./spec/models/location/celestial_location_spec.rb:372 # Location::CelestialLocation orbital mechanics #gravity returns surface gravity for surface locations
rspec ./spec/models/location/celestial_location_spec.rb:376 # Location::CelestialLocation orbital mechanics #gravity calculates reduced gravity at altitude
rspec ./spec/models/location/celestial_location_spec.rb:400 # Location::CelestialLocation#description describes surface locations
rspec ./spec/models/location/celestial_location_spec.rb:414 # Location::CelestialLocation#description describes orbital locations
rspec ./spec/models/location/spatial_location_spec.rb:69 # Location::SpatialLocation#update_location updates coordinates
rspec ./spec/models/market/marketplace_spec.rb:81 # Market::Marketplace#find_matching_orders when order is a Sell order calls the settlement NPC methods
rspec ./spec/models/market/marketplace_spec.rb:100 # Market::Marketplace#find_matching_orders when order is not a Sell order returns an empty array
rspec ./spec/models/market/marketplace_spec.rb:141 # Market::Marketplace#place_order creates an order
rspec ./spec/models/market/marketplace_spec.rb:152 # Market::Marketplace#place_order converts volume parameter to quantity
rspec ./spec/models/market/marketplace_spec.rb:164 # Market::Marketplace#place_order sets the base_settlement_id
rspec ./spec/models/market/marketplace_spec.rb:176 # Market::Marketplace#place_order removes unused parameters
rspec ./spec/models/market/marketplace_spec.rb:190 # Market::Marketplace#place_order when order is fully filled returns nil
rspec ./spec/models/market/marketplace_spec.rb:214 # Market::Marketplace#place_order when order is fully filled sets order quantity to zero
rspec ./spec/models/market/marketplace_spec.rb:256 # Market::Marketplace#place_order when order is partially filled returns the order
rspec ./spec/models/market/marketplace_spec.rb:274 # Market::Marketplace#place_order when no matching orders exist returns the unfilled order
rspec ./spec/models/market/marketplace_spec.rb:353 # Market::Marketplace#execute_trades delegates the entire trade execution to Market::TradeExecutionService
rspec ./spec/models/market/marketplace_spec.rb:366 # Market::Marketplace#execute_trades updates the order quantity to zero when fully filled
rspec ./spec/models/market/marketplace_spec.rb:398 # Market::Marketplace#execute_trades wraps the execution in a transaction
rspec ./spec/models/market/marketplace_spec.rb:390 # Market::Marketplace#execute_trades when partially filled updates the order quantity to remaining amount
rspec ./spec/models/market/transaction_fee_spec.rb:5 # Market::TransactionFee validations is expected to validate that :fee_type cannot be empty/falsy
rspec ./spec/models/market/transaction_fee_spec.rb:6 # Market::TransactionFee validations is expected to validate that :fee_type is either ‹"percentage"› or ‹"fixed"›
rspec ./spec/models/market/transaction_fee_spec.rb:7 # Market::TransactionFee validations is expected to validate that :percentage looks like a number greater than or equal to 0 as long as it is not nil
rspec ./spec/models/market/transaction_fee_spec.rb:8 # Market::TransactionFee validations is expected to validate that :fixed_amount looks like a number greater than or equal to 0 as long as it is not nil
rspec ./spec/models/market/transaction_fee_spec.rb:12 # Market::TransactionFee#calculate calculates percentage fee
rspec ./spec/models/market/transaction_fee_spec.rb:17 # Market::TransactionFee#calculate calculates fixed fee
rspec ./spec/models/market/transaction_fee_spec.rb:22 # Market::TransactionFee#calculate returns 0 for unknown fee_type
rspec ./spec/models/material_request_spec.rb:13 # MaterialRequest validations is valid with required attributes
rspec ./spec/models/material_request_spec.rb:22 # MaterialRequest validations requires a material_name
rspec ./spec/models/material_request_spec.rb:31 # MaterialRequest validations requires quantity_requested to be present
rspec ./spec/models/material_request_spec.rb:40 # MaterialRequest validations requires quantity_requested to be greater than 0
rspec ./spec/models/material_request_spec.rb:50 # MaterialRequest validations requires quantity_requested to be a number
rspec ./spec/models/material_request_spec.rb:64 # MaterialRequest associations belongs to a requestable (polymorphic)
rspec ./spec/models/material_request_spec.rb:68 # MaterialRequest associations can be associated with different requestable types
rspec ./spec/models/material_request_spec.rb:91 # MaterialRequest enums status enum defaults to pending status
rspec ./spec/models/material_request_spec.rb:95 # MaterialRequest enums status enum can be set to different statuses
rspec ./spec/models/material_request_spec.rb:101 # MaterialRequest enums status enum accepts string values for status
rspec ./spec/models/material_request_spec.rb:117 # MaterialRequest enums priority enum defaults to normal priority
rspec ./spec/models/material_request_spec.rb:121 # MaterialRequest enums priority enum can be set to different priorities
rspec ./spec/models/material_request_spec.rb:127 # MaterialRequest enums priority enum accepts string values for priority
rspec ./spec/models/material_request_spec.rb:143 # MaterialRequest scopes .pending_requests returns pending and partially fulfilled requests
rspec ./spec/models/material_request_spec.rb:151 # MaterialRequest scopes .fulfilled returns only fulfilled requests
rspec ./spec/models/material_request_spec.rb:159 # MaterialRequest scopes .for_material returns requests for a specific material
rspec ./spec/models/material_request_spec.rb:170 # MaterialRequest delegations delegates settlement to requestable
rspec ./spec/models/material_request_spec.rb:174 # MaterialRequest delegations handles nil settlement gracefully
rspec ./spec/models/material_request_spec.rb:183 # MaterialRequest instance methods #quantity_still_needed returns the full quantity when quantity_fulfilled is nil
rspec ./spec/models/material_request_spec.rb:192 # MaterialRequest instance methods #quantity_still_needed returns the difference when quantity_fulfilled is set
rspec ./spec/models/material_request_spec.rb:201 # MaterialRequest instance methods #quantity_still_needed returns 0 when fully fulfilled
rspec ./spec/models/material_request_spec.rb:220 # MaterialRequest instance methods #gas_request? returns true when material is a gas
rspec ./spec/models/material_request_spec.rb:227 # MaterialRequest instance methods #gas_request? returns false when material is not a gas
rspec ./spec/models/material_request_spec.rb:234 # MaterialRequest instance methods #gas_request? returns false when material data is not found
rspec ./spec/models/material_request_spec.rb:240 # MaterialRequest instance methods #gas_request? returns false when material data has no category
rspec ./spec/models/material_request_spec.rb:250 # MaterialRequest factory creates a valid material request with factory
rspec ./spec/models/material_spec.rb:27 # CelestialBodies::Material validations is not valid without a state
rspec ./spec/models/material_spec.rb:39 # CelestialBodies::Material validations is not valid with an invalid state
rspec ./spec/models/material_spec.rb:50 # CelestialBodies::Material validations is not valid with non-numeric melting and boiling points
rspec ./spec/models/material_spec.rb:64 # CelestialBodies::Material#state_at returns "solid" when temperature is below the adjusted melting point
rspec ./spec/models/material_spec.rb:68 # CelestialBodies::Material#state_at returns "liquid" when temperature is between the adjusted melting and boiling points
rspec ./spec/models/material_spec.rb:72 # CelestialBodies::Material#state_at returns "gas" when temperature is above the adjusted boiling point
rspec ./spec/models/orbital_relationship_spec.rb:11 # OrbitalRelationship associations belongs to primary_body polymorphically
rspec ./spec/models/orbital_relationship_spec.rb:16 # OrbitalRelationship associations belongs to secondary_body polymorphically
rspec ./spec/models/orbital_relationship_spec.rb:33 # OrbitalRelationship validations is valid with valid attributes
rspec ./spec/models/orbital_relationship_spec.rb:39 # OrbitalRelationship validations relationship_type validation requires relationship_type to be present
rspec ./spec/models/orbital_relationship_spec.rb:45 # OrbitalRelationship validations relationship_type validation validates relationship_type inclusion
rspec ./spec/models/orbital_relationship_spec.rb:59 # OrbitalRelationship validations numerical validations validates distance is positive
rspec ./spec/models/orbital_relationship_spec.rb:65 # OrbitalRelationship validations numerical validations validates semi_major_axis is positive
rspec ./spec/models/orbital_relationship_spec.rb:70 # OrbitalRelationship validations numerical validations validates eccentricity is between 0 and 1
rspec ./spec/models/orbital_relationship_spec.rb:80 # OrbitalRelationship validations numerical validations validates orbital_period is positive
rspec ./spec/models/orbital_relationship_spec.rb:87 # OrbitalRelationship validations uniqueness validation prevents duplicate relationships between same bodies
rspec ./spec/models/orbital_relationship_spec.rb:107 # OrbitalRelationship backward compatibility methods #sun returns primary_body when it's a Star
rspec ./spec/models/orbital_relationship_spec.rb:111 # OrbitalRelationship backward compatibility methods #sun returns nil when primary_body is not a Star
rspec ./spec/models/orbital_relationship_spec.rb:122 # OrbitalRelationship backward compatibility methods #sun= sets primary_body and relationship_type
rspec ./spec/models/orbital_relationship_spec.rb:132 # OrbitalRelationship backward compatibility methods #celestial_body returns secondary_body when it's a CelestialBody
rspec ./spec/models/orbital_relationship_spec.rb:138 # OrbitalRelationship backward compatibility methods #celestial_body= sets secondary_body
rspec ./spec/models/orbital_relationship_spec.rb:148 # OrbitalRelationship relationship type helpers identifies star_planet relationships
rspec ./spec/models/orbital_relationship_spec.rb:158 # OrbitalRelationship relationship type helpers identifies planet_moon relationships
rspec ./spec/models/orbital_relationship_spec.rb:168 # OrbitalRelationship relationship type helpers identifies binary_star relationships
rspec ./spec/models/orbital_relationship_spec.rb:181 # OrbitalRelationship energy calculations #stellar_energy_input calculates stellar energy based on luminosity and distance
rspec ./spec/models/orbital_relationship_spec.rb:193 # OrbitalRelationship energy calculations #stellar_energy_input returns 0 when primary_body doesn't have luminosity
rspec ./spec/models/orbital_relationship_spec.rb:206 # OrbitalRelationship energy calculations #tidal_heating calculates tidal heating for planet-moon relationships
rspec ./spec/models/orbital_relationship_spec.rb:219 # OrbitalRelationship energy calculations #tidal_heating includes eccentricity factor in calculation
rspec ./spec/models/orbital_relationship_spec.rb:241 # OrbitalRelationship energy calculations #energy_input returns stellar energy for star_planet relationships
rspec ./spec/models/orbital_relationship_spec.rb:252 # OrbitalRelationship energy calculations #energy_input returns combined tidal and reflected energy for planet_moon relationships
rspec ./spec/models/orbital_relationship_spec.rb:277 # OrbitalRelationship terraforming reflected_energy and energy_input returns extra energy for star_planet with orbital mirrors and albedo adjustment
rspec ./spec/models/orbital_relationship_spec.rb:300 # OrbitalRelationship orbital mechanics #orbital_distance returns semi_major_axis when available
rspec ./spec/models/orbital_relationship_spec.rb:308 # OrbitalRelationship orbital mechanics #orbital_distance falls back to distance when semi_major_axis is nil
rspec ./spec/models/orbital_relationship_spec.rb:316 # OrbitalRelationship orbital mechanics #orbital_distance returns 0 when both are nil
rspec ./spec/models/orbital_relationship_spec.rb:326 # OrbitalRelationship orbital mechanics #calculated_orbital_period calculates orbital period using Kepler's Third Law
rspec ./spec/models/orbital_relationship_spec.rb:338 # OrbitalRelationship orbital mechanics #calculated_orbital_period returns nil when primary_body has no mass
rspec ./spec/models/orbital_relationship_spec.rb:352 # OrbitalRelationship orbital mechanics #current_orbital_position calculates orbital position based on time
rspec ./spec/models/orbital_relationship_spec.rb:365 # OrbitalRelationship orbital mechanics #current_orbital_position returns nil when orbital_period or epoch_time is missing
rspec ./spec/models/orbital_relationship_spec.rb:380 # OrbitalRelationship private methods #masses_present? returns true when both bodies have mass
rspec ./spec/models/orbital_relationship_spec.rb:384 # OrbitalRelationship private methods #masses_present? returns false when primary_body has no mass
rspec ./spec/models/orbital_relationship_spec.rb:393 # OrbitalRelationship private methods #extract_mass extracts mass from Star objects
rspec ./spec/models/orbital_relationship_spec.rb:398 # OrbitalRelationship private methods #extract_mass extracts and converts mass from CelestialBody objects
rspec ./spec/models/orbital_relationship_spec.rb:403 # OrbitalRelationship private methods #extract_mass returns nil for unsupported object types
rspec ./spec/models/organizations/base_organization_profit_spec.rb:13 # Organizations::BaseOrganization distributes profits to members based on ownership
rspec ./spec/models/organizations/tax_authority_spec.rb:19 # Organizations::TaxAuthority.instance always returns the same single instance
rspec ./spec/models/planet_biome_spec.rb:15 # PlanetBiome 
rspec ./spec/models/planet_biome_spec.rb:16 # PlanetBiome 
rspec ./spec/models/planet_biome_spec.rb:19 # PlanetBiome is valid with valid attributes
rspec ./spec/models/planet_biome_spec.rb:23 # PlanetBiome is not valid without a biome
rspec ./spec/models/planet_biome_spec.rb:28 # PlanetBiome is not valid without a celestial_body
rspec ./spec/models/plant_environment_spec.rb:13 # PlantEnvironment validations is valid with valid attributes
rspec ./spec/models/plant_environment_spec.rb:17 # PlantEnvironment validations is not valid without a plant
rspec ./spec/models/plant_environment_spec.rb:22 # PlantEnvironment validations is not valid without an environment
rspec ./spec/models/plant_environment_spec.rb:27 # PlantEnvironment validations is not valid with duplicate plant and environment pair
rspec ./spec/models/plant_spec.rb:9 # Plant validations is valid with valid attributes
rspec ./spec/models/plant_spec.rb:35 # Plant methods can grow in a given environment if conditions are met
rspec ./spec/models/plant_spec.rb:41 # Plant methods cannot grow in a given environment if conditions are not met
rspec ./spec/models/rigs/base_rig_spec.rb:23 # Rigs::BaseRig#apply_rig_to_attachable applies rig effect to the attachable unit
rspec ./spec/models/rigs/base_rig_spec.rb:30 # Rigs::BaseRig#remove_from removes rig effect from the attachable unit
rspec ./spec/models/rigs/base_rig_spec.rb:37 # Rigs::BaseRig polymorphic association can belong to an attachable BaseUnit
rspec ./spec/models/rigs/base_rig_spec.rb:106 # Rigs::BaseRig#apply_output_effects and #revert_output_effects applies and reverts output effects if attachable responds to update_outputs
rspec ./spec/models/rigs/base_rig_spec.rb:128 # Rigs::BaseRig#apply_damage_effects and #revert_damage_effects applies and reverts damage effects if attachable responds to update_damage_risks
rspec ./spec/models/route_proposal_spec.rb:12 # RouteProposal calculates vote outcome based on threshold
rspec ./spec/models/route_proposal_spec.rb:17 # RouteProposal fails if votes do not meet threshold
rspec ./spec/models/route_proposal_vote_spec.rb:7 # RouteProposalVote is valid with valid attributes
rspec ./spec/models/route_proposal_vote_spec.rb:12 # RouteProposalVote is invalid with an invalid vote value
rspec ./spec/models/settlement/city_spec.rb:20 # Settlement::City validations is valid with valid attributes
rspec ./spec/models/settlement/city_spec.rb:24 # Settlement::City validations is not valid without a location
rspec ./spec/models/settlement/city_spec.rb:29 # Settlement::City validations is not valid without a name
rspec ./spec/models/settlement/city_spec.rb:34 # Settlement::City validations is not valid with a negative current population
rspec ./spec/models/settlement/city_spec.rb:39 # Settlement::City validations is not valid with food_per_person less than or equal to zero
rspec ./spec/models/settlement/city_spec.rb:44 # Settlement::City validations is not valid with water_per_person less than or equal to zero
rspec ./spec/models/settlement/city_spec.rb:49 # Settlement::City validations is not valid with energy_per_person less than or equal to zero
rspec ./spec/models/settlement/city_spec.rb:56 # Settlement::City#resource_requirements calculates resource requirements correctly
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:13 # Settlement::NPCColony can build a unit
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:19 # Settlement::NPCColony can establish trade routes
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:25 # Settlement::NPCColony can perform autonomous tasks
rspec ./spec/models/settlement/n_p_c_colony_spec.rb:29 # Settlement::NPCColony calculates total population across settlements
rspec ./spec/models/settlement/outpost_spec.rb:15 # Settlement::Outpost validations is valid with valid attributes
rspec ./spec/models/settlement/outpost_spec.rb:19 # Settlement::Outpost validations is not valid without a name
rspec ./spec/models/settlement/outpost_spec.rb:27 # Settlement::Outpost population capacity calculates total capacity from habitat units
rspec ./spec/models/settlement/outpost_spec.rb:34 # Settlement::Outpost population capacity calculates available capacity correctly
rspec ./spec/models/settlement/outpost_spec.rb:40 # Settlement::Outpost population capacity checks if it has capacity for additional population
rspec ./spec/models/settlement/settlement_spec.rb:20 # Settlement::Settlement validations is valid with valid attributes
rspec ./spec/models/settlement/settlement_spec.rb:24 # Settlement::Settlement validations is not valid without a name
rspec ./spec/models/settlement/settlement_spec.rb:32 # Settlement::Settlement population capacity calculates total capacity from habitat units
rspec ./spec/models/settlement/settlement_spec.rb:37 # Settlement::Settlement population capacity calculates available capacity correctly
rspec ./spec/models/settlement/settlement_spec.rb:42 # Settlement::Settlement population capacity checks if it has capacity for additional population
rspec ./spec/models/shell_printing_job_spec.rb:36 # ShellPrintingJob scopes returns active jobs
rspec ./spec/models/shell_printing_job_spec.rb:40 # ShellPrintingJob scopes returns completed jobs
rspec ./spec/models/shell_printing_job_spec.rb:44 # ShellPrintingJob scopes returns in_progress jobs
rspec ./spec/models/shell_printing_job_spec.rb:50 # ShellPrintingJob#start! changes status to in_progress and sets started_at
rspec ./spec/models/shell_printing_job_spec.rb:59 # ShellPrintingJob#complete! changes status to completed and sets completed_at
rspec ./spec/models/shell_printing_job_spec.rb:69 # ShellPrintingJob#progress_percentage calculates progress percentage
rspec ./spec/models/shell_printing_job_spec.rb:77 # ShellPrintingJob#time_remaining_hours calculates remaining time
rspec ./spec/models/shell_printing_job_spec.rb:86 # ShellPrintingJob#process_tick when job is not complete increases progress_hours
rspec ./spec/models/shell_printing_job_spec.rb:97 # ShellPrintingJob#process_tick when job completes during tick completes the job
rspec ./spec/models/solar_system_spec.rb:23 # SolarSystem associations has one spatial_location association
rspec ./spec/models/solar_system_spec.rb:30 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:31 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:32 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:33 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:34 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:35 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:36 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:38 # SolarSystem associations 
rspec ./spec/models/solar_system_spec.rb:42 # SolarSystem validations 
rspec ./spec/models/solar_system_spec.rb:43 # SolarSystem validations 
rspec ./spec/models/solar_system_spec.rb:47 # SolarSystem callbacks generates a unique name before create if name is not present
rspec ./spec/models/solar_system_spec.rb:62 # SolarSystem callbacks sets an initial star after create if no stars exist
rspec ./spec/models/solar_system_spec.rb:73 # SolarSystem#load_star loads or creates a star with the given parameters
rspec ./spec/models/solar_system_spec.rb:88 # SolarSystem#load_star updates an existing star if the name matches
rspec ./spec/models/solar_system_spec.rb:102 # SolarSystem#load_terrestrial_planet loads or creates a terrestrial planet
rspec ./spec/models/solar_system_spec.rb:110 # SolarSystem#load_terrestrial_planet updates an existing terrestrial planet if the name matches
rspec ./spec/models/solar_system_spec.rb:125 # SolarSystem#load_gas_giant loads or creates a gas giant
rspec ./spec/models/solar_system_spec.rb:133 # SolarSystem#load_gas_giant updates an existing gas giant if the name matches
rspec ./spec/models/solar_system_spec.rb:147 # SolarSystem#load_ice_giant loads or creates an ice giant
rspec ./spec/models/solar_system_spec.rb:155 # SolarSystem#load_ice_giant updates an existing ice giant if the name matches
rspec ./spec/models/solar_system_spec.rb:169 # SolarSystem#load_moon loads or creates a moon
rspec ./spec/models/solar_system_spec.rb:177 # SolarSystem#load_moon updates an existing moon if the name matches
rspec ./spec/models/solar_system_spec.rb:191 # SolarSystem#load_dwarf_planet loads or creates a dwarf planet
rspec ./spec/models/solar_system_spec.rb:200 # SolarSystem#load_dwarf_planet updates an existing dwarf planet if the name matches
rspec ./spec/models/solar_system_spec.rb:219 # SolarSystem#habitable_zone? when a planet is in the habitable zone of at least one star returns true
rspec ./spec/models/solar_system_spec.rb:227 # SolarSystem#habitable_zone? when a planet is outside the habitable zone of all stars returns false
rspec ./spec/models/solar_system_spec.rb:235 # SolarSystem#habitable_zone? when there are no stars returns false
rspec ./spec/models/solar_system_spec.rb:244 # SolarSystem#habitable_zone? when the planet does not have an orbital period returns false
rspec ./spec/models/solar_system_spec.rb:260 # SolarSystem#total_mass calculates total mass of all planets and dwarf planets
rspec ./spec/models/solar_system_spec.rb:288 # SolarSystem star relationships can have multiple stars
rspec ./spec/models/solar_system_spec.rb:302 # SolarSystem star relationships identifies the primary star by mass
rspec ./spec/models/solar_system_spec.rb:317 # SolarSystem star relationships supports binary star systems
rspec ./spec/models/storage/base_storage_spec.rb:8 # Storage::BaseStorage#add_item adds item successfully
rspec ./spec/models/storage/base_storage_spec.rb:22 # Storage::BaseStorage#remove_item removes item successfully
rspec ./spec/models/storage/base_storage_spec.rb:29 # Storage::BaseStorage#remove_item fails to remove item if not enough available
rspec ./spec/models/storage/gas_storage_spec.rb:7 # Storage::GasStorage initializes with the correct type
rspec ./spec/models/storage/solid_storage_spec.rb:7 # Storage::SolidStorage initializes with the correct type
rspec ./spec/models/terrestrial_planets_spec.rb:33 # CelestialBodies::TerrestrialPlanet runs TerraSim on planet creation
rspec ./spec/models/terrestrial_planets_spec.rb:9 # CelestialBodies::TerrestrialPlanet#update_biomes updates biomes specific to terrestrial planets
rspec ./spec/models/terrestrial_planets_spec.rb:18 # CelestialBodies::TerrestrialPlanet#add_gas adds gas and updates the mass
rspec ./spec/models/terrestrial_planets_spec.rb:27 # CelestialBodies::TerrestrialPlanet#calculate_surface_conditions calculates surface conditions specific to terrestrial planets
rspec ./spec/models/unit_assembly_job_spec.rb:53 # UnitAssemblyJob#materials_gathered? returns false when not all materials are fulfilled
rspec ./spec/models/unit_assembly_job_spec.rb:57 # UnitAssemblyJob#materials_gathered? returns true when all materials are fulfilled
rspec ./spec/models/unit_assembly_job_spec.rb:62 # UnitAssemblyJob#materials_gathered? returns true when no material requests exist
rspec ./spec/models/unit_assembly_job_spec.rb:98 # UnitAssemblyJob#start_assembly starts assembly when materials are gathered
rspec ./spec/models/unit_assembly_job_spec.rb:107 # UnitAssemblyJob#start_assembly consumes materials from inventory
rspec ./spec/models/unit_assembly_job_spec.rb:115 # UnitAssemblyJob#start_assembly returns false when not materials_pending status
rspec ./spec/models/units/base_unit_spec.rb:123 # Units::BaseUnit storage operations #store_item stores items in both inventory and operational data
rspec ./spec/models/units/base_unit_spec.rb:139 # Units::BaseUnit storage operations #store_item updates existing items
rspec ./spec/models/units/battery_spec.rb:101 # Units::Battery interaction with BatteryManagement concern prefers specialized methods over concern methods
rspec ./spec/models/waste_treatment_unit_spec.rb:18 # Units::WasteTreatmentUnit#operate operates successfully and produces recycled and neutralized output
rspec ./spec/models/waste_treatment_unit_spec.rb:27 # Units::WasteTreatmentUnit#operate returns false if insufficient waste is available
rspec ./spec/models/waste_treatment_unit_spec.rb:32 # Units::WasteTreatmentUnit#operate returns false if insufficient power is available
rspec ./spec/models/wormhole_spec.rb:44 # Wormhole associations is expected to have many endpoints class_name => SpatialLocation dependent => destroy
rspec ./spec/models/wormhole_spec.rb:129 # Wormhole#stabilization_satellites returns deployed stabilization satellites within range of either endpoint
rspec ./spec/models/wormhole_spec.rb:162 # Wormhole#operational_stabilizers returns a unique list of operational direct stabilizers and stabilization satellites
rspec ./spec/models/wormhole_spec.rb:256 # Wormhole#can_traverse? with sufficient mass limit returns true
rspec ./spec/models/wormhole_spec.rb:262 # Wormhole#can_traverse? with insufficient mass limit returns false
rspec ./spec/models/wormhole_spec.rb:301 # Wormhole#can_traverse? when one-way and already traversed returns false
rspec ./spec/models/wormhole_spec.rb:341 # Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint A when not stabilized and mass limit is hit
rspec ./spec/models/wormhole_spec.rb:353 # Wormhole#traverse! with endpoint shifting randomizes coordinates of endpoint B when not stabilized and mass limit is hit
rspec ./spec/models/wormhole_spec.rb:365 # Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint A when mass limit is hit
rspec ./spec/models/wormhole_spec.rb:377 # Wormhole#traverse! with endpoint shifting does not shift stabilized endpoint B when mass limit is hit
rspec ./spec/services/ai_manager/decision_tree_spec.rb:81 # AIManager::DecisionTree#handle_mars_oxygen_maintenance calls prioritize_energy_for_o2_generation on resource_planner
rspec ./spec/services/ai_manager/decision_tree_spec.rb:97 # AIManager::DecisionTree#handle_mars_nitrogen_import finds closest resource source and creates interplanetary contract
rspec ./spec/services/ai_manager/operational_manager_spec.rb:59 # AIManager::OperationalManager#make_decision when stable and expansion is feasible considers expansion
rspec ./spec/services/ai_manager/operational_manager_spec.rb:76 # AIManager::OperationalManager#make_decision when stable with no expansion opportunities maintains current operations
rspec ./spec/services/ai_manager/operational_manager_spec.rb:181 # AIManager::OperationalManager decision logging logs decisions with timestamps and categories
rspec ./spec/services/ai_manager/system_architect_spec.rb:99 # AIManager::SystemArchitect#deploy_subsurface_foothold creates subsurface location
rspec ./spec/services/ai_manager/system_architect_spec.rb:103 # AIManager::SystemArchitect#deploy_subsurface_foothold creates settlement
rspec ./spec/services/ai_manager/system_architect_spec.rb:120 # AIManager::SystemArchitect#find_nearby_asteroid with suitable asteroid finds the asteroid
rspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:24 # AIManager::SystemIntelligenceService#system_status with operational structures returns correct operational ratio and status
rspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:47 # AIManager::SystemIntelligenceService#system_status with all operational structures returns healthy status
rspec ./spec/services/ai_manager/system_intelligence_service_spec.rb:59 # AIManager::SystemIntelligenceService#system_status with mostly non-operational structures returns critical status
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:517 # AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure creates a crater dome structure
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:526 # AIManager::TaskExecutionEngine#initiate_construction with crater_dome structure uses ConstructionJobService
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:645 # AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply schedules a material ferry mission
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:651 # AIManager::TaskExecutionEngine.orbital_resupply_cycle when conditions are met for resupply updates craft status
rspec ./spec/services/ai_manager/task_execution_engine_spec.rb:663 # AIManager::TaskExecutionEngine.orbital_resupply_cycle when no active projects does not schedule missions
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:17 # AIManager::TerraformingManager#calculate_gas_needs with magnetosphere protection returns gas needs for warming phase
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:27 # AIManager::TerraformingManager#calculate_gas_needs without magnetosphere protection returns empty hash
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:37 # AIManager::TerraformingManager#calculate_gas_needs with preservation mode and exceeded limit returns empty hash
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:48 # AIManager::TerraformingManager#has_magnetosphere_protection? with natural magnetosphere returns true
rspec ./spec/services/ai_manager/terraforming_manager_spec.rb:54 # AIManager::TerraformingManager#has_magnetosphere_protection? without natural magnetosphere returns false
rspec ./spec/services/autonomous_mission_service_spec.rb:12 # AutonomousMissionService.find_or_create_worldhouse_feature when a lava tube exists returns the existing lava tube
rspec ./spec/services/autonomous_mission_service_spec.rb:54 # AutonomousMissionService.find_or_create_worldhouse_feature priority order prioritizes lava tube over valley and canyon
rspec ./spec/services/autonomous_mission_service_spec.rb:85 # AutonomousMissionService.execute_base_building_sequence calls the feature finding method
rspec ./spec/services/autonomous_mission_service_spec.rb:91 # AutonomousMissionService.execute_base_building_sequence logs mission progress
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:74 # Construction::OrbitalShipyardService.deliver_materials when material is needed consumes the material for the project
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:80 # Construction::OrbitalShipyardService.deliver_materials when material is needed returns the unconsumed quantity
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:85 # Construction::OrbitalShipyardService.deliver_materials when material is needed does not consume more than needed
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:96 # Construction::OrbitalShipyardService.deliver_materials when material is not needed returns the full quantity
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:101 # Construction::OrbitalShipyardService.deliver_materials when material is not needed does not update any project materials
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:113 # Construction::OrbitalShipyardService.deliver_materials when project becomes ready changes status to in_progress when all materials are delivered
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:130 # Construction::OrbitalShipyardService.deliver_materials with multiple projects distributes materials across projects
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:155 # Construction::OrbitalShipyardService.update_construction_progress does not exceed 100%
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:177 # Construction::OrbitalShipyardService.complete_project marks the project as completed
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:192 # Construction::OrbitalShipyardService.spawn_completed_craft creates a new craft
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:198 # Construction::OrbitalShipyardService.spawn_completed_craft associates the craft with the station
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:203 # Construction::OrbitalShipyardService.spawn_completed_craft sets the craft status to docked
rspec ./spec/services/construction/orbital_shipyard_service_spec.rb:208 # Construction::OrbitalShipyardService.spawn_completed_craft loads operational data from blueprint
rspec ./spec/services/crater_dome_construction_service_spec.rb:90 # CraterDomeConstructionService#construct creates a construction job successfully
rspec ./spec/services/crater_dome_construction_service_spec.rb:110 # CraterDomeConstructionService#construct when entity is different from service provider processes a payment
rspec ./spec/services/crater_dome_construction_service_spec.rb:169 # CraterDomeConstructionService#start_construction starts the construction process
rspec ./spec/services/crater_dome_construction_service_spec.rb:214 # CraterDomeConstructionService#complete_construction completes the construction process
rspec ./spec/services/fitting_service_spec.rb:30 # FittingService fits all components from inventory
rspec ./spec/services/fitting_service_spec.rb:47 # FittingService fits components without inventory if inventory is nil
rspec ./spec/services/game_spec.rb:66 # Game#advance_by_days advances the simulation by the given number of days
rspec ./spec/services/game_spec.rb:72 # Game#advance_by_days does not advance time if days is zero or negative
rspec ./spec/services/generators/lava_tube_generator_spec.rb:9 # Generators::LavaTubeGenerator#generate with random generation creates a lava tube with random features
rspec ./spec/services/generators/lava_tube_generator_spec.rb:21 # Generators::LavaTubeGenerator#generate with random generation generates random dimensions
rspec ./spec/services/generators/lava_tube_generator_spec.rb:30 # Generators::LavaTubeGenerator#generate with random generation generates random attributes
rspec ./spec/services/generators/lava_tube_generator_spec.rb:39 # Generators::LavaTubeGenerator#generate with random generation creates random skylights and access points
rspec ./spec/services/generators/lava_tube_generator_spec.rb:88 # Generators::LavaTubeGenerator#generate with predefined parameters creates a lava tube with specified parameters
rspec ./spec/services/generators/lava_tube_generator_spec.rb:108 # Generators::LavaTubeGenerator#generate with predefined parameters creates predefined skylights and access points
rspec ./spec/services/generators/lava_tube_generator_spec.rb:127 # Generators::LavaTubeGenerator#generate with minimal parameters creates a lava tube with defaults
rspec ./spec/services/generators/valley_generator_spec.rb:8 # Generators::ValleyGenerator#generate with random generation creates a valley with random features
rspec ./spec/services/generators/valley_generator_spec.rb:20 # Generators::ValleyGenerator#generate with random generation generates random dimensions
rspec ./spec/services/generators/valley_generator_spec.rb:29 # Generators::ValleyGenerator#generate with random generation generates segments
rspec ./spec/services/generators/valley_generator_spec.rb:44 # Generators::ValleyGenerator#generate with random generation creates random access points
rspec ./spec/services/generators/valley_generator_spec.rb:81 # Generators::ValleyGenerator#generate with predefined parameters creates a valley with specified parameters
rspec ./spec/services/generators/valley_generator_spec.rb:95 # Generators::ValleyGenerator#generate with predefined parameters creates predefined access points
rspec ./spec/services/logistics/contract_service_spec.rb:18 # Logistics::ContractService.create_internal_transfer with valid settlements creates a logistics contract for internal transfer
rspec ./spec/services/logistics/inventory_manager_spec.rb:23 # Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects intercepts materials for orbital construction
rspec ./spec/services/logistics/inventory_manager_spec.rb:40 # Logistics::InventoryManager.transfer_item when transferring to a station with orbital construction projects does not add materials to station inventory if all consumed by projects
rspec ./spec/services/logistics/inventory_manager_spec.rb:62 # Logistics::InventoryManager.transfer_item when transferring orbital construction materials to non-orbital settlement transfers materials normally without interception
rspec ./spec/services/logistics/inventory_manager_spec.rb:81 # Logistics::InventoryManager.transfer_item when transferring non-orbital materials to orbital station transfers materials normally without interception
rspec ./spec/services/lookup/craft_lookup_service_spec.rb:19 # Lookup::CraftLookupService#find_craft loads JSON files with correct format
rspec ./spec/services/lookup/item_lookup_service_spec.rb:8 # Lookup::ItemLookupService#find_item loads items from the correct file structure
rspec ./spec/services/lookup/item_lookup_service_spec.rb:61 # Lookup::ItemLookupService#find_item handles scrap items dynamically
rspec ./spec/services/lookup/item_lookup_service_spec.rb:124 # Lookup::ItemLookupService dynamic item creation creates scrap items on the fly
rspec ./spec/services/lookup/item_lookup_service_spec.rb:132 # Lookup::ItemLookupService dynamic item creation creates processed items on the fly
rspec ./spec/services/lookup/item_lookup_service_spec.rb:140 # Lookup::ItemLookupService dynamic item creation creates used items on the fly
rspec ./spec/services/lookup/material_lookup_service_spec.rb:207 # Lookup::MaterialLookupService.locate_gases_path uses GalaxyGame::Paths consistently
rspec ./spec/services/lookup/material_lookup_service_spec.rb:254 # Lookup::MaterialLookupService error handling with corrupted JSON files handles JSON parsing errors gracefully
rspec ./spec/services/lookup/module_lookup_service_spec.rb:49 # Lookup::ModuleLookupService service configuration has the correct base path
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:20 # Lookup::PlanetaryGeologicalFeatureLookupService#initialize initializes with a celestial body
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:25 # Lookup::PlanetaryGeologicalFeatureLookupService#initialize loads features during initialization
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:46 # Lookup::PlanetaryGeologicalFeatureLookupService#all_features returns all loaded features
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:63 # Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles multiple JSON files
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:80 # Lookup::PlanetaryGeologicalFeatureLookupService#all_features handles single feature JSON files
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:108 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by exact name match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:117 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by case-insensitive name match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:125 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name finds a feature by lowercase name match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:133 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns nil when feature is not found
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:140 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name handles symbol input
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:150 # Lookup::PlanetaryGeologicalFeatureLookupService#find_by_name returns the first match when multiple features have the same name
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:182 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features of a specific type
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:190 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns features by case-insensitive type match
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:197 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type returns empty array when no features of that type exist
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:204 # Lookup::PlanetaryGeologicalFeatureLookupService#features_by_type handles symbol input
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:229 # Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary groups features by type
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:242 # Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary handles features with nil type
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:250 # Lookup::PlanetaryGeologicalFeatureLookupService#feature_summary returns empty hash when no features exist
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:259 # Lookup::PlanetaryGeologicalFeatureLookupService path construction constructs correct path for planet
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:280 # Lookup::PlanetaryGeologicalFeatureLookupService error handling handles JSON parse errors gracefully
rspec ./spec/services/lookup/planetary_geological_feature_lookup_service_spec.rb:296 # Lookup::PlanetaryGeologicalFeatureLookupService error handling logs debug information about found files
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:103 # Lookup::UnitLookupService#find_unit finds units case-insensitively by ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:54 # Lookup::UnitLookupService#find_unit with propulsion units finds propulsion units by their exact ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:63 # Lookup::UnitLookupService#find_unit with propulsion units has expected propulsion unit properties
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:93 # Lookup::UnitLookupService#find_unit with robot units finds robot units by their ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:123 # Lookup::UnitLookupService service configuration has all expected unit categories
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:217 # Lookup::UnitLookupService matching behavior matches by exact ID
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:222 # Lookup::UnitLookupService matching behavior matches by exact name
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:226 # Lookup::UnitLookupService matching behavior matches by partial ID with sufficient length
rspec ./spec/services/lookup/unit_lookup_service_spec.rb:233 # Lookup::UnitLookupService matching behavior is case insensitive
rspec ./spec/services/manfacturing_service_spec.rb:52 # ManufacturingService.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
rspec ./spec/services/manfacturing_service_spec.rb:82 # ManufacturingService.manufacture with real blueprints works with different blueprint categories
rspec ./spec/services/manfacturing_service_spec.rb:112 # ManufacturingService.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
rspec ./spec/services/manfacturing_service_spec.rb:138 # ManufacturingService.manufacture with different construction cost percentages uses settlement's custom construction percentage
rspec ./spec/services/manfacturing_service_spec.rb:161 # ManufacturingService.manufacture with real blueprint data creates material requests based on actual blueprint requirements
rspec ./spec/services/manfacturing_service_spec.rb:208 # ManufacturingService.manufacture with real blueprint data automatically fulfills material requirements when materials are available
rspec ./spec/services/manfacturing_service_spec.rb:266 # ManufacturingService.manufacture with real blueprint data stores actual blueprint data in specifications
rspec ./spec/services/manfacturing_service_spec.rb:291 # ManufacturingService.manufacture with invalid blueprint returns failure when blueprint not found
rspec ./spec/services/manufacturing/assembly_service_spec.rb:56 # Manufacturing::AssemblyService.start_assembly with all materials available charges the tenant fee
rspec ./spec/services/manufacturing/component_production_integration_spec.rb:82 # Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) creates a production job using real blueprint
rspec ./spec/services/manufacturing/component_production_integration_spec.rb:93 # Component Production Integration with real blueprint files producing mk1 I-beams (bootstrap version) consumes depleted_regolith from inventory
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:10 # Manufacturing::Construction::CoveringService#initialize initializes with coverable, panel type, and settlement
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:18 # Manufacturing::Construction::CoveringService#initialize uses default panel type if not provided
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:23 # Manufacturing::Construction::CoveringService#initialize finds settlement from coverable if not provided
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:32 # Manufacturing::Construction::CoveringService#calculate_materials calculates base materials using CoveringCalculator
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:48 # Manufacturing::Construction::CoveringService#calculate_materials merges panel-specific materials
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:61 # Manufacturing::Construction::CoveringService#calculate_materials sums quantities for duplicate materials
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:84 # Manufacturing::Construction::CoveringService#schedule_construction returns error if no settlement
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:94 # Manufacturing::Construction::CoveringService#schedule_construction returns error if no blueprint found
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:103 # Manufacturing::Construction::CoveringService#schedule_construction creates a construction job
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:109 # Manufacturing::Construction::CoveringService#schedule_construction creates material requests
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:114 # Manufacturing::Construction::CoveringService#schedule_construction creates equipment requests
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:119 # Manufacturing::Construction::CoveringService#schedule_construction updates coverable status to materials_requested
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:124 # Manufacturing::Construction::CoveringService#schedule_construction returns success with construction job
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:142 # Manufacturing::Construction::CoveringService#start_construction returns false if materials not gathered
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:147 # Manufacturing::Construction::CoveringService#start_construction returns false if equipment not gathered
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:154 # Manufacturing::Construction::CoveringService#start_construction updates job status to in_progress
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:163 # Manufacturing::Construction::CoveringService#start_construction assigns builders through ConstructionManager
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:171 # Manufacturing::Construction::CoveringService#start_construction updates coverable status to under_construction
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:191 # Manufacturing::Construction::CoveringService#track_progress returns false if job not in progress
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:196 # Manufacturing::Construction::CoveringService#track_progress returns false if construction not complete
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:201 # Manufacturing::Construction::CoveringService#track_progress completes construction when work is done
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:209 # Manufacturing::Construction::CoveringService#track_progress updates coverable status
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:217 # Manufacturing::Construction::CoveringService#track_progress releases equipment
rspec ./spec/services/manufacturing/construction/covering_service_spec.rb:224 # Manufacturing::Construction::CoveringService#track_progress returns true when complete
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:76 # Manufacturing::Construction::DomeService#initialize initializes with default panel type
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:83 # Manufacturing::Construction::DomeService#initialize initializes with custom panel type
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:87 # Manufacturing::Construction::DomeService#initialize defaults service provider to entity
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:93 # Manufacturing::Construction::DomeService#schedule_construction creates a construction job successfully
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:107 # Manufacturing::Construction::DomeService#schedule_construction fails when no settlement found
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:116 # Manufacturing::Construction::DomeService#schedule_construction creates material and equipment requests for player construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:134 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider processes payment for contracted construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:145 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider does not create material requests for contracted construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:153 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider marks materials and equipment as provided by contractor
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:161 # Manufacturing::Construction::DomeService#schedule_construction when entity is different from service provider handles payment failure gracefully
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:198 # Manufacturing::Construction::DomeService#start_construction starts construction when materials and equipment are ready
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:207 # Manufacturing::Construction::DomeService#start_construction fails when materials not ready for player construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:215 # Manufacturing::Construction::DomeService#start_construction bypasses checks for contracted construction
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:246 # Manufacturing::Construction::DomeService#track_progress completes construction when work is finished
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:257 # Manufacturing::Construction::DomeService#track_progress returns false when construction not complete
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:264 # Manufacturing::Construction::DomeService#track_progress sets correct status for different layer types
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:275 # Manufacturing::Construction::DomeService#track_progress releases equipment when construction completes
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:300 # Manufacturing::Construction::DomeService#complete_construction completes the construction process
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:311 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for primary layer
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:316 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for secondary layer
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:321 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns correct status for both layers
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:326 # Manufacturing::Construction::DomeService private methods #determine_completion_status returns operational for unknown layer types
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:333 # Manufacturing::Construction::DomeService private methods #is_player_construction? returns true when entity and provider are the same
rspec ./spec/services/manufacturing/construction/dome_service_spec.rb:345 # Manufacturing::Construction::DomeService private methods #is_player_construction? returns false when entity and provider are different
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:67 # Manufacturing::Construction::HangarService#initialize initializes with default hangar type
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:73 # Manufacturing::Construction::HangarService#initialize initializes with custom hangar type
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:77 # Manufacturing::Construction::HangarService#initialize raises error for non-large access points
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:87 # Manufacturing::Construction::HangarService#schedule_construction creates a hangar structure successfully
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:96 # Manufacturing::Construction::HangarService#schedule_construction creates a construction job
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:106 # Manufacturing::Construction::HangarService#schedule_construction connects the access point to the hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:113 # Manufacturing::Construction::HangarService#schedule_construction fails when no settlement found
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:122 # Manufacturing::Construction::HangarService#schedule_construction fails when no blueprint found
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:131 # Manufacturing::Construction::HangarService#schedule_construction creates material and equipment requests
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:138 # Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for standard rover hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:145 # Manufacturing::Construction::HangarService#schedule_construction calculates correct capacity for large craft hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:190 # Manufacturing::Construction::HangarService#start_construction starts construction when materials and equipment are ready
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:199 # Manufacturing::Construction::HangarService#start_construction fails when materials not ready
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:207 # Manufacturing::Construction::HangarService#start_construction fails when equipment not ready
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:244 # Manufacturing::Construction::HangarService#track_progress completes construction when work is finished
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:256 # Manufacturing::Construction::HangarService#track_progress returns false when construction not complete
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:263 # Manufacturing::Construction::HangarService#track_progress releases equipment when construction completes
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:272 # Manufacturing::Construction::HangarService#calculate_materials calculates materials for standard rover hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:281 # Manufacturing::Construction::HangarService#calculate_materials calculates materials for large craft hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:290 # Manufacturing::Construction::HangarService#calculate_materials merges blueprint materials with specific materials
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:300 # Manufacturing::Construction::HangarService#calculate_construction_time calculates base time for standard hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:305 # Manufacturing::Construction::HangarService#calculate_construction_time calculates longer time for large craft hangar
rspec ./spec/services/manufacturing/construction/hangar_service_spec.rb:312 # Manufacturing::Construction::HangarService#calculate_equipment_requirements calculates equipment requirements
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:18 # Manufacturing::Construction::SegmentCoveringService#initialize uses modular_structural_panel as default
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:23 # Manufacturing::Construction::SegmentCoveringService#initialize finds settlement from worldhouse
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:32 # Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials calculates worldhouse-scale materials
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:40 # Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials includes cable calculations for massive segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:48 # Manufacturing::Construction::SegmentCoveringService#calculate_panel_specific_materials scales materials by panel count
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:61 # Manufacturing::Construction::SegmentCoveringService#complexity_factor returns 1.5 base factor for worldhouse
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:66 # Manufacturing::Construction::SegmentCoveringService#complexity_factor increases factor for very large segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:77 # Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires minimum 10 printers for worldhouse
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:84 # Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements requires heavy equipment
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:91 # Manufacturing::Construction::SegmentCoveringService#calculate_equipment_requirements scales equipment for massive segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:114 # Manufacturing::Construction::SegmentCoveringService#schedule_construction creates construction phases for large segments
rspec ./spec/services/manufacturing/construction/segment_covering_service_spec.rb:127 # Manufacturing::Construction::SegmentCoveringService#schedule_construction includes phase names and durations
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:18 # Manufacturing::Construction::SkylightService#initialize uses skylight-specific default panel type
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:23 # Manufacturing::Construction::SkylightService#initialize finds settlement from lava tube
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:32 # Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates transparent panel materials
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:40 # Manufacturing::Construction::SkylightService#calculate_panel_specific_materials calculates solar panel materials
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:47 # Manufacturing::Construction::SkylightService#calculate_panel_specific_materials scales materials by panel count
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:59 # Manufacturing::Construction::SkylightService#complexity_factor returns 1.0 for basic transparent panels
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:64 # Manufacturing::Construction::SkylightService#complexity_factor returns 1.5 for solar panels
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:69 # Manufacturing::Construction::SkylightService#complexity_factor returns 1.3 for thermal insulation
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:78 # Manufacturing::Construction::SkylightService#determine_completion_status returns primary_cover for basic transparent
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:83 # Manufacturing::Construction::SkylightService#determine_completion_status returns solar_cover for solar panels
rspec ./spec/services/manufacturing/construction/skylight_service_spec.rb:88 # Manufacturing::Construction::SkylightService#determine_completion_status returns full_cover for structural on primary cover
rspec ./spec/services/manufacturing/cost_calculator_spec.rb:65 # Manufacturing::CostCalculator Earth-Imported COGS (EAP-COGS) calculates the EAP-COGS (Earth Import Cost) for the unit
rspec ./spec/services/manufacturing/cost_calculator_spec.rb:86 # Manufacturing::CostCalculator Local Production COGS (LAP-COGS) calculates the LAP-COGS (Local Production Cost) for the unit
rspec ./spec/services/manufacturing/material_processing_service_spec.rb:94 # Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs creates a material processing job record
rspec ./spec/services/manufacturing/material_processing_service_spec.rb:110 # Manufacturing::MaterialProcessingService#volatiles_extraction with valid inputs produces gases with correct composition after job completion
rspec ./spec/services/manufacturing/material_request_system_spec.rb:8 # Manufacturing::MaterialRequest.create_material_requests creates requests for all required materials
rspec ./spec/services/manufacturing/processing_spec.rb:101 # Manufacturing::Processing#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
rspec ./spec/services/manufacturing/processing_spec.rb:114 # Manufacturing::Processing#process when owner does not have enough resources returns an error when resources are insufficient
rspec ./spec/services/manufacturing/processing_spec.rb:126 # Manufacturing::Processing#process when owner does not have enough GCC raises an error when GCC is insufficient
rspec ./spec/services/manufacturing/service_spec.rb:52 # Manufacturing::Service.manufacture with real blueprints creates a UnitAssemblyJob and charges construction cost using real blueprint
rspec ./spec/services/manufacturing/service_spec.rb:80 # Manufacturing::Service.manufacture with real blueprints works with different blueprint categories
rspec ./spec/services/manufacturing/service_spec.rb:110 # Manufacturing::Service.manufacture with sufficient funds creates a UnitAssemblyJob and charges the player construction cost
rspec ./spec/services/manufacturing/service_spec.rb:136 # Manufacturing::Service.manufacture with different construction cost percentages uses settlement's custom construction percentage
rspec ./spec/services/manufacturing/service_spec.rb:159 # Manufacturing::Service.manufacture with real blueprint data creates material requests based on actual blueprint requirements
rspec ./spec/services/manufacturing/service_spec.rb:206 # Manufacturing::Service.manufacture with real blueprint data automatically fulfills material requirements when materials are available
rspec ./spec/services/manufacturing/service_spec.rb:268 # Manufacturing::Service.manufacture with real blueprint data stores actual blueprint data in specifications
rspec ./spec/services/manufacturing/service_spec.rb:293 # Manufacturing::Service.manufacture with invalid blueprint returns failure when blueprint not found
rspec ./spec/services/market/trade_execution_service_spec.rb:87 # Market::TradeExecutionService returns true on successful execution
rspec ./spec/services/market/trade_execution_service_spec.rb:93 # Market::TradeExecutionService calls the TaxCollectionService with gross revenue and seller
rspec ./spec/services/market/trade_execution_service_spec.rb:103 # Market::TradeExecutionService calls TransactionManager.create_transfer with the NET amount
rspec ./spec/services/market/trade_execution_service_spec.rb:119 # Market::TradeExecutionService removes inventory from seller
rspec ./spec/services/market/trade_execution_service_spec.rb:124 # Market::TradeExecutionService creates a trade record
rspec ./spec/services/market/trade_execution_service_spec.rb:129 # Market::TradeExecutionService creates a price history record
rspec ./spec/services/market/trade_execution_service_spec.rb:134 # Market::TradeExecutionService creates a supply chain record
rspec ./spec/services/material_lookup_service_spec.rb:15 # MaterialLookupService#find_material returns the correct material
rspec ./spec/services/material_lookup_service_spec.rb:21 # MaterialLookupService#find_material returns nil for a nonexistent material
rspec ./spec/services/material_request_service_spec.rb:8 # MaterialRequestService.create_material_requests creates requests for all required materials
rspec ./spec/services/naming/planet_name_service_spec.rb:86 # Naming::PlanetNameService#add_suffix_to_name adds a suffix to the base name
rspec ./spec/services/pressurization/habitat_pressurization_service_spec.rb:19 # Pressurization::HabitatPressurizationService#calculate_habitat_volume calculates correct volume for crater dome
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:21 # Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available sources gases from depot tanks
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:27 # Pressurization::StructurePressurizationService.pressurize_structure when depot tanks are available uses depot tank gases for pressurization
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:59 # Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks aggregates gases from all depot tanks
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:66 # Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when settlement has depot tanks returns empty hash when no gases are stored
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:92 # Pressurization::StructurePressurizationService.source_gases_from_depot_tanks when depot tanks have no gas_storage data returns empty hash
rspec ./spec/services/pressurization/structure_pressurization_service_spec.rb:108 # Pressurization::StructurePressurizationService mining byproduct integration when mining Si produces O2 byproduct increases available gases from depot tanks for pressurization
rspec ./spec/services/pressurization_service_spec.rb:24 # PressurizationService#check_sealing_status with traditional sealed environment returns ready for sealed environment
rspec ./spec/services/pressurization_service_spec.rb:30 # PressurizationService#check_sealing_status with traditional sealed environment returns not ready for unsealed environment
rspec ./spec/services/pressurization_service_spec.rb:62 # PressurizationService#check_sealing_status with pressurization target (lava tube) returns not ready when requirements not met
rspec ./spec/services/pressurization_service_spec.rb:69 # PressurizationService#check_sealing_status with pressurization target (lava tube) returns ready when requirements met
rspec ./spec/services/pressurization_service_spec.rb:88 # PressurizationService#check_sealing_status with pressurization target (canyon) returns not ready when requirements not met
rspec ./spec/services/processing_service_spec.rb:101 # ProcessingService#process when owner has sufficient resources and funds successfully processes the blueprint and creates unassembled items
rspec ./spec/services/processing_service_spec.rb:114 # ProcessingService#process when owner does not have enough resources returns an error when resources are insufficient
rspec ./spec/services/processing_service_spec.rb:126 # ProcessingService#process when owner does not have enough GCC raises an error when GCC is insufficient
rspec ./spec/services/star_sim/procedural_generator_spec.rb:163 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests terraformed names for template-based planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:175 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates requests neutral names for procedural planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:187 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates applies orbital optimization for template-based planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:201 # StarSim::ProceduralGenerator#generate_terrestrial_planets with available templates generates procedural planets when not using templates
rspec ./spec/services/star_sim/procedural_generator_spec.rb:313 # StarSim::ProceduralGenerator#generate_biosphere_data provides enhanced biosphere for template-based planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:328 # StarSim::ProceduralGenerator#generate_biosphere_data provides basic biosphere for planets with good conditions
rspec ./spec/services/star_sim/procedural_generator_spec.rb:341 # StarSim::ProceduralGenerator#generate_biosphere_data returns empty biosphere for unsuitable planets
rspec ./spec/services/star_sim/procedural_generator_spec.rb:447 # StarSim::ProceduralGenerator integration test generates a complete, valid system
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:23 # TerraSim::AtmosphereSimulationService#initialize initializes with a celestial body
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:27 # TerraSim::AtmosphereSimulationService#initialize sets up the Stefan-Boltzmann constant
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:52 # TerraSim::AtmosphereSimulationService#simulate updates the pressure
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:57 # TerraSim::AtmosphereSimulationService#simulate calculates the greenhouse effect
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:63 # TerraSim::AtmosphereSimulationService#simulate updates temperature data in the atmosphere
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:76 # TerraSim::AtmosphereSimulationService#simulate simulates atmospheric loss
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:82 # TerraSim::AtmosphereSimulationService#simulate decreases dust
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:105 # TerraSim::AtmosphereSimulationService temperature calculation methods calculates stefan_boltzmann_temp correctly
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:110 # TerraSim::AtmosphereSimulationService temperature calculation methods calculates greenhouse_adjusted_temp correctly
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:115 # TerraSim::AtmosphereSimulationService temperature calculation methods calculates water_vapor_pressure correctly
rspec ./spec/services/terra_sim/atmosphere_simulation_service_spec.rb:122 # TerraSim::AtmosphereSimulationService#update_temperatures updates all temperature types in atmosphere
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:88 # TerraSim::GeosphereInitializer ice giant initialization sets up ice_tectonics_enabled for ice giants
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:159 # TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for planets with atmospheres
rspec ./spec/services/terra_sim/geosphere_initializer_spec.rb:175 # TerraSim::GeosphereInitializer regolith property initialization initializes regolith properties for airless bodies
rspec ./spec/services/terra_sim/geosphere_simulation_service_spec.rb:50 # TerraSim::GeosphereSimulationService#simulate_tectonic_activity updates plate positions when tectonic activity is enabled
rspec ./spec/services/trade_service_spec.rb:11 # TradeService#dynamic_price calculates the dynamic price based on scarcity, transportation, and market conditions
rspec ./spec/services/trade_service_spec.rb:27 # TradeService#base_price_for_type returns the correct base price for raw materials
rspec ./spec/services/trade_service_spec.rb:32 # TradeService#base_price_for_type returns the correct base price for processed goods
rspec ./spec/services/trade_service_spec.rb:40 # TradeService#fuel_cost_per_unit returns the correct fuel cost per unit
rspec ./spec/services/trade_service_spec.rb:47 # TradeService#distance_to_buyer calculates the distance between colonies
rspec ./spec/services/trade_service_spec.rb:59 # TradeService#market_conditions returns a random market condition modifier
rspec ./spec/services/unit_module_assembly_service_spec.rb:49 # UnitModuleAssemblyService.build_units_and_modules creates units from the recommended fit
rspec ./spec/services/unit_module_assembly_service_spec.rb:73 # UnitModuleAssemblyService.build_units_and_modules creates modules from the recommended fit
rspec ./spec/services/unit_module_assembly_service_spec.rb:87 # UnitModuleAssemblyService.build_units_and_modules creates rigs from the recommended fit
rspec ./spec/services/unit_module_assembly_service_spec.rb:101 # UnitModuleAssemblyService.build_units_and_modules processes custom port configurations
rspec ./spec/services/unit_module_assembly_service_spec.rb:117 # UnitModuleAssemblyService.build_units_and_modules handles missing inventory items gracefully
rspec ./spec/services/unit_module_assembly_service_spec.rb:134 # UnitModuleAssemblyService.build_units_and_modules handles missing recommended fit data gracefully
rspec ./spec/services/unit_module_assembly_service_spec.rb:161 # UnitModuleAssemblyService.build_units_and_modules assigns correct port names to components
rspec ./spec/services/unit_module_assembly_service_spec.rb:190 # UnitModuleAssemblyService.disconnect_unit disconnects a unit and returns it to inventory as an item
rspec ./spec/services/wormhole_consortium_formation_service_spec.rb:10 # WormholeConsortiumFormationService creates memberships for founding members and updates consortium operational_data
rspec ./spec/services/wormhole_consortium_formation_service_spec.rb:21 # WormholeConsortiumFormationService updates member operational_data with consortium membership

